!function o(i,s,l){function u(r,e){if(!s[r]){if(!i[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[r]={exports:{}};i[r][0].call(a.exports,function(e){var t=i[r][1][e];return u(t||e)},a,a.exports,o,i,s,l)}return s[r].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,r){"use strict";r.toByteArray=function(e){var t,r,n,a,o,i,s=e.length;if(0<s%4)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[s-2]?2:"="===e[s-1]?1:0,i=new d(3*s/4-o),n=0<o?s-4:s;var l=0;for(r=t=0;t<n;t+=4,r+=3)a=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],i[l++]=a>>16&255,i[l++]=a>>8&255,i[l++]=255&a;2===o?(a=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,i[l++]=255&a):1===o&&(a=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,i[l++]=a>>8&255,i[l++]=255&a);return i},r.fromByteArray=function(e){for(var t,r=e.length,n=r%3,a="",o=[],i=16383,s=0,l=r-n;s<l;s+=i)o.push(f(e,s,l<s+i?l:s+i));1===n?(t=e[r-1],a+=u[t>>2],a+=u[t<<4&63],a+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],a+=u[t>>10],a+=u[t>>4&63],a+=u[t<<2&63],a+="=");return o.push(a),o.join("")};var u=[],c=[],d="undefined"!=typeof Uint8Array?Uint8Array:Array;function f(e,t,r){for(var n,a,o=[],i=t;i<r;i+=3)n=(e[i]<<16)+(e[i+1]<<8)+e[i+2],o.push(u[(a=n)>>18&63]+u[a>>12&63]+u[a>>6&63]+u[63&a]);return o.join("")}!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,r=e.length;t<r;++t)u[t]=e[t],c[e.charCodeAt(t)]=t;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63}()},{}],2:[function(t,e,I){(function(e){"use strict";var n=t("base64-js"),o=t("ieee754"),i=t("isarray");function r(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=d.prototype:(null===e&&(e=new d(t)),e.length=t),e}function d(e,t,r){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return a(this,e,t,r)}function a(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);d.TYPED_ARRAY_SUPPORT?(e=t).__proto__=d.prototype:e=c(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!d.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,r),a=(e=s(e,n)).write(t,r);a!==n&&(e=e.slice(0,a));return e}(e,t,r):function(e,t){if(d.isBuffer(t)){var r=0|f(t.length);return 0===(e=s(e,r)).length||t.copy(e,0,0,r),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):c(e,t);if("Buffer"===t.type&&i(t.data))return c(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number')}function u(e,t){if(l(t),e=s(e,t<0?0:0|f(t)),!d.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function c(e,t){var r=0|f(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function p(e,t){if(d.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(n)return q(e).length;t=(""+t).toLowerCase(),n=!0}}function h(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,a){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=a?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(a)return-1;r=e.length-1}else if(r<0){if(!a)return-1;r=0}if("string"==typeof t&&(t=d.from(t,n)),d.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,a);if("number"==typeof t)return t&=255,d.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,a);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,a){var o,i=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s/=i=2,l/=2,r/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(a){var c=-1;for(o=r;o<s;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*i}else-1!==c&&(o-=o-c),c=-1}else for(s<r+l&&(r=s-l),o=r;0<=o;o--){for(var d=!0,f=0;f<l;f++)if(u(e,o+f)!==u(t,f)){d=!1;break}if(d)return o}return-1}function m(e,t,r,n){r=Number(r)||0;var a=e.length-r;n?a<(n=Number(n))&&(n=a):n=a;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<n&&(n=o/2);for(var i=0;i<n;++i){var s=parseInt(t.substr(2*i,2),16);if(isNaN(s))return i;e[r+i]=s}return i}function y(e,t,r,n){return P(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function x(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function b(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var o,i,s,l,u=e[a],c=null,d=239<u?4:223<u?3:191<u?2:1;if(a+d<=r)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[a+1]))&&127<(l=(31&u)<<6|63&o)&&(c=l);break;case 3:o=e[a+1],i=e[a+2],128==(192&o)&&128==(192&i)&&2047<(l=(15&u)<<12|(63&o)<<6|63&i)&&(l<55296||57343<l)&&(c=l);break;case 4:o=e[a+1],i=e[a+2],s=e[a+3],128==(192&o)&&128==(192&i)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&o)<<12|(63&i)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,d=1):65535<c&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),a+=d}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=w));return r}(n)}I.Buffer=d,I.SlowBuffer=function(e){+e!=e&&(e=0);return d.alloc(+e)},I.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),I.kMaxLength=r(),d.poolSize=8192,d._augment=function(e){return e.__proto__=d.prototype,e},d.from=function(e,t,r){return a(null,e,t,r)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(e,t,r){return n=null,o=t,i=r,l(a=e),a<=0?s(n,a):void 0!==o?"string"==typeof i?s(n,a).fill(o,i):s(n,a).fill(o):s(n,a);var n,a,o,i},d.allocUnsafe=function(e){return u(null,e)},d.allocUnsafeSlow=function(e){return u(null,e)},d.isBuffer=function(e){return!(null==e||!e._isBuffer)},d.compare=function(e,t){if(!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,a=0,o=Math.min(r,n);a<o;++a)if(e[a]!==t[a]){r=e[a],n=t[a];break}return r<n?-1:n<r?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var r;if(void 0===t)for(r=t=0;r<e.length;++r)t+=e[r].length;var n=d.allocUnsafe(t),a=0;for(r=0;r<e.length;++r){var o=e[r];if(!d.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,a),a+=o.length}return n},d.byteLength=p,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},d.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?b(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return z(this,t,r);case"utf8":case"utf-8":return b(this,t,r);case"ascii":return _(this,t,r);case"latin1":case"binary":return k(this,t,r);case"base64":return x(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=I.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},d.prototype.compare=function(e,t,r,n,a){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||r>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(a<=n&&r<=t)return 0;if(a<=n)return-1;if(r<=t)return 1;if(this===e)return 0;for(var o=(a>>>=0)-(n>>>=0),i=(r>>>=0)-(t>>>=0),s=Math.min(o,i),l=this.slice(n,a),u=e.slice(t,r),c=0;c<s;++c)if(l[c]!==u[c]){o=l[c],i=u[c];break}return o<i?-1:i<o?1:0},d.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},d.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},d.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},d.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-t;if((void 0===r||a<r)&&(r=a),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o,i,s,l,u,c,d,f,p,h=!1;;)switch(n){case"hex":return m(this,e,t,r);case"utf8":case"utf-8":return f=t,p=r,P(q(e,(d=this).length-f),d,f,p);case"ascii":return y(this,e,t,r);case"latin1":case"binary":return y(this,e,t,r);case"base64":return l=this,u=t,c=r,P(N(e),l,u,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i=t,s=r,P(function(e,t){for(var r,n,a,o=[],i=0;i<e.length&&!((t-=2)<0);++i)r=e.charCodeAt(i),n=r>>8,a=r%256,o.push(a),o.push(n);return o}(e,(o=this).length-i),o,i,s);default:if(h)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),h=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function _(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}function k(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}function z(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||n<r)&&(r=n);for(var a="",o=t;o<r;++o)a+=C(e[o]);return a}function A(e,t,r){for(var n=e.slice(t,r),a="",o=0;o<n.length;o+=2)a+=String.fromCharCode(n[o]+256*n[o+1]);return a}function j(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,a,o){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(a<t||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function O(e,t,r,n){t<0&&(t=65535+t+1);for(var a=0,o=Math.min(e.length-r,2);a<o;++a)e[r+a]=(t&255<<8*(n?a:1-a))>>>8*(n?a:1-a)}function E(e,t,r,n){t<0&&(t=4294967295+t+1);for(var a=0,o=Math.min(e.length-r,4);a<o;++a)e[r+a]=t>>>8*(n?a:3-a)&255}function F(e,t,r,n,a,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function S(e,t,r,n,a){return a||F(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function T(e,t,r,n,a){return a||F(e,0,r,8),o.write(e,t,r,n,52,8),r+8}d.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),t<e&&(t=e),d.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=d.prototype;else{var a=t-e;r=new d(a,void 0);for(var o=0;o<a;++o)r[o]=this[o+e]}return r},d.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=this[e],a=1,o=0;++o<t&&(a*=256);)n+=this[e+o]*a;return n},d.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=this[e+--t],a=1;0<t&&(a*=256);)n+=this[e+--t]*a;return n},d.prototype.readUInt8=function(e,t){return t||j(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return t||j(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return t||j(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=this[e],a=1,o=0;++o<t&&(a*=256);)n+=this[e+o]*a;return(a*=128)<=n&&(n-=Math.pow(2,8*t)),n},d.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=t,a=1,o=this[e+--n];0<n&&(a*=256);)o+=this[e+--n]*a;return(a*=128)<=o&&(o-=Math.pow(2,8*t)),o},d.prototype.readInt8=function(e,t){return t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){t||j(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt16BE=function(e,t){t||j(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt32LE=function(e,t){return t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return t||j(e,4,this.length),o.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return t||j(e,4,this.length),o.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return t||j(e,8,this.length),o.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return t||j(e,8,this.length),o.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var a=1,o=0;for(this[t]=255&e;++o<r&&(a*=256);)this[t+o]=e/a&255;return t+r},d.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var a=r-1,o=1;for(this[t+a]=255&e;0<=--a&&(o*=256);)this[t+a]=e/o&255;return t+r},d.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},d.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},d.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):E(this,e,t,!0),t+4},d.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):E(this,e,t,!1),t+4},d.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var a=Math.pow(2,8*r-1);M(this,e,t,r,a-1,-a)}var o=0,i=1,s=0;for(this[t]=255&e;++o<r&&(i*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+r},d.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var a=Math.pow(2,8*r-1);M(this,e,t,r,a-1,-a)}var o=r-1,i=1,s=0;for(this[t+o]=255&e;0<=--o&&(i*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/i>>0)-s&255;return t+r},d.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},d.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},d.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):E(this,e,t,!0),t+4},d.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):E(this,e,t,!1),t+4},d.prototype.writeFloatLE=function(e,t,r){return S(this,e,t,!0,r)},d.prototype.writeFloatBE=function(e,t,r){return S(this,e,t,!1,r)},d.prototype.writeDoubleLE=function(e,t,r){return T(this,e,t,!0,r)},d.prototype.writeDoubleBE=function(e,t,r){return T(this,e,t,!1,r)},d.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var a,o=n-r;if(this===e&&r<t&&t<n)for(a=o-1;0<=a;--a)e[a+t]=this[a+r];else if(o<1e3||!d.TYPED_ARRAY_SUPPORT)for(a=0;a<o;++a)e[a+t]=this[a+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+o),t);return o},d.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!d.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var i=d.isBuffer(e)?e:q(new d(e,n).toString()),s=i.length;for(o=0;o<r-t;++o)this[o+t]=i[o%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function C(e){return e<16?"0"+e.toString(16):e.toString(16)}function q(e,t){var r;t=t||1/0;for(var n=e.length,a=null,o=[],i=0;i<n;++i){if(55295<(r=e.charCodeAt(i))&&r<57344){if(!a){if(56319<r){-1<(t-=3)&&o.push(239,191,189);continue}if(i+1===n){-1<(t-=3)&&o.push(239,191,189);continue}a=r;continue}if(r<56320){-1<(t-=3)&&o.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&-1<(t-=3)&&o.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function N(e){return n.toByteArray(function(e){var t;if((e=(t=e,t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function P(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length||a>=e.length);++a)t[a+r]=e[a];return a}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:5,isarray:6}],3:[function(e,t,r){t.exports=e("./lib/heap")},{"./lib/heap":4}],4:[function(e,m,y){(function(){var e,f,l,p,h,r,u,n,v,g,a,o,i,c,d,t,s;l=Math.floor,g=Math.min,f=function(e,t){return e<t?-1:t<e?1:0},v=function(e,t,r,n,a){var o;if(null==r&&(r=0),null==a&&(a=f),r<0)throw new Error("lo must be non-negative");for(null==n&&(n=e.length);r<n;)a(t,e[o=l((r+n)/2)])<0?n=o:r=o+1;return[].splice.apply(e,[r,r-r].concat(t)),t},r=function(e,t,r){return null==r&&(r=f),e.push(t),c(e,0,e.length-1,r)},h=function(e,t){var r,n;return null==t&&(t=f),r=e.pop(),e.length?(n=e[0],e[0]=r,d(e,0,t)):n=r,n},n=function(e,t,r){var n;return null==r&&(r=f),n=e[0],e[0]=t,d(e,0,r),n},u=function(e,t,r){var n;return null==r&&(r=f),e.length&&r(e[0],t)<0&&(t=(n=[e[0],t])[0],e[0]=n[1],d(e,0,r)),t},p=function(r,e){var t,n,a,o,i,s;for(null==e&&(e=f),i=[],n=0,a=(o=function(){s=[];for(var e=0,t=l(r.length/2);0<=t?e<t:t<e;0<=t?e++:e--)s.push(e);return s}.apply(this).reverse()).length;n<a;n++)t=o[n],i.push(d(r,t,e));return i},i=function(e,t,r){var n;if(null==r&&(r=f),-1!==(n=e.indexOf(t)))return c(e,0,n,r),d(e,n,r)},a=function(e,t,r){var n,a,o,i,s;if(null==r&&(r=f),!(a=e.slice(0,t)).length)return a;for(p(a,r),o=0,i=(s=e.slice(t)).length;o<i;o++)n=s[o],u(a,n,r);return a.sort(r).reverse()},o=function(e,t,r){var n,a,o,i,s,l,u,c,d;if(null==r&&(r=f),10*t<=e.length){if(!(o=e.slice(0,t).sort(r)).length)return o;for(a=o[o.length-1],i=0,l=(u=e.slice(t)).length;i<l;i++)r(n=u[i],a)<0&&(v(o,n,0,null,r),o.pop(),a=o[o.length-1]);return o}for(p(e,r),d=[],s=0,c=g(t,e.length);0<=c?s<c:c<s;0<=c?++s:--s)d.push(h(e,r));return d},c=function(e,t,r,n){var a,o,i;for(null==n&&(n=f),a=e[r];t<r&&n(a,o=e[i=r-1>>1])<0;)e[r]=o,r=i;return e[r]=a},d=function(e,t,r){var n,a,o,i,s;for(null==r&&(r=f),a=e.length,o=e[s=t],n=2*t+1;n<a;)(i=n+1)<a&&!(r(e[n],e[i])<0)&&(n=i),e[t]=e[n],n=2*(t=n)+1;return e[t]=o,c(e,s,t,r)},e=function(){function t(e){this.cmp=null!=e?e:f,this.nodes=[]}return t.push=r,t.pop=h,t.replace=n,t.pushpop=u,t.heapify=p,t.updateItem=i,t.nlargest=a,t.nsmallest=o,t.prototype.push=function(e){return r(this.nodes,e,this.cmp)},t.prototype.pop=function(){return h(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},t.prototype.replace=function(e){return n(this.nodes,e,this.cmp)},t.prototype.pushpop=function(e){return u(this.nodes,e,this.cmp)},t.prototype.heapify=function(){return p(this.nodes,this.cmp)},t.prototype.updateItem=function(e){return i(this.nodes,e,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),t=this,s=function(){return e},"function"==typeof define&&define.amd?define([],s):"object"==typeof y?m.exports=s():t.Heap=s()}).call(this)},{}],5:[function(e,t,r){r.read=function(e,t,r,n,a){var o,i,s=8*a-n-1,l=(1<<s)-1,u=l>>1,c=-7,d=r?a-1:0,f=r?-1:1,p=e[t+d];for(d+=f,o=p&(1<<-c)-1,p>>=-c,c+=s;0<c;o=256*o+e[t+d],d+=f,c-=8);for(i=o&(1<<-c)-1,o>>=-c,c+=n;0<c;i=256*i+e[t+d],d+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return i?NaN:1/0*(p?-1:1);i+=Math.pow(2,n),o-=u}return(p?-1:1)*i*Math.pow(2,o-n)},r.write=function(e,t,r,n,a,o){var i,s,l,u=8*o-a-1,c=(1<<u)-1,d=c>>1,f=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,h=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,i=c):(i=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-i))<1&&(i--,l*=2),2<=(t+=1<=i+d?f/l:f*Math.pow(2,1-d))*l&&(i++,l/=2),c<=i+d?(s=0,i=c):1<=i+d?(s=(t*l-1)*Math.pow(2,a),i+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),i=0));8<=a;e[r+p]=255&s,p+=h,s/=256,a-=8);for(i=i<<a|s,u+=a;0<u;e[r+p]=255&i,p+=h,i/=256,u-=8);e[r+p-h]|=128*v}},{}],6:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],7:[function(require,module,exports){(function(global){"use strict";var numeric=void 0===exports?function(){}:exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var r,n,a;for(void 0===t&&(t=15),n=.5,r=new Date;;){for(a=n*=2;3<a;a-=4)e(),e(),e(),e();for(;0<a;)e(),a--;if(t<new Date-r)break}for(a=n;3<a;a-=4)e(),e(),e(),e();for(;0<a;)e(),a--;return 1e3*(3*n-1)/(new Date-r)},numeric._myIndexOf=function(e){var t,r=this.length;for(t=0;t<r;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){var l=[];return function e(t){var r;if(void 0===t)return l.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof t)return l.push('"'+t+'"'),!1;if("boolean"==typeof t)return l.push(t.toString()),!1;if("number"==typeof t){var n=function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var r=Math.floor(Math.log(t)/Math.log(10)),n=t/Math.pow(10,r),a=n.toPrecision(numeric.precision);return 10===parseFloat(a)&&(r++,a=(n=1).toPrecision(numeric.precision)),parseFloat(a).toString()+"e"+r.toString()}return"Infinity"}(t),a=t.toPrecision(numeric.precision),o=parseFloat(t.toString()).toString(),i=[n,a,o,parseFloat(a).toString(),parseFloat(o).toString()];for(r=1;r<i.length;r++)i[r].length<n.length&&(n=i[r]);return l.push(Array(numeric.precision+8-n.length).join(" ")+n),!1}if(null===t)return l.push("null"),!1;if("function"==typeof t){l.push(t.toString());var s=!1;for(r in t)t.hasOwnProperty(r)&&(s?l.push(",\n"):l.push("\n{"),s=!0,l.push(r),l.push(": \n"),e(t[r]));return s&&l.push("}\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return l.push("...Large Array..."),!0;for(s=!1,l.push("["),r=0;r<t.length;r++)0<r&&(l.push(","),s&&l.push("\n ")),s=e(t[r]);return l.push("]"),!0}l.push("{");s=!1;for(r in t)t.hasOwnProperty(r)&&(s&&l.push(",\n"),s=!0,l.push(r),l.push(": \n"),e(t[r]));return l.push("}"),!0}(e),l.join("")},numeric.parseDate=function(e){return function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}(e)},numeric.parseFloat=function(e){return function e(t){if("string"==typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}(e)},numeric.parseCSV=function(e){var t,r,n,a=e.split("\n"),o=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,l=0;for(r=0;r<a.length;r++){var u,c=(a[r]+",").match(i);if(0<c.length){for(o[l]=[],t=0;t<c.length;t++)u=(n=c[t]).substr(0,n.length-1),s.test(u)?o[l][t]=parseFloat(u):o[l][t]=u;l++}}return o},numeric.toCSV=function(e){var t,r,n,a,o,i=numeric.dim(e);for(n=i[0],i[1],o=[],t=0;t<n;t++){for(a=[],r=0;r<n;r++)a[r]=e[t][r].toString();o[t]=a.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e,t,r){void 0===t&&(t=0),void 0===r&&(r=e.length);var n,a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1;e.length;for(n=t;n<r;n++)o=o>>>8^a[255&(o^e[n])];return-1^o}var r,n,a,o,i,s,l,u,c,d,f=e[0].length,p=e[0][0].length,h=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,p>>24&255,p>>16&255,p>>8&255,255&p,f>>24&255,f>>16&255,f>>8&255,255&f,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(d=t(h,12,29),h[29]=d>>24&255,h[30]=d>>16&255,h[31]=d>>8&255,h[32]=255&d,r=1,l=n=0;l<f;l++){for(l<f-1?h.push(0):h.push(1),i=3*p+1+(0===l)&255,s=3*p+1+(0===l)>>8&255,h.push(i),h.push(s),h.push(255&~i),h.push(255&~s),0===l&&h.push(0),u=0;u<p;u++)for(a=0;a<3;a++)n=(n+(r=(r+(i=255<(i=e[a][l][u])?255:i<0?0:Math.round(i)))%65521))%65521,h.push(i);h.push(0)}return c=(n<<16)+r,h.push(c>>24&255),h.push(c>>16&255),h.push(c>>8&255),h.push(255&c),o=h.length-41,h[33]=o>>24&255,h[34]=o>>16&255,h[35]=o>>8&255,h[36]=255&o,d=t(h,37),h.push(d>>24&255),h.push(d>>16&255),h.push(d>>8&255),h.push(255&d),h.push(0),h.push(0),h.push(0),h.push(0),h.push(73),h.push(69),h.push(78),h.push(68),h.push(174),h.push(66),h.push(96),h.push(130),"data:image/png;base64,"+function(e){var t,r,n,a,o,i,s,l=e.length,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(t=0;t<l;t+=3)o=((3&(r=e[t]))<<4)+((n=e[t+1])>>4),i=((15&n)<<2)+((a=e[t+2])>>6),s=63&a,l<=t+1?i=s=64:l<=t+2&&(s=64),c+=u.charAt(r>>2)+u.charAt(o)+u.charAt(i)+u.charAt(s);return c}(h)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t;return"object"==typeof e?"object"==typeof(t=e[0])?"object"==typeof t[0]?numeric._dim(e):[e.length,t.length]:[e.length]:[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,r){var n,a;if(!(t instanceof Array&&r instanceof Array))return!1;if((a=t.length)!==r.length)return!1;for(n=0;n<a;n++)if(t[n]!==r[n]){if("object"!=typeof t[n])return!1;if(!e(t[n],r[n]))return!1}return!0},numeric.rep=function(e,t,r){void 0===r&&(r=0);var n,a=e[r],o=Array(a);if(r===e.length-1){for(n=a-2;0<=n;n-=2)o[n+1]=t,o[n]=t;return-1===n&&(o[0]=t),o}for(n=a-1;0<=n;n--)o[n]=numeric.rep(e,t,r+1);return o},numeric.dotMMsmall=function(e,t){var r,n,a,o,i,s,l,u,c,d,f;for(o=e.length,i=t.length,s=t[0].length,l=Array(o),r=o-1;0<=r;r--){for(u=Array(s),c=e[r],a=s-1;0<=a;a--){for(d=c[i-1]*t[i-1][a],n=i-2;1<=n;n-=2)f=n-1,d+=c[n]*t[n][a]+c[f]*t[f][a];0===n&&(d+=c[0]*t[0][a]),u[a]=d}l[r]=u}return l},numeric._getCol=function(e,t,r){var n;for(n=e.length-1;0<n;--n)r[n]=e[n][t],r[--n]=e[n][t];0===n&&(r[0]=e[0][t])},numeric.dotMMbig=function(e,t){var r,n,a,o=numeric._getCol,i=t.length,s=Array(i),l=e.length,u=t[0].length,c=new Array(l),d=numeric.dotVV;for(--i,n=--l;-1!==n;--n)c[n]=Array(u);for(n=--u;-1!==n;--n)for(o(t,n,s),a=l;-1!==a;--a)0,r=e[a],c[a][n]=d(r,s);return c},numeric.dotMV=function(e,t){var r,n=e.length,a=(t.length,Array(n)),o=numeric.dotVV;for(r=n-1;0<=r;r--)a[r]=o(e[r],t);return a},numeric.dotVM=function(e,t){var r,n,a,o,i,s,l;for(a=e.length,o=t[0].length,i=Array(o),n=o-1;0<=n;n--){for(s=e[a-1]*t[a-1][n],r=a-2;1<=r;r-=2)l=r-1,s+=e[r]*t[r][n]+e[l]*t[l][n];0===r&&(s+=e[0]*t[0][n]),i[n]=s}return i},numeric.dotVV=function(e,t){var r,n,a=e.length,o=e[a-1]*t[a-1];for(r=a-2;1<=r;r-=2)n=r-1,o+=e[r]*t[r]+e[n]*t[n];return 0===r&&(o+=e[0]*t[0]),o},numeric.dot=function(e,t){var r=numeric.dim;switch(1e3*r(e).length+r(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,r,n,a,o=e.length,i=Array(o);for(t=o-1;0<=t;t--){for(a=Array(o),r=t+2,n=o-1;r<=n;n-=2)a[n]=0,a[n-1]=0;for(t<n&&(a[n]=0),a[t]=e[t],n=t-1;1<=n;n-=2)a[n]=0,a[n-1]=0;0===n&&(a[0]=0),i[t]=a}return i},numeric.getDiag=function(e){var t,r=Math.min(e.length,e[0].length),n=Array(r);for(t=r-1;1<=t;--t)n[t]=e[t][t],n[--t]=e[t][t];return 0===t&&(n[0]=e[0][0]),n},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,r){void 0===r&&(r="");var n,a,o=[],i=/\[i\]$/,s="",l=!1;for(n=0;n<e.length;n++)i.test(e[n])?s=a=e[n].substring(0,e[n].length-3):a=e[n],"ret"===a&&(l=!0),o.push(a);return o[e.length]="_s",o[e.length+1]="_k",o[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(l?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(e,t,r){void 0===r&&(r="");var n,a,o=[],i=/\[i\]$/,s="",l=!1;for(n=0;n<e.length;n++)i.test(e[n])?s=a=e[n].substring(0,e[n].length-3):a=e[n],"ret"===a&&(l=!0),o.push(a);return o[e.length]="var _n = "+s+".length;\nvar i"+(l?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function e(t,r,n,a,o){var i;if(a!==n.length-1)for(i=n[a]-1;0<=i;i--)e("object"==typeof t?t[i]:t,"object"==typeof r?r[i]:r,n,a+1,o);else o(t,r)},numeric._biforeach2=function e(t,r,n,a,o){if(a===n.length-1)return o(t,r);var i,s=n[a],l=Array(s);for(i=s-1;0<=i;--i)l[i]=e("object"==typeof t?t[i]:t,"object"==typeof r?r[i]:r,n,a+1,o);return l},numeric._foreach=function e(t,r,n,a){var o;if(n!==r.length-1)for(o=r[n]-1;0<=o;o--)e(t[o],r,n+1,a);else a(t)},numeric._foreach2=function e(t,r,n,a){if(n===r.length-1)return a(t);var o,i=r[n],s=Array(i);for(o=i-1;0<=o;o--)s[o]=e(t[o],r,n+1,a);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,n;for(e=0;e<numeric.mathfuns2.length;++e)n=numeric.mathfuns2[e],numeric.ops2[n]=n;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){n=numeric.ops2[e];var t,r,a="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(a="var "+n+" = Math."+n+";\n",t=function(e,t,r){return e+" = "+n+"("+t+","+r+")"},r=function(e,t){return e+" = "+n+"("+e+","+t+")"}):(t=function(e,t,r){return e+" = "+t+" "+n+" "+r},r=numeric.opseq.hasOwnProperty(e+"eq")?function(e,t){return e+" "+n+"= "+t}:function(e,t){return e+" = "+e+" "+n+" "+t}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],t("ret[i]","x[i]","y[i]"),a),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],t("ret[i]","x","y[i]"),a),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],t("ret[i]","x[i]","y"),a),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),a),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),a),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)n=numeric.mathfuns2[e],delete numeric.ops2[n];for(e=0;e<numeric.mathfuns.length;++e)n=numeric.mathfuns[e],numeric.ops1[n]=n;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(a="",n=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(n)&&(a="var "+n+" = Math."+n+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",a),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",a),numeric[e]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)n=numeric.mathfuns[e],delete numeric.ops1[n];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(n=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[e]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,r,n,a,o,i,s,l=numeric.dim(e),u=Math.abs,c=l[0],d=l[1],f=numeric.clone(e),p=numeric.identity(c);for(i=0;i<d;++i){var h=-1,v=-1;for(o=i;o!==c;++o)v<(s=u(f[o][i]))&&(h=o,v=s);for(r=f[h],f[h]=f[i],f[i]=r,a=p[h],p[h]=p[i],p[i]=a,e=r[i],s=i;s!==d;++s)r[s]/=e;for(s=d-1;-1!==s;--s)a[s]/=e;for(o=c-1;-1!==o;--o)if(o!==i){for(t=f[o],n=p[o],e=t[i],s=i+1;s!==d;++s)t[s]-=r[s]*e;for(s=d-1;0<s;--s)n[s]-=a[s]*e,n[--s]-=a[s]*e;0===s&&(n[0]-=a[0]*e)}}return p},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var r,n,a,o,i,s,l,u,c=t[0],d=1,f=numeric.clone(e);for(n=0;n<c-1;n++){for(r=(a=n)+1;r<c;r++)Math.abs(f[r][n])>Math.abs(f[a][n])&&(a=r);for(a!==n&&(l=f[a],f[a]=f[n],f[n]=l,d*=-1),o=f[n],r=n+1;r<c;r++){for(s=(i=f[r])[n]/o[n],a=n+1;a<c-1;a+=2)u=a+1,i[a]-=o[a]*s,i[u]-=o[u]*s;a!==c&&(i[a]-=o[a]*s)}if(0===o[n])return 0;d*=o[n]}return d*f[n][n]},numeric.transpose=function(e){var t,r,n,a,o,i=e.length,s=e[0].length,l=Array(s);for(r=0;r<s;r++)l[r]=Array(i);for(t=i-1;1<=t;t-=2){for(a=e[t],n=e[t-1],r=s-1;1<=r;--r)(o=l[r])[t]=a[r],o[t-1]=n[r],(o=l[--r])[t]=a[r],o[t-1]=n[r];0===r&&((o=l[0])[t]=a[0],o[t-1]=n[0])}if(0===t){for(n=e[0],r=s-1;1<=r;--r)l[r][0]=n[r],l[--r][0]=n[r];0===r&&(l[0][0]=n[0])}return l},numeric.negtranspose=function(e){var t,r,n,a,o,i=e.length,s=e[0].length,l=Array(s);for(r=0;r<s;r++)l[r]=Array(i);for(t=i-1;1<=t;t-=2){for(a=e[t],n=e[t-1],r=s-1;1<=r;--r)(o=l[r])[t]=-a[r],o[t-1]=-n[r],(o=l[--r])[t]=-a[r],o[t-1]=-n[r];0===r&&((o=l[0])[t]=-a[0],o[t-1]=-n[0])}if(0===t){for(n=e[0],r=s-1;1<=r;--r)l[r][0]=-n[r],l[--r][0]=-n[r];0===r&&(l[0][0]=-n[0])}return l},numeric._random=function e(t,r){var n,a,o=t[r],i=Array(o);if(r===t.length-1){for(a=Math.random,n=o-1;1<=n;n-=2)i[n]=a(),i[n-1]=a();return 0===n&&(i[0]=a()),i}for(n=o-1;0<=n;n--)i[n]=e(t,r+1);return i},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,r){if(void 0===r&&(r=Math.max(Math.round(t-e)+1,1)),r<2)return 1===r?[e]:[];var n,a=Array(r);for(n=--r;0<=n;n--)a[n]=(n*t+(r-n)*e)/r;return a},numeric.getBlock=function(e,s,l){var u=numeric.dim(e);return function e(t,r){var n,a=s[r],o=l[r]-a,i=Array(o);if(r===u.length-1){for(n=o;0<=n;n--)i[n]=t[n+a];return i}for(n=o;0<=n;n--)i[n]=e(t[n+a],r+1);return i}(e,0)},numeric.setBlock=function(e,s,l,t){var u=numeric.dim(e);return function e(t,r,n){var a,o=s[n],i=l[n]-o;if(n===u.length-1)for(a=i;0<=a;a--)t[a+o]=r[a];for(a=i;0<=a;a--)e(t[a+o],r[a],n+1)}(e,t,0),e},numeric.getRange=function(e,t,r){var n,a,o,i,s=t.length,l=r.length,u=Array(s);for(n=s-1;-1!==n;--n)for(u[n]=Array(l),o=u[n],i=e[t[n]],a=l-1;-1!==a;--a)o[a]=i[r[a]];return u},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var r,n,a,o,i,s=t[0],l=t[1];for(a=n=r=0;a<s;++a)r+=e[a][0].length;for(o=0;o<l;++o)n+=e[0][o][0].length;var u=Array(r);for(a=0;a<r;++a)u[a]=Array(n);var c,d,f,p,h,v=0;for(a=0;a<s;++a){for(c=n,o=l-1;-1!==o;--o)for(c-=(i=e[a][o])[0].length,f=i.length-1;-1!==f;--f)for(h=i[f],d=u[v+f],p=h.length-1;-1!==p;--p)d[c+p]=h[p];v+=e[a][0].length}return u},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var r=numeric.dim(e),n=numeric.dim(t);if(1!==r.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var a,o,i,s,l=r[0],u=n[0],c=Array(l);for(o=l-1;0<=o;o--){for(a=Array(u),s=e[o],i=u-1;3<=i;--i)a[i]=s*t[i],a[--i]=s*t[i],a[--i]=s*t[i],a[--i]=s*t[i];for(;0<=i;)a[i]=s*t[i],--i;c[o]=a}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,r,n,a){var o;numeric.indexOf;if("string"!=typeof a)for(o in a="",numeric)numeric.hasOwnProperty(o)&&(0<=e.indexOf(o)||0<=t.indexOf(o)||0<=r.indexOf(o)||0<=n.indexOf(o))&&1<o.length&&(a+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+a+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+r+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var r=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,r),t(numeric.neg(this.y),r))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),e(r)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,r=this.y;return r?new numeric.T(e(t),numeric.negtranspose(r)):new numeric.T(e(t))},numeric.Tunop=function(e,t,r){return"string"!=typeof r&&(r=""),Function("var x = this;\n"+r+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if(void 0===e.y)return new numeric.T(numeric.inv(e.x));var t,r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x=e.x.length,b=numeric.identity(x),w=numeric.rep([x,x],0),_=numeric.clone(e.x),k=numeric.clone(e.y);for(u=0;u<x;u++){for(f=(h=_[u][u])*h+(v=k[u][u])*v,c=(d=u)+1;c<x;c++)f<(p=(h=_[c][u])*h+(v=k[c][u])*v)&&(d=c,f=p);for(d!==u&&(y=_[u],_[u]=_[d],_[d]=y,y=k[u],k[u]=k[d],k[d]=y,y=b[u],b[u]=b[d],b[d]=y,y=w[u],w[u]=w[d],w[d]=y),t=_[u],r=k[u],o=b[u],i=w[u],h=t[u],v=r[u],c=u+1;c<x;c++)g=t[c],m=r[c],t[c]=(g*h+m*v)/f,r[c]=(m*h-g*v)/f;for(c=0;c<x;c++)g=o[c],m=i[c],o[c]=(g*h+m*v)/f,i[c]=(m*h-g*v)/f;for(c=u+1;c<x;c++){for(n=_[c],a=k[c],s=b[c],l=w[c],h=n[u],v=a[u],d=u+1;d<x;d++)g=t[d],m=r[d],n[d]-=g*h-m*v,a[d]-=m*h+g*v;for(d=0;d<x;d++)g=o[d],m=i[d],s[d]-=g*h-m*v,l[d]-=m*h+g*v}}for(u=x-1;0<u;u--)for(o=b[u],i=w[u],c=u-1;0<=c;c--)for(s=b[c],l=w[c],h=_[c][u],v=k[c][u],d=x-1;0<=d;d--)g=o[d],m=i[d],s[d]-=h*g-v*m,l[d]-=h*m+v*g;return new numeric.T(b,w)},numeric.T.prototype.get=function(e){var t,r=this.x,n=this.y,a=0,o=e.length;if(n){for(;a<o;)r=r[t=e[a]],n=n[t],a++;return new numeric.T(r,n)}for(;a<o;)r=r[t=e[a]],a++;return new numeric.T(r)},numeric.T.prototype.set=function(e,t){var r,n=this.x,a=this.y,o=0,i=e.length,s=t.x,l=t.y;if(0===i)return l?this.y=l:a&&(this.y=void 0),this.x=n,this;if(l){for(a||(a=numeric.rep(numeric.dim(n),0),this.y=a);o<i-1;)n=n[r=e[o]],a=a[r],o++;return n[r=e[o]]=s,a[r]=l,this}if(a){for(;o<i-1;)n=n[r=e[o]],a=a[r],o++;return(n[r=e[o]]=s)instanceof Array?a[r]=numeric.rep(numeric.dim(s),0):a[r]=0,this}for(;o<i-1;)n=n[r=e[o]],o++;return n[r=e[o]]=s,this},numeric.T.prototype.getRows=function(e,t){var r,n,a=t-e+1,o=Array(a),i=this.x,s=this.y;for(r=e;r<=t;r++)o[r-e]=i[r];if(s){for(n=Array(a),r=e;r<=t;r++)n[r-e]=s[r];return new numeric.T(o,n)}return new numeric.T(o)},numeric.T.prototype.setRows=function(e,t,r){var n,a=this.x,o=this.y,i=r.x,s=r.y;for(n=e;n<=t;n++)a[n]=i[n-e];if(s)for(o||(o=numeric.rep(numeric.dim(a),0),this.y=o),n=e;n<=t;n++)o[n]=s[n-e];else if(o)for(n=e;n<=t;n++)o[n]=numeric.rep([i[n-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,r=this.y;return r?new numeric.T(t[e],r[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var r=this.x,n=this.y,a=t.x,o=t.y;return r[e]=a,o?(n||(n=numeric.rep(numeric.dim(r),0),this.y=n),n[e]=o):n&&(n=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var r=this.x,n=this.y,a=numeric.getBlock;return n?new numeric.T(a(r,e,t),a(n,e,t)):new numeric.T(a(r,e,t))},numeric.T.prototype.setBlock=function(e,t,r){r instanceof numeric.T||(r=new numeric.T(r));var n=this.x,a=this.y,o=numeric.setBlock,i=r.x,s=r.y;if(s)return a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),o(n,e,t,i),o(a,e,t,s),this;o(n,e,t,i),a&&o(a,e,t,numeric.rep(numeric.dim(i),0))},numeric.T.rep=function(e,t){var r=numeric.T;t instanceof r||(t=new r(t));var n=t.x,a=t.y,o=numeric.rep;return a?new r(o(e,n),o(e,a)):new r(o(e,n))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,r=e.y,n=numeric.diag;return r?new numeric.T(n(t),n(r)):new numeric.T(n(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,r=this.y;return r?new e.T(e.getDiag(t),e.getDiag(r)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),r=(0<=e[0]?1:-1)*numeric.norm2(e);t[0]+=r;var n=numeric.norm2(t);if(0===n)throw new Error("eig: internal error");return numeric.div(t,n)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r,n,a,o,i,s,l,u,c,d,f=t[0],p=numeric.clone(e),h=numeric.identity(f);for(n=0;n<f-2;n++){for(o=Array(f-n-1),r=n+1;r<f;r++)o[r-n-1]=p[r][n];if(0<numeric.norm2(o)){for(i=numeric.house(o),s=numeric.getBlock(p,[n+1,n],[f-1,f-1]),l=numeric.tensor(i,numeric.dot(i,s)),r=n+1;r<f;r++)for(u=p[r],c=l[r-n-1],a=n;a<f;a++)u[a]-=2*c[a-n];for(s=numeric.getBlock(p,[0,n+1],[f-1,f-1]),l=numeric.tensor(numeric.dot(s,i),i),r=0;r<f;r++)for(u=p[r],c=l[r],a=n+1;a<f;a++)u[a]-=2*c[a-n-1];for(s=Array(f-n-1),r=n+1;r<f;r++)s[r-n-1]=h[r];for(l=numeric.tensor(i,numeric.dot(i,s)),r=n+1;r<f;r++)for(d=h[r],c=l[r-n-1],a=0;a<f;a++)d[a]-=2*c[a]}}return{H:p,Q:h}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,t){void 0===t&&(t=1e4),e=numeric.clone(e);numeric.clone(e);var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b=numeric.dim(e)[0],w=numeric.identity(b);if(b<3)return{Q:w,B:[[0,b-1]]};var _=numeric.epsilon;for(x=0;x<t;x++){for(m=0;m<b-1;m++)if(Math.abs(e[m+1][m])<_*(Math.abs(e[m][m])+Math.abs(e[m+1][m+1]))){var k=numeric.QRFrancis(numeric.getBlock(e,[0,0],[m,m]),t),z=numeric.QRFrancis(numeric.getBlock(e,[m+1,m+1],[b-1,b-1]),t);for(p=Array(m+1),g=0;g<=m;g++)p[g]=w[g];for(h=numeric.dot(k.Q,p),g=0;g<=m;g++)w[g]=h[g];for(p=Array(b-m-1),g=m+1;g<b;g++)p[g-m-1]=w[g];for(h=numeric.dot(z.Q,p),g=m+1;g<b;g++)w[g]=h[g-m-1];return{Q:w,B:k.B.concat(numeric.add(z.B,m+1))}}var A,j,M;if(a=e[b-2][b-2],o=e[b-2][b-1],i=e[b-1][b-2],u=a+(s=e[b-1][b-1]),l=a*s-o*i,c=numeric.getBlock(e,[0,0],[2,2]),4*l<=u*u)A=.5*(u+Math.sqrt(u*u-4*l)),j=.5*(u-Math.sqrt(u*u-4*l)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,A+j)),numeric.diag(numeric.rep([3],A*j)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,u)),numeric.diag(numeric.rep([3],l)));for(r=[c[0][0],c[1][0],c[2][0]],n=numeric.house(r),p=[e[0],e[1],e[2]],h=numeric.tensor(n,numeric.dot(n,p)),g=0;g<3;g++)for(f=e[g],v=h[g],y=0;y<b;y++)f[y]-=2*v[y];for(p=numeric.getBlock(e,[0,0],[b-1,2]),h=numeric.tensor(numeric.dot(p,n),n),g=0;g<b;g++)for(f=e[g],v=h[g],y=0;y<3;y++)f[y]-=2*v[y];for(p=[w[0],w[1],w[2]],h=numeric.tensor(n,numeric.dot(n,p)),g=0;g<3;g++)for(d=w[g],v=h[g],y=0;y<b;y++)d[y]-=2*v[y];for(m=0;m<b-2;m++){for(y=m;y<=m+1;y++)if(Math.abs(e[y+1][y])<_*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){k=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),z=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[b-1,b-1]),t);for(p=Array(y+1),g=0;g<=y;g++)p[g]=w[g];for(h=numeric.dot(k.Q,p),g=0;g<=y;g++)w[g]=h[g];for(p=Array(b-y-1),g=y+1;g<b;g++)p[g-y-1]=w[g];for(h=numeric.dot(z.Q,p),g=y+1;g<b;g++)w[g]=h[g-y-1];return{Q:w,B:k.B.concat(numeric.add(z.B,y+1))}}for(M=Math.min(b-1,m+3),r=Array(M-m),g=m+1;g<=M;g++)r[g-m-1]=e[g][m];for(n=numeric.house(r),p=numeric.getBlock(e,[m+1,m],[M,b-1]),h=numeric.tensor(n,numeric.dot(n,p)),g=m+1;g<=M;g++)for(f=e[g],v=h[g-m-1],y=m;y<b;y++)f[y]-=2*v[y-m];for(p=numeric.getBlock(e,[0,m+1],[b-1,M]),h=numeric.tensor(numeric.dot(p,n),n),g=0;g<b;g++)for(f=e[g],v=h[g],y=m+1;y<=M;y++)f[y]-=2*v[y-m-1];for(p=Array(M-m),g=m+1;g<=M;g++)p[g-m-1]=w[g];for(h=numeric.tensor(n,numeric.dot(n,p)),g=m+1;g<=M;g++)for(d=w[g],v=h[g-m-1],y=0;y<b;y++)d[y]-=2*v[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y=numeric.toUpperHessenberg(e),x=numeric.QRFrancis(y.H,t),b=numeric.T,w=e.length,_=x.B,k=numeric.dot(x.Q,numeric.dot(y.H,numeric.transpose(x.Q))),z=new b(numeric.dot(x.Q,y.Q)),A=_.length,j=Math.sqrt;for(n=0;n<A;n++)if((r=_[n][0])===_[n][1]);else{if(o=r+1,i=k[r][r],s=k[r][o],l=k[o][r],u=k[o][o],0===s&&0===l)continue;0<=(d=(c=-i-u)*c-4*(i*u-s*l))?((m=l*l+(u-(f=c<0?-.5*(c-j(d)):-.5*(c+j(d))))*(u-f))<(g=(i-f)*(i-f)+s*s)?(h=(i-f)/(g=j(g)),v=s/g):(h=l/(m=j(m)),v=(u-f)/m),a=new b([[v,-h],[h,v]])):(f=-.5*c,p=.5*j(-d),(m=l*l+(u-f)*(u-f))<(g=(i-f)*(i-f)+s*s)?(h=(i-f)/(g=j(g+p*p)),v=s/g,f=0,p/=g):(h=l/(m=j(m+p*p)),v=(u-f)/m,f=p/m,p=0),a=new b([[v,-h],[h,v]],[[f,p],[p,-f]])),z.setRows(r,o,a.dot(z.getRows(r,o)))}var M=z.dot(e).dot(z.transjugate()),O=(w=e.length,numeric.T.identity(w));for(o=0;o<w;o++)if(0<o)for(n=o-1;0<=n;n--){var E=M.get([n,n]),F=M.get([o,o]);numeric.neq(E.x,F.x)||numeric.neq(E.y,F.y)?(f=M.getRow(n).getBlock([n],[o-1]),p=O.getRow(o).getBlock([n],[o-1]),O.set([o,n],M.get([n,o]).neg().sub(f.dot(p)).div(E.sub(F)))):O.setRow(o,O.getRow(n))}for(o=0;o<w;o++)f=O.getRow(o),O.setRow(o,f.div(f.norm2()));return O=O.transpose(),O=z.transjugate().dot(O),{lambda:M.getDiag(),E:O}},numeric.ccsSparse=function(e){var t,r,n,a=e.length,o=[];for(r=a-1;-1!==r;--r)for(n in t=e[r]){for(n=parseInt(n);n>=o.length;)o[o.length]=0;0!==t[n]&&o[n]++}var i=o.length,s=Array(i+1);for(r=s[0]=0;r<i;++r)s[r+1]=s[r]+o[r];var l=Array(s[i]),u=Array(s[i]);for(r=a-1;-1!==r;--r)for(n in t=e[r])0!==t[n]&&(o[n]--,l[s[n]+o[n]]=r,u[s[n]+o[n]]=t[n]);return[s,l,u]},numeric.ccsFull=function(e){var t,r,n,a,o=e[0],i=e[1],s=e[2],l=numeric.ccsDim(e),u=l[0],c=l[1],d=numeric.rep([u,c],0);for(t=0;t<c;t++)for(n=o[t],a=o[t+1],r=n;r<a;++r)d[i[r]][t]=s[r];return d},numeric.ccsTSolve=function(e,t,r,n,a){var o,i,s,l,u,c,d,f=e[0],p=e[1],h=e[2],v=f.length-1,g=Math.max,m=0;function y(e){var t;if(0===r[e]){for(r[e]=1,t=f[e];t<f[e+1];++t)y(p[t]);a[m]=e,++m}}for(void 0===n&&(r=numeric.rep([v],0)),void 0===n&&(n=numeric.linspace(0,r.length-1)),void 0===a&&(a=[]),o=n.length-1;-1!==o;--o)y(n[o]);for(a.length=m,o=a.length-1;-1!==o;--o)r[a[o]]=0;for(o=n.length-1;-1!==o;--o)i=n[o],r[i]=t[i];for(o=a.length-1;-1!==o;--o){for(i=a[o],s=f[i],l=g(f[i+1],s),u=s;u!==l;++u)if(p[u]===i){r[i]/=h[u];break}for(d=r[i],u=s;u!==l;++u)(c=p[u])!==i&&(r[c]-=d*h[u])}return r},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,r,n,a,o){var i,s,l,u=0,c=a.length,d=this.k,f=this.k1,p=this.j;if(0===n[e])for(n[e]=1,p[0]=e,d[0]=s=t[e],f[0]=l=t[e+1];;)if(l<=s){if(a[c]=p[u],0===u)return;++c,s=d[--u],l=f[u]}else 0===n[i=o[r[s]]]?(n[i]=1,d[u]=s,s=t[p[++u]=i],f[u]=l=t[i+1]):++s},numeric.ccsLPSolve=function(e,t,r,n,a,o,i){var s,l,u,c,d,f,p,h,v,g=e[0],m=e[1],y=e[2],x=(g.length,t[0]),b=t[1],w=t[2];for(l=x[a],u=x[a+1],n.length=0,s=l;s<u;++s)i.dfs(o[b[s]],g,m,r,n,o);for(s=n.length-1;-1!==s;--s)r[n[s]]=0;for(s=l;s!==u;++s)r[c=o[b[s]]]=w[s];for(s=n.length-1;-1!==s;--s){for(d=g[c=n[s]],f=g[c+1],p=d;p<f;++p)if(o[m[p]]===c){r[c]/=y[p];break}for(v=r[c],p=d;p<f;++p)(h=o[m[p]])!==c&&(r[h]-=v*y[p])}return r},numeric.ccsLUP1=function(e,t){var r,n,a,o,i,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],d=[numeric.rep([u+1],0),[],[]],f=c[0],p=c[1],h=c[2],v=d[0],g=d[1],m=d[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),k=numeric.linspace(0,u-1),z=new numeric.ccsDFS(u);for(void 0===t&&(t=1),r=0;r<u;++r){for(b(c,e,y,x,r,k,z),i=o=-1,n=x.length-1;-1!==n;--n)(a=x[n])<=r||o<(s=w(y[a]))&&(i=a,o=s);for(w(y[r])<t*o&&(n=_[r],o=_[i],k[_[r]=o]=r,k[_[i]=n]=i,o=y[r],y[r]=y[i],y[i]=o),o=f[r],i=v[r],l=y[r],p[o]=_[r],h[o]=1,++o,n=x.length-1;-1!==n;--n)s=y[a=x[n]],x[n]=0,y[a]=0,a<=r?(g[i]=a,m[i]=s,++i):(p[o]=_[a],h[o]=s/l,++o);f[r+1]=o,v[r+1]=i}for(n=p.length-1;-1!==n;--n)p[n]=k[p[n]];return{L:c,U:d,P:_,Pinv:k}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,r,n,a,o,i){var s,l,u,c=0,d=a.length,f=this.k,p=this.k1,h=this.j;if(0===n[e])for(n[e]=1,h[0]=e,f[0]=l=t[o[e]],p[0]=u=t[o[e]+1];;){if(isNaN(l))throw new Error("Ow!");if(u<=l){if(a[d]=o[h[c]],0===c)return;++d,l=f[--c],u=p[c]}else 0===n[s=r[l]]?(n[s]=1,f[c]=l,l=t[s=o[h[++c]=s]],p[c]=u=t[s+1]):++l}},numeric.ccsLPSolve0=function(e,t,r,n,a,o,i,s){var l,u,c,d,f,p,h,v,g,m=e[0],y=e[1],x=e[2],b=(m.length,t[0]),w=t[1],_=t[2];for(u=b[a],c=b[a+1],n.length=0,l=u;l<c;++l)s.dfs(w[l],m,y,r,n,o,i);for(l=n.length-1;-1!==l;--l)r[i[d=n[l]]]=0;for(l=u;l!==c;++l)r[d=w[l]]=_[l];for(l=n.length-1;-1!==l;--l){for(v=i[d=n[l]],f=m[d],p=m[d+1],h=f;h<p;++h)if(y[h]===v){r[v]/=x[h];break}for(g=r[v],h=f;h<p;++h)r[y[h]]-=g*x[h];r[v]=g}},numeric.ccsLUP0=function(e,t){var r,n,a,o,i,s,l,u=e[0].length-1,c=[numeric.rep([u+1],0),[],[]],d=[numeric.rep([u+1],0),[],[]],f=c[0],p=c[1],h=c[2],v=d[0],g=d[1],m=d[2],y=numeric.rep([u],0),x=numeric.rep([u],0),b=numeric.ccsLPSolve0,w=(Math.max,Math.abs),_=numeric.linspace(0,u-1),k=numeric.linspace(0,u-1),z=new numeric.ccsDFS0(u);for(void 0===t&&(t=1),r=0;r<u;++r){for(b(c,e,y,x,r,k,_,z),i=o=-1,n=x.length-1;-1!==n;--n)(a=x[n])<=r||o<(s=w(y[_[a]]))&&(i=a,o=s);for(w(y[_[r]])<t*o&&(n=_[r],o=_[i],k[_[r]=o]=r,k[_[i]=n]=i),o=f[r],i=v[r],l=y[_[r]],p[o]=_[r],h[o]=1,++o,n=x.length-1;-1!==n;--n)s=y[_[a=x[n]]],x[n]=0,y[_[a]]=0,a<=r?(g[i]=a,m[i]=s,++i):(p[o]=_[a],h[o]=s/l,++o);f[r+1]=o,v[r+1]=i}for(n=p.length-1;-1!==n;--n)p[n]=k[p[n]];return{L:c,U:d,P:_,Pinv:k}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,r){var n=numeric.ccsDim(e),a=n[0],o=n[1];void 0===t?t=numeric.linspace(0,a-1):"number"==typeof t&&(t=[t]),void 0===r?r=numeric.linspace(0,o-1):"number"==typeof r&&(r=[r]);var i,s,l,u,c=t.length,d=r.length,f=numeric.rep([o],0),p=[],h=[],v=[f,p,h],g=e[0],m=e[1],y=e[2],x=numeric.rep([a],0),b=0,w=numeric.rep([a],0);for(s=0;s<d;++s){var _=g[u=r[s]],k=g[u+1];for(i=_;i<k;++i)w[l=m[i]]=1,x[l]=y[i];for(i=0;i<c;++i)w[t[i]]&&(p[b]=i,h[b]=x[t[i]],++b);for(i=_;i<k;++i)w[l=m[i]]=0;f[s+1]=b}return v},numeric.ccsDot=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p=e[0],h=e[1],v=e[2],g=t[0],m=t[1],y=t[2],x=numeric.ccsDim(e),b=numeric.ccsDim(t),w=x[0],_=(x[1],b[1]),k=numeric.rep([w],0),z=numeric.rep([w],0),A=Array(w),j=numeric.rep([_],0),M=[],O=[],E=[j,M,O];for(a=0;a!==_;++a){for(o=g[a],i=g[a+1],c=0,n=o;n<i;++n)for(d=m[n],f=y[n],s=p[d],l=p[d+1],r=s;r<l;++r)0===z[u=h[r]]&&(c+=z[A[c]=u]=1),k[u]=k[u]+v[r]*f;for(i=(o=j[a])+c,j[a+1]=i,n=c-1;-1!==n;--n)f=o+n,r=A[n],M[f]=r,O[f]=k[r],z[r]=0,k[r]=0;j[a+1]=j[a]+c}return E},numeric.ccsLUPSolve=function(e,t){var r=e.L,n=e.U,a=(e.P,t[0]),o=!1;"object"!=typeof a&&(a=(t=[[0,t.length],numeric.linspace(0,t.length-1),t])[0],o=!0);var i,s,l,u,c,d,f=t[1],p=t[2],h=r[0].length-1,v=a.length-1,g=numeric.rep([h],0),m=Array(h),y=numeric.rep([h],0),x=Array(h),b=numeric.rep([v+1],0),w=[],_=[],k=numeric.ccsTSolve,z=0;for(i=0;i<v;++i){for(c=0,l=a[i],u=a[i+1],s=l;s<u;++s)d=e.Pinv[f[s]],y[x[c]=d]=p[s],++c;for(x.length=c,k(r,y,g,x,m),s=x.length-1;-1!==s;--s)y[x[s]]=0;if(k(n,g,y,m,x),o)return y;for(s=m.length-1;-1!==s;--s)g[m[s]]=0;for(s=x.length-1;-1!==s;--s)d=x[s],w[z]=d,_[z]=y[d],y[d]=0,++z;b[i+1]=z}return[b,w,_]},numeric.ccsbinop=function(e,t){return void 0===t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,r=e[0],n=e[1],a=e[2],o=numeric.sup(n)+1,i=r.length,s=numeric.rep([o],0),l=Array(i),u=Array(i),c=numeric.rep([o],0);for(t=0;t<i;++t)c[n[t]]++;for(t=0;t<o;++t)s[t+1]=s[t]+c[t];var d,f,p=s.slice(0);for(t=0;t<i;++t)l[d=p[f=n[t]]]=r[t],u[d]=a[t],p[f]=p[f]+1;return[s,l,u]},numeric.ccsGather=function(e){var t,r,n,a,o,i=e[0],s=e[1],l=e[2],u=i.length-1,c=s.length,d=Array(c),f=Array(c),p=Array(c);for(t=o=0;t<u;++t)for(n=i[t],a=i[t+1],r=n;r!==a;++r)f[o]=t,d[o]=s[r],p[o]=l[r],++o;return[d,f,p]},numeric.sdim=function e(t,r,n){if(void 0===r&&(r=[]),"object"!=typeof t)return r;var a;for(a in void 0===n&&(n=0),n in r||(r[n]=0),t.length>r[n]&&(r[n]=t.length),t)t.hasOwnProperty(a)&&e(t[a],r,n+1);return r},numeric.sclone=function e(t,r,n){void 0===r&&(r=0),void 0===n&&(n=numeric.sdim(t).length);var a,o=Array(t.length);if(r===n-1){for(a in t)t.hasOwnProperty(a)&&(o[a]=t[a]);return o}for(a in t)t.hasOwnProperty(a)&&(o[a]=e(t[a],r+1,n));return o},numeric.sdiag=function(e){var t,r,n=e.length,a=Array(n);for(t=n-1;1<=t;t-=2)r=t-1,a[t]=[],a[t][t]=e[t],a[r]=[],a[r][r]=e[r];return 0===t&&(a[0]=[],a[0][0]=e[t]),a},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,r,n,a=[];e.length;for(t in e)if(e.hasOwnProperty(t))for(r in n=e[t])n.hasOwnProperty(r)&&("object"!=typeof a[r]&&(a[r]=[]),a[r][t]=n[r]);return a},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var r,n,a,o,i,s,l,u=e.length,c=(t.length,numeric.stranspose(t)),d=c.length,f=Array(u);for(a=u-1;0<=a;a--){for(l=[],r=e[a],i=d-1;0<=i;i--){for(o in s=0,n=c[i],r)r.hasOwnProperty(o)&&o in n&&(s+=r[o]*n[o]);s&&(l[i]=s)}f[a]=l}return f},numeric.sdotMV=function(e,t){var r,n,a,o,i=e.length,s=Array(i);for(n=i-1;0<=n;n--){for(a in o=0,r=e[n])r.hasOwnProperty(a)&&t[a]&&(o+=r[a]*t[a]);o&&(s[n]=o)}return s},numeric.sdotVM=function(e,t){var r,n,a,o,i=[];for(r in e)if(e.hasOwnProperty(r))for(n in a=t[r],o=e[r],a)a.hasOwnProperty(n)&&(i[n]||(i[n]=0),i[n]+=o*a[n]);return i},numeric.sdotVV=function(e,t){var r,n=0;for(r in e)e[r]&&t[r]&&(n+=e[r]*t[r]);return n},numeric.sdot=function(e,t){var r=numeric.sdim(e).length,n=numeric.sdim(t).length;switch(1e3*r+n){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+n)}},numeric.sscatter=function(e){var t,r,n,a,o=e[0].length,i=e.length,s=[];for(r=o-1;0<=r;--r)if(e[i-1][r]){for(a=s,n=0;n<i-2;n++)a[t=e[n][r]]||(a[t]=[]),a=a[t];a[e[n][r]]=e[n+1][r]}return s},numeric.sgather=function e(t,r,n){var a,o,i;for(o in void 0===r&&(r=[]),void 0===n&&(n=[]),a=n.length,t)if(t.hasOwnProperty(o))if(n[a]=parseInt(o),"number"==typeof(i=t[o])){if(i){if(0===r.length)for(o=a+1;0<=o;--o)r[o]=[];for(o=a;0<=o;--o)r[o].push(n[o]);r[a+1].push(i)}}else e(i,r,n);return n.length>a&&n.pop(),r},numeric.cLU=function(e){var t,r,n,a,o,i,s=e[0],l=e[1],u=e[2],c=s.length,d=0;for(t=0;t<c;t++)s[t]>d&&(d=s[t]);d++;var f,p=Array(d),h=Array(d),v=numeric.rep([d],1/0),g=numeric.rep([d],-1/0);for(n=0;n<c;n++)t=s[n],(r=l[n])<v[t]&&(v[t]=r),r>g[t]&&(g[t]=r);for(t=0;t<d-1;t++)g[t]>g[t+1]&&(g[t+1]=g[t]);for(t=d-1;1<=t;t--)v[t]<v[t-1]&&(v[t-1]=v[t]);for(t=0;t<d;t++)h[t]=numeric.rep([g[t]-v[t]+1],0),p[t]=numeric.rep([t-v[t]],0),t-v[t]+1,g[t]-t+1;for(n=0;n<c;n++)h[t=s[n]][l[n]-v[t]]=u[n];for(t=0;t<d-1;t++)for(a=t-v[t],x=h[t],r=t+1;v[r]<=t&&r<d;r++)if(o=t-v[r],i=g[t]-t,f=(b=h[r])[o]/x[a]){for(n=1;n<=i;n++)b[n+o]-=f*x[n+a];p[r][t-v[r]]=f}var m,y,x=[],b=[],w=[],_=[],k=[],z=[];for(t=m=c=0;t<d;t++){for(a=v[t],o=g[t],y=h[t],r=t;r<=o;r++)y[r-a]&&(x[c]=t,b[c]=r,w[c]=y[r-a],c++);for(y=p[t],r=a;r<t;r++)y[r-a]&&(_[m]=t,k[m]=r,z[m]=y[r-a],m++);_[m]=t,k[m]=t,z[m]=1,m++}return{U:[x,b,w],L:[_,k,z]}},numeric.cLUsolve=function(e,t){var r,n,a=e.L,o=e.U,i=numeric.clone(t),s=a[0],l=a[1],u=a[2],c=o[0],d=o[1],f=o[2],p=c.length,h=(s.length,i.length);for(r=n=0;r<h;r++){for(;l[n]<r;)i[r]-=u[n]*i[l[n]],n++;n++}for(n=p-1,r=h-1;0<=r;r--){for(;d[n]>r;)i[r]-=f[n]*i[d[n]],n--;i[r]/=f[n],n--}return i},numeric.cgrid=function(r,e){"number"==typeof r&&(r=[r,r]);var t,n,a,o=numeric.rep(r,-1);if("function"!=typeof e)switch(e){case"L":e=function(e,t){return e>=r[0]/2||t<r[1]/2};break;default:e=function(e,t){return!0}}for(a=0,t=1;t<r[0]-1;t++)for(n=1;n<r[1]-1;n++)e(t,n)&&(o[t][n]=a,a++);return o},numeric.cdelsq=function(e){var t,r,n,a,o,i=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(e),l=s[0],u=s[1],c=[],d=[],f=[];for(t=1;t<l-1;t++)for(r=1;r<u-1;r++)if(!(e[t][r]<0)){for(n=0;n<4;n++)a=t+i[n][0],o=r+i[n][1],e[a][o]<0||(c.push(e[t][r]),d.push(e[a][o]),f.push(-1));c.push(e[t][r]),d.push(e[t][r]),f.push(4)}return[c,d,f]},numeric.cdotMV=function(e,t){var r,n,a,o=e[0],i=e[1],s=e[2],l=o.length;for(n=a=0;n<l;n++)o[n]>a&&(a=o[n]);for(a++,r=numeric.rep([a],0),n=0;n<l;n++)r[o[n]]+=s[n]*t[i[n]];return r},numeric.Spline=function(e,t,r,n,a){this.x=e,this.yl=t,this.yr=r,this.kl=n,this.kr=a},numeric.Spline.prototype._at=function(e,t){var r,n,a,o=this.x,i=this.yl,s=this.yr,l=this.kl,u=this.kr,c=numeric.add,d=numeric.sub,f=numeric.mul;r=d(f(l[t],o[t+1]-o[t]),d(s[t+1],i[t])),n=c(f(u[t+1],o[t]-o[t+1]),d(s[t+1],i[t]));var p=(a=(e-o[t])/(o[t+1]-o[t]))*(1-a);return c(c(c(f(1-a,i[t]),f(a,s[t+1])),f(r,p*(1-a))),f(n,p*a))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,r,n,a=this.x,o=a.length,i=Math.floor;for(t=0,r=o-1;1<r-t;)a[n=i((t+r)/2)]<=e?t=n:r=n;return this._at(e,t)}o=e.length;var s,l=Array(o);for(s=o-1;-1!==s;--s)l[s]=this.at(e[s]);return l},numeric.Spline.prototype.diff=function(){var e,t,r,n=this.x,a=this.yl,o=this.yr,i=this.kl,s=this.kr,l=a.length,u=i,c=s,d=Array(l),f=Array(l),p=numeric.add,h=numeric.mul,v=numeric.div,g=numeric.sub;for(e=l-1;-1!==e;--e)t=n[e+1]-n[e],r=g(o[e+1],a[e]),d[e]=v(p(h(r,6),h(i[e],-4*t),h(s[e+1],-2*t)),t*t),f[e+1]=v(p(h(r,-6),h(i[e],2*t),h(s[e+1],4*t)),t*t);return new numeric.Spline(n,u,c,d,f)},numeric.Spline.prototype.roots=function(){var e=[],t=this.x,r=this.yl,n=this.yr,a=this.kl,o=this.kr;"number"==typeof r[0]&&(r=[r],n=[n],a=[a],o=[o]);var i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F=r.length,S=t.length-1,T=(e=Array(F),Math.sqrt);for(i=0;i!==F;++i){for(u=r[i],c=n[i],d=a[i],f=o[i],p=[],s=0;s!==S;s++){for(0<s&&c[s]*u[s]<0&&p.push(t[s]),w=t[s+1]-t[s],t[s],g=u[s],m=c[s+1],h=d[s]/w,y=(v=f[s+1]/w)+3*g+2*h-3*m,x=3*(v+h+2*(g-m)),(b=(E=h-v+3*(g-m))*E+12*v*g)<=0?_=(k=y/x)>t[s]&&k<t[s+1]?[t[s],k,t[s+1]]:[t[s],t[s+1]]:(k=(y-T(b))/x,z=(y+T(b))/x,_=[t[s]],k>t[s]&&k<t[s+1]&&_.push(k),z>t[s]&&z<t[s+1]&&_.push(z),_.push(t[s+1])),j=_[0],k=this._at(j,s),l=0;l<_.length-1;l++)if(M=_[l+1],z=this._at(M,s),0!==k)if(0===z||0<k*z)j=M,k=z;else{for(var B=0;!((O=(k*M-z*j)/(k-z))<=j||M<=O);)if(0<(A=this._at(O,s))*z)M=O,z=A,-1===B&&(k*=.5),B=-1;else{if(!(0<A*k))break;j=O,k=A,1===B&&(z*=.5),B=1}p.push(O),j=_[l+1],k=this._at(j,s)}else p.push(j),j=M,k=z;0===z&&p.push(M)}e[i]=p}return"number"==typeof this.yl[0]?e[0]:e},numeric.spline=function(e,t,r,n){var a,o=e.length,i=[],s=[],l=[],u=numeric.sub,c=numeric.mul,d=numeric.add;for(a=o-2;0<=a;a--)s[a]=e[a+1]-e[a],l[a]=u(t[a+1],t[a]);"string"!=typeof r&&"string"!=typeof n||(r=n="periodic");var f=[[],[],[]];switch(typeof r){case"undefined":i[0]=c(3/(s[0]*s[0]),l[0]),f[0].push(0,0),f[1].push(0,1),f[2].push(2/s[0],1/s[0]);break;case"string":i[0]=d(c(3/(s[o-2]*s[o-2]),l[o-2]),c(3/(s[0]*s[0]),l[0])),f[0].push(0,0,0),f[1].push(o-2,0,1),f[2].push(1/s[o-2],2/s[o-2]+2/s[0],1/s[0]);break;default:i[0]=r,f[0].push(0),f[1].push(0),f[2].push(1)}for(a=1;a<o-1;a++)i[a]=d(c(3/(s[a-1]*s[a-1]),l[a-1]),c(3/(s[a]*s[a]),l[a])),f[0].push(a,a,a),f[1].push(a-1,a,a+1),f[2].push(1/s[a-1],2/s[a-1]+2/s[a],1/s[a]);switch(typeof n){case"undefined":i[o-1]=c(3/(s[o-2]*s[o-2]),l[o-2]),f[0].push(o-1,o-1),f[1].push(o-2,o-1),f[2].push(1/s[o-2],2/s[o-2]);break;case"string":f[1][f[1].length-1]=0;break;default:i[o-1]=n,f[0].push(o-1),f[1].push(o-1),f[2].push(1)}i="number"!=typeof i[0]?numeric.transpose(i):[i];var p=Array(i.length);if("string"==typeof r)for(a=p.length-1;-1!==a;--a)p[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(f)),i[a]),p[a][o-1]=p[a][0];else for(a=p.length-1;-1!==a;--a)p[a]=numeric.cLUsolve(numeric.cLU(f),i[a]);return p="number"==typeof t[0]?p[0]:numeric.transpose(p),new numeric.Spline(e,t,t,p,p)},numeric.fftpow2=function e(t,r){var n=t.length;if(1!==n){var a,o,i=Math.cos,s=Math.sin,l=Array(n/2),u=Array(n/2),c=Array(n/2),d=Array(n/2);for(o=n/2,a=n-1;-1!==a;--a)c[--o]=t[a],d[o]=r[a],--a,l[o]=t[a],u[o]=r[a];e(l,u),e(c,d),o=n/2;var f,p,h,v=-6.283185307179586/n;for(a=n-1;-1!==a;--a)-1===--o&&(o=n/2-1),p=i(f=v*a),h=s(f),t[a]=l[o]+p*c[o]-h*d[o],r[a]=u[o]+p*d[o]+h*c[o]}},numeric._ifftpow2=function e(t,r){var n=t.length;if(1!==n){var a,o,i=Math.cos,s=Math.sin,l=Array(n/2),u=Array(n/2),c=Array(n/2),d=Array(n/2);for(o=n/2,a=n-1;-1!==a;--a)c[--o]=t[a],d[o]=r[a],--a,l[o]=t[a],u[o]=r[a];e(l,u),e(c,d),o=n/2;var f,p,h,v=6.283185307179586/n;for(a=n-1;-1!==a;--a)-1===--o&&(o=n/2-1),p=i(f=v*a),h=s(f),t[a]=l[o]+p*c[o]-h*d[o],r[a]=u[o]+p*d[o]+h*c[o]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,r,n){var a,o,i,s,l;for(numeric.fftpow2(e,t),numeric.fftpow2(r,n),a=e.length-1;-1!==a;--a)o=e[a],s=t[a],i=r[a],l=n[a],e[a]=o*i-s*l,t[a]=o*l+s*i;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,r=this.x,n=this.y,a=r.length,o=Math.log,i=o(2),s=Math.ceil(o(2*a-1)/i),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),d=Math.cos,f=Math.sin,p=-3.141592653589793/a,h=numeric.rep([l],0),v=numeric.rep([l],0);Math.floor(a/2);for(e=0;e<a;e++)h[e]=r[e];if(void 0!==n)for(e=0;e<a;e++)v[e]=n[e];for(e=u[0]=1;e<=l/2;e++)t=p*e*e,u[e]=d(t),c[e]=f(t),u[l-e]=d(t),c[l-e]=f(t);var g=new numeric.T(h,v),m=new numeric.T(u,c);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),(g=g.mul(m)).x.length=a,g.y.length=a,g},numeric.T.prototype.ifft=function(){var e,t,r=this.x,n=this.y,a=r.length,o=Math.log,i=o(2),s=Math.ceil(o(2*a-1)/i),l=Math.pow(2,s),u=numeric.rep([l],0),c=numeric.rep([l],0),d=Math.cos,f=Math.sin,p=3.141592653589793/a,h=numeric.rep([l],0),v=numeric.rep([l],0);Math.floor(a/2);for(e=0;e<a;e++)h[e]=r[e];if(void 0!==n)for(e=0;e<a;e++)v[e]=n[e];for(e=u[0]=1;e<=l/2;e++)t=p*e*e,u[e]=d(t),c[e]=f(t),u[l-e]=d(t),c[l-e]=f(t);var g=new numeric.T(h,v),m=new numeric.T(u,c);return g=g.mul(m),numeric.convpow2(g.x,g.y,numeric.clone(m.x),numeric.neg(m.y)),(g=g.mul(m)).x.length=a,g.y.length=a,g.div(a)},numeric.gradient=function(e,t){var r=t.length,n=e(t);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var a,o,i,s,l,u,c,d,f,p=Math.max,h=numeric.clone(t),v=Array(r),g=(numeric.div,numeric.sub,p=Math.max,Math.abs),m=Math.min,y=0;for(a=0;a<r;a++)for(var x=p(1e-6*n,1e-8);;){if(20<++y)throw new Error("Numerical gradient fails");if(h[a]=t[a]+x,o=e(h),h[a]=t[a]-x,i=e(h),h[a]=t[a],isNaN(o)||isNaN(i))x/=16;else{if(v[a]=(o-i)/(2*x),s=t[a]-x,l=t[a],u=t[a]+x,c=(o-n)/x,d=(n-i)/x,f=p(g(v[a]),g(n),g(o),g(i),g(s),g(l),g(u),1e-8),!(.001<m(p(g(c-v[a]),g(d-v[a]),g(c-d))/f,x/f)))break;x/=16}}return v},numeric.uncmin=function(t,e,r,n,a,o,i){var s=numeric.gradient;void 0===i&&(i={}),void 0===r&&(r=1e-8),void 0===n&&(n=function(e){return s(t,e)}),void 0===a&&(a=1e3);var l,u,c=(e=numeric.clone(e)).length,d=t(e);if(isNaN(d))throw new Error("uncmin: f(x0) is a NaN!");var f=Math.max,p=numeric.norm2;r=f(r,numeric.epsilon);var h,v,g,m,y,x,b,w,_,k,z=i.Hinv||numeric.identity(c),A=numeric.dot,j=(numeric.inv,numeric.sub),M=numeric.add,O=numeric.tensor,E=numeric.div,F=numeric.mul,S=numeric.all,T=numeric.isFinite,B=numeric.neg,C=0,q="";for(v=n(e);C<a;){if("function"==typeof o&&o(C,e,d,v,z)){q="Callback returned true";break}if(!S(T(v))){q="Gradient has Infinity or NaN";break}if(!S(T(h=B(A(z,v))))){q="Search direction has Infinity or NaN";break}if((k=p(h))<r){q="Newton step smaller than tol";break}for(_=1,u=A(v,h),y=e;C<a&&!(_*k<r)&&(y=M(e,m=F(h,_)),.1*_*u<=(l=t(y))-d||isNaN(l));)_*=.5,++C;if(_*k<r){q="Line search step size smaller than tol";break}if(C===a){q="maxit reached during line search";break}z=j(M(z,F(((w=A(x=j(g=n(y),v),m))+A(x,b=A(z,x)))/(w*w),O(m,m))),E(M(O(b,m),O(m,b)),w)),e=y,d=l,v=g,++C}return{solution:e,f:d,gradient:v,invHessian:z,iterations:C,message:q}},numeric.Dopri=function(e,t,r,n,a,o,i){this.x=e,this.y=t,this.f=r,this.ymid=n,this.iterations=a,this.events=i,this.message=o},numeric.Dopri.prototype._at=function(e,t){function r(e){return e*e}var n,a,o,i,s,l,u,c,d,f=this.x,p=this.y,h=this.f,v=this.ymid,g=(f.length,Math.floor,numeric.add),m=numeric.mul,y=numeric.sub;return n=f[t],a=f[t+1],i=p[t],s=p[t+1],o=n+.5*(a-n),l=v[t],u=y(h[t],m(i,1/(n-o)+2/(n-a))),c=y(h[t+1],m(s,1/(a-o)+2/(a-n))),g(g(g(g(m(i,(d=[r(e-a)*(e-o)/r(n-a)/(n-o),r(e-n)*r(e-a)/r(n-o)/r(a-o),r(e-n)*(e-o)/r(a-n)/(a-o),(e-n)*r(e-a)*(e-o)/r(n-a)/(n-o),(e-a)*r(e-n)*(e-o)/r(n-a)/(a-o)])[0]),m(l,d[1])),m(s,d[2])),m(u,d[3])),m(c,d[4]))},numeric.Dopri.prototype.at=function(e){var t,r,n,a=Math.floor;if("number"!=typeof e){var o=e.length,i=Array(o);for(t=o-1;-1!==t;--t)i[t]=this.at(e[t]);return i}var s=this.x;for(t=0,r=s.length-1;1<r-t;)s[n=a(.5*(t+r))]<=e?t=n:r=n;return this._at(e,t)},numeric.dopri=function(e,t,r,n,a,o,i){void 0===a&&(a=1e-6),void 0===o&&(o=1e3);var s,l,u,c,d,f,p,h,v,g,m,y,x,b=[e],w=[r],_=[n(e,r)],k=[],z=[.075,.225],A=[44/45,-56/15,32/9],j=[19372/6561,-25360/2187,64448/6561,-212/729],M=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],O=[35/384,0,500/1113,125/192,-2187/6784,11/84],E=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],F=[.2,.3,.8,8/9,1,1],S=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],T=0,B=(t-e)/10,C=0,q=numeric.add,N=numeric.mul,P=(Math.max,Math.min),I=Math.abs,D=numeric.norminf,V=Math.pow,R=numeric.any,U=numeric.lt,L=numeric.and,Y=(numeric.sub,new numeric.Dopri(b,w,_,k,-1,""));for("function"==typeof i&&(m=i(e,r));e<t&&C<o;)if(++C,t<e+B&&(B=t-e),s=n(e+F[0]*B,q(r,N(.2*B,_[T]))),l=n(e+F[1]*B,q(q(r,N(z[0]*B,_[T])),N(z[1]*B,s))),u=n(e+F[2]*B,q(q(q(r,N(A[0]*B,_[T])),N(A[1]*B,s)),N(A[2]*B,l))),c=n(e+F[3]*B,q(q(q(q(r,N(j[0]*B,_[T])),N(j[1]*B,s)),N(j[2]*B,l)),N(j[3]*B,u))),d=n(e+F[4]*B,q(q(q(q(q(r,N(M[0]*B,_[T])),N(M[1]*B,s)),N(M[2]*B,l)),N(M[3]*B,u)),N(M[4]*B,c))),f=n(e+B,v=q(q(q(q(q(r,N(_[T],B*O[0])),N(l,B*O[2])),N(u,B*O[3])),N(c,B*O[4])),N(d,B*O[5]))),a<(g="number"==typeof(p=q(q(q(q(q(N(_[T],B*S[0]),N(l,B*S[2])),N(u,B*S[3])),N(c,B*S[4])),N(d,B*S[5])),N(f,B*S[6])))?I(p):D(p))){if(e+(B=.2*B*V(a/g,.25))===e){Y.msg="Step size became too small";break}}else{if(k[T]=q(q(q(q(q(q(r,N(_[T],B*E[0])),N(l,B*E[2])),N(u,B*E[3])),N(c,B*E[4])),N(d,B*E[5])),N(f,B*E[6])),b[++T]=e+B,w[T]=v,_[T]=f,"function"==typeof i){var H,X,G=e,J=e+.5*B;if(y=i(J,k[T-1]),R(x=L(U(m,0),U(0,y)))||(G=J,m=y,y=i(J=e+B,v),x=L(U(m,0),U(0,y))),R(x)){for(var W,Q,K=0,Z=1,$=1;;){if("number"==typeof m)X=($*y*G-Z*m*J)/($*y-Z*m);else for(X=J,h=m.length-1;-1!==h;--h)m[h]<0&&0<y[h]&&(X=P(X,($*y[h]*G-Z*m[h]*J)/($*y[h]-Z*m[h])));if(X<=G||J<=X)break;Q=i(X,H=Y._at(X,T-1)),R(W=L(U(m,0),U(0,Q)))?(J=X,y=Q,x=W,-($=1)===K?Z*=.5:Z=1,K=-1):(G=X,m=Q,(Z=1)===K?$*=.5:$=1,K=1)}return v=Y._at(.5*(e+X),T-1),Y.f[T]=n(X,H),Y.x[T]=X,Y.y[T]=H,Y.ymid[T-1]=v,Y.events=x,Y.iterations=C,Y}}e+=B,r=v,m=y,B=P(.8*B*V(a/g,.25),4*B)}return Y.iterations=C,Y},numeric.LU=function(e,t){t=t||!1;var r,n,a,o,i,s,l,u,c,d=Math.abs,f=e.length,p=f-1,h=new Array(f);for(t||(e=numeric.clone(e)),a=0;a<f;++a){for(c=d((s=e[l=a])[a]),n=a+1;n<f;++n)c<(o=d(e[n][a]))&&(c=o,l=n);for((h[a]=l)!=a&&(e[a]=e[l],e[l]=s,s=e[a]),i=s[a],r=a+1;r<f;++r)e[r][a]/=i;for(r=a+1;r<f;++r){for(u=e[r],n=a+1;n<p;++n)u[n]-=u[a]*s[n],u[++n]-=u[a]*s[n];n===p&&(u[n]-=u[a]*s[n])}}return{LU:e,P:h}},numeric.LUsolve=function(e,t){var r,n,a,o,i,s=e.LU,l=s.length,u=numeric.clone(t),c=e.P;for(r=l-1;-1!==r;--r)u[r]=t[r];for(r=0;r<l;++r)for(a=c[r],c[r]!==r&&(i=u[r],u[r]=u[a],u[a]=i),o=s[r],n=0;n<r;++n)u[r]-=u[n]*o[n];for(r=l-1;0<=r;--r){for(o=s[r],n=r+1;n<l;++n)u[r]-=u[n]*o[n];u[r]/=o[r]}return u},numeric.solve=function(e,t,r){return numeric.LUsolve(numeric.LU(e,r),t)},numeric.echelonize=function(e){var t,r,n,a,o,i,s,l,u=numeric.dim(e),c=u[0],d=u[1],f=numeric.identity(c),p=Array(c),h=Math.abs,v=numeric.diveq;for(e=numeric.clone(e),t=0;t<c;++t){for(n=0,o=e[t],i=f[t],r=1;r<d;++r)h(o[n])<h(o[r])&&(n=r);for(v(i,o[p[t]=n]),v(o,o[n]),r=0;r<c;++r)if(r!==t){for(l=(s=e[r])[n],a=d-1;-1!==a;--a)s[a]-=o[a]*l;for(s=f[r],a=c-1;-1!==a;--a)s[a]-=i[a]*l}}return{I:f,A:e,P:p}},numeric.__solveLP=function(e,t,r,n,a,o,i){var s,l,u,c,d=numeric.sum,f=(numeric.log,numeric.mul),p=numeric.sub,h=numeric.dot,v=numeric.div,g=numeric.add,m=e.length,y=r.length,x=!1,b=1,w=(numeric.transpose(t),numeric.svd,numeric.transpose),_=(numeric.leq,Math.sqrt),k=Math.abs,z=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,j=numeric.gt,M=Array(m),O=Array(y),E=(numeric.rep([y],1),numeric.solve),F=p(r,h(t,o)),S=h(e,e);for(u=0;u<a;++u){var T,B;for(T=y-1;-1!==T;--T)O[T]=v(t[T],F[T]);var C=w(O);for(T=m-1;-1!==T;--T)M[T]=d(C[T]);b=.25*k(S/h(e,M));var q=100*_(S/h(M,M));for((!isFinite(b)||q<b)&&(b=q),c=g(e,f(b,M)),l=h(C,O),T=m-1;-1!==T;--T)l[T][T]+=1;var N=v(F,h(t,B=E(l,v(c,b),!0))),P=1;for(T=y-1;-1!==T;--T)N[T]<0&&(P=z(P,-.999*N[T]));if(!A(j(F=p(r,h(t,s=p(o,f(B,P)))),0)))return{solution:o,message:"",iterations:u};if(o=s,b<n)return{solution:s,message:"",iterations:u};if(i){var I=h(e,c),D=h(t,c);for(x=!0,T=y-1;-1!==T;--T)if(I*D[T]<0){x=!1;break}}else x=!(0<=o[m-1]);if(x)return{solution:s,message:"Unbounded",iterations:u}}return{solution:o,message:"maximum iteration count exceeded",iterations:u}},numeric._solveLP=function(e,t,r,n,a){var o=e.length,i=r.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),l=numeric.dot,u=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([i,1],-1),d=numeric.blockMatrix([[t,c]]),f=r,p=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),h=numeric.__solveLP(u,d,f,n,a,p,!1),v=numeric.clone(h.solution);if(v.length=o,numeric.inf(s(r,l(t,v)))<0)return{solution:NaN,message:"Infeasible",iterations:h.iterations};var g=numeric.__solveLP(e,t,r,n,a-h.iterations,v,!0);return g.iterations+=h.iterations,g},numeric.solveLP=function(e,t,r,n,a,o,i){if(void 0===i&&(i=1e3),void 0===o&&(o=numeric.epsilon),void 0===n)return numeric._solveLP(e,t,r,o,i);var s,l=n.length,u=n[0].length,c=t.length,d=numeric.echelonize(n),f=numeric.rep([u],0),p=d.P,h=[];for(s=p.length-1;-1!==s;--s)f[p[s]]=1;for(s=u-1;-1!==s;--s)0===f[s]&&h.push(s);var v=numeric.getRange,g=numeric.linspace(0,l-1),m=numeric.linspace(0,c-1),y=v(n,g,h),x=v(t,m,p),b=v(t,m,h),w=numeric.dot,_=numeric.sub,k=w(x,d.I),z=_(b,w(k,y)),A=_(r,w(k,a)),j=Array(p.length),M=Array(h.length);for(s=p.length-1;-1!==s;--s)j[s]=e[p[s]];for(s=h.length-1;-1!==s;--s)M[s]=e[h[s]];var O=_(M,w(j,w(d.I,y))),E=numeric._solveLP(O,z,A,o,i),F=E.solution;if(F!=F)return E;var S=w(d.I,_(a,w(y,F))),T=Array(e.length);for(s=p.length-1;-1!==s;--s)T[p[s]]=S[s];for(s=h.length-1;-1!==s;--s)T[h[s]]=F[s];return{solution:T,message:E.message,iterations:E.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split("\n");var r,e,n,a,o=0,i=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=t.length,l=0,u={},c=[],d=0,f={},p=0,h=[],v=[],g=[];function m(e){throw new Error("MPStoLP: "+e+"\nLine "+r+": "+t[r]+"\nCurrent state: "+i[o]+"\n")}for(r=0;r<s;++r){var y=(n=t[r]).match(/\S*/g),x=[];for(e=0;e<y.length;++e)""!==y[e]&&x.push(y[e]);if(0!==x.length){for(e=0;e<i.length&&n.substr(0,i[e].length)!==i[e];++e);if(e<i.length){if(1===(o=e)&&(a=x[1]),6===e)return{name:a,c:h,A:numeric.transpose(v),b:g,rows:u,vars:f}}else switch(o){case 0:case 1:m("Unexpected line");case 2:switch(x[0]){case"N":0===l?l=x[1]:m("Two or more N rows");break;case"L":c[u[x[1]]=d]=1,g[d]=0,++d;break;case"G":c[u[x[1]]=d]=-1,g[d]=0,++d;break;case"E":c[u[x[1]]=d]=0,g[d]=0,++d;break;default:m("Parse error "+numeric.prettyPrint(x))}break;case 3:f.hasOwnProperty(x[0])||(h[f[x[0]]=p]=0,v[p]=numeric.rep([d],0),++p);var b=f[x[0]];for(e=1;e<x.length;e+=2)if(x[e]!==l){var w=u[x[e]];v[b][w]=(c[w]<0?-1:1)*parseFloat(x[e+1])}else h[b]=parseFloat(x[e+1]);break;case 4:for(e=1;e<x.length;e+=2)g[u[x[e]]]=(c[u[x[e]]]<0?-1:1)*parseFloat(x[e+1]);break;case 5:break;case 6:m("Internal error")}}}m("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(a,o,l,e,i,s,u){function c(e,t,r,n){for(e+="",n=r=0;n<e.length;n++)t[d(n)]=d((r^=19*t[d(n)])+e.charCodeAt(n));for(n in e="",t)e+=String.fromCharCode(t[n]);return e}function d(e){return e&l-1}o.seedrandom=function(e,t){var n,r=[];return e=c(function e(t,r,n,a,o){n=[];o=typeof t;if(r&&"object"==o)for(a in t)if(a.indexOf("S")<5)try{n.push(e(t[a],r-1))}catch(e){}return n.length?n:t+("string"!=o?"\0":"")}(t?[e,a]:arguments.length?e:[(new Date).getTime(),a,window],3),r),c((n=new function(e){var t,r,s=this,n=e.length,a=0,o=s.i=s.j=s.m=0;s.S=[],s.c=[],n||(e=[n++]);for(;a<l;)s.S[a]=a++;for(a=0;a<l;a++)t=s.S[a],o=d(o+t+e[a%n]),r=s.S[o],s.S[a]=r,s.S[o]=t;s.g=function(e){var t=s.S,r=d(s.i+1),n=t[r],a=d(s.j+n),o=t[a];t[r]=o,t[a]=n;for(var i=t[d(n+o)];--e;)r=d(r+1),n=t[r],a=d(a+n),o=t[a],t[r]=o,t[a]=n,i=i*l+t[d(n+o)];return s.i=r,s.j=a,i},s.g(l)}(r)).S,a),o.random=function(){for(var e=n.g(6),t=u,r=0;e<i;)e=(e+r)*l,t*=l,r=n.g(1);for(;s<=e;)e/=2,t/=2,r>>>=1;return(e+r)/t},e},u=o.pow(l,6),i=o.pow(2,i),s=2*i,c(o.random(),a)}([],numeric.seedrandom,256,0,52),function(e){function g(e){if("object"!=typeof e)return e;var t,r=[],n=e.length;for(t=0;t<n;t++)r[t+1]=g(e[t]);return r}function m(e){if("object"!=typeof e)return e;var t,r=[],n=e.length;for(t=1;t<n;t++)r[t-1]=m(e[t]);return r}function y(e,t,r,n,a,o,i,s,l,u,c,d,f,p,h,v){var g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P,I,D,V;for(O=Math.min(n,u),y=2*n+O*(O+5)/2+2*u+1,D=1e-60;1+.1*(D+=D)<=1||1+.2*D<=1;);for(g=1;g<=n;g+=1)h[g]=t[g];for(g=n+1;g<=y;g+=1)h[g]=0;for(g=1;g<=u;g+=1)d[g]=0;if(b=[],0===v[1]){if(function(e,t,r,n){var a,o,i,s,l,u;for(o=1;o<=r;o+=1){if(u=0,(i=(n[1]=o)-1)<1){if((u=e[o][o]-u)<=0)break;e[o][o]=Math.sqrt(u)}else{for(s=1;s<=i;s+=1){for(l=e[s][o],a=1;a<s;a+=1)l-=e[a][o]*e[a][s];l/=e[s][s],u+=(e[s][o]=l)*l}if((u=e[o][o]-u)<=0)break;e[o][o]=Math.sqrt(u)}n[1]=0}}(e,0,n,b),0!==b[1])return void(v[1]=2);!function(e,t,r,n){var a,o,i,s;for(o=1;o<=r;o+=1){for(s=0,a=1;a<o;a+=1)s+=e[a][o]*n[a];n[o]=(n[o]-s)/e[o][o]}for(i=1;i<=r;i+=1)for(n[o=r+1-i]=n[o]/e[o][o],s=-n[o],a=1;a<o;a+=1)n[a]=n[a]+s*e[a][o]}(e,0,n,t),function(e,t,r){var n,a,o,i,s;for(o=1;o<=r;o+=1){for(e[o][o]=1/e[o][o],s=-e[o][o],n=1;n<o;n+=1)e[n][o]=s*e[n][o];if(r<(i=o+1))break;for(a=i;a<=r;a+=1)for(s=e[o][a],e[o][a]=0,n=1;n<=o;n+=1)e[n][a]=e[n][a]+s*e[n][o]}}(e,0,n)}else{for(m=1;m<=n;m+=1)for(a[m]=0,g=1;g<=m;g+=1)a[m]=a[m]+e[g][m]*t[g];for(m=1;m<=n;m+=1)for(t[m]=0,g=m;g<=n;g+=1)t[m]=t[m]+e[m][g]*a[g]}for(o[1]=0,m=1;m<=n;m+=1)for(a[m]=t[m],o[1]=o[1]+h[m]*a[m],h[m]=0,g=m+1;g<=n;g+=1)e[g][m]=0;for(o[1]=-o[1]/2,v[1]=0,E=(A=(z=(j=(k=(_=n)+n)+O)+O+1)+O*(O+1)/2)+u,g=1;g<=u;g+=1){for(S=0,m=1;m<=n;m+=1)S+=i[m][g]*i[m][g];h[E+g]=Math.sqrt(S)}function R(){for(p[1]=p[1]+1,y=A,g=1;g<=u;g+=1){for(y+=1,S=-s[g],m=1;m<=n;m+=1)S+=i[m][g]*a[m];if(Math.abs(S)<D&&(S=0),c<g)h[y]=S;else if(h[y]=-Math.abs(S),0<S){for(m=1;m<=n;m+=1)i[m][g]=-i[m][g];s[g]=-s[g]}}for(g=1;g<=f;g+=1)h[A+d[g]]=0;for(F=M=0,g=1;g<=u;g+=1)h[A+g]<F*h[E+g]&&(F=h[A+(M=g)]/h[E+g]);return 0===M?999:0}function U(){for(g=1;g<=n;g+=1){for(S=0,m=1;m<=n;m+=1)S+=e[m][g]*i[m][M];h[g]=S}for(x=_,g=1;g<=n;g+=1)h[x+g]=0;for(m=f+1;m<=n;m+=1)for(g=1;g<=n;g+=1)h[x+g]=h[x+g]+e[g][m]*h[m];for(P=!0,g=f;1<=g;g-=1){for(S=h[g],x=(y=z+g*(g+3)/2)-g,m=g+1;m<=f;m+=1)S-=h[y]*h[k+m],y+=m;if(S/=h[x],h[k+g]=S,d[g]<c)break;if(S<0)break;P=!1,w=g}if(!P)for(T=h[j+w]/h[k+w],g=1;g<=f&&!(d[g]<c)&&!(h[k+g]<0);g+=1)(F=h[j+g]/h[k+g])<T&&(T=F,w=g);for(S=0,g=_+1;g<=_+n;g+=1)S+=h[g]*h[g];if(Math.abs(S)<=D){if(P)return v[1]=1,999;for(g=1;g<=f;g+=1)h[j+g]=h[j+g]-T*h[k+g];return h[j+f+1]=h[j+f+1]+T,700}for(S=0,g=1;g<=n;g+=1)S+=h[_+g]*i[g][M];for(B=-h[A+M]/S,I=!0,P||T<B&&(B=T,I=!1),g=1;g<=n;g+=1)a[g]=a[g]+B*h[_+g],Math.abs(a[g])<D&&(a[g]=0);for(o[1]=o[1]+B*S*(B/2+h[j+f+1]),g=1;g<=f;g+=1)h[j+g]=h[j+g]-B*h[k+g];if(h[j+f+1]=h[j+f+1]+B,!I){for(S=-s[M],m=1;m<=n;m+=1)S+=a[m]*i[m][M];if(c<M)h[A+M]=S;else if(h[A+M]=-Math.abs(S),0<S){for(m=1;m<=n;m+=1)i[m][M]=-i[m][M];s[M]=-s[M]}return 700}for(d[f+=1]=M,y=z+(f-1)*f/2+1,g=1;g<=f-1;g+=1)h[y]=h[g],y+=1;if(f===n)h[y]=h[n];else{for(g=n;f+1<=g&&0!==h[g]&&(C=Math.max(Math.abs(h[g-1]),Math.abs(h[g])),q=Math.min(Math.abs(h[g-1]),Math.abs(h[g])),F=0<=h[g-1]?Math.abs(C*Math.sqrt(1+q*q/(C*C))):-Math.abs(C*Math.sqrt(1+q*q/(C*C))),C=h[g-1]/F,q=h[g]/F,1!==C);g-=1)if(0===C)for(h[g-1]=q*F,m=1;m<=n;m+=1)F=e[m][g-1],e[m][g-1]=e[m][g],e[m][g]=F;else for(h[g-1]=F,N=q/(1+C),m=1;m<=n;m+=1)F=C*e[m][g-1]+q*e[m][g],e[m][g]=N*(e[m][g-1]+F)-e[m][g],e[m][g-1]=F;h[y]=h[f]}return 0}function L(){if(0===h[x=(y=z+w*(w+1)/2+1)+w])return 798;if(C=Math.max(Math.abs(h[x-1]),Math.abs(h[x])),q=Math.min(Math.abs(h[x-1]),Math.abs(h[x])),F=0<=h[x-1]?Math.abs(C*Math.sqrt(1+q*q/(C*C))):-Math.abs(C*Math.sqrt(1+q*q/(C*C))),C=h[x-1]/F,q=h[x]/F,1===C)return 798;if(0===C){for(g=w+1;g<=f;g+=1)F=h[x-1],h[x-1]=h[x],h[x]=F,x+=g;for(g=1;g<=n;g+=1)F=e[g][w],e[g][w]=e[g][w+1],e[g][w+1]=F}else{for(N=q/(1+C),g=w+1;g<=f;g+=1)F=C*h[x-1]+q*h[x],h[x]=N*(h[x-1]+F)-h[x],h[x-1]=F,x+=g;for(g=1;g<=n;g+=1)F=C*e[g][w]+q*e[g][w+1],e[g][w+1]=N*(e[g][w]+F)-e[g][w+1],e[g][w]=F}return 0}function Y(){for(x=y-w,g=1;g<=w;g+=1)h[x]=h[y],y+=1,x+=1;return h[j+w]=h[j+w+1],d[w]=d[w+1],(w+=1)<f?797:0}function H(){return h[j+f]=h[j+f+1],h[j+f+1]=0,d[f]=0,f-=1,p[2]=p[2]+1,0}for(f=0,p[1]=0,V=p[2]=0;;){if(999===(V=R()))return;for(;0!==(V=U());){if(999===V)return;if(700===V)if(w===f)H();else{for(;L(),797===(V=Y()););H()}}}}numeric.solveQP=function(e,t,r,n,a,o){e=g(e),t=g(t),r=g(r);var i,s,l,u,c,d=[],f=[],p=[],h=[],v=[];if(a=a||0,o=o?g(o):[void 0,0],n=n?g(n):[],s=e.length-1,l=r[1].length-1,!n)for(i=1;i<=l;i+=1)n[i]=0;for(i=1;i<=l;i+=1)f[i]=0;for(u=Math.min(s,l),i=1;i<=s;i+=1)p[i]=0;for(d[1]=0,i=1;i<=2*s+u*(u+5)/2+2*l+1;i+=1)h[i]=0;for(i=1;i<=2;i+=1)v[i]=0;return y(e,t,0,s,p,d,r,n,0,l,a,f,0,v,h,o),c="",1===o[1]&&(c="constraints are inconsistent, no solution!"),2===o[1]&&(c="matrix D in quadratic function is not positive definite!"),{solution:m(p),value:m(d),unconstrained_solution:m(t),iterations:m(v),iact:m(f),message:c}}}(),numeric.svd=function(e){var t,r=numeric.epsilon,n=1e-64/r,a=0,o=0,i=0,s=0,l=0,u=numeric.clone(e),c=u.length,d=u[0].length;if(c<d)throw"Need more rows than columns";var f=new Array(d),p=new Array(d);for(o=0;o<d;o++)f[o]=p[o]=0;var h=numeric.rep([d,d],0);function v(e,t){return e=Math.abs(e),(t=Math.abs(t))<e?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var g=0,m=0,y=0,x=0,b=0,w=0,_=0;for(o=0;o<d;o++){for(f[o]=m,_=0,l=o+1,i=o;i<c;i++)_+=u[i][o]*u[i][o];if(_<=n)m=0;else for(g=u[o][o],m=Math.sqrt(_),0<=g&&(m=-m),y=g*m-_,u[o][o]=g-m,i=l;i<d;i++){for(_=0,s=o;s<c;s++)_+=u[s][o]*u[s][i];for(g=_/y,s=o;s<c;s++)u[s][i]+=g*u[s][o]}for(p[o]=m,_=0,i=l;i<d;i++)_+=u[o][i]*u[o][i];if(_<=n)m=0;else{for(g=u[o][o+1],m=Math.sqrt(_),0<=g&&(m=-m),y=g*m-_,u[o][o+1]=g-m,i=l;i<d;i++)f[i]=u[o][i]/y;for(i=l;i<c;i++){for(_=0,s=l;s<d;s++)_+=u[i][s]*u[o][s];for(s=l;s<d;s++)u[i][s]+=_*f[s]}}x<(b=Math.abs(p[o])+Math.abs(f[o]))&&(x=b)}for(o=d-1;-1!=o;o+=-1){if(0!=m){for(y=m*u[o][o+1],i=l;i<d;i++)h[i][o]=u[o][i]/y;for(i=l;i<d;i++){for(_=0,s=l;s<d;s++)_+=u[o][s]*h[s][i];for(s=l;s<d;s++)h[s][i]+=_*h[s][o]}}for(i=l;i<d;i++)h[o][i]=0,h[i][o]=0;h[o][o]=1,m=f[o],l=o}for(o=d-1;-1!=o;o+=-1){for(l=o+1,m=p[o],i=l;i<d;i++)u[o][i]=0;if(0!=m){for(y=u[o][o]*m,i=l;i<d;i++){for(_=0,s=l;s<c;s++)_+=u[s][o]*u[s][i];for(g=_/y,s=o;s<c;s++)u[s][i]+=g*u[s][o]}for(i=o;i<c;i++)u[i][o]=u[i][o]/m}else for(i=o;i<c;i++)u[i][o]=0;u[o][o]+=1}for(r*=x,s=d-1;-1!=s;s+=-1)for(var k=0;k<50;k++){var z=!1;for(l=s;-1!=l;l+=-1){if(Math.abs(f[l])<=r){z=!0;break}if(Math.abs(p[l-1])<=r)break}if(!z){a=0;var A=l-(_=1);for(o=l;o<s+1&&(g=_*f[o],f[o]=a*f[o],!(Math.abs(g)<=r));o++)for(y=v(g,m=p[o]),a=m/(p[o]=y),_=-g/y,i=0;i<c;i++)b=u[i][A],w=u[i][o],u[i][A]=b*a+w*_,u[i][o]=-b*_+w*a}if(w=p[s],l==s){if(w<0)for(p[s]=-w,i=0;i<d;i++)h[i][s]=-h[i][s];break}if(49<=k)throw"Error: no convergence.";for(x=p[l],m=v(g=(((b=p[s-1])-w)*(b+w)+((m=f[s-1])-(y=f[s]))*(m+y))/(2*y*b),1),g=g<0?((x-w)*(x+w)+y*(b/(g-m)-y))/x:((x-w)*(x+w)+y*(b/(g+m)-y))/x,o=l+(_=a=1);o<s+1;o++){for(m=f[o],b=p[o],y=_*m,m*=a,w=v(g,y),g=x*(a=g/(f[o-1]=w))+m*(_=y/w),m=-x*_+m*a,y=b*_,b*=a,i=0;i<d;i++)x=h[i][o-1],w=h[i][o],h[i][o-1]=x*a+w*_,h[i][o]=-x*_+w*a;for(w=v(g,y),g=(a=g/(p[o-1]=w))*m+(_=y/w)*b,x=-_*m+a*b,i=0;i<c;i++)b=u[i][o-1],w=u[i][o],u[i][o-1]=b*a+w*_,u[i][o]=-b*_+w*a}f[l]=0,f[s]=g,p[s]=x}for(o=0;o<p.length;o++)p[o]<r&&(p[o]=0);for(o=0;o<d;o++)for(i=o-1;0<=i;i--)if(p[i]<p[o]){for(a=p[i],p[i]=p[o],p[o]=a,s=0;s<u.length;s++)t=u[s][o],u[s][o]=u[s][i],u[s][i]=t;for(s=0;s<h.length;s++)t=h[s][o],h[s][o]=h[s][i],h[s][i]=t;o=i}return{U:u,S:p,V:h}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],8:[function(e,t,r){!function(){"use strict";function f(e,t,r){var n=t.x,a=t.y,o=r.x-n,i=r.y-a;if(0!==o||0!==i){var s=((e.x-n)*o+(e.y-a)*i)/(o*o+i*i);1<s?(n=r.x,a=r.y):0<s&&(n+=o*s,a+=i*s)}return(o=e.x-n)*o+(i=e.y-a)*i}function e(e,t,r){var n=void 0!==t?t*t:1;return e=function(e,t){var r,n,a,o,i=e.length,s=new("undefined"!=typeof Uint8Array?Uint8Array:Array)(i),l=0,u=i-1,c=[],d=[];for(s[l]=s[u]=1;u;){for(n=0,r=l+1;r<u;r++)n<(a=f(e[r],e[l],e[u]))&&(o=r,n=a);t<n&&(s[o]=1,c.push(l,o,o,u)),u=c.pop(),l=c.pop()}for(r=0;r<i;r++)s[r]&&d.push(e[r]);return d}(e=r?e:function(e,t){for(var r,n,a,o,i,s=e[0],l=[s],u=1,c=e.length;u<c;u++)r=e[u],a=s,o=(n=r).x-a.x,i=n.y-a.y,t<o*o+i*i&&(l.push(r),s=r);return s!==r&&l.push(r),l}(e,n),n)}"function"==typeof define&&define.amd?define(function(){return e}):void 0!==t?t.exports=e:"undefined"!=typeof self?self.simplify=e:window.simplify=e}()},{}],9:[function(e,t,r){"use strict";t.exports=function(e){var t,r,n;if(Array.isArray(e)){if(0===(t=e.length))return new A(null,null,0,0);r=e[0].length,n=w(N.mallocDouble(t*(r+1)),[t,r+1]),E(e,n.hi(t,r))}else{t=e.shape[0],r=e.shape[1];var a=e.dtype;a="int8"===a||"int16"===a||"int32"===a?"int32":"uint8"===a||"uint8_clamped"===a||"buffer"===a||"uint16"===a||"uint32"===a?"uint32":"float32"===a?"float32":"float64",n=w(N.malloc(t*(r+1)),[t,r+1]),k.assign(n.hi(t,r),e)}for(var o=0;o<t;++o)n.set(o,r,o);var i=S.malloc([t,r],e.dtype),s=N.mallocInt32(t),l=0,u=i.data,c=n.data,d=(P.log2(P.nextPow2(t)),_.compile(n.order,!0,n.dtype)),f=[n];for(;l<t;){var p=f.shift(),h=p,v=0|h.shape[0];if(1<v){var g,m=P.log2(l+1)%r,y=z.root(v);g=d(h,y,function(e,t){return e.get(m)-t.get(m)});for(var x=i.index(l,0),b=g.offset,o=0;o<r;++o)u[x++]=c[b++];s[l]=c[b],l+=1,f.push(h.hi(y)),2<v&&f.push(h.lo(y+1))}else{for(var b=h.offset,x=i.index(l,0),o=0;o<r;++o)u[x+o]=c[b++];s[l]=c[b],l+=1}}return N.free(n.data),new A(i,s,t,r)},t.exports.deserialize=function(e){var t=e.p,r=e.i;{if(t){for(var n=t.length,a=N.mallocFloat64(n),o=0;o<n;++o)a[o]=t[o];for(var i=r.length,s=N.mallocInt32(i),o=0;o<i;++o)s[o]=r[o];var l=n/i|0;return new A(w(a,[i,l]),s,i,l)}return new A(null,null,0,e.d)}};var w=e("ndarray"),_=e("ndarray-select"),E=e("ndarray-pack"),k=e("ndarray-ops"),S=e("ndarray-scratch"),N=e("typedarray-pool"),z=e("inorder-tree-layout"),P=e("bit-twiddle"),I=e("./lib/heap.js");function A(e,t,r,n){this.points=e,this.ids=t,this.dimension=n,this.length=r}var n=A.prototype;n.serialize=function(){return 0<this.length?{p:Array.prototype.slice.call(this.points.data,0,this.length*this.dimension),i:Array.prototype.slice.call(this.ids,0,this.length)}:{d:this.dimension}},n.range=function(e,t,r){var n=this.length;if(!(n<1)){for(var a=this.dimension,o=0;o<a;++o)if(t[o]<e[o])return;var i,s=this.points,l=this.ids,u=S.malloc([n,2,a]),c=N.mallocInt32(n),d=u.data,f=s.data,p=1,h=0;for(c[0]=0,E(e,u.pick(0,0)),E(t,u.pick(0,1));h<p;){var v=c[h],g=P.log2(v+1)%a,m=u.index(h,0,0),y=u.index(h,1,0),x=s.index(v,0),b=!0;for(o=0;o<a;++o){var w=f[x+o];if(w<d[m+o]||d[y+o]<w){b=!1;break}}if(b&&void 0!==(i=r(l[v])))break;var _=f[x+g],k=d[y+g],z=d[m+g];if(z<=_){var A=2*v+1;if(A<n){c[p]=A;var j=u.index(p,0,0);for(o=0;o<a;++o)d[j+o]=d[m+o];var M=u.index(p,1,0);for(o=0;o<a;++o)d[M+o]=d[y+o];d[M+g]=Math.min(k,_),p+=1}}if(_<=k){var O=2*(v+1);if(O<n){c[p]=O;for(j=u.index(p,0,0),o=0;o<a;++o)d[j+o]=d[m+o];for(M=u.index(p,1,0),o=0;o<a;++o)d[M+o]=d[y+o];d[j+g]=Math.max(z,_),p+=1}}h+=1}return S.free(u),N.free(c),i}},n.rnn=function(e,t,r){if(!(t<0)){var n=this.length;if(!(n<1)){for(var a,o=this.dimension,i=this.points,s=this.ids,l=S.malloc([n,o]),u=N.mallocInt32(n),c=l.data,d=i.data,f=1,p=0,h=t*t,v=u[0]=0;v<o;++v)l.set(0,v,0);for(;p<f;){var g=u[p],m=i.index(g,0),y=0;for(v=0;v<o;++v)y+=Math.pow(e[v]-d[m+v],2);if(y<=h&&void 0!==(a=r(s[g])))break;var x=P.log2(g+1)%o,b=0,w=l.index(p,0);for(v=0;v<o;++v)v!==x&&(b+=c[w+v]);var _=e[x],k=d[m+x],z=c[w+x],A=z,j=z;_<k?j=Math.max(z,Math.pow(k-_,2)):A=Math.max(z,Math.pow(k-_,2));var M=j+b;if(A+b<=h){var O=2*g+1;if(O<n){u[f]=O;var E=l.index(f,0);for(v=0;v<o;++v)c[E+v]=c[w+v];c[E+x]=A,f+=1}}if(M<=h){var F=2*(g+1);if(F<n){u[f]=F;for(E=l.index(f,0),v=0;v<o;++v)c[E+v]=c[w+v];c[E+x]=j,f+=1}}p+=1}return S.free(l),N.free(u),a}}},n.nn=function(e,t){var r=this.length;if(r<1)return-1;if("number"==typeof t){if(t<0)return-1}else t=1/0;for(var n=this.dimension,a=this.points,o=a.data,i=N.mallocFloat64(n),s=new I(r,n+1),l=s.index,u=s.data,c=l[0]=0;c<=n;++c)u[c]=0;s.count+=1;for(var d=-1,f=t;0<s.count&&!(u[0]>=f);){var p=l[0],h=a.index(p,0),v=0;for(c=0;c<n;++c)v+=Math.pow(e[c]-o[h+c],2);v<f&&(f=v,d=p);var g=P.log2(p+1)%n,m=0;for(c=0;c<n;++c){var y=u[c+1];c!==g&&(m+=y),i[c]=y}var x=e[g],b=o[h+g],w=i[g],_=w,k=w;x<b?k=Math.max(w,Math.pow(b-x,2)):_=Math.max(w,Math.pow(b-x,2));var z=_+m,A=k+m;if(s.pop(),z<f){var j=2*p+1;if(j<r){l[O=s.count]=j,u[E=O*(n+1)]=z;for(c=1;c<=n;++c)u[E+c]=i[c-1];u[E+g+1]=_,s.push()}}if(A<f){var M=2*(p+1);if(M<r){var O,E;l[O=s.count]=M,u[E=O*(n+1)]=A;for(c=1;c<=n;++c)u[E+c]=i[c-1];u[E+g+1]=k,s.push()}}}return N.freeFloat64(i),s.dispose(),d<0?-1:this.ids[d]},n.knn=function(e,t,r){if("number"==typeof r){if(r<0)return[]}else r=1/0;var n=this.length;if(n<1)return[];if("number"==typeof t){if(t<=0)return[];t=0|Math.min(t,n)}else t=n;for(var a=this.ids,o=this.dimension,i=this.points,s=i.data,l=N.mallocFloat64(o),u=new I(t,1),c=u.index,d=u.data,f=new I(n,o+1),p=f.index,h=f.data,v=p[0]=0;v<=o;++v)h[v]=0;f.count+=1;for(var g=r;0<f.count&&!(h[0]>=g);){var m=p[0],y=i.index(m,0),x=0;for(v=0;v<o;++v)x+=Math.pow(e[v]-s[y+v],2);if(x<g){u.count>=t&&u.pop();var b=u.count;c[b]=m,d[b]=-x,u.push(),u.count>=t&&(g=-d[0])}var w=P.log2(m+1)%o,_=0;for(v=0;v<o;++v){var k=h[v+1];v!==w&&(_+=k),l[v]=k}var z=e[w],A=s[y+w],j=l[w],M=j,O=j;z<A?O=Math.max(j,Math.pow(A-z,2)):M=Math.max(j,Math.pow(A-z,2));var E=M+_,F=O+_;if(f.pop(),E<g){var S=2*m+1;if(S<n){p[B=f.count]=S,h[C=B*(o+1)]=E;for(v=1;v<=o;++v)h[C+v]=l[v-1];h[C+w+1]=M,f.push()}}if(F<g){var T=2*(m+1);if(T<n){var B,C;p[B=f.count]=T,h[C=B*(o+1)]=F;for(v=1;v<=o;++v)h[C+v]=l[v-1];h[C+w+1]=O,f.push()}}}N.freeFloat64(l),f.dispose();var q=new Array(u.count);for(a=this.ids,v=u.count-1;0<=v;--v)q[v]=a[c[0]],u.pop();return u.dispose(),q},n.dispose=function(){N.free(this.points.data),N.freeInt32(this.ids),this.points=null,this.ids=null,this.length=0}},{"./lib/heap.js":10,"bit-twiddle":11,"inorder-tree-layout":12,ndarray:27,"ndarray-ops":14,"ndarray-pack":19,"ndarray-scratch":25,"ndarray-select":26,"typedarray-pool":31}],10:[function(e,t,r){"use strict";t.exports=a;var n=e("typedarray-pool");function a(e,t){this.count=0,this.dataSize=t,this.index=n.mallocInt32(e),this.data=n.mallocFloat64(e*t)}var o=a.prototype;o.heapSwap=function(e,t){var r=this.data,n=this.index,a=this.dataSize,o=n[e];n[e]=n[t],n[t]=o;for(var i=a*e,s=a*t,l=0;l<a;++l){var u=r[i];r[i]=r[s],r[s]=u,i+=1,s+=1}},o.heapUp=function(e){for(var t,r=this.dataSize,n=(this.index,this.data),a=n[r*e];0<e;){var o=1&(t=e)?t-1>>1:(t>>1)-1;if(0<=o)if(a<n[r*o]){this.heapSwap(e,o),e=o;continue}break}},o.heapDown=function(e){for(var t=this.dataSize,r=(this.index,this.data),n=this.count,a=r[t*e];;){var o=a,i=2*e+1,s=2*(e+1),l=e;if(i<n){var u=r[t*i];u<o&&(l=i,o=u)}if(s<n)r[t*s]<o&&(l=s);if(l===e)break;this.heapSwap(e,l),e=l}},o.pop=function(){this.count-=1,this.heapSwap(0,this.count),this.heapDown(0)},o.push=function(){this.heapUp(this.count),this.count+=1},o.dispose=function(){n.freeInt32(this.index),n.freeFloat64(this.data)}},{"typedarray-pool":31}],11:[function(e,t,r){"use strict";"use restrict";function n(e){var t=32;return(e&=-e)&&t--,65535&e&&(t-=16),16711935&e&&(t-=8),252645135&e&&(t-=4),858993459&e&&(t-=2),1431655765&e&&(t-=1),t}r.INT_BITS=32,r.INT_MAX=2147483647,r.INT_MIN=-1<<31,r.sign=function(e){return(0<e)-(e<0)},r.abs=function(e){var t=e>>31;return(e^t)-t},r.min=function(e,t){return t^(e^t)&-(e<t)},r.max=function(e,t){return e^(e^t)&-(e<t)},r.isPow2=function(e){return!(e&e-1||!e)},r.log2=function(e){var t,r;return t=(65535<e)<<4,t|=r=(255<(e>>>=t))<<3,t|=r=(15<(e>>>=r))<<2,(t|=r=(3<(e>>>=r))<<1)|(e>>>=r)>>1},r.log10=function(e){return 1e9<=e?9:1e8<=e?8:1e7<=e?7:1e6<=e?6:1e5<=e?5:1e4<=e?4:1e3<=e?3:100<=e?2:10<=e?1:0},r.popCount=function(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24},r.countTrailingZeros=n,r.nextPow2=function(e){return e+=0===e,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1},r.prevPow2=function(e){return e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)-(e>>>1)},r.parity=function(e){return e^=e>>>16,e^=e>>>8,e^=e>>>4,27030>>>(e&=15)&1};var a=new Array(256);!function(e){for(var t=0;t<256;++t){var r=t,n=t,a=7;for(r>>>=1;r;r>>>=1)n<<=1,n|=1&r,--a;e[t]=n<<a&255}}(a),r.reverse=function(e){return a[255&e]<<24|a[e>>>8&255]<<16|a[e>>>16&255]<<8|a[e>>>24&255]},r.interleave2=function(e,t){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))<<1},r.deinterleave2=function(e,t){return(e=65535&((e=16711935&((e=252645135&((e=858993459&((e=e>>>t&1431655765)|e>>>1))|e>>>2))|e>>>4))|e>>>16))<<16>>16},r.interleave3=function(e,t,r){return e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2),(e|=(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<1)|(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2))<<2},r.deinterleave3=function(e,t){return(e=1023&((e=4278190335&((e=251719695&((e=3272356035&((e=e>>>t&1227133513)|e>>>2))|e>>>4))|e>>>8))|e>>>16))<<22>>22},r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>n(e)+1}},{}],12:[function(e,t,r){"use strict";var n=e("bit-twiddle");function o(e){var t=(n.nextPow2(e+1)>>>1)-1,r=e-t;return n.nextPow2(r)-1>=t?t:(t>>>1)+r}function a(e,t){if(e<=0)return 0;var r=o(e);return r<t?a(e-r-1,t-r-1):t===r?n.log2(e):a(r,t)}r.root=o,r.begin=function(e){return 0},r.end=function(e){return e-1},r.height=a,r.prev=function(e,t){return Math.max(t-1,0)},r.next=function(e,t){return Math.min(t+1,e-1)},r.parent=function e(t,r){if(t<=0)return-1;var n,a=o(t);return a<r?(n=e(t-a-1,r-a-1))<0?a:n+a+1:r===a?-1:(n=e(a,r))<0?a:n},r.left=function e(t,r){if(t<=0)return 0;var n=o(t);return n<r?e(t-n-1,r-n-1)+n+1:r===n?o(r):e(n,r)},r.right=function e(t,r){if(t<=0)return 0;var n=o(t);return n<r?e(t-n-1,r-n-1)+n+1:r===n?o(t-n-1)+n+1:e(n,r)},r.leaf=function(e,t){return 0===a(e,t)},r.lo=function(e,t){e|=0,t|=0;for(var r=0;1<e;){var n=o(e);if(n<t)r+=n+1,e-=n+1,t-=n+1;else{if(t===n)break;e=n}}return r},r.hi=function(e,t){e|=0,t|=0;for(var r=0;1<e;){var n=o(e);if(n<t)r+=n+1,e-=n+1,t-=n+1;else{if(t===n){r+=e-1;break}e=n}}return r}},{"bit-twiddle":13}],13:[function(e,t,r){arguments[4][11][0].apply(r,arguments)},{dup:11}],14:[function(e,t,r){"use strict";var a=e("cwise-compiler"),n={body:"",args:[],thisVars:[],localVars:[]};function o(e){if(!e)return n;for(var t=0;t<e.args.length;++t){var r=e.args[t];e.args[t]=0===t?{name:r,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:r,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function i(e){for(var t=[],r=0;r<e.args.length;++r)t.push("a"+r);var n;return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(a({args:(n=e).args,pre:o(n.pre),body:o(n.body),post:o(n.proc),funcName:n.funcName}))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var t=s[e];r[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),r[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:!0,funcName:e+"eq"}),r[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),r[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:!0,funcName:e+"seq"})}}();var l={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in l){var t=l[e];r[e]=i({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e}),r[e+"eq"]=i({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var u={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in u){var t=u[e];r[e]=i({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e}),r[e+"s"]=i({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"}),r[e+"eq"]=i({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:!0,count:2,funcName:e+"eq"}),r[e+"seq"]=i({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<c.length;++e){var t=c[e];r[t]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t}),r[t+"eq"]=i({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"})}}();var d=["max","min","atan2","pow"];!function(){for(var e=0;e<d.length;++e){var t=d[e];r[t]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t}),r[t+"s"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"}),r[t+"eq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"eq"}),r[t+"seq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"seq"})}}();var f=["atan2","pow"];!function(){for(var e=0;e<f.length;++e){var t=f[e];r[t+"op"]=i({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"}),r[t+"ops"]=i({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"}),r[t+"opeq"]=i({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opeq"}),r[t+"opseq"]=i({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:t+"opseq"})}}(),r.any=a({args:["array"],pre:n,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),r.all=a({args:["array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),r.sum=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),r.prod=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),r.norm2squared=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),r.norm2=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),r.norminf=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),r.norm1=a({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),r.sup=a({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.inf=a({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),r.argmin=a({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.argmax=a({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),r.random=i({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),r.assign=i({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),r.assigns=i({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),r.equals=a({args:["array","array"],pre:n,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":15}],15:[function(e,t,r){"use strict";var o=e("./lib/thunk.js");t.exports=function(e){var t=new function(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1};t.pre=e.pre,t.body=e.body,t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var n=0;n<r.length;++n){var a=r[n];if("array"===a||"object"==typeof a&&a.blockIndices){if(t.argTypes[n]="array",t.arrayArgs.push(n),t.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),t.shimArgs.push("array"+n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array args");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)t.scalarArgs.push(n),t.shimArgs.push("scalar"+n);else if("index"===a){if(t.indexArgs.push(n),n<t.pre.args.length&&0<t.pre.args[n].count)throw new Error("cwise: pre() block may not reference array index");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array index");if(n<t.post.args.length&&0<t.post.args[n].count)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(t.shapeArgs.push(n),n<t.pre.args.length&&t.pre.args[n].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(n<t.body.args.length&&t.body.args[n].lvalue)throw new Error("cwise: body() block may not write to array shape");if(n<t.post.args.length&&t.post.args[n].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof a||!a.offset)throw new Error("cwise: Unknown argument type "+r[n]);t.argTypes[n]="offset",t.offsetArgs.push({array:a.array,offset:a.offset}),t.offsetArgIndex.push(n)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>r.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>r.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>r.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,o(t)}},{"./lib/thunk.js":17}],16:[function(e,t,r){"use strict";var k=e("uniq");function z(e,t,r){var n,a,o=e.length,i=t.arrayArgs.length,s=0<t.indexArgs.length,l=[],u=[],c=0,d=0;for(n=0;n<o;++n)u.push(["i",n,"=0"].join(""));for(a=0;a<i;++a)for(n=0;n<o;++n)d=c,c=e[n],0===n?u.push(["d",a,"s",n,"=t",a,"p",c].join("")):u.push(["d",a,"s",n,"=(t",a,"p",c,"-s",d,"*t",a,"p",d,")"].join(""));for(l.push("var "+u.join(",")),n=o-1;0<=n;--n)c=e[n],l.push(["for(i",n,"=0;i",n,"<s",c,";++i",n,"){"].join(""));for(l.push(r),n=0;n<o;++n){for(d=c,c=e[n],a=0;a<i;++a)l.push(["p",a,"+=d",a,"s",n].join(""));s&&(0<n&&l.push(["index[",d,"]-=s",d].join("")),l.push(["++index[",c,"]"].join(""))),l.push("}")}return l.join("\n")}function A(e,t,r){for(var n=e.body,a=[],o=[],i=0;i<e.args.length;++i){var s=e.args[i];if(!(s.count<=0)){var l=new RegExp(s.name,"g"),u="",c=t.arrayArgs.indexOf(i);switch(t.argTypes[i]){case"offset":var d=t.offsetArgIndex.indexOf(i);c=t.offsetArgs[d].array,u="+q"+d;case"array":u="p"+c+u;var f="l"+i,p="a"+c;if(0===t.arrayBlockIndices[c])1===s.count?"generic"===r[c]?s.lvalue?(a.push(["var ",f,"=",p,".get(",u,")"].join("")),n=n.replace(l,f),o.push([p,".set(",u,",",f,")"].join(""))):n=n.replace(l,[p,".get(",u,")"].join("")):n=n.replace(l,[p,"[",u,"]"].join("")):"generic"===r[c]?(a.push(["var ",f,"=",p,".get(",u,")"].join("")),n=n.replace(l,f),s.lvalue&&o.push([p,".set(",u,",",f,")"].join(""))):(a.push(["var ",f,"=",p,"[",u,"]"].join("")),n=n.replace(l,f),s.lvalue&&o.push([p,"[",u,"]=",f].join("")));else{for(var h=[s.name],v=[u],g=0;g<Math.abs(t.arrayBlockIndices[c]);g++)h.push("\\s*\\[([^\\]]+)\\]"),v.push("$"+(g+1)+"*t"+c+"b"+g);if(l=new RegExp(h.join(""),"g"),u=v.join("+"),"generic"===r[c])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(l,[p,"[",u,"]"].join(""))}break;case"scalar":n=n.replace(l,"Y"+t.scalarArgs.indexOf(i));break;case"index":n=n.replace(l,"index");break;case"shape":n=n.replace(l,"shape")}}}return[a.join("\n"),n,o.join("\n")].join("\n").trim()}t.exports=function(e,t){for(var r=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,n=new Array(e.arrayArgs.length),a=new Array(e.arrayArgs.length),o=0;o<e.arrayArgs.length;++o)a[o]=t[2*o],n[o]=t[2*o+1];var i=[],s=[],l=[],u=[],c=[];for(o=0;o<e.arrayArgs.length;++o){e.arrayBlockIndices[o]<0?(l.push(0),u.push(r),i.push(r),s.push(r+e.arrayBlockIndices[o])):(l.push(e.arrayBlockIndices[o]),u.push(e.arrayBlockIndices[o]+r),i.push(0),s.push(e.arrayBlockIndices[o]));for(var d=[],f=0;f<n[o].length;f++)l[o]<=n[o][f]&&n[o][f]<u[o]&&d.push(n[o][f]-l[o]);c.push(d)}var p=["SS"],h=["'use strict'"],v=[];for(f=0;f<r;++f)v.push(["s",f,"=SS[",f,"]"].join(""));for(o=0;o<e.arrayArgs.length;++o){for(p.push("a"+o),p.push("t"+o),p.push("p"+o),f=0;f<r;++f)v.push(["t",o,"p",f,"=t",o,"[",l[o]+f,"]"].join(""));for(f=0;f<Math.abs(e.arrayBlockIndices[o]);++f)v.push(["t",o,"b",f,"=t",o,"[",i[o]+f,"]"].join(""))}for(o=0;o<e.scalarArgs.length;++o)p.push("Y"+o);if(0<e.shapeArgs.length&&v.push("shape=SS.slice(0)"),0<e.indexArgs.length){var g=new Array(r);for(o=0;o<r;++o)g[o]="0";v.push(["index=[",g.join(","),"]"].join(""))}for(o=0;o<e.offsetArgs.length;++o){var m=e.offsetArgs[o],y=[];for(f=0;f<m.offset.length;++f)0!==m.offset[f]&&(1===m.offset[f]?y.push(["t",m.array,"p",f].join("")):y.push([m.offset[f],"*t",m.array,"p",f].join("")));0===y.length?v.push("q"+o+"=0"):v.push(["q",o,"=",y.join("+")].join(""))}var x=k([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for(v=v.concat(x),h.push("var "+v.join(",")),o=0;o<e.arrayArgs.length;++o)h.push("p"+o+"|=0");3<e.pre.body.length&&h.push(A(e.pre,e,a));var b=A(e.body,e,a),w=function(e){for(var t=0,r=e[0].length;t<r;){for(var n=1;n<e.length;++n)if(e[n][t]!==e[0][t])return t;++t}return t}(c);w<r?h.push(function(e,t,r,n){for(var a=t.length,o=r.arrayArgs.length,i=r.blockSize,s=0<r.indexArgs.length,l=[],u=0;u<o;++u)l.push(["var offset",u,"=p",u].join(""));for(u=e;u<a;++u)l.push(["for(var j"+u+"=SS[",t[u],"]|0;j",u,">0;){"].join("")),l.push(["if(j",u,"<",i,"){"].join("")),l.push(["s",t[u],"=j",u].join("")),l.push(["j",u,"=0"].join("")),l.push(["}else{s",t[u],"=",i].join("")),l.push(["j",u,"-=",i,"}"].join("")),s&&l.push(["index[",t[u],"]=j",u].join(""));for(u=0;u<o;++u){for(var c=["offset"+u],d=e;d<a;++d)c.push(["j",d,"*t",u,"p",t[d]].join(""));l.push(["p",u,"=(",c.join("+"),")"].join(""))}for(l.push(z(t,r,n)),u=e;u<a;++u)l.push("}");return l.join("\n")}(w,c[0],e,b)):h.push(z(c[0],e,b)),3<e.post.body.length&&h.push(A(e.post,e,a)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+h.join("\n")+"\n----------");var _=[e.funcName||"unnamed","_cwise_loop_",n[0].join("s"),"m",w,function(e){for(var t=new Array(e.length),r=!0,n=0;n<e.length;++n){var a=e[n],o=a.match(/\d+/);o=o?o[0]:"",0===a.charAt(0)?t[n]="u"+a.charAt(1)+o:t[n]=a.charAt(0)+o,0<n&&(r=r&&t[n]===t[n-1])}return r?t[0]:t.join("")}(a)].join("");return new Function(["function ",_,"(",p.join(","),"){",h.join("\n"),"} return ",_].join(""))()}},{uniq:18}],17:[function(e,t,r){"use strict";var d=e("./compile.js");t.exports=function(e){var t=["'use strict'","var CACHED={}"],r=[],n=e.funcName+"_cwise_thunk";t.push(["return function ",n,"(",e.shimArgs.join(","),"){"].join(""));for(var a=[],o=[],i=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],s=[],l=[],u=0;u<e.arrayArgs.length;++u){var c=e.arrayArgs[u];r.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),a.push("t"+c),a.push("r"+c),o.push("t"+c),o.push("r"+c+".join()"),i.push("array"+c+".data"),i.push("array"+c+".stride"),i.push("array"+c+".offset|0"),0<u&&(s.push("array"+e.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[u]))),l.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[u])+"]"))}for(1<e.arrayArgs.length&&(t.push("if (!("+s.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),u=0;u<e.scalarArgs.length;++u)i.push("scalar"+e.scalarArgs[u]);return r.push(["type=[",o.join(","),"].join()"].join("")),r.push("proc=CACHED[type]"),t.push("var "+r.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",i.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(d.bind(void 0,e))}},{"./compile.js":16}],18:[function(e,t,r){"use strict";t.exports=function(e,t,r){return 0===e.length?e:t?(r||e.sort(t),function(e,t){for(var r=1,n=e.length,a=e[0],o=e[0],i=1;i<n;++i)if(o=a,t(a=e[i],o)){if(i===r){r++;continue}e[r++]=a}return e.length=r,e}(e,t)):(r||e.sort(),function(e){for(var t=1,r=e.length,n=e[0],a=e[0],o=1;o<r;++o,a=n)if(a=n,(n=e[o])!==a){if(o===t){t++;continue}e[t++]=n}return e.length=t,e}(e))}},{}],19:[function(e,t,r){"use strict";var o=e("ndarray"),i=e("./doConvert.js");t.exports=function(e,t){for(var r=[],n=e,a=1;n instanceof Array;)r.push(n.length),a*=n.length,n=n[0];return 0===r.length?o():(t||(t=o(new Float64Array(a),r)),i(t,e),t)}},{"./doConvert.js":20,ndarray:27}],20:[function(e,t,r){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":21}],21:[function(e,t,r){arguments[4][15][0].apply(r,arguments)},{"./lib/thunk.js":23,dup:15}],22:[function(e,t,r){arguments[4][16][0].apply(r,arguments)},{dup:16,uniq:24}],23:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"./compile.js":22,dup:17}],24:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{dup:18}],25:[function(e,t,r){"use strict";var u=e("ndarray"),a=e("ndarray-ops"),c=e("typedarray-pool");r.clone=function(e){var t=e.dtype;"generic"!==t&&"array"!==t||(t="double");var r=c.malloc(e.size,t),n=u(r,e.shape);return a.assign(n,e),n},r.malloc=function(e,t){t||(t="double");for(var r=1,n=new Array(e.length),a=e.length-1;0<=a;--a)n[a]=r,r*=e[a];return u(c.malloc(r,t),e,n,0)},r.free=function(e){"generic"!==e.dtype&&"array"!==e.dtype&&c.free(e.data)},r.zeros=function(e,t){t||(t="double");for(var r=1,n=new Array(e.length),a=e.length-1;0<=a;--a)n[a]=r,r*=e[a];var o=c.malloc(r,t);for(a=0;a<r;++a)o[a]=0;return u(o,e,n,0)},r.ones=function(e,t){t||(t="double");for(var r=1,n=new Array(e.length),a=e.length-1;0<=a;--a)n[a]=r,r*=e[a];var o=c.malloc(r,t);for(a=0;a<r;++a)o[a]=1;return u(o,e,n,0)},r.eye=function(e,t){var r,n;t||(t="double");var a=1,o=new Array(e.length);for(r=e.length-1;0<=r;--r)o[r]=a,a*=e[r];var i=c.malloc(a,t);for(r=0;r<a;++r)i[r]=0;var s=1/0,l=0;for(r=e.length-1;0<=r;r--)l+=o[r],s=Math.min(s,e[r]);for(n=r=0;r<s;r++,n+=l)i[n]=1;return u(i,e,o,0)}},{ndarray:27,"ndarray-ops":14,"typedarray-pool":31}],26:[function(e,t,r){"use strict";t.exports=function(e,t,r){if(t|=0,0===e.dimension||e.shape[0]<=t||t<0)return null;var n=!!r,a=i(e.order,n,e.dtype);return n?a(e,t,r):a(e,t)},t.exports.compile=i;var h="a",v="K",g="C",m="d",y="o",x="R",b="T",w="L",_="H",k="X";function z(e){return"s"+e}function A(e){return"t"+e}function j(e){return"u"+e}function M(e){return"v"+e}function O(e){return"i"+e}function E(e){return"p"+e}function F(e){return"x"+e}var o={};function i(e,t,r){var n=e.join()+t+r,a=o[n];return a||(o[n]=function(a,o,e){var t,r;(r=(t=a).slice()).splice(t.indexOf(0),1),r.unshift(0);var i=(a=r).length,s="generic"===e,n="ndSelect"+e+a.join("_")+"_"+(o?"cmp":"lex"),l=[],u=[h,v];o&&u.push(g);for(var c=[m+"="+h+".data",y+"="+h+".offset|0",x+"=Math.random",b],d=0;d<2;++d)c.push(F(d)+"=0");for(d=0;d<i;++d)c.push(z(d)+"="+h+".shape["+d+"]|0",A(d)+"="+h+".stride["+d+"]|0",O(d)+"=0");for(d=1;d<i;++d)1<d?c.push(M(d)+"=("+A(d)+"-"+z(d-1)+"*"+A(d-1)+")|0",j(a[d])+"=("+A(a[d])+"-"+z(a[d-1])+"*"+A(a[d-1])+")|0"):c.push(M(d)+"="+A(d),j(a[d])+"="+A(a[d]));if(o)for(d=0;d<2;++d)c.push(E(d)+"="+h+".pick(0)");function f(e,t){l.push(F(0),"=",y,"+",A(a[0]),"*(",e,");",F(1),"=",y,"+",A(a[0]),"*(",t,");");for(var r=i-1;0<r;--r)l.push("for(",O(a[r]),"=0;",O(a[r]),"<",z(a[r]),";",O(a[r]),"++){");for(s?l.push(b,"=",m,".get(",F(0),");",m,".set(",F(0),",",m,".get(",F(1),"));",m,".set(",F(1),",",b,");"):l.push(b,"=",m,"[",F(0),"];",m,"[",F(0),"]=",m,"[",F(1),"];",m,"[",F(1),"]=",b,";"),r=1;r<i;++r)l.push(F(0),"+=",j(a[r]),";",F(1),"+=",j(a[r]),"}")}c.push(k+"=0",w+"=0",_+"="+z(a[0])+"-1"),l.push("while(",w,"<",_,"){",k,"=(",x,"()*(",_,"-",w,"+1)+",w,")|0;"),f(k,_),l.push(k,"=",w,";","for(",O(0),"=",w,";",O(0),"<",_,";",O(0),"++){"),function(e,t,r){if(o)l.push(E(0),".offset=",y,"+",A(a[0]),"*(",t,");",E(1),".offset=",y,"+",A(a[0]),"*(",r,");",e,"=",g,"(",E(0),",",E(1),");");else{l.push(F(0),"=",y,"+",A(0),"*(",t,");",F(1),"=",y,"+",A(0),"*(",r,");"),1<i&&l.push("_cmp:");for(var n=i-1;0<n;--n)l.push("for(",O(n),"=0;",O(n),"<",z(n),";",O(n),"++){");for(s?l.push(e,"=",m,".get(",F(0),")-",m,".get(",F(1),");"):l.push(e,"=",m,"[",F(0),"]-",m,"[",F(1),"];"),1<i&&l.push("if(",e,")break _cmp;"),n=1;n<i;++n)l.push(F(0),"+=",M(n),";",F(1),"+=",M(n),"}")}}(b,O(0),_),l.push("if(",b,"<0){"),f(k,O(0)),l.push(k,"++;"),l.push("}}"),f(k,_),l.push("if(",k,"===",v,"){",w,"=",k,";","break;","}else if(",v,"<",k,"){",_,"=",k,"-1;","}else{",w,"=",k,"+1;","}","}"),o?l.push(E(0),".offset=",y,"+",w,"*",A(0),";","return ",E(0),";"):l.push("return ",h,".pick(",w,");");var p=["'use strict';function ",n,"(",u,"){","var ",c.join(),";",l.join(""),"};return ",n].join("");return new Function(p)()}(e,t,r))}},{}],27:[function(e,t,r){var v=e("iota-array"),u=e("is-buffer"),c="undefined"!=typeof Float64Array;function a(e,t){return e[0]-t[0]}function g(){var e,t=this.stride,r=new Array(t.length);for(e=0;e<r.length;++e)r[e]=[Math.abs(t[e]),e];r.sort(a);var n=new Array(r.length);for(e=0;e<n.length;++e)n[e]=r[e][1];return n}function d(e,t){var r=["View",t,"d",e].join("");t<0&&(r="View_Nil"+e);var n="generic"===e;if(-1===t){var a="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";return new Function(a)()}if(0===t){a="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(n?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(n?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";return new Function("TrivialArray",a)(m[e][0])}a=["'use strict'"];var o=v(t),i=o.map(function(e){return"i"+e}),s="this.offset+"+o.map(function(e){return"this.stride["+e+"]*i"+e}).join("+"),l=o.map(function(e){return"b"+e}).join(","),u=o.map(function(e){return"c"+e}).join(",");a.push("function "+r+"(a,"+l+","+u+",d){this.data=a","this.shape=["+l+"]","this.stride=["+u+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),a.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+o.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})"),1===t?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),t<4?(a.push("function "+r+"_order(){"),2===t?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+r+"_set("+i.join(",")+",v){"),n?a.push("return this.data.set("+s+",v)}"):a.push("return this.data["+s+"]=v}"),a.push("proto.get=function "+r+"_get("+i.join(",")+"){"),n?a.push("return this.data.get("+s+")}"):a.push("return this.data["+s+"]}"),a.push("proto.index=function "+r+"_index(",i.join(),"){return "+s+"}"),a.push("proto.hi=function "+r+"_hi("+i.join(",")+"){return new "+r+"(this.data,"+o.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+o.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var c=o.map(function(e){return"a"+e+"=this.shape["+e+"]"}),d=o.map(function(e){return"c"+e+"=this.stride["+e+"]"});a.push("proto.lo=function "+r+"_lo("+i.join(",")+"){var b=this.offset,d=0,"+c.join(",")+","+d.join(","));for(var f=0;f<t;++f)a.push("if(typeof i"+f+"==='number'&&i"+f+">=0){d=i"+f+"|0;b+=c"+f+"*d;a"+f+"-=d}");a.push("return new "+r+"(this.data,"+o.map(function(e){return"a"+e}).join(",")+","+o.map(function(e){return"c"+e}).join(",")+",b)}"),a.push("proto.step=function "+r+"_step("+i.join(",")+"){var "+o.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+o.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(f=0;f<t;++f)a.push("if(typeof i"+f+"==='number'){d=i"+f+"|0;if(d<0){c+=b"+f+"*(a"+f+"-1);a"+f+"=ceil(-a"+f+"/d)}else{a"+f+"=ceil(a"+f+"/d)}b"+f+"*=d}");a.push("return new "+r+"(this.data,"+o.map(function(e){return"a"+e}).join(",")+","+o.map(function(e){return"b"+e}).join(",")+",c)}");var p=new Array(t),h=new Array(t);for(f=0;f<t;++f)p[f]="a[i"+f+"]",h[f]="b[i"+f+"]";a.push("proto.transpose=function "+r+"_transpose("+i+"){"+i.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+p.join(",")+","+h.join(",")+",this.offset)}"),a.push("proto.pick=function "+r+"_pick("+i+"){var a=[],b=[],c=this.offset");for(f=0;f<t;++f)a.push("if(typeof i"+f+"==='number'&&i"+f+">=0){c=(c+this.stride["+f+"]*i"+f+")|0}else{a.push(this.shape["+f+"]);b.push(this.stride["+f+"])}");return a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+o.map(function(e){return"shape["+e+"]"}).join(",")+","+o.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",a.join("\n"))(m[e],g)}var m={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=function(e,t,r,n){if(void 0===e)return(0,m.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var a=t.length;if(void 0===r){r=new Array(a);for(var o=a-1,i=1;0<=o;--o)r[o]=i,i*=t[o]}if(void 0===n)for(o=n=0;o<a;++o)r[o]<0&&(n-=(t[o]-1)*r[o]);for(var s=function(e){if(u(e))return"buffer";if(c)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}(e),l=m[s];l.length<=a+1;)l.push(d(s,l.length-1));return(0,l[a+1])(e,t,r,n)}},{"iota-array":28,"is-buffer":29}],28:[function(e,t,r){"use strict";t.exports=function(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=r;return t}},{}],29:[function(e,t,r){t.exports=function(e){return!(null==e||!(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)))}},{}],30:[function(e,t,r){"use strict";t.exports=function(e,t){switch(void 0===t&&(t=0),typeof e){case"number":if(0<e)return function(e,t){var r,n;for(r=new Array(e),n=0;n<e;++n)r[n]=t;return r}(0|e,t);break;case"object":if("number"==typeof e.length)return function e(t,r,n){var a=0|t[n];if(a<=0)return[];var o,i=new Array(a);if(n===t.length-1)for(o=0;o<a;++o)i[o]=r;else for(o=0;o<a;++o)i[o]=e(t,r,n+1);return i}(e,t,0)}return[]}},{}],31:[function(w,e,_){(function(e,n){"use strict";var a=w("bit-twiddle"),t=w("dup");e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:t([32,0]),UINT16:t([32,0]),UINT32:t([32,0]),INT8:t([32,0]),INT16:t([32,0]),INT32:t([32,0]),FLOAT:t([32,0]),DOUBLE:t([32,0]),DATA:t([32,0]),UINT8C:t([32,0]),BUFFER:t([32,0])});var r="undefined"!=typeof Uint8ClampedArray,o=e.__TYPEDARRAY_POOL;o.UINT8C||(o.UINT8C=t([32,0])),o.BUFFER||(o.BUFFER=t([32,0]));var i=o.DATA,s=o.BUFFER;function l(e){if(e){var t=e.length||e.byteLength,r=a.log2(t);i[r].push(e)}}function u(e){e=a.nextPow2(e);var t=a.log2(e),r=i[t];return 0<r.length?r.pop():new ArrayBuffer(e)}function c(e){return new Uint8Array(u(e),0,e)}function d(e){return new Uint16Array(u(2*e),0,e)}function f(e){return new Uint32Array(u(4*e),0,e)}function p(e){return new Int8Array(u(e),0,e)}function h(e){return new Int16Array(u(2*e),0,e)}function v(e){return new Int32Array(u(4*e),0,e)}function g(e){return new Float32Array(u(4*e),0,e)}function m(e){return new Float64Array(u(8*e),0,e)}function y(e){return r?new Uint8ClampedArray(u(e),0,e):c(e)}function x(e){return new DataView(u(e),0,e)}function b(e){e=a.nextPow2(e);var t=a.log2(e),r=s[t];return 0<r.length?r.pop():new n(e)}_.free=function(e){if(n.isBuffer(e))s[a.log2(e.length)].push(e);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(e)&&(e=e.buffer),!e)return;var t=e.length||e.byteLength,r=0|a.log2(t);i[r].push(e)}},_.freeUint8=_.freeUint16=_.freeUint32=_.freeInt8=_.freeInt16=_.freeInt32=_.freeFloat32=_.freeFloat=_.freeFloat64=_.freeDouble=_.freeUint8Clamped=_.freeDataView=function(e){l(e.buffer)},_.freeArrayBuffer=l,_.freeBuffer=function(e){s[a.log2(e.length)].push(e)},_.malloc=function(e,t){if(void 0===t||"arraybuffer"===t)return u(e);switch(t){case"uint8":return c(e);case"uint16":return d(e);case"uint32":return f(e);case"int8":return p(e);case"int16":return h(e);case"int32":return v(e);case"float":case"float32":return g(e);case"double":case"float64":return m(e);case"uint8_clamped":return y(e);case"buffer":return b(e);case"data":case"dataview":return x(e);default:return null}return null},_.mallocArrayBuffer=u,_.mallocUint8=c,_.mallocUint16=d,_.mallocUint32=f,_.mallocInt8=p,_.mallocInt16=h,_.mallocInt32=v,_.mallocFloat32=_.mallocFloat=g,_.mallocFloat64=_.mallocDouble=m,_.mallocUint8Clamped=y,_.mallocDataView=x,_.mallocBuffer=b,_.clearCache=function(){for(var e=0;e<32;++e)o.UINT8[e].length=0,o.UINT16[e].length=0,o.UINT32[e].length=0,o.INT8[e].length=0,o.INT16[e].length=0,o.INT32[e].length=0,o.FLOAT[e].length=0,o.DOUBLE[e].length=0,o.UINT8C[e].length=0,i[e].length=0,s[e].length=0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},w("buffer").Buffer)},{"bit-twiddle":11,buffer:2,dup:30}],32:[function(e,t,r){var c;c=e("../color/sort.coffee"),t.exports=function(e,t,r,n,a,o,i){var s,l,u;for(n||(n="asc"),a instanceof Array||(a=[a]),r instanceof Array||(r=[r]),o&&void 0!==i&&"number"!=typeof i&&(i=o.id.nesting.indexOf(i)),s=u=0;s<r.length&&(l=r[s],e=o&&e.d3plus&&e.d3plus.sortKeys?e.d3plus.sortKeys[l]:e[l],t=o&&t.d3plus&&t.d3plus.sortKeys?t.d3plus.sortKeys[l]:t[l],0===(u=o&&0<=a.indexOf(l)?c(e,t):e<t?-1:1)&&s!==r.length-1);)s++;return"asc"===n?u:-u}},{"../color/sort.coffee":49}],33:[function(e,t,r){t.exports=function(e,t){var r;return e instanceof Array&&(r=null==t?t:t.constructor,0<=e.indexOf(t)||0<=e.indexOf(r))}},{}],34:[function(e,t,r){var c,d;c=e("./comparator.coffee"),d=e("../core/fetch/sort.coffee"),t.exports=function(e,r,n,a,o,i){var t,s,l,u;if(!e||e.length<=1)return e||[];if(o)for(r||(r=o.order.value||o.size.value||o.id.value),n||(n=o.order.sort.value),a||(a=o.color.value||[]),l=0,u=e.length;l<u;l++)(t=e[l]).d3plus||(t.d3plus={}),s="d3plus"in t&&"d3plus"in t.d3plus?t.d3plus:t,t.d3plus.sortKeys=d(o,s,r,a,i);return e.sort(function(e,t){return c(e,t,r,n,a,o,i)})}},{"../core/fetch/sort.coffee":65,"./comparator.coffee":32}],35:[function(e,t,r){t.exports=function(e,t){return void 0===t?e:!1===t?[]:t instanceof Array?t:(e instanceof Array||(e=[]),0<=e.indexOf(t)?e.splice(e.indexOf(t),1):e.push(t),e)}},{}],36:[function(e,t,r){var o;(o=function(e){var t,r,n,a;if(e in(a=o.tested))return a[e];for(r=0,n=!1;r<document.styleSheets.length;){if((t=document.styleSheets[r]).href&&0<=t.href.indexOf(e)){n=!0;break}r++}return n}).tested={},t.exports=o},{}],37:[function(e,t,r){t.exports=/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)},{}],38:[function(e,t,r){var n,a;n=e("./ie.js"),a=e("./touch.coffee"),t.exports=a?{click:"click",down:"touchstart",up:"touchend",over:n?"mouseenter":"mouseover",out:n?"mouseleave":"mouseout",move:"mousemove"}:{click:"click",down:"mousedown",up:"mouseup",over:n?"mouseenter":"mouseover",out:n?"mouseleave":"mouseout",move:"mousemove"}},{"./ie.js":37,"./touch.coffee":43}],39:[function(e,t,r){var n;n=function(){var e;return e="-webkit-transform"in document.body.style?"-webkit-":"-moz-transform"in document.body.style?"-moz-":"-ms-transform"in document.body.style?"-ms-":"-o-transform"in document.body.style?"-o-":"",n=function(){return e},e},t.exports=n},{}],40:[function(e,t,r){t.exports="rtl"===d3.select("html").attr("dir")},{}],41:[function(e,t,r){t.exports={y:function(){return void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop},x:function(){return void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}}},{}],42:[function(e,t,r){var o;o=function(){var e,t,r,n,a;return(e=document.createElement("p")).style.width="100%",e.style.height="200px",(t=document.createElement("div")).style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),document.body.appendChild(t),n=e.offsetWidth,t.style.overflow="scroll",n===(a=e.offsetWidth)&&(a=t.clientWidth),document.body.removeChild(t),o=function(){return r},r=n-a},t.exports=o},{}],43:[function(e,t,r){t.exports=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},{}],44:[function(e,t,r){t.exports=function(e){var t;return.45<(t=d3.hsl(e)).l&&(.8<t.s&&(t.s=.8),t.l=.45),t.toString()}},{}],45:[function(e,t,r){t.exports=function(e,t){var r;return void 0===t&&(t=.5),t=(1-(r=d3.hsl(e)).l)*t,r.l+=t,r.s-=t,r.toString()}},{}],46:[function(e,t,r){t.exports=function(e,t,r,n){var a,o,i;return r||(r=1),n||(n=1),e=d3.rgb(e),t=d3.rgb(t),i=(r*e.r+n*t.r-r*n*t.r)/(r+n-r*n),o=(r*e.g+n*t.g-r*n*t.g)/(r+n-r*n),a=(r*e.b+n*t.b-r*n*t.b)/(r+n-r*n),d3.rgb(i,o,a).toString()}},{}],47:[function(e,t,r){var n;n=e("./scale.coffee"),t.exports=function(e,t){var r;return r=e||Math.floor(20*Math.random()),(t=t||n)(r)}},{"./scale.coffee":48}],48:[function(e,t,r){t.exports=d3.scale.ordinal().range(["#b22200","#282F6B","#EACE3F","#B35C1E","#224F20","#5F487C","#759143","#419391","#993F88","#e89c89","#ffee8d","#afd5e8","#f7ba77","#a5c697","#c5b5e5","#d1d392","#bbefd0","#e099cf"])},{}],49:[function(e,t,r){t.exports=function(e,t){var r,n;return r=d3.hsl(e),n=d3.hsl(t),(e=0===r.s?361:r.h)===(t=0===n.s?361:n.h)?r.l-n.l:e-t}},{}],50:[function(e,t,r){t.exports=function(e){var t;return 128<=(299*(t=d3.rgb(e)).r+587*t.g+114*t.b)/1e3?"#444444":"#f7f7f7"}},{}],51:[function(e,t,r){t.exports=function(e){var t,r;return 0===(e=(e+="").replace(RegExp(" ","g"),"")).indexOf("rgb")&&(e=e.split("(")[1].split(")")[0].split(",").slice(0,3).join(",")),0===e.indexOf("hsl")&&(e=e.split(",")[2].split(")")[0]),t=d3.rgb(e).toString(),r=0<=["black","#000","#000000","0%","0,0,0"].indexOf(e),"#000000"!==t||r}},{}],52:[function(e,t,r){var o,n,a;o=e("../../client/ie.js"),a=e("./wiki.coffee"),(n=function(e,t,r){r=r||"",o||"undefined"!=typeof InstallTrigger?console.log("[ D3plus ] "+t):0===e.indexOf("group")?console[e]("%c[ D3plus ]%c "+t,"font-weight: 800;color: #b35c1e;margin-left: 0px;","font-weight:200;"+r):console[e]("%c"+t,r+"font-weight:200;")}).comment=function(e){this("log",e,"color:#aaa;")},n.error=function(e,t){this("groupCollapsed","ERROR: "+e,"font-weight:800;color:#D74B03;"),this.stack(),this.wiki(t),this.groupEnd()},n.group=function(e){this("group",e,"color:#888;")},n.groupCollapsed=function(e){this("groupCollapsed",e,"color:#888;")},n.groupEnd=function(){o||console.groupEnd()},n.log=function(e){this("log",e,"color:#444444;")},n.stack=function(){var e,t,r,n,a;o||(e=new Error).stack&&(n=(n=e.stack.split("\n")).filter(function(e){return 0!==e.indexOf("Error")&&e.indexOf("d3plus.js:")<0&&e.indexOf("d3plus.min.js:")<0})).length&&n[0].length&&(r=window.chrome?"at ":"@",0<=(a=n[0]).indexOf(r)&&(a=a.split(r)[1]),3===(n=a.split(":")).length&&n.pop(),this("log","line "+n.pop()+" of "+(t=(t=n.join(":").split("/"))[t.length-1])+": "+a,"color:#D74B03;"))},n.time=function(e){o||console.time(e)},n.timeEnd=function(e){o||console.timeEnd(e)},n.warning=function(e,t){this("groupCollapsed",e,"color:#888;"),this.stack(),this.wiki(t),this.groupEnd()},n.wiki=function(e){e&&(e in a&&(e=d3plus.repo+"wiki/"+a[e]),this("log","documentation: "+e,"color:#aaa;"))},t.exports=n},{"../../client/ie.js":37,"./wiki.coffee":53}],53:[function(e,t,r){t.exports={active:"Visualizations#active",aggs:"Visualizations#aggs",alt:"Forms#alt",attrs:"Visualizations#attrs",axes:"Visualizations#axes",background:"Visualizations#background",color:"Visualizations#color",cols:"Visualizations#cols",config:"Visualizations#config",container:"Visualizations#container",coords:"Visualizations#coords",csv:"Visualizations#csv",data:"Visualizations#data",depth:"Visualizations#depth",descs:"Visualizations#descs",dev:"Visualizations#dev",draw:"Visualizations#draw",edges:"Visualizations#edges",error:"Visualizations#error",focus:"Visualizations#focus",font:"Visualizations#font",footer:"Visualizations#footer",format:"Visualizations#format",height:"Visualizations#height",history:"Visualizations#history",hover:"Forms#hover",icon:"Visualizations#icon",id:"Visualizations#id",keywords:"Forms#keywords",labels:"Visualizations#labels",legend:"Visualizations#legend",links:"Visualizations#links",margin:"Visualizations#margin",messages:"Visualizations#messages",method:"Methods",mouse:"Visualizations#mouse",nodes:"Visualizations#nodes",open:"Forms#open",order:"Visualizations#order",remove:"Forms#remove",search:"Forms#search",select:"Forms#select",selectAll:"Forms#selectAll",shape:"Visualizations#shape",size:"Visualizations#size",temp:"Visualizations#temp",text:"Visualizations#text",time:"Visualizations#time",timeline:"Visualizations#timeline",timing:"Visualizations#timing",title:"Visualizations#title",tooltip:"Visualizations#tooltip",total:"Visualizations#total",type:"Visualizations#type",ui:"Visualizations#ui",width:"Visualizations#width",x:"Visualizations#x",y:"Visualizations#y",zoom:"Visualizations#zoom"}},{}],54:[function(e,t,r){var a=e("../../util/buckets.coffee"),o=e("../fetch/value.coffee"),i=e("../console/print.coffee");t.exports=function(r){if(r.dev.value&&i.time("getting color data range"),r.color.domain.value)var n=r.color.domain.value;else{n=[];r.data.pool.forEach(function(e){var t=parseFloat(o(r,e,r.color.value));"number"==typeof t&&!isNaN(t)&&n.indexOf(t)<0&&n.push(t)})}if(r.dev.value&&i.timeEnd("getting color data range"),1<n.length){if(r.dev.value&&i.time("calculating color scale"),(n=d3.extent(n))[0]<0&&0<n[1])3==(e=r.color.range).length&&(n.push(n[1]),n[1]=0);else if(0<n[1]&&0<=n[0]){var e=r.color.heatmap;n=a(n,e.length)}else{e=r.color.range.slice(0);n[0]<0?e.pop():e.shift()}r.color.valueScale=d3.scale.sqrt().domain(n).range(e).interpolate(d3.interpolateRgb),r.dev.value&&i.timeEnd("calculating color scale")}else r.color.valueScale=null}},{"../../util/buckets.coffee":204,"../console/print.coffee":52,"../fetch/value.coffee":67}],55:[function(e,t,r){var l=e("../fetch/value.coffee"),u=e("../console/print.coffee"),c=e("../../object/validate.coffee");t.exports=function(s,e){s.dev.value&&u.time("filtering data");var t=d3.keys(s.data.keys||{});"attrs"in s&&(t=t.concat(d3.keys(s.attrs.keys||{}))),e=e.filter(function(e){return null!==l(s,e,s.id.value)});var n=s.types[s.type.value].requirements||[];s.data.filters.forEach(function(r){0<=t.indexOf(s[r].value)&&0<=n.indexOf(r)&&(e=e.filter(function(e){var t=l(s,e,s[r].value);return"y"===r&&s.y2.value&&null===t?t=l(s,e,s.y2.value):"x"===r&&s.x2.value&&null===t&&(t=l(s,e,s.x2.value)),"size"===r?"number"==typeof t:null!==t}))});var a=s.data.solo.length?"solo":"mute";return s.data[a].length?s.data[a].forEach(function(o){function i(t){var e=s[o][a].value,r=!1;return e.forEach(function(e){"function"==typeof e?r=e(t):e===t&&(r=!0)}),"solo"===a?r:!r}function t(e,t){if(!t&&s[o].nesting){var r=s[o].nesting;c(r)&&(r=d3.values(r));for(var n=0;n<r.length;n++){var a=e.filter(function(e){return i(l(s,e,r[n]))});a.length&&(e=a)}}else e=e.filter(function(e){return i(l(s,e,s[o].value))});return e}e=t(e),"id"===o&&("nodes"in s&&s.nodes.value&&(s.dev.value&&u.time("filtering nodes"),s.nodes.restricted=t(s.nodes.value),s.dev.value&&u.timeEnd("filtering nodes")),"edges"in s&&s.edges.value&&(s.dev.value&&u.time("filtering edges"),s.edges.restricted=s.edges.value.filter(function(e){return 2===t([e[s.edges.source],e[s.edges.target]]).length}),s.dev.value&&u.timeEnd("filtering edges")))}):"nodes"in s&&(s.nodes.restricted=void 0,s.edges.restricted=void 0),s.dev.value&&u.timeEnd("filtering data"),e}},{"../../object/validate.coffee":172,"../console/print.coffee":52,"../fetch/value.coffee":67}],56:[function(e,t,r){var k=e("./nest.js"),z=e("../fetch/value.coffee"),A=e("../console/print.coffee"),j=e("../../util/uniques.coffee");t.exports=function(o){var e;if(o.data.time={values:[]},o.time&&o.time.value){o.dev.value&&(e="analyzing time periods",A.time(e)),o.data.time.values=j(o.data.value,o.time.value,z,o),o.data.time.values.sort(function(e,t){return e-t});var i=[];o.data.time.values.forEach(function(e,t){if(0!==t){var r=o.data.time.values[t-1];i.push(e-r),t===o.data.time.values.length-1&&(o.data.time.total=e-o.data.time.values[0])}}),i=d3.min(i),o.data.time.step=i;var s=["Milliseconds","Seconds","Minutes","Hours","Date","Month","FullYear"],l=[1e3,60,60,24,30,12,1];o.data.time.periods=s;var u=function(e,t,r){return o.data.time.stepDivider||(arr=l.slice(0,r),arr.length?o.data.time.stepDivider=arr.reduce(function(e,t){return e*t}):o.data.time.stepDivider=1),Math.round(Math.floor(t-e)/o.data.time.stepDivider)},c=o.data.time.total;s.forEach(function(e,t){var r="Date"===e?28:l[t];if(!o.data.time.stepType&&(t===s.length-1||Math.round(i)<r)){o.data.time.stepType=e;var n=o.data.time.values[0],a=o.data.time.values[o.data.time.values.length-1];o.data.time.stepIntervals=u(n,a,t)}!o.data.time.totalType&&(t===s.length-1||Math.round(c)<r)&&(o.data.time.totalType=e),i/=r,c/=r}),o.data.time.values.forEach(function(e,t){if(0!==t){var r=o.data.time.values[0];o.data.time.dataSteps.push(u(r,e,s.indexOf(o.data.time.stepType)))}else o.data.time.dataSteps=[0]});var t=o.time.format.value,a=o.format.locale.value,r=[function(e){return e.getMilliseconds()},function(e){return e.getSeconds()},function(e){return e.getMinutes()},function(e){return e.getHours()},function(e){return 1!=e.getDate()},function(e){return e.getMonth()},function(e){return!0}];o.data.time.functions=r;var n=function(e,t,r){return e===t?r&&a.timeFormat[e+"Small"]?a.timeFormat[e+"Small"]:a.timeFormat[e]:4<=s.indexOf(e)||s.indexOf(t)<=3?a.timeFormat[t+"-"+e]:(n="Date"===t?a.timeFormat[t]:a.timeFormat[t+"-Date"],"Hours"===e?n+" "+a.timeFormat[e]:n+" "+a.timeFormat["Hours-"+e]);var n};if(o.data.time.getFormat=n,t)"string"==typeof t?o.data.time.format=d3.locale(a.format).timeFormat(t):"function"==typeof t?o.data.time.format=t:t instanceof Array&&(o.data.time.format=d3.locale(a.format).timeFormat.multi(t)),o.data.time.multiFormat=o.data.time.format;else{for(var d=o.data.time.stepType,f=o.data.time.totalType,p=[],h=s.indexOf(d);h<=s.indexOf(f);h++){var v=h-1<s.indexOf(d)?s[h]:s[h-1],g=s[h]===v&&d!==f,m=n(v,s[h],g);p.push([m,r[h]])}o.data.time.format=d3.locale(a.format).timeFormat(n(d,f)),1<p.length?(p[p.length-1][1]=function(e){return!0},o.data.time.multiFormat=d3.locale(a.format).timeFormat.multi(p)):o.data.time.multiFormat=o.data.time.format}o.data.time.ticks=[];for(var y=d3.min(o.data.time.values),x=d3.max(o.data.time.values),b=0;b<=o.data.time.stepIntervals;b++){var w=new Date(y);w["set"+o.data.time.stepType](w["get"+o.data.time.stepType]()+b),w<=x&&o.data.time.ticks.push(w)}o.dev.value&&A.timeEnd(e)}if(o.dev.value&&(e="nesting data by time and depths",A.time(e)),o.data.nested={},0===o.data.time.values.length)o.data.nested.all={},o.id.nesting.forEach(function(e,t){var r=o.id.nesting.slice(0,t+1);o.data.nested.all[e]=k(o,o.data.value,r)});else{var _=o.data.value.reduce(function(e,t){var r=z(o,t,o.time.value).getTime();return r in e||(e[r]=[]),e[r].push(t),e},{});o.data.time.values.forEach(function(e){var n=e.getTime();o.data.nested[n]={},o.id.nesting.forEach(function(e,t){var r=o.id.nesting.slice(0,t+1);o.data.nested[n][e]=k(o,_[n],r)})})}o.dev.value&&A.timeEnd(e)}},{"../../util/uniques.coffee":210,"../console/print.coffee":52,"../fetch/value.coffee":67,"./nest.js":60}],57:[function(e,t,r){var p;p=e("../fetch/value.coffee"),t.exports=function(r,e,t){var n,a,o,i,s,l,u,c,d,f;if(a=d3.nest(),r.id.grouping.value)for(void 0===t&&(t=r.id.nesting),o=i=0,l=t.length;i<l;o=++i)c=t[o],o<r.depth.value&&function(t){a.key(function(e){return p(r,e.d3plus,t)})}(c);for(d=[],s=0,u=e.length;s<u;s++)n=e[s],(f=r.size.value?p(r,n,r.size.value):1)&&"number"==typeof f&&0<f&&(delete n.d3plus.r,delete n.d3plus.x,delete n.d3plus.y,d.push({d3plus:n,id:n[r.id.value],value:f}));return a.entries(d)}},{"../fetch/value.coffee":67}],58:[function(e,t,r){var d,f,p=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};d=e("../console/print.coffee"),f=e("../../object/validate.coffee"),t.exports=function(l,u){var c,e,t,r,n,a,o,i,s;if(o=u+" key analysis",l.dev.value&&d.time(o),l[u].keys={},c=function(e){var t,r,n,a,o,i,s;if(e instanceof Array){for(o=[],r=0,a=e.length;r<a;r++)t=e[r],o.push(c(t));return o}if(f(e)){for(n in i=[],e)s=e[n],0===n.indexOf("d3plus")||0<=p.call(l[u].keys,n)||null===s?i.push(void 0):i.push(l[u].keys[n]=typeof s);return i}},f(l[u].value))for(e in r=d3.keys(l[u].value).length===l.id.nesting.length,n=l[u].value)if(i=n[e],r&&0<=l.id.nesting.indexOf(e)&&f(i))for(t in i)s=i[t],c(s);else c(i);else for(e in a=l[u].value)i=a[e],c(i);if(l.dev.value)return d.time(o)}},{"../../object/validate.coffee":172,"../console/print.coffee":52}],59:[function(e,t,r){var c,d;c=e("../console/print.coffee"),d=e("../../object/validate.coffee"),t.exports=function(a,o,i){var s,l,u;return(s=a.dev.value)&&c.time("loading "+o),u=a[o].url,a[o].filetype.value?l=a[o].filetype.value:(l=1<(l=u.slice(u.length-5).split(".")).length&&l[1])?("txt"===l&&(l="text"),a[o].filetype.accepted.indexOf(l)<0&&(l="json")):l="json",("dsv"===l?d3.dsv(a[o].delimiter.value,"text/plain"):d3[l])(u,function(e,t){var r,n;if(!e&&t){if("function"==typeof a[o].callback){if(n=a[o].callback(t))if(d(n)&&o in n)for(r in n)r in a&&(a[r].value=n[r]);else a[o].value=n}else a[o].value=t;["json"].indexOf(l)<0&&a[o].value.forEach(function(e){var t;for(r in t=[],e)isNaN(e[r])?"false"===e[r].toLowerCase()?t.push(e[r]=!1):"true"===e[r].toLowerCase()?t.push(e[r]=!0):"null"===e[r].toLowerCase()?t.push(e[r]=null):"undefined"===e[r].toLowerCase()?t.push(e[r]=void 0):t.push(void 0):t.push(e[r]=parseFloat(e[r]));return t}),a[o].changed=!0,a[o].loaded=!0}else a.error.internal='Could not load data from: "'+u+'"';return s&&c.timeEnd("loading "+o),i()})}},{"../../object/validate.coffee":172,"../console/print.coffee":52}],60:[function(e,t,r){var z=e("../fetch/value.coffee"),a=e("../../object/validate.coffee"),A=e("../../util/uniques.coffee"),j=function(e,r){var n=[];return function e(t){t instanceof Array?t.forEach(e):a(t)&&r in t&&(t[r]instanceof Array?t[r].forEach(e):n.push(t))}(e),n},M=function(e){var a=[];return function e(t){for(var r=0;r<t.length;r++){var n=t[r];n&&(n.constructor===Array?e(n):a.push(n))}}(e),A(a)},o=function(e){return e.values&&e.values.length?(e.children=e.values.map(function(e){return o(e)}),delete e.values,e):e.values?e.values:e};t.exports=function(x,e,b,t){void 0===t&&(t=!0);var r=d3.nest(),w=[],_="temp"in x?["active","temp","total"]:[];b.length?b.forEach(function(t,e){r.key(function(e){return z(x,e,t)})}):r.key(function(e){return!0}),t&&x.axes&&x.axes.discrete&&(!x.time||x[x.axes.discrete].value!==x.time.value)&&r.key(function(e){return z(x,e,x[x.axes.discrete].value)});var n=b.length&&0<=x.id.nesting.indexOf(b[b.length-1]),k=b.length&&n?b.length-1:0;n?x.id.nesting[k]:x.depth.value;r.rollup(function(e){if(1===e.length&&"d3plus"in e[0])return w.push(e[0]),e[0];e=e.reduce(function(e,t){return t.values instanceof Array?e.concat(t.values):(e.push(t),e)},[]);var t={d3plus:{data:{},depth:k}};if(d3.sum(e,function(e){return"d3plus"in e&&e.d3plus.merged?1:0})===e.length)for(var r=0;r<e.length;r++){var n=e[r];t.d3plus.merged||(t.d3plus.merged=[]),t.d3plus.merged=t.d3plus.merged.concat(n.d3plus.merged),n.d3plus.text&&(t.d3plus.text=n.d3plus.text)}for(var a=0;a<_.length;a++){var o=_[a],i=x.aggs&&x.aggs.value[s]?x.aggs.value[s]:"sum";"d3plus"in e[0]&&o in e[0].d3plus?t.d3plus[o]=d3.sum(e,function(e){return e.d3plus[o]}):t.d3plus[o]="function"==typeof i?i(e):d3[i](e,function(e){var t="total"===o?1:0;return x[o].value&&"number"!=typeof(t=z(x,e,x[o].value))&&(t=t?1:0),t})}for(var s in x.data.keys){if(s in t.d3plus.data)t[s]=t.d3plus[s];else{var l=x.aggs&&x.aggs.value[s]?x.aggs.value[s]:"sum",u=typeof l,c=x.data.keys[s],d=0<=x.id.nesting.indexOf(s),f="time"in x&&s===x.time.value;if(s in t.d3plus.data)t[s]=t.d3plus[s];else if("function"===u)t[s]=x.aggs.value[s](e);else if(f)t[s]=M(A(e,s));else if(x.axes&&x.axes.discrete&&x[x.axes.discrete].value===s)t[s]=A(e,s);else if("number"!==c||"string"!==u||d){var p=j(e,s),h=1===p.length?p[0][s]:A(p,s);if(1===p.length)t[s]=h;else if(h&&h.length)h instanceof Array||(h=[h]),d&&x.id.nesting.indexOf(s)>k?t[s]=p:t[s]=h;else if(d){var v=x.id.nesting.indexOf(s)-1;k<=v&&(!("endPoint"in t.d3plus)||t.d3plus.endPoint>k)&&(t.d3plus.endPoint=k)}}else{var g=e.map(function(e){return e[s]});(g=g.filter(function(e){return typeof e===c})).length&&(t[s]=d3[l](g))}}s in t&&t[s]instanceof Array&&1===t[s].length&&(t[s]=t[s][0])}for(var m=0;m<b.length;m++){var y=b[m];y in t||(t[y]=z(x,e[0],y))}return w.push(t),t});var a=function(e,t,r){if(e.children){for(var n in"number"==x.data.keys[b[t]]&&(e.key=parseFloat(e.key)),r[b[t]]=e.key,delete e.key,r)e[n]=r[n];t++,e.children.forEach(function(e){a(e,t,r)})}};return r=r.entries(e).map(o).map(function(e){return a(e,0,{}),e}),w}},{"../../object/validate.coffee":172,"../../util/uniques.coffee":210,"../fetch/value.coffee":67}],61:[function(e,t,r){var h=e("../../array/sort.coffee"),v=e("./nest.js"),g=e("../fetch/value.coffee"),m=(e("../fetch/color.coffee"),e("../fetch/text.js"));t.exports=function(o,e,i){var s;if("number"==typeof(s=!1===o.size.threshold.value?0:"number"==typeof o.size.threshold.value?o.size.threshold.value:"function"==typeof o.size.threshold.value?o.size.threshold.value(o):"number"==typeof o.types[o.type.value].threshold?o.types[o.type.value].threshold:"function"==typeof o.types[o.type.value].threshold?o.types[o.type.value].threshold(o):.02)&&0<s){var l=[],u=0===o.depth.value?0:{},c=[],d=[],f=[],p={},t=d3.nest();i&&t.key(function(e){return g(o,e,i)}),t.rollup(function(e){var t=e.length;o.aggs.value[o.size.value]?"function"==typeof o.aggs.value[o.size.value]?t=o.aggs.value[o.size.value](e):"string"==typeof o.aggs.value[o.size.value]&&(t=d3[o.aggs.value[o.size.value]](e,function(e){return g(o,e,o.size.value)})):t=d3.sum(e,function(e){return g(o,e,o.size.value)});var r=i?g(o,e[0],i):"all";return p[r]=t}).entries(e),e.forEach(function(e){var t=g(o,e,o.id.value),r=g(o,e,o.size.value),n=i?g(o,e,i):"all";if(r/p[n]>=s&&l.indexOf(t)<0&&(l.push(t),o.depth.value)){var a=g(o,e,o.id.nesting[o.depth.value-1]);d.indexOf(a)<0&&d.push(a)}});var r=e.filter(function(e){var t=g(o,e,o.id.value),r=0<=l.indexOf(t),n=o.depth.value?g(o,e,o.id.nesting[o.depth.value-1]):null;if(null!==n&&d.indexOf(n)<0&&f.indexOf(n)<0&&f.push(n),!r){var a=g(o,e,o.size.value);0<a&&(0===o.depth.value?u<a&&(u=a):(n in u||(u[n]=0),a>u[n]&&(u[n]=a)),c.push(e))}return r});if(1<c.length){c=h(c,o.size.value,"desc",[],o);var n=o.id.nesting.slice(0,o.depth.value);0<=o.types[o.type.value].requirements.indexOf(o.axes.discrete)&&n.push(o[o.axes.discrete].value);var a=v(o,c,n);a.forEach(function(n){var e,t=o.id.nesting[o.depth.value-1],r=g(o,n,t);(children=t?c.filter(function(e){return g(o,e,t)===r}):c,1<children.length)&&(o.id.nesting.forEach(function(e,t){if(o.depth.value==t){var r=n[e];n[e]="string"==typeof r?"d3plus_other_"+r:"d3plus_other"}else t>o.depth.value&&delete n[e]}),o.color.value&&"string"===o.color.type&&(0===o.depth.value?n[o.color.value]=o.color.missing:n[o.color.value]=g(o,r,o.color.value,t)),o.icon.value&&(n[o.icon.value]=g(o,r,o.icon.value,t)),r&&(n.d3plus.depth=o.depth.value),0===o.depth.value?(e=o.format.value(o.format.locale.value.ui.values,{key:"threshold",vars:o}),e+=" < "+o.format.value(u,{key:o.size.value,vars:o})):(e=(e=m(o,n,o.depth.value-1)).length?e[0].split(" < ")[0]:o.format.value(o.format.locale.value.ui.values,{key:"threshold",vars:o}),f.indexOf(r)<0&&(e+=" < "+o.format.value(u[r],{key:o.size.value,vars:o}))),f.indexOf(r)<0&&(e+=" ("+o.format.value(100*s,{key:"share",vars:o})+")"),n.d3plus.threshold=u,n.d3plus.merged=children,o.text.value&&(n[o.text.value]=e),n.d3plus.text=e)})}else a=c;return r.concat(a)}return e}},{"../../array/sort.coffee":34,"../fetch/color.coffee":63,"../fetch/text.js":66,"../fetch/value.coffee":67,"./nest.js":60}],62:[function(e,t,r){var b;b=e("../../font/sizes.coffee"),t.exports=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x;if(x=t.values||e.data.time.ticks,v=t.style||{},i=t.limit||e.width.value,g={},u=e.data.time.periods,h=e.data.time.stepType,m=e.data.time.totalType,a=e.data.time.functions,o=e.data.time.getFormat,s=e.format.locale.value.format,e.time.format.value)g.format=e.data.time.format,g.values=x,g.sizes=b(x.map(function(e){return g.format(e)}),v);else for(l=u.indexOf(h);l<=u.indexOf(m);){if(y=x.filter(function(e){var t,r;if(l===u.indexOf(h))return!0;if(t=!0,r=l-1,l<0)return!0;for(;r>=u.indexOf(h)&&t;)t=!a[r](e),r--;return t}),u[l]===m)n=d3.locale(s).timeFormat(o(u[l],m));else{for(c=l,n=[];c<=u.indexOf(m);)d=c-1<u.indexOf(h)?c:c-1,d=u[d],p=u[c]===d&&h!==m,r=o(d,u[c],p),n.push([r,a[c]]),c++;n[n.length-1][1]=function(){return!0},n=d3.locale(s).timeFormat.multi(n)}if(f=b(y.map(function(e){return n(e)}),v),d3.sum(f,function(e){return e.width})<i||l===u.indexOf(m)){g.format=n,g.values=y,g.sizes=f;break}l++}return g}},{"../../font/sizes.coffee":102}],63:[function(e,t,r){var l,u,c,n,d,a,f;l=e("./value.coffee"),n=e("../../color/random.coffee"),a=e("../../color/validate.coffee"),f=e("../../object/validate.coffee"),d=e("../../util/uniques.coffee"),t.exports=function(e,t,r){var n,a,o,i,s;if(f(t)&&"d3plus"in t&&"color"in t.d3plus)return t.d3plus.color;if(void 0===r&&(r=e.id.value),"number"==typeof r&&(r=e.id.nesting[r]),e.color.value){for(o=[],i=e.id.nesting.indexOf(r);0<=i;){if(a=e.id.nesting[i],1===(s=d(t,e.color.value,l,e,a)).length&&(s=s[0]),!(s instanceof Array)&&null!=s){n=u(e,t,s,r),o.indexOf(n)<0&&o.push(n);break}i--}return 1===o.length?o[0]:e.color.missing}return c(e,t,r)},u=function(e,t,r,n){return r?e.color.valueScale?e.color.valueScale(r):a(r)?r:c(e,r,n):e.color.value&&"function"==typeof e.color.valueScale?e.color.valueScale(0):c(e,t,n)},c=function(e,t,r){return f(t)&&(t=l(e,t,r)),t instanceof Array&&(t=t[0]),n(t,e.color.scale.value)}},{"../../color/random.coffee":47,"../../color/validate.coffee":51,"../../object/validate.coffee":172,"../../util/uniques.coffee":210,"./value.coffee":67}],64:[function(e,t,r){var O=e("../data/filter.js"),E=e("../data/nest.js"),F=e("../console/print.coffee"),S=e("../../string/format.js"),T=e("../../string/list.coffee");t.exports=function(t,r,e){if(!t.data.value)return[];void 0===e&&(e=t.depth.value);var n=t.id.nesting[e];if(!r||r instanceof Array||(r=[r]),!r&&"time"in t){r=[];var a=t.time.solo.value.length?"solo":"mute",o=t.time[a].value;if(o.length){r=[];for(var i=0;i<o.length;i++){var s=o[i];if("function"==typeof s)for(var l=0;l<t.data.time.values.length;l++){var u=t.data.time.values[l].getTime();s(u)&&r.push(u)}else if(s.constructor===Date)r.push(new Date(s).getTime());else{4===(s+="").length&&parseInt(s)+""===s&&(s+="/01/01");var c=new Date(s);"Invalid Date"!==c&&r.push(c.getTime())}}"mute"===a&&(r=t.data.time.values.filter(function(e){return r.indexOf(e.getTime())<0}))}else r.push("all")}else r=["all"];if(0<=r.indexOf("all")&&t.data.time.values.length){r=t.data.time.values.slice(0);for(var d=0;d<r.length;d++)r[d]=r[d].getTime()}var f=[t.type.value,n,e].concat(t.data.filters).concat(r),p=t.data.solo.length?"solo":"mute",h=d3.keys(t.data.cache),v=t.types[t.type.value].filter||void 0;if(t.data[p].length)for(var g=0;g<t.data[p].length;g++){var m=t.data[p][g],y=t[m][p].value.slice(0);y.unshift(m),y.unshift(p),f=f.concat(y)}t.axes&&t.axes.discrete&&f.push(t.axes.discrete),f=f.join("_"),t.data.cacheID=f;for(var x,b=0;b<h.length;b++){if(h[b].split("_").slice(1).join("_")===f){f=(new Date).getTime()+"_"+f,t.data.cache[f]=t.data.cache[h[b]],delete t.data.cache[h[b]];break}}if(t.data.cache[f])return t.dev.value&&F.comment("data already cached"),x=t.data.cache[f].data,"nodes"in t&&(t.nodes.restricted=t.data.cache[f].nodes,t.edges.restricted=t.data.cache[f].edges),"function"==typeof v&&(x=v(t,x)),x;var w=[];if(x=[],t.data.value&&t.data.value.length)for(var _=0;_<r.length;_++){var k=r[_];t.data.nested[k]?x=x.concat(t.data.nested[k][n]):w.push(k)}if(0===x.length&&w.length&&!t.error.internal){1<w.length&&(w=d3.extent(w)),w=(w=w.map(function(e){return t.data.time.format(new Date(e))})).join(" - ");var z=t.format.locale.value.error.dataYear,A=t.format.locale.value.ui.and;w=T(w,A),t.error.internal=S(z,w),t.time.missing=!0}else{if(t.time&&(t.time.missing=!1),1<r.length){var j=!1;if(["x","y","x2","y2"].forEach(function(e){t[e].value===t.time.value&&"discrete"===t[e].scale.value&&(j=!0)}),!j){var M=t.id.nesting.slice(0,e+1);x=E(t,x,M)}}x=x?O(t,x):[],20===h.length&&(h.sort(),delete t.data.cache[h[0]]),f=(new Date).getTime()+"_"+f,t.data.cache[f]={data:x},"nodes"in t&&(t.data.cache[f].nodes=t.nodes.restricted,t.data.cache[f].edges=t.edges.restricted),"function"==typeof v&&(x=v(t,x)),t.dev.value&&F.comment("storing data in cache")}return x}},{"../../string/format.js":173,"../../string/list.coffee":174,"../console/print.coffee":52,"../data/filter.js":55,"../data/nest.js":60}],65:[function(e,t,r){var d,f,p;p=e("./value.coffee"),d=e("./color.coffee"),f=e("./text.js"),t.exports=function(e,t,r,n,a){var o,i,s,l,u,c;for(r instanceof Array||(r=[r]),n instanceof Array||(n=[n]),e&&(void 0===a?a=e.id.value:"number"!=typeof a&&(a=e.id.nesting.indexOf(a))),u={},i=0,l=r.length;i<l;i++)s=r[i],c=e?0<=n.indexOf(s)?d(e,t,a):s===e.text.value?f(e,t,a):3===d3.keys(t).length&&t.d3plus&&t.key&&t.values?p(e,t.values.map(function(e){return e.d3plus}),s,a):p(e,t,s,a):t[s],0<=[e.data.keys[s],e.attrs.keys[s]].indexOf("number")?((o=e.order.agg.value||e.aggs.value[s]||"sum").constructor===String&&(o=d3[o]),c instanceof Array||(c=[c]),c=o(c)):(c instanceof Array&&(c=c[0]),c="string"==typeof c?c.toLowerCase():c),u[s]=c;return u}},{"./color.coffee":63,"./text.js":66,"./value.coffee":67}],66:[function(e,t,r){var s=e("./value.coffee"),l=e("../../object/validate.coffee"),u=e("../../util/uniques.coffee");t.exports=function(r,n,e){"number"!=typeof e&&(e=r.depth.value);var t,a=r.id.nesting[e];r.text.nesting&&l(r.text.nesting)?t=r.text.nesting[a]?r.text.nesting[a]:r.text.value:(t=[],r.text.value&&e===r.depth.value&&t.push(r.text.value),t.push(a)),t instanceof Array||(t=[t]);var o=[];if(l(n)&&"d3plus"in n&&n.d3plus.text)o.push(n.d3plus.text.toString()),o.push(r.format.value(n.d3plus.text.toString(),{vars:r,data:n}));else{var i=l(n)?n:void 0;i&&n[r.id.value]instanceof Array?n=n[r.id.value]:n instanceof Array||(n=[n]),t.forEach(function(t){var e=u(n,t,s,r,a);e.length&&(1<e.length&&(e=e.filter(function(e){return e instanceof Array||"string"==typeof e&&e.indexOf(" < ")<0})),1===(e=e.map(function(e){return e instanceof Array?(e=e.filter(function(e){return e})).map(function(e){return r.format.value(e.toString(),{vars:r,data:i,key:t})}):e?r.format.value(e.toString(),{vars:r,data:i,key:t}):void 0})).length&&(e=e[0]),o.push(e))})}return o}},{"../../object/validate.coffee":172,"../../util/uniques.coffee":210,"./value.coffee":67}],67:[function(e,t,r){var l,u,c,n,i,d,f,p,h,v;h=e("../../object/validate.coffee"),p=e("../../util/uniques.coffee"),f=function(e,t,r,n){var a,o,i,s;if(o=h(t),"function"==typeof r&&o)return r(t,e);if(o){if(r in t)return t[r];if(a=e.data.cacheID+"_"+n,l(t,a,e),r in t.d3plus.data[a])return t.d3plus.data[a][r];if(n in t)t=t[n];else{if(!(e.id.value in t))return null;if(t=t[e.id.value],n!==r&&(i=c(e,t,n,e.id.value)),null==i&&(i=u(e,t,n,e.id.value)),null==i)return null;if(n===r)return i;t=i}}return t instanceof Array&&!h(t[0])&&(t=p(t)),t instanceof Array&&h(t[0])&&(s=p(t,r)).length?s:(s=c(e,t,r,n))?s:s=u(e,t,r,n)},c=function(e,t,r,n){var a;return e.data.viz instanceof Array&&r in e.data.keys&&(a=p(d(e.data.viz,t,n),r)),a&&a.length?a:null},u=function(e,n,t,r){var a,o,i,s;if("attrs"in e&&e.attrs.value&&t in e.attrs.keys)if((a=h(e.attrs.value)&&r in e.attrs.value?e.attrs.value[r]:e.attrs.value)instanceof Array){if((i=p(d(a,n,r),t)).length)return i}else if(n instanceof Array){if((a=[function(){var e,t,r;if(o in a){for(r=[],e=0,t=n.length;e<t;e++)o=n[e],r.push(a[o]);return r}}()]).length&&(s=p(a,t)).length)return s}else if(n in a)return a[n][t];return null},d=function(e,t,r){return t instanceof Array?e.filter(function(e){return 0<=t.indexOf(e[r])}):e.filter(function(e){return e[r]===t})},l=function(e,t,r){return"d3plus"in e||(e.d3plus={}),"data"in e.d3plus||(e.d3plus.data={}),!(r.data.changed||r.attrs&&r.attrs.changed)&&t in e.d3plus.data||(e.d3plus.data[t]={}),e},v=function(e,t,r,n,a){var o,i,s,l,u,c,d;if(null===a)return a;c="time"in e&&e.time.value===n,a instanceof Array||(a=[a]);for(s=l=0,u=a.length;l<u;s=++l)d=a[s],c&&null!==d&&d.constructor!==Date&&(4===(d+="").length&&parseInt(d)+""===d&&(d+="/01/01"),"Invalid Date"!==(i=new Date(d))&&(a[s]=i));return 1===a.length&&(a=a[0]),null===a||!h(t)||"string"!=typeof n||n in t||(o=e.data.cacheID+"_"+r,t.d3plus.data[o][n]=a),a},i=function(e,t,r,n){var a,o,i,s,l;for(l=[],o=0,i=t.length;o<i;o++)a=t[o],h(a)?(s=f(e,a,r,n),l.push(v(e,a,n,r,s))):l.push(a);return"number"!=typeof l[0]&&(l=p(l)),1===l.length?l[0]:l},n=function(e,t,r,n){var a,o;return r?"number"==typeof r?r:(a=h(t),n||(n=e.id.value),a&&t.values instanceof Array?o=i(e,t.values,r,n):a&&t[r]instanceof Array?o=i(e,t[r],r,n):t instanceof Array?o=i(e,t,r,n):(o=f(e,t,r,n),o=v(e,t,n,r,o)),o):null},t.exports=n},{"../../object/validate.coffee":172,"../../util/uniques.coffee":210}],68:[function(e,t,r){t.exports=function(e){var t,r,n;return["div","svg"].indexOf(e)<0&&(e="div"),r={position:"absolute",left:"-9999px",top:"-9999px",visibility:"hidden",display:"block"},t="div"===e?{}:{position:"absolute"},(n=d3.select("body").selectAll(e+".d3plus_tester").data([0])).enter().append(e).attr("class","d3plus_tester").style(r).attr(t),n}},{}],69:[function(e,t,r){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," €"],dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},error:{accepted:"{0} ist kein gültiger {1} für {2}-Darstellungen. Benutzen Sie bitte: {3}.",connections:"Keine Verbindungen verfügbar für {0}.",data:"Keine Daten verfügbar",dataYear:"Für {0} sind keine Daten verfügbar.",lib:"{0}-Darstellungen erfordern das Laden der Bibliothek {1}.",libs:"{0}-Darstellungen erfordern das Laden folgender Bibliotheken: {1}.",method:"{0}-Darstellungen erfordern die Methode {1}.",methods:"Weitere Einstellungen für folgende Methoden {1} sind bei {0}-Darstellungen erforderlich."},lowercase:["ein","ein","und","wie","bei","aber","durch","für","von","wenn","in","in","in der Nähe","noch","von","auf","auf","oder","pro","das","die","zu","mit","über","gegen","gegen."],method:{active:"aktive Segmente",color:"Farbe",depth:"Tiefe",dev:"ausführlich",focus:"Fokus",icon:"Symbol",id:"Kennung",height:"Höhe",labels:"Beschriftungen",legend:"Legende",margin:"Rand",messages:"Statusmeldungen",order:"Reihenfolge",search:"Suche",shape:"Form",size:"Größe",style:"Stil",temp:"temporäre Segmente",text:"Text",time:"Zeit",timeline:"Zeitleiste",total:"Segmente gesamt",type:"Typ",width:"Breite",x:"x-Achse",y:"y-Achse",zoom:"Zoom",mode:"Modus",mute:"ausblenden",solo:"isolieren"},time:["Datum","Tag","Monat","Zeit","Jahr"],visualization:{bubbles:"Blasen",chart:"Diagramm",geo_map:"Karte",line:"Liniendiagramm",network:"Netzwerk",rings:"Ringe",scatter:"Punktdiagramm",stacked:"Gestapelte Fläche",tree_map:"Baumdiagramm",bar:"Balkendiagramm",box:"Boxplot",paths:"Pfade",pie:"Kreisdiagramm",table:"Tabelle"},ui:{and:"und",back:"zurück",collapse:"Zum Ausblenden klicken",error:"Fehler",expand:"Zum Einblenden klicken",loading:"Lade...",more:"{0} weitere",moreInfo:"Für zusätzliche Informationen klicken",noResults:"Keine Ergebnisse für {0} gefunden.",primary:"Primäre Verbindungen",share:"teilen",total:"gesamt",values:"Werte",including:"einschließlich",or:"oder",iqr:"Interquartilsabstände {0}",max:"Maximalwert",min:"Minimalwert",percentile:"Perzentil P{0}",tukey_bottom:"Unterer Ausreißer",tukey_top:"Oberer Ausreißer",quartile_first:"Unteres Quartil Q1",quartile_third:"Oberes Quartil Q3",median:"Medianwert"},message:{data:"analysiere Daten",draw:"Darstellung wird gerendert",initializing:"initialisiere {0}",loading:"Daten werden geladen",tooltipReset:"Tooltips zurücksetzen",ui:"aktualisiere Oberfläche"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","BIP","HVAC","ID","IT","FuE","TV","UI"]}},{}],70:[function(e,t,r){t.exports={dev:{accepted:"{0} is not an accepted value for {1}, please use one of the following: {2}.",deprecated:"the {0} method has been removed, please update your code to use {1}.",noChange:"{0} was not updated because it did not change.",noContainer:"cannot find a container on the page matching {0}.",of:"of",oldStyle:"style properties for {0} have now been embedded directly into .{1}().",sameEdge:"edges cannot link to themselves. automatically removing self-referencing edge {0}.",set:"{0} has been set.",setLong:"{0} has been set to {1}.",setContainer:"please define a container div using .container()"},error:{accepted:"{0} is not an accepted {1} for {2} visualizations, please use one of the following: {3}.",connections:"no connections available for {0}.",data:"no data available",dataYear:"no data available for {0}.",lib:"{0} visualizations require loading the {1} library.",libs:"{0} visualizations require loading the following libraries: {1}.",method:"{0} visualizations require setting the {1} method.",methods:"{0} visualizations require setting the following methods: {1}."},format:{decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%A, %B %-d, %Y %X",date:"%-m/%-d/%Y",time:"%I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},lowercase:["a","an","and","as","at","but","by","for","from","if","in","into","near","nor","of","on","onto","or","per","that","the","to","with","via","vs","vs."],message:{data:"analyzing data",draw:"drawing visualization",initializing:"initializing {0}",loading:"loading data",tooltipReset:"resetting tooltips",ui:"updating ui"},method:{active:"active segments",color:"color",depth:"depth",dev:"verbose",focus:"focus",icon:"icon",id:"id",height:"height",labels:"labels",legend:"legend",margin:"margin",messages:"status messages",mode:"mode",mute:"hide",order:"order",search:"search",shape:"shape",size:"size",solo:"isolate",style:"style",temp:"temporary segments",text:"text",time:"time",timeline:"timeline",total:"total segments",type:"type",width:"width",x:"x axis",y:"y axis",zoom:"zoom"},time:["date","day","month","time","year"],timeFormat:{FullYear:"%Y",Month:"%B",MonthSmall:"%b",Date:"%A %-d",DateSmall:"%-d",Hours:"%I %p",Minutes:"%I:%M",Seconds:"%Ss",Milliseconds:"%Lms","FullYear-Month":"%b %Y","FullYear-Date":"%-m/%-d/%Y","Month-Date":"%b %-d","Hours-Minutes":"%I:%M %p","Hours-Seconds":"%I:%M:%S %p","Hours-Milliseconds":"%H:%M:%S.%L","Minutes-Seconds":"%I:%M:%S %p","Minutes-Milliseconds":"%H:%M:%S.%L","Seconds-Milliseconds":"%H:%M:%S.%L"},ui:{and:"and",back:"back",collapse:"click to collapse",error:"error",expand:"click to expand",including:"including",iqr:"interquartile range for {0}",loading:"loading...",max:"maximum",median:"median",min:"minimum",more:"{0} more",moreInfo:"click for more info",or:"or",noResults:"no results matching {0}.",percentile:"{0} percentile",primary:"primary connections",quartile_first:"first quartile",quartile_third:"third quartile",share:"share",total:"total",tukey_bottom:"bottom tukey",tukey_top:"top tukey",values:"values"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"],visualization:{bar:"Bar Chart",box:"Box Plot",bubbles:"Bubbles",chart:"Chart",geo_map:"Geo Map",line:"Line Plot",network:"Network",paths:"Paths",pie:"Pie Chart",rings:"Rings",scatter:"Scatter Plot",stacked:"Stacked Area",table:"Table",tree_map:"Tree Map"}}},{}],71:[function(e,t,r){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," €"],dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],shortDays:["dom","lun","mar","mié","jue","vie","sáb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},dev:{accepted:"{0} no es un valor aceptado para {1}, por favor utilice uno de los siguientes: {2}.",deprecated:"el método {0} ha sido eliminado, por favor, actualiza tu código para utilizar {1}.",noChange:"{0} no se actualiza porque no cambió.",noContainer:"no se puede encontrar un contenedor en la página correspondiente a {0}.",of:"de",oldStyle:"propiedades de estilo para {0} ahora se han incorporado directamente en. {1} ().",sameEdge:"los vínculos no se pueden enlazar con si mismos. eliminando automáticamente el vínculo {0} que se autorreferencia.",set:"{0} se ha establecido.",setLong:"{0} ha sido establecido a {1}.",setContainer:"defina un div contenedor utilizando .container ()"},error:{accepted:"{0} no es un {1} aceptado para visualizaciones de {2}, por favor utilice uno de los siguientes: {3}.",connections:"no hay conexiones disponibles para {0}.",data:"No hay datos disponibles",dataYear:"no hay datos disponibles para {0}.",lib:"{0} visualizaciones requieren cargar las siguientes librerías: {1}.",libs:"{0} visualizaciones requieren cargar las siguientes librerías: {1}.",method:"{0} visualizaciones requieren establecer el ​​método {1}.",methods:"{0} visualizaciones requieren establecer los siguientes métodos: {1}."},lowercase:["una","y","en","pero","en","de","o","el","la","los","las","para","a","con"],method:{active:"segmentos activos",color:"color",depth:"profundidad",dev:"detallado",focus:"foco",icon:"ícono",id:"id",height:"alto",labels:"rótulo",legend:"leyenda",margin:"margen",messages:"mensajes de estado",order:"orden",search:"búsqueda",shape:"forma",size:"tamaño",style:"estilo",temp:"segmentos temporales",text:"texto",time:"tiempo",timeline:"línea de tiempo",total:"segmentos totales",type:"tipo",width:"anchura",x:"eje x",y:"eje Y",zoom:"zoom",mode:"modo",mute:"ocultar",solo:"aislar"},time:["fecha","día","mes","hora","año"],visualization:{bubbles:"Burbujas",chart:"Gráfico",geo_map:"Mapa",line:"Gráfico de linea",network:"Red",rings:"Anillos",scatter:"Gráfico De Dispersión",stacked:"Área Apilada",tree_map:"Tree Map",bar:"Gráfico De Barras",box:"Diagrama de Cajas",paths:"Caminos",pie:"Gráfico de Pastel",table:"Tabla"},ui:{and:"y",back:"atrás",collapse:"click para cerrar",error:"error",expand:"haga clic para ampliar",loading:"Cargando ...",more:"{0} más",moreInfo:"clic para más información",noResults:"no se encontraron resultados para {0}.",primary:"relaciones principales",share:"porcentaje",total:"total",values:"valores",including:"Incluyendo",or:"o",iqr:"rango intercuartil para {0}",max:"máximo",min:"mínimo",percentile:"{0} percentil",tukey_bottom:"Tukey inferior",tukey_top:"la parte superior de Tukey",quartile_first:"primer cuartil",quartile_third:"tercer cuartil",median:"mediana"},message:{data:"analizando los datos",draw:"visualizando",initializing:"inicializando {0}",loading:"cargando datos",tooltipReset:"restableciendo las descripciones emergentes",ui:"actualizando la interfaz de usuario"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","UI"]}},{}],72:[function(e,t,r){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," €"],dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortMonths:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."]},dev:{accepted:"{0} n'est pas une option valide pour {1}, les valeurs possibles sont: {2}.",deprecated:"{0} a été éliminé de la version courante, mettez à jour votre code source avec {1}.",noChange:"{0} n'a pas été mis à jour car inchangé.",noContainer:"impossible de trouver un contenant correspondant à {0}.",of:"de",oldStyle:"les propriétés de {0} ont été imbriquées dans .{1}().",sameEdge:"un arc ne peut pas boucler sur lui même. L'auto-référence est automatiquement éliminée {0}.",set:"{0} a été mis à jour.",setLong:"{0} a été mis à jour à {1}.",setContainer:"merci de choisir un div qui utilise .container()"},error:{accepted:"{0} n'est pas correct {1} pour {2} visualisations, merci d'utilisez une des options suivantes: {3}.",connections:"Pas de connections disponibles pour {0}.",data:"Pas de données disponibles",dataYear:"Pas de données disponibles pour {0}.",lib:"La visualisation de {0} nécessite le chargement de la librairie {1}.",libs:"La visualisation de {0} nécessite le chargement des librairies {1}.",method:"La visualisation du {0} exige la définition de {1}.",methods:"La visualisation du {0} exige les définitions de {1}."},lowercase:["un","une","de","des","et","mais","les","ou","pour","avec","comme","par","vers","si","dans","près","ni","dessus","que","le","la","via","sinon","alors"],method:{active:"segments actifs",color:"couleur",depth:"profondeur",dev:"verbeux",focus:"focus",icon:"ícone",id:"id",height:"hauteur",labels:"labels",legend:"légende",margin:"marge",messages:"messages",order:"ordre",search:"recherche",shape:"format",size:"taille",style:"style",temp:"segments temporaires",text:"texte",time:"temps",timeline:"ligne temporelle",total:"segments totaux",type:"type",width:"largeur",x:"axe x",y:"axe y",zoom:"zoom",mode:"mode",mute:"cacher",solo:"isoler"},time:["année","date","jour","heure","mois"],visualization:{bubbles:"Bulles",chart:"Graphique",geo_map:"Carte",line:"Courbes",network:"Réseau",rings:"Anneaux",scatter:"Nuage de points",stacked:"Aires empilées",tree_map:"Arbre",bar:"Diagramme en barres",box:"Boîtes à Moustaches",paths:"Chemins",pie:"Camembert",table:"Table"},ui:{and:"et",back:"retour",collapse:"clic pour réduire",error:"erreur",expand:"clic pour agrandir",loading:"chargement ...",more:"plus {0}",moreInfo:"clic pour plus d'information",noResults:"pas de résultat correspondant à {0}.",primary:"connections primaires",share:"part",total:"total",values:"valeurs",including:"incluant",or:"ou",iqr:"gamme interquartile pour {0}",max:"maximum",min:"le minimum",percentile:"{0} percentile",tukey_bottom:"tukey bas",tukey_top:"top tukey",quartile_first:"premier quartile",quartile_third:"le troisième quartile",median:"médian"},message:{data:"analyse des données",draw:"tracé en cours",initializing:"Initialisation {0}",loading:"chargement",tooltipReset:"réinitialisation des bulles",ui:"rafraichissement de l'interface"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","IT","TV","UI"]}},{}],73:[function(e,t,r){t.exports={format:{decimal:".",thousands:",",grouping:[3],currency:["₩",""],dateTime:"%Y/%m/%d %a %X",date:"%Y/%m/%d",time:"%H:%M:%S",periods:["오전","오후"],days:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],shortDays:["일","월","화","수","목","금","토"],months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],shortMonths:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},error:{accepted:"{0}하지 허용 {1} {2} 시각화는 다음 중 하나를 사용하십시오에 대해 : {3}.",connections:"{0}에 대한 연결이 없음.",data:"자료 없음",dataYear:"{0}에 대한 자료가 없음.",lib:"{0} 시각화는 {1} 라이브러리를로드 할 필요합니다.",libs:"{0} 시각화는 다음과 같은 라이브러리를로드 할 필요 : {1}.",method:"{0} 시각화를 위해 {1} 메서드를 설정해야 한다.",methods:"{0} 시각화를 위해 다음과 같은 메서드를 설정해야한다: {1}."},lowercase:[""],method:{active:"활성 세그먼트",color:"색",depth:"깊이",dev:"풀어서",focus:"집중하다",icon:"상",id:"신분증",height:"높이",labels:"라벨",legend:"범례",margin:"여유",messages:"상태 메시지",order:"주문",search:"수색",shape:"모양",size:"크기",style:"스타일",temp:"임시 세그먼트",text:"본문",time:"시각",timeline:"타임 라인",total:"총 세그먼트",type:"유형",width:"폭",x:"X 축",y:"Y 축",zoom:"줌",mode:"모드",mute:"숨김",solo:"독주"},time:["날짜","요일","월","시간","년"],visualization:{bubbles:"버블 차트",chart:"차트",geo_map:"지도형",line:"선형 그래프",network:"네트워크 그래프",rings:"반지",scatter:"산포도",stacked:"누적 된 지역",tree_map:"트리 맵",bar:"막대 차트",box:"박스 플롯",paths:"경로",pie:"파이 차트",table:"탁자"},ui:{and:"과",back:"뒤로",collapse:"축소하려면 클릭",error:"오류",expand:"확장하려면 클릭",loading:"로드 중 ...",more:"{0} 이상",moreInfo:"추가 정보를 위해 클릭하십시오",noResults:"일치하는 결과값이 없음 {0}.",primary:"기본 연결",share:"비중",total:"합계",values:"값",including:"...을 포함하여",or:"또는",iqr:"대한 사 분위 범위 {0}",max:"최고",min:"최저한의",percentile:"{0} 백분위 수",tukey_bottom:"바닥 Tukey에",tukey_top:"상단 Tukey에",quartile_first:"1 분위",quartile_third:"3 분위",median:"중앙값"},message:{data:"데이터 분석 중",draw:"데이터 시각화 중",initializing:"초기화 {0}",loading:"데이터 로딩 중",tooltipReset:"툴팁을 재설정",ui:"UI 업데이트 중"},uppercase:["CEO","최고 경영자","최고 재무 책임자 (CFO)","CFO는","CNC","COO","구구","CPU","CPU에","GDP","HVAC","ID","IT","R & D","TV","UI"]}},{}],74:[function(e,t,r){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:[""," ден."],dateTime:"%A, %e %B %Y г. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["недела","понеделник","вторник","среда","четврток","петок","сабота"],shortDays:["нед","пон","вто","сре","чет","пет","саб"],months:["јануари","февруари","март","април","мај","јуни","јули","август","септември","октомври","ноември","декември"],shortMonths:["јан","фев","мар","апр","мај","јун","јул","авг","сеп","окт","ное","дек"]},error:{accepted:"{0} не е прифатлива за {1} {2} визуелизација, ве молиме користете една од следниве: {3}.",connections:"не е достапна за врски {0}.",data:"нема податоци",dataYear:"Не е достапен за податоци {0}.",lib:"{0} визуализации бараат вчитување на библиотеката {1} .",libs:"{0} визуализации бараат вчитување на следниве библиотеки: {1}.",method:"{0} визуализации бара поставување на {1} методот.",methods:"{0} визуализации бараат поставување на следниве методи: {1}."},lowercase:["a","и","во","но","на","или","да","се","со"],method:{active:"активни сегменти",color:"боја",depth:"длабочина",dev:"опширно",focus:"фокус",icon:"икона",id:"проект",height:"височина",labels:"етикети",legend:"легенда",margin:"маргина",messages:"пораки за статусот",order:"со цел",search:"барај",shape:"форма",size:"големина",style:"стил",temp:"привремени сегменти",text:"текст",time:"време",timeline:"времеплов",total:"Вкупно сегменти",type:"тип",width:"ширина",x:"x оската",y:"Y оската",zoom:"зум",mode:"режим",mute:"се скрие",solo:"изолирање"},time:["датум","ден","месец","време","година"],visualization:{bubbles:"меурчиња",chart:"Графикон",geo_map:"Гео мапа",line:"Линиски график",network:"мрежа",rings:"прстени",scatter:"Распрскан график",stacked:"Наредена површина",tree_map:"Мапа во вид на дрво",bar:"бар шема",box:"правоаголен дијаграм",paths:"патеки",pie:"пита графикон",table:"Табела"},ui:{and:"и",back:"назад",collapse:"кликни за да се собере",error:"грешка",expand:"Кликни за проширување",loading:"Се вчитува ...",more:"{0} повеќе",moreInfo:"кликнете за повеќе информации",noResults:"Не се пронајдени резултати за појавување на {0}.",primary:"основните врски",share:"удел",total:"Вкупниот",values:"вредности",including:"Вклучувајќи",or:"или",iqr:"interquartile опсег за {0}",max:"максималната",min:"минимум",percentile:"{0} перцентил",tukey_bottom:"дното Tukey",tukey_top:"Топ Tukey",quartile_first:"првиот квартал",quartile_third:"третиот квартал",median:"средната"},message:{data:"анализа на податоци",draw:"цртање на визуелизација",initializing:"иницијализација {0}",loading:"податоци за товарење",tooltipReset:"ресетирање на објаснувањата",ui:"ажурирање на кориничкиот интерфејс"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"]}},{}],75:[function(e,t,r){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:["R$",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},dev:{accepted:"{0} não é um valor válido para {1}, por favor use um dos seguintes procedimentos: {2}.",deprecated:"{0} método foi removido, por favor atualize seu código para utilizar {1}.",noChange:"{0} não foi atualizado porque ele não mudou.",noContainer:"Não foi possível encontrar um local na página correspondente a {0}.",of:"do",oldStyle:"propriedades de estilo para {0} já foram incorporados diretamente no. {1} ().",sameEdge:"bordas não podem vincular a si mesmos. removendo automaticamente borda de auto-referência {0}.",set:"{0} foi definido.",setLong:"{0} foi definido para {1}.",setContainer:"por favor, defina um div utilizando .container()"},error:{accepted:"{0} não é um {1} reconhecido para visualizações {2}, favor usar um dos seguintes procedimentos: {3}.",connections:"Não há conexões disponíveis para {0}.",data:"Não há dados disponíveis",dataYear:"Não há dados disponíveis para {0}.",lib:"A visualização {0} necessita que seja carregado a biblioteca {1}.",libs:"A visualização {0} necessita que seja carregado as bibliotecas {1}.",method:"A visualização {0} exige a definição do método {1}.",methods:"A visualização {0} exige a definição dos métodos {1}."},lowercase:["um","uma","e","como","em","no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],method:{active:"segmentos activos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"ícone",id:"identificador",height:"altura",labels:"etiquetas",legend:"legenda",margin:"margem",messages:"mensagens de status",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",style:"estilo",temp:"segmentos temporários",text:"texto",time:"Tempo",timeline:"cronograma",total:"segmentos totais",type:"digitar",width:"largura",x:"eixo x",y:"eixo y",zoom:"zoom",mode:"modo",mute:"ocultar",solo:"isolar"},time:["data","dia","mês","hora","ano"],visualization:{bubbles:"Bolhas",chart:"Gráfico",geo_map:"Mapa",line:"Gráfico de Linha",network:"Rede",rings:"Anéis",scatter:"dispersão",stacked:"Evolução",tree_map:"Tree Map",bar:"Gráfico de Barras",box:"box Plot",paths:"caminhos",pie:"Carta de torta",table:"Mesa"},ui:{and:"e",back:"voltar",collapse:"clique para entrar em colapso",error:"erro",expand:"clique para expandir",loading:"carregando ...",more:"mais {0}",moreInfo:"Clique para mais informações",noResults:"nenhum resultado para {0}.",primary:"conexões primárias",share:"participação",total:"total",values:"valores",including:"Incluindo",or:"ou",iqr:"intervalo interquartil para {0}",max:"máximo",min:"mínimo",percentile:"{0} percentil",tukey_bottom:"tukey bottom",tukey_top:"tukey topo",quartile_first:"primeiro quartil",quartile_third:"terceiro quartil",median:"mediana"},message:{data:"analisando dados",draw:"desenhando visualização",initializing:"inicializando {0}",loading:"carregando dados",tooltipReset:"redefinindo as dicas",ui:"atualizando interface"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","P&D","TV","IU"]}},{}],76:[function(e,t,r){t.exports={format:{decimal:",",thousands:".",grouping:[3],currency:["€",""],dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},error:{accepted:"{0} não é uma {1} válida para a visualização {2}, por favor escolha uma das seguintes: {3}.",connections:"não existem ligações disponíveis para {0}.",data:"não existem dados disponíveis",dataYear:"não existem dados disponíveis para {0}.",lib:"a visualização {0} necessita que a biblioteca {1} seja carregada.",libs:"a visualização {0} necessita que as seguintes bibliotecas sejam carregadas: {1}.",method:"A visualização {0} exige a definição do método {1}.",methods:"A visualização {0} exige a definição dos seguintes métodos {1}."},lowercase:["um","uma","e","como","em","no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],method:{active:"segmentos activos",color:"cor",depth:"profundidade",dev:"verboso",focus:"foco",icon:"ícone",id:"identificador",height:"altura",labels:"etiquetas",legend:"legenda",margin:"margem",messages:"estado",order:"ordenar",search:"pesquisar",shape:"forma",size:"tamanho",style:"estilo",temp:"segmentos temporários",text:"texto",time:"tempo",timeline:"linha temporal",total:"segmentos totais",type:"digitar",width:"largura",x:"eixo dos xx",y:"eixo dos yy",zoom:"zoom",mode:"modo",mute:"ocultar",solo:"isolar"},time:["data","dia","mês","hora","ano"],visualization:{bubbles:"Bolhas",chart:"Diagrama",geo_map:"Mapa",line:"Gráfico de Linha",network:"Grafo",rings:"Anéis",scatter:"Gráfico de Dispersão",stacked:"Gráfico de Área",tree_map:"Tree Map",bar:"Gráfico de Barras",box:"Diagrama de Caixa e Bigodes",paths:"caminhos",pie:"Gráfico de Setores",table:"Mesa"},ui:{and:"e",back:"voltar",collapse:"Clique para colapsar",error:"erro",expand:"clique para expandir",loading:"a carregar ...",more:"mais {0}",moreInfo:"Clique para mais informações",noResults:"nenhum resultado para {0}.",primary:"ligações principais",share:"proporção",total:"total",values:"valores",including:"Incluindo",or:"ou",iqr:"intervalo interquartil para {0}",max:"máximo",min:"mínimo",percentile:"{0} percentil",tukey_bottom:"tukey bottom",tukey_top:"tukey topo",quartile_first:"primeiro quartil",quartile_third:"terceiro quartil",median:"mediana"},message:{data:"a analisar os dados",draw:"a desenhar a visualização",initializing:"a inicializar {0}",loading:"a carregar os dados",tooltipReset:"a actualizar as caixas de informação",ui:"a actualizar o interface"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","IU"]}},{}],77:[function(e,t,r){t.exports={format:{decimal:",",thousands:" ",grouping:[3],currency:[""," руб."],dateTime:"%A, %e %B %Y г. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],shortDays:["вс","пн","вт","ср","чт","пт","сб"],months:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortMonths:["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"]},error:{accepted:"{0} не является обслуживаемым {1} для {2} визуализаций, пожалуйста, используйте одно из следующих действий: {3}.",connections:"нет соединений, доступных для {0}.",data:"данные недоступны",dataYear:"нет данных для {0}.",lib:"{0} визуализаций требуют загрузки {1} библиотеки.",libs:"{0} визуализаций требует загрузки следующие библиотеки: {1}.",method:"{0} визуализаций требуют установки {1} метод.",methods:"{0} визуализаций требуют установки следующих методов: {1}."},lowercase:["и","как","в","но","для","из","если в","в","недалеко","ни","на","на","или","в","что","к","с","с помощью","против","против"],method:{active:"активные сегменты",color:"цвет",depth:"глубина",dev:"подробный",focus:"фокус",icon:"значок",id:"Я бы",height:"высота",labels:"надписи",legend:"легенда",margin:"поле",messages:"сообщения о состоянии",order:"заказ",search:"поиск",shape:"форма",size:"размер",style:"стиль",temp:"временные сегменты",text:"текст",time:"время",timeline:"график",total:"всего сегментов",type:"тип",width:"ширина",x:"ось х",y:"ось Y",zoom:"масштаб",mode:"Режим",mute:"скрывать",solo:"изолировать"},time:["дата","день недели","месяц","время","год"],visualization:{bubbles:"Пузыри",chart:"Диаграмма",geo_map:"Карта Geo",line:"линия Участок",network:"сеть",rings:"Кольца",scatter:"Scatter Plot",stacked:"Stacked Площадь",tree_map:"Дерево Карта",bar:"гистограмма",box:"Box Участок",paths:"пути",pie:"Круговая диаграмма",table:"Таблица"},ui:{and:"а также",back:"назад",collapse:"нажмите, чтобы свернуть",error:"ошибка",expand:"нажмите, чтобы развернуть",loading:"загрузка ...",more:"{0} более",moreInfo:"нажмите для получения дополнительной информации",noResults:"нет результатов, соответствующих {0}.",primary:"первичные соединения",share:"доля",total:"Всего",values:"значения",including:"в том числе",or:"или",iqr:"межквартильный диапазон для {0}",max:"максимальная",min:"минимальный",percentile:"{0} процентиль",tukey_bottom:"нижний Тьюки",tukey_top:"сверху Тьюки",quartile_first:"первый квартиль",quartile_third:"третий квартиль",median:"медиана"},message:{data:"данные анализа",draw:"рисование визуализация",initializing:"инициализацией {0}",loading:"Загрузка данных",tooltipReset:"сброс всплывающих подсказок",ui:"обновление пользовательского интерфейса"},uppercase:["ID"]}},{}],78:[function(e,t,r){t.exports={format:{decimal:".",thousands:",",grouping:[3],currency:["¥",""],dateTime:"%A %B %e %Y %X",date:"%Y/%-m/%-d",time:"%H:%M:%S",periods:["上午","下午"],days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],shortDays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],shortMonths:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},error:{accepted:"{0}对于{2}的可视化效果并不是一个可接受的{1}, 请使用如下的一个：{3}.",connections:"没有对{0}可用的连接。",data:"无可用数据",dataYear:"没有数据对{0}可用。",lib:"{0}的可视化要求装载{1}库。",libs:"{0}的可视化需要加载以下库：{1}。",method:"{0}的可视化要求设置{1}方法。",methods:"{0}的可视化要求设置以下方法：{1}。"},lowercase:["一个","和","在","但是","在...里","的","或者","这","向","与...一起"],method:{active:"活跃段",color:"颜色",depth:"深度",dev:"详细",focus:"焦点",icon:"图标",id:"身份认证",height:"高度",labels:"标签",legend:"图例注释",margin:"外边距",messages:"状态消息",order:"规则",search:"搜索",shape:"形状",size:"大小",style:"样式",temp:"暂时性区段",text:"文本",time:"时间",timeline:"时间轴",total:"总段",type:"类型",width:"宽度",x:"X轴",y:"Y轴",zoom:"缩放",mode:"模式",mute:"隐藏",solo:"隔离"},time:["日","星期","月","时间","年"],visualization:{bubbles:"气泡",chart:"图表",geo_map:"地理地图",line:"线图",network:"网络",rings:"特性",scatter:"散点图",stacked:"堆积面积图",tree_map:"树图",bar:"条图",box:"箱形图",paths:"路径",pie:"饼形图",table:"表"},ui:{and:"和",back:"后面",collapse:"点击合并",error:"错误",expand:"单击以展开",loading:"载入中...",more:"{0}更多",moreInfo:"点击了解更多信息",noResults:"没有结果匹配{0}。",primary:"主要连接",share:"共享",total:"总",values:"值",including:"包括",or:"要么",iqr:"间距范围为{0}",max:"最大值",min:"最低限度",percentile:"{0}百分",tukey_bottom:"底部杜克",tukey_top:"顶部杜克",quartile_first:"第一个四分位数",quartile_third:"第三个四分位数",median:"中位数"},message:{data:"分析数据",draw:"绘制可视化",initializing:"初始化{0}",loading:"加载数据",tooltipReset:"重置工具提示",ui:"更新UI"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","电视","用户界面","研发"]}},{}],79:[function(e,t,r){t.exports={de_DE:e("./languages/de_DE.js"),en_US:e("./languages/en_US.coffee"),es_ES:e("./languages/es_ES.js"),fr_FR:e("./languages/fr_FR.js"),ko_KR:e("./languages/ko_KR.js"),mk_MK:e("./languages/mk_MK.js"),pt_BR:e("./languages/pt_BR.js"),pt_PT:e("./languages/pt_PT.js"),ru_RU:e("./languages/ru_RU.js"),zh_CN:e("./languages/zh_CN.js")}},{"./languages/de_DE.js":69,"./languages/en_US.coffee":70,"./languages/es_ES.js":71,"./languages/fr_FR.js":72,"./languages/ko_KR.js":73,"./languages/mk_MK.js":74,"./languages/pt_BR.js":75,"./languages/pt_PT.js":76,"./languages/ru_RU.js":77,"./languages/zh_CN.js":78}],80:[function(e,t,r){var f,o,i,u,p,c,d,h,v;o=e("../../util/copy.coffee"),p=e("../console/print.coffee"),c=e("./process/detect.coffee"),d=e("./set.coffee"),h=e("../../string/format.js"),v=e("../../object/validate.coffee"),t.exports=function(e,t){var r,n,a;for(r in a=[],t)n=t[r],e[r]=o(n),e[r].initialized=u(e,e[r],r),a.push(e.self[r]=i(e,r));return a},u=function(i,e,t,s){var r,n,a,o,l;for(l in e.previous=!1,e.changed=!1,e.initialized=!1,e.callback=!1,"init"in e&&!("value"in e)&&(e.value=e.init(i),delete e.init),"process"in e&&(e.value=c(i,e,e.value)),e)if("deprecates"===l)for(a=0,o=(n=e[l]instanceof Array?e[l]:[e[l]]).length;a<o;a++)r=n[a],i.self[r]=function(a,o){return function(e){var t,r,n;return n=i.format.locale.value.dev.deprecated,a="."+a+"()",r=s?'"'+o+'" in .'+s+"()":"."+o+"()",t=s||o,p.error(h(n,a,r),t),i.self}}(r,t);else"global"===l?t in i||(i[t]=[]):"value"!==l&&v(e[l])&&u(i,e[l],l,t);return!0},i=function(c,d){return function(e,t){var r,a,o,n,i,s,l,u;if("function"==typeof(r="accepted"in c[d]?c[d].accepted:null)&&(r=r(c)),r instanceof Array||(r=[r]),e===Object)return c[d];if(!arguments.length&&r.indexOf(void 0)<0)return"value"in c[d]?c[d].value:c[d];if("style"===d&&"object"==typeof e)for(s in u=c.format.locale.value.dev.oldStyle,e)p.warning(h(u,'"'+s+'"',s),s),c.self[s](e[s]);if("font"===d)for(n in"string"==typeof e&&(e={family:e}),l=!0,o=function(e,t,r,n){v(e[r])&&t in e[r]&&(v(e[r][t])?e[r][t].process?e[r][t].value=e[r][t].process(n):e[r][t].value=n:e[r][t]=n)},a=function(e,t,r){var n;if(v(e)){if(l)for(n in e)o(e,t,n,r);else"font"in e&&o(e,t,"font",r);for(n in l=!1,e)a(e[n],t,r)}},e)i=e[n],"secondary"!==n&&(v(i)&&(i=i.value),i&&a(c,n,i));return f(c,d,c,d,e),"function"==typeof t&&(c[d].callback=t),!1===c[d].chainable?c[d].value:c.self}},f=function(e,t,r,n,a){var o,i,s,l;if(["accepted","changed","initialized","previous","process"].indexOf(n)<0)if(l=v(a),s=v(r[n])&&"objectAccess"in r[n]&&!1===r[n].objectAccess,o=l&&(s||!("value"in a)&&(!v(r[n])||!(d3.keys(a)[0]in r[n]))),null===a||!l||o)d(e,t,r,n,a);else if(l)for(i in a)f(e,t,r[n],i,a[i])}},{"../../object/validate.coffee":172,"../../string/format.js":173,"../../util/copy.coffee":207,"../console/print.coffee":52,"./process/detect.coffee":88,"./set.coffee":94}],81:[function(e,t,r){t.exports=function(e){return e||(e=!1),{accepted:[!1,Array,Function,Number,Object,String],callback:{accepted:[!1,Function],value:!1},global:e,process:Array,value:[]}}},{}],82:[function(e,t,r){var n;n=e("../../../client/rtl.coffee"),t.exports=function(e){var t;return!(t=["left","center","right"])===e&&t.unshift(!1),t.indexOf(e)<0&&(e="left"),{accepted:t,process:function(e){return n?"left"===e?"right":"right"===e?"left":e:e},value:e}}},{"../../../client/rtl.coffee":40}],83:[function(e,t,r){t.exports=function(e){var t;return!(t=["line-through","none","overline","underline"])===e&&t.unshift(!1),t.indexOf(e)<0&&(e="none"),{accepted:t,value:e}}},{}],84:[function(e,t,r){var n,a;a=e("../../../font/validate.coffee"),n=["Helvetica Neue","HelveticaNeue","Helvetica","Arial","sans-serif"],t.exports=function(e){return void 0===e&&(e=n),{process:a,value:e}}},{"../../../font/validate.coffee":103}],85:[function(e,t,r){t.exports=function(e){var t;return!(t=["top","middle","bottom"])===e&&t.unshift(!1),t.indexOf(e)<0&&(e="bottom"),{accepted:t,mapping:{top:"0ex",middle:"0.5ex",bottom:"1ex"},process:function(e){return this.text=e,this.mapping[e]},value:e}}},{}],86:[function(e,t,r){t.exports=function(e){var t;return!(t=["capitalize","lowercase","none","uppercase"])===e&&t.unshift(!1),t.indexOf(e)<0&&(e="none"),{accepted:t,value:e}}},{}],87:[function(e,t,r){t.exports=function(e,t,r){var n;return t.history&&t.history.reset(),e.constructor===String?0<=e.indexOf("/")?(r.url=e,[]):(n=d3.selectAll(e)).size()?n:(0<=e.indexOf(".")&&(r.url=e),[]):e}},{}],88:[function(e,t,r){var n,a;n=e("../../../util/copy.coffee"),a=e("../../../array/update.coffee"),t.exports=function(e,t,r){return t.process===Array?a(n(t.value),r):"object"==typeof t.process&&"string"==typeof r?t.process[r]:"function"==typeof t.process?t.process(r,e,t):r}},{"../../../array/update.coffee":35,"../../../util/copy.coffee":207}],89:[function(e,t,r){var n;n=e("../../../client/css.coffee"),t.exports=function(e,t,r){return!1===e||e.indexOf("fa-")<0||0===e.indexOf("fa-")&&n("font-awesome")?e:r.fallback}},{"../../../client/css.coffee":36}],90:[function(e,t,r){t.exports=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p,h;if("string"==typeof e){for(r=n=0,i=(e=e.split(" ")).length;n<i;r=++n)h=e[r],e[r]=parseFloat(h,10);e=1===e.length?e[0]:2===e.length?{top:e[0],right:e[1],bottom:e[0],left:e[1]}:3===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[1]}:4===e.length?{top:e[0],right:e[1],bottom:e[2],left:e[3]}:0}if(p=["top","right","bottom","left"],"number"==typeof e)for(a=0,s=p.length;a<s;a++)t[f=p[a]]=e;else for(o=0,l=p.length;o<l;o++)t[f=p[o]]=e[f];for(t.css="",d=[],r=c=0,u=p.length;c<u;r=++c)f=p[r],r&&(t.css+=" "),d.push(t.css+=t[f]+"px");return d}},{}],91:[function(e,t,r){var p,h,v,g;p=e("../../array/contains.coffee"),h=e("../../string/format.js"),v=e("../../string/list.coffee"),g=e("../console/print.coffee"),t.exports=function(e,t,r,n,a){var o,i,s,l,u,c,d,f;if("function"==typeof t&&(t=t(e)),t instanceof Array||(t=[t]),!1===(i=p(t,r))&&void 0!==r){for(c=[],f=JSON.stringify(r),"string"!=typeof r&&(f='"'+f+'"'),l=0,u=t.length;l<u;l++)"string"==typeof(o=t[l])?c.push('"'+o+'"'):"function"==typeof o?c.push(o.toString().split("()")[0].substring(9)):void 0===o?c.push("undefined"):c.push(JSON.stringify(o));c=v(c,e.format.locale.value.ui.or),e.type&&0<=["mode","shape"].indexOf(n)?(d=e.format.locale.value.error.accepted,s=e.format.locale.value.visualization[e.type.value]||e.type.value,g.warning(h(d,f,n,s,c),n)):(d=e.format.locale.value.dev.accepted,g.warning(h(d,f,a,c),n))}return!i}},{"../../array/contains.coffee":33,"../../string/format.js":173,"../../string/list.coffee":174,"../console/print.coffee":52}],92:[function(e,t,r){t.exports=function(e){var t;return 0<=(t=["auto","optimizeSpeed","crispEdges","geometricPrecision"]).indexOf(e)||(e="crispEdges"),{accepted:t,value:e}}},{}],93:[function(e,t,r){var n,a;a=e("../../object/validate.coffee"),n=function(e,t){var r;for(r in e.changed&&(e.changed=!1),"draw"===t&&(e.frozen=!1,e.update=!0,e.first=!1),e)r.indexOf("d3plus")<0&&a(e[r])&&n(e[r],r)},t.exports=n},{"../../object/validate.coffee":172}],94:[function(e,t,r){var x,b,w,_,k,z,A,j,M;x=e("../../util/copy.coffee"),b=e("../../util/d3selection.coffee"),M=e("../../object/validate.coffee"),w=e("../../object/merge.coffee"),_=e("../console/print.coffee"),k=e("./process/detect.coffee"),z=e("./rejected.coffee"),A=e("../../string/format.js"),j=e("../../array/update.coffee"),t.exports=function(e,t,r,n,a){var o,i,s,l,u,c,d,f,p,h,v,g,m,y;if(g="value"!==n&&n&&n!==t?'"'+n+'" '+e.format.locale.value.dev.of+" ."+t+"()":"."+t+"()",o="value"===n&&"accepted"in r?r.accepted:M(r[n])&&"accepted"in r[n]?r[n].accepted:[a],!z(e,o,a,t,g)){if(M(r[n])&&"value"in r[n]&&(r=r[h=n],n="value"),"value"===n&&"process"in r&&(a=k(e,r,a)),r[n]instanceof Array||r[n]!==a||void 0===a){if(r.changed=!0,r.loaded&&(r.loaded=!1),"history"in e&&"draw"!==t&&((i=x(r)).method=t,e.history.chain.push(i)),r.previous=r[n],"id"in e&&"value"===n&&"nesting"in r)if("id"!==t){if("object"!=typeof r.nesting&&(r.nesting={}),M(a)){for(c in a)"string"==typeof a[c]&&(a[c]=[a[c]]);r.nesting=w(r.nesting,a),e.id.value in r.nesting||(r.nesting[e.id.value]=a[d3.keys(a)[0]])}else a instanceof Array?r.nesting[e.id.value]=a:r.nesting[e.id.value]=[a];r[n]=r.nesting[e.id.value][0]}else a instanceof Array?(r.nesting=a,"depth"in e&&e.depth.value<a.length?r[n]=a[e.depth.value]:(r[n]=a[0],"depth"in e&&(e.depth.value=0))):(r[n]=a,r.nesting=[a],"depth"in e&&(e.depth.value=0));else"depth"===t?(a>=e.id.nesting.length?e.depth.value=e.id.nesting.length-1:e.depth.value=a<0?0:a,e.id.value=e.id.nesting[e.depth.value],"object"==typeof e.text.nesting&&(p=e.text.nesting[e.id.value])&&(e.text.nesting[e.id.value]="string"==typeof p?[p]:p,e.text.value=p instanceof Array?p[0]:p)):M(r[n])&&M(a)?r[n]=w(r[n],a):r[n]=a;"value"===n&&r.global&&(u=0<r[n].length,(d=h||n)in e&&(u&&e.data[d].indexOf(t)<0||!u&&0<=e.data[d].indexOf(t))&&(e.data[d]=j(e.data[d],t))),"value"===n&&r.dataFilter&&e.data&&e.data.filters.indexOf(t)<0&&e.data.filters.push(t),e.dev.value&&r.changed&&void 0!==r[n]&&(f=r[n]instanceof Array&&10<r[n].length,l=b(r[n]),m="function"==typeof r[n],null!==(y=f||l||m?null:"string"==typeof r[n]?r[n]:JSON.stringify(r[n]))&&y.length<260?(v=e.format.locale.value.dev.setLong,_.log(A(v,g,'"'+y+'"'))):(v=e.format.locale.value.dev.set,_.log(A(v,g))))}else v=e.format.locale.value.dev.noChange,e.dev.value&&_.comment(A(v,g));"value"===n&&r.callback&&!r.url&&(s="function"==typeof r.callback?r.callback:r.callback.value)&&s(a,e.self)}}},{"../../array/update.coffee":35,"../../object/merge.coffee":171,"../../object/validate.coffee":172,"../../string/format.js":173,"../../util/copy.coffee":207,"../../util/d3selection.coffee":208,"../console/print.coffee":52,"./process/detect.coffee":88,"./rejected.coffee":91}],95:[function(e,t,r){var n=e("../console/print.coffee"),a=e("../../string/format.js");t.exports=function(o){if(o.dev.value){var e="analyzing edges list";n.time(e)}var t=o.types[o.type.value].requirements;t instanceof Array||(t=[t]);var i=0<=t.indexOf("nodes")&&!o.nodes.value;if(i){o.nodes.value=[];var s=[];o.nodes.changed=!0}o.edges.value.forEach(function(a){["source","target"].forEach(function(t){var e=typeof a[o.edges[t]];if("object"!==e)if("number"!==e||i||"number"===o.data.keys[o.id.value])if(i&&0<=s.indexOf(a[o.edges[t]]))a[o.edges[t]]=o.nodes.value.filter(function(e){return e[o.id.value]===a[o.edges[t]]})[0];else{var r={};r[o.id.value]=a[o.edges[t]],a[o.edges[t]]=r}else a[o.edges[t]]=o.nodes.value[a[o.edges[t]]];var n=a[o.edges[t]];i&&s.indexOf(n[o.id.value])<0&&(s.push(n[o.id.value]),o.nodes.value.push(n))}),"keys"in o.data||(o.data.keys={}),o.id.value in o.data.keys||(o.data.keys[o.id.value]=typeof a[o.edges.source][o.id.value])}),o.edges.value=o.edges.value.filter(function(e){var t=e[o.edges.source][o.id.value];if(t===e[o.edges.target][o.id.value]){var r=o.format.locale.value.dev.sameEdge;return n.warning(a(r,'"'+t+'"'),"edges"),!1}return!0}),o.edges.linked=!0,o.dev.value&&n.timeEnd(e)}},{"../../string/format.js":173,"../console/print.coffee":52}],96:[function(e,t,r){var c=e("./hideElement.js");t.exports=function(o){var e=[o.color.value,o.icon.value,o.keywords.value,o.alt.value,"style"];function i(r,t){[].forEach.call(t.attributes,function(e){if(/^data-/.test(e.name)){var t=e.name.substr(5).replace(/-(.)/g,function(e,t){return t.toUpperCase()});r[t]=e.value}}),e.forEach(function(e){null!==t.getAttribute(e)&&(r[e]=t.getAttribute(e))})}o.text.value||o.self.text("text"),e=e.concat(o.id.nesting),o.self.data({element:o.data.value});var t=o.data.element.value.node().tagName.toLowerCase(),r=o.data.element.value.attr("type"),s=[];if("select"===t){var n=o.data.element.value.node().id;n&&o.self.container({id:n}),o.data.element.value.selectAll("option").each(function(e,t){var r={};if(r.text=d3.select(this).text(),i(r,this),s.push(r),this.selected)for(t=o.id.nesting.length-1;0<=t;t--){var n=o.id.nesting[t];if(n in r){o.self.focus(r[n]);break}}})}else if("input"===t&&"radio"===r){var a=o.data.element.value.node().getAttribute("name");a&&o.self.container({id:a}),o.data.element.value.each(function(e,t){var r={};i(r,this);var n=r[o.id.value]||this.id||!1;if(n&&isNaN(parseFloat(n))){var a=d3.select("label[for="+n+"]");a.empty()||(r.text=a.html(),a.call(c))}s.push(r),this.checked&&o.self.focus(r[o.id.value])})}!o.focus.value.length&&s.length&&(o.data.element.value.node().selectedIndex=0,o.self.focus(s[0][o.id.value]));var l=d3.select("legend[for="+o.container.id+"]");l.empty()||(o.self.title(l.html()),l.call(c));var u=!!o.container.value&&o.container.value.node().tagName.toLowerCase();return!1!==o.container.value&&"body"!==u||(o.container.value=d3.select(o.data.element.value.node().parentNode)),o.data.element.value.call(c),s}},{"./hideElement.js":97}],97:[function(e,t,r){t.exports=function(e){e.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}},{}],98:[function(e,t,r){var o=e("../console/print.coffee");t.exports=function(e){if("network"===e.type.value){if(e.dev.value){var t="analyzing node positions";o.time(t)}if(e.nodes.value.filter(function(e){return"number"==typeof e.x&&"number"==typeof e.y}).length===e.nodes.value.length)e.nodes.positions=!0;else{var r=d3.layout.force().size([e.width.viz,e.height.viz]).nodes(e.nodes.value).links(e.edges.value),n=e.edges.strength.value;n&&("string"==typeof n?r.linkStrength(function(e){return e[n]}):r.linkStrength(n));r.start();for(var a=50;0<a&&(r.tick(),!(r.alpha()<.01));--a);r.stop(),e.nodes.positions=!0}e.dev.value&&o.timeEnd(t)}}},{"../console/print.coffee":52}],99:[function(e,t,r){var A;A=e("numeric"),t.exports=function(n,a){var o,e,t,r,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z;for(null==a&&(a={}),null==a.maxDegree&&(a.maxDegree=5),o=n.length,m=Number.MAX_VALUE,i=null,t=function(){var e,t,r;for(r=[],u=e=1,t=a.maxDegree+1;1<=t?e<t:t<e;u=1<=t?++e:--e)r.push(function(){var e,t,r;for(r=[],t=0,e=n.length;t<e;t++)g=n[t],r.push(Math.pow(g[0],u));return r}());return r}(),k=function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)g=n[e],r.push(g[1]);return r}(),d=h=0,y=1<<a.maxDegree;0<=y?h<y:y<h;d=0<=y?++h:--h){for(r=[function(){var e,t,r;for(r=[],e=0,t=o;0<=t?e<t:t<e;0<=t?++e:--e)r.push(1);return r}()],c=[0],f=v=0,x=a.maxDegree;0<=x?v<x:x<v;f=0<=x?++v:--v)0<(d&1<<f)&&(r.push(t[f]),c.push(f+1));e=A.transpose(r),p=c.length,s=A.dot(A.dot(A.inv(A.dot(r,e)),r),k),z=A.dot(e,s),b=A.sub(k,z),w=(_=A.dot(b,b))/(o-p),(l=-2*(-.5*o*Math.log(2*Math.PI)-.5*o*Math.log(w)-_/(2*w))+p*(Math.log(o)-Math.log(2*Math.PI)))<m&&(m=l,i=[c,s,z])}return i}},{numeric:7}],100:[function(e,t,r){var v;v=e("static-kdtree"),t.exports=function(l,i){var s,u,c,r,n,d,f,a,p,o,h;return null==i&&(i=10),h=v(l),f=function(){var e,t,r;for(r=[],e=0,t=l.length;e<t;e++)a=l[e],r.push(h.knn(a,i+1).slice(1));return r}(),o=function(e,t){var r,n,a,o,i,s;for(r=l[e],n=l[t],e=i=o=0,s=r.length;0<=s?i<s:s<i;e=0<=s?++i:--i)o+=(a=r[e]-n[e])*a;return o},r=function(){var e,t,r;for(r=[],u=e=0,t=l.length;0<=t?e<t:t<e;u=0<=t?++e:--e)r.push(o(u,f[u][i-1]));return r}(),p=function(e,t){return Math.max(o(e,t),r[t])},n=function(e){var t,r,n,a,o;for(r=a=0,n=(o=f[e]).length;r<n;r++)t=o[r],a+=p(e,t);return i/a},d=function(){var e,t,r;for(r=[],u=e=0,t=l.length;0<=t?e<t:t<e;u=0<=t?++e:--e)r.push(n(u));return r}(),function(){var e,t,r,n,a,o;for(o=[],u=e=0,n=l.length;0<=n?e<n:n<e;u=0<=n?++e:--e){for(t=s=0,r=(a=f[u]).length;t<r;t++)c=a[t],s+=d[c];s/=i,o.push([u,s/d[u]])}return o}().sort(function(e,t){return t[1]-e[1]})}},{"static-kdtree":9}],101:[function(e,t,r){t.exports=function(e){var r,n;return n=d3.median(e),r=d3.median(e.map(function(e){return Math.abs(e-n)})),e.map(function(e,t){return[t,Math.abs(e-n)/r]}).sort(function(e,t){return t[1]-e[1]})}},{}],102:[function(e,t,r){var c;c=e("../core/font/tester.coffee"),t.exports=function(e,t,r){var n,a,o,i,s,l,u;return r||(r={}),t=t||{},l=r.parent||c("svg").append("text"),i=[],e instanceof Array||(e=[e]),u=l.selectAll("tspan").data(e),n={left:"0px",position:"absolute",top:"0px",x:0,y:0},s=0,"letter-spacing"in t&&(s=parseFloat(t["letter-spacing"]),delete t["letter-spacing"]),o=function(e){var t;return t=0,s&&(t=(d3.select(e).text().length-1)*s),e.getComputedTextLength()+t},a=function(e){return e.parentNode.getBBox().height||e.getBoundingClientRect().height},u.enter().append("tspan").text(String).style(t).attr(n).each(function(e){if("function"==typeof r.mod)return r.mod(this)}).each(function(e){var t,r,n;return(t=d3.select(this).selectAll("tspan")).size()?(n=[],t.each(function(){return n.push(o(this))}),n=d3.max(n)):n=o(this),r=a(this),i.push({height:r,text:e,width:n})}),u.remove(),r.parent||l.remove(),i}},{"../core/font/tester.coffee":68}],103:[function(e,t,r){var h,v;h=e("../core/font/tester.coffee"),(v=function(e){var t,r,n,a,o,i,s,l,u,c,d,f,p;for(e instanceof Array||(e=e.split(",")),a=0,i=e.length;a<i;a++)e[a].trim();if((n=e.join(", "))in(t=v.complete))return t[n];for(c=function(e){return f.append("span").style("font-family",e).style("font-size","32px").style("padding","0px").style("margin","0px").text("abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890")},d=function(e,t){var r,n,a;return n=(r=c(e)).node().offsetWidth,a=t.node().offsetWidth,r.remove(),n!==a},f=h("div"),l=c("monospace"),u=c("sans-serif"),o=0,s=e.length;o<s;o++)if((p=d((r=e[o])+",monospace",l))||(p=d(r+",sans-serif",u)),p){p=r;break}return p||(p="sans-serif"),l.remove(),u.remove(),t[n]=p}).complete={},t.exports=v},{"../core/font/tester.coffee":68}],104:[function(e,t,r){var v=e("../array/sort.coffee"),n=e("../core/methods/attach.coffee"),g=e("../core/data/format.js"),m=e("../core/data/keys.coffee"),y=e("../core/data/load.coffee"),x=e("../core/fetch/data.js"),b=e("../client/ie.js"),w=e("../core/methods/reset.coffee"),_=e("../core/console/print.coffee");t.exports=function(){var h={types:{auto:e("./types/auto.js"),button:e("./types/button/button.coffee"),drop:e("./types/drop/drop.coffee"),toggle:e("./types/toggle.js")},self:function(e){var t=h.data.value instanceof Array&&h.data.value.length>h.data.large;if(h.draw.timing=h.draw.first||t||b?0:h.timing.ui,h.data.value instanceof Array){if(h.dev.value&&_.group('drawing "'+h.type.value+'"'),h.data.changed&&(h.data.cache={},m(h,"data"),g(h)),h.data.viz=x(h),h.data.sort.value&&(h.data.changed||h.order.changed||h.order.sort.changed)&&v(h.data.viz,h.order.value||h.text.value,h.order.sort.value,h.color.value,h),!1===h.focus.value&&["auto","button"].indexOf(h.type.value)<0){var r=h.data.element.value;if(r&&"select"===r.node().tagName.toLowerCase()){var n=r.property("selectedIndex");n=n<0?0:n;var a=r.selectAll("option")[0][n],o=a.getAttribute("data-"+h.id.value)||a.getAttribute(h.id.value);o&&(h.focus.value=o)}!1===h.focus.value&&h.data.viz.length&&(h.focus.value=h.data.viz[0][h.id.value]),h.dev.value&&!1!==h.focus.value&&_.log('"value" set to "'+h.focus.value+'"')}var i=function(e,t){t="number"!=typeof t?1===h.id.nesting.length?0:h.id.nesting.length-1:t;var r=h.id.nesting[t];return 0<t&&(!(r in e)||e[r]instanceof Array)?i(e,t-1):r};if(h.data.changed){"auto"===h.search.value?10<h.data.viz.length?(h.search.enabled=!0,h.dev.value&&_.log("Search enabled.")):(h.search.enabled=!1,h.dev.value&&_.log("Search disabled.")):h.search.enabled=h.search.value;var s=h.data.element.value?h.data.element.value.node().tagName.toLowerCase():"";if(h.data.element.value&&"select"===s){var l=[];for(var u in h.data.nested.all)l=l.concat(h.data.nested.all[u]);options=h.data.element.value.selectAll("option").data(l,function(e){var t=!!e&&i(e);return!!(e&&t in e)&&e[t]}),options.exit().remove(),options.enter().append("option"),options.each(function(e){var t=i(e),r=t===h.id.value?h.text.value||h.id.value:!0!==h.text.nesting&&t in h.text.nesting?h.text.nesting[t]:t;for(var n in e)"object"!=typeof e[n]&&(n===r&&d3.select(this).html(e[n]),0<=["alt","value"].indexOf(n)?d3.select(this).attr(n,e[n]):d3.select(this).attr("data-"+n,e[n]));e[t]===h.focus.value?this.selected=!0:this.selected=!1})}}else if(h.focus.changed&&h.data.element.value){if("select"===h.data.element.value.node().tagName.toLowerCase())h.data.element.value.selectAll("option").each(function(e){e[i(e)]===h.focus.value?this.selected=!0:this.selected=!1});else"radio"===h.data.element.value.attr("type").toLowerCase()&&h.data.element.value.each(function(e){this.value===h.focus.value?this.checked=!0:this.checked=!1})}if("auto"!==h.type.value){if(!h.container.ui){h.container.ui=h.container.value.selectAll("div#d3plus_"+h.type.value+"_"+h.container.id).data(["container"]);var c=h.data.element.value?h.data.element.value[0][0]:null;if(c)if(c.id)c="#"+c.id;else{var d=c.getAttribute(h.id.value)?h.id.value:"data-"+h.id.value;c=c.getAttribute(d)?"["+d+"="+c.getAttribute(d)+"]":null}h.container.ui.enter().insert("div",c).attr("id","d3plus_"+h.type.value+"_"+h.container.id).style("position","relative").style("overflow","visible").style("vertical-align","top")}h.container.ui.style("display",h.ui.display.value),h.container.ui.transition().duration(h.draw.timing).style("margin",h.ui.margin.css);var f=h.container.ui.selectAll("div.d3plus_title").data(h.title.value?[h.title.value]:[]);f.enter().insert("div","#d3plus_"+h.type.value+"_"+h.container.id).attr("class","d3plus_title").style("display","inline-block"),f.style("color",h.font.color).style("font-family",h.font.family.value).style("font-size",h.font.size+"px").style("font-weight",h.font.weight).style("padding",h.ui.padding.css).style("border-color","transparent").style("border-style","solid").style("border-width",h.ui.border+"px").text(String).each(function(e){h.margin.left=this.offsetWidth})}if(h.data.value.length){var p=h.format.locale.value.visualization[h.type.value];h.dev.value&&_.time("drawing "+p),h.types[h.type.value](h),h.dev.value&&_.timeEnd("drawing "+p)}else!h.data.url||h.data.loaded&&!h.data.stream||y(h,"data",h.self.draw);h.dev.value&&_.timeEnd("total draw time"),w(h)}}};return n(h,{active:e("./methods/active.coffee"),alt:e("./methods/alt.coffee"),color:e("./methods/color.coffee"),config:e("./methods/config.coffee"),container:e("./methods/container.coffee"),data:e("./methods/data.js"),depth:e("./methods/depth.coffee"),dev:e("./methods/dev.coffee"),draw:e("./methods/draw.js"),focus:e("./methods/focus.coffee"),font:e("./methods/font.coffee"),format:e("./methods/format.coffee"),height:e("./methods/height.coffee"),history:e("./methods/history.coffee"),hover:e("./methods/hover.coffee"),icon:e("./methods/icon.coffee"),id:e("./methods/id.coffee"),keywords:e("./methods/keywords.coffee"),margin:e("./methods/margin.coffee"),open:e("./methods/open.coffee"),order:e("./methods/order.coffee"),remove:e("./methods/remove.coffee"),search:e("./methods/search.coffee"),select:e("./methods/select.coffee"),selectAll:e("./methods/selectAll.coffee"),text:e("./methods/text.coffee"),timing:e("./methods/timing.coffee"),title:e("./methods/title.coffee"),type:e("./methods/type.coffee"),ui:e("./methods/ui.coffee"),width:e("./methods/width.coffee")}),h.self}},{"../array/sort.coffee":34,"../client/ie.js":37,"../core/console/print.coffee":52,"../core/data/format.js":56,"../core/data/keys.coffee":58,"../core/data/load.coffee":59,"../core/fetch/data.js":64,"../core/methods/attach.coffee":80,"../core/methods/reset.coffee":93,"./methods/active.coffee":105,"./methods/alt.coffee":106,"./methods/color.coffee":107,"./methods/config.coffee":108,"./methods/container.coffee":109,"./methods/data.js":110,"./methods/depth.coffee":111,"./methods/dev.coffee":112,"./methods/draw.js":113,"./methods/focus.coffee":114,"./methods/font.coffee":115,"./methods/format.coffee":116,"./methods/height.coffee":117,"./methods/history.coffee":118,"./methods/hover.coffee":119,"./methods/icon.coffee":120,"./methods/id.coffee":121,"./methods/keywords.coffee":122,"./methods/margin.coffee":123,"./methods/open.coffee":124,"./methods/order.coffee":125,"./methods/remove.coffee":126,"./methods/search.coffee":127,"./methods/select.coffee":128,"./methods/selectAll.coffee":129,"./methods/text.coffee":130,"./methods/timing.coffee":131,"./methods/title.coffee":132,"./methods/type.coffee":133,"./methods/ui.coffee":134,"./methods/width.coffee":135,"./types/auto.js":136,"./types/button/button.coffee":137,"./types/drop/drop.coffee":142,"./types/toggle.js":159}],105:[function(e,t,r){e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Array,Function,Number,String],value:!1}},{"../../core/methods/filter.coffee":81}],106:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],mute:n(!0),solo:n(!0),value:"alt"}},{"../../core/methods/filter.coffee":81}],107:[function(e,t,r){t.exports={accepted:[String],value:"color"}},{}],108:[function(e,t,r){t.exports={accepted:[Object],objectAccess:!1,process:function(e,t){var r,n;for(r in e)n=e[r],r in t.self&&t.self[r](n);return e},value:{}}},{}],109:[function(e,t,r){var n;n=e("../../util/d3selection.coffee"),t.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(e){return!1===e?d3.select("body"):n(e)?e:e instanceof Array?d3.select(e[0][0]):(this.selector=e,d3.select(e))},value:d3.select("body")}},{"../../util/d3selection.coffee":208}],110:[function(e,t,r){var n=e("../../util/d3selection.coffee"),a=e("../../core/methods/process/data.coffee");t.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},element:{process:function(e,t){var r=!1;return n(e)?r=e:"string"!=typeof e||d3.select(e).empty()||(r=d3.select(e)),r&&t.self.container(d3.select(r.node().parentNode)),r},value:!1},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],large:400,mute:[],process:function(e,t){return"default"===t.container.id&&e.length&&t.self.container({id:"default"+e.length}),a(e,t,this)},solo:[],sort:{accepted:[Boolean],value:!1},value:!1}},{"../../core/methods/process/data.coffee":87,"../../util/d3selection.coffee":208}],111:[function(e,t,r){t.exports={accepted:[Number],value:0}},{}],112:[function(e,t,r){t.exports={accepted:[Boolean],value:!1}},{}],113:[function(e,t,r){var o=e("../../util/d3selection.coffee"),i=e("../../core/parse/hideElement.js"),s=e("../../core/parse/element.js"),l=e("../../core/console/print.coffee"),u=e("../../string/format.js");t.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e,t){if(!1===this.initialized)return this.initialized=!0,e;if(!t.data.value||t.data.value instanceof Array&&!o(t.data.value)?t.data.element.value&&t.data.element.value.call(i):t.data.value=s(t),void 0===e&&"function"==typeof this.value&&(e=this.value),!1===t.container.value){var r=t.format.locale.value.dev.setContainer;l.warning(r,"container")}else if(t.container.value.empty()){r=t.format.locale.value.dev.noContainer;var n=t.container.selector||"";l.warning(u(r,'"'+n+'"'),"container")}else t.dev.value&&l.time("total draw time"),t.container.value.call(t.self);if("function"==typeof e&&t.history.chain.length){var a={};t.history.chain.forEach(function(e){var t=e.method;delete e.method,a[t]=e}),e(a),t.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/console/print.coffee":52,"../../core/parse/element.js":96,"../../core/parse/hideElement.js":97,"../../string/format.js":173,"../../util/d3selection.coffee":208}],114:[function(e,t,r){t.exports={accepted:[!1,Number,String],deprecates:"highlight",process:function(e,t){var r,n,a,o,i,s,l,u,c,d;if((n=t.data.element.value)&&0<=["string","number"].indexOf(typeof e))if(a=n.node().tagName.toLowerCase(),o=n.attr("type"),"select"===a)for(i=s=0,u=(d=n.selectAll("option")).length;s<u;i=++s)(r=d[i])&&r[t.id.value]===e&&(n.node().selectedIndex=i);else if("input"===a&&"radio"===o)for(l=0,c=n.length;l<c;l++)r=n[l],this.checked=r&&r[t.id.value]===e;return e},value:!1}},{}],115:[function(e,t,r){var n,a,o,i;o=e("../../core/methods/font/family.coffee"),n=e("../../core/methods/font/align.coffee"),a=e("../../core/methods/font/decoration.coffee"),i=e("../../core/methods/font/transform.coffee"),t.exports={align:n(),color:"#444444",decoration:a(),family:o(),secondary:{align:n(),color:"#444444",decoration:a(),family:o(),size:12,spacing:0,transform:i(),weight:200},size:12,spacing:0,transform:i(),weight:200}},{"../../core/methods/font/align.coffee":82,"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],116:[function(e,t,r){var a,n,o,i;a=e("../../number/format.coffee"),n=e("../../core/locale/locale.coffee"),o=e("../../object/merge.coffee"),i=e("../../string/title.coffee"),t.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(n)},process:function(e){var t;return"en_US",t=n.en_US,"en_US"!==e&&(t=o(t,n[e])),this.language=e,t},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e,t){if("string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var r,n;return t||(t={}),(n=t.vars||{}).time&&n.time.value&&t.key===n.time.value?(r=e.constructor===Date?e:new Date(e),n.data.time.format(r)):"number"==typeof e?(this.number.value||a)(e,t):"string"==typeof e?(this.text.value||i)(e,t):JSON.stringify(e)}}},{"../../core/locale/locale.coffee":79,"../../number/format.coffee":170,"../../object/merge.coffee":171,"../../string/title.coffee":176}],117:[function(e,t,r){t.exports={accepted:[!1,Number],max:600,secondary:!1,value:!1}},{}],118:[function(e,t,r){t.exports={back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var e;for(e=[];this.states.length;)e.push(this.states.pop()());return e},states:[]}},{}],119:[function(e,t,r){t.exports={accepted:[Boolean,Number,String],value:!1}},{}],120:[function(e,t,r){var n;n=e("../../core/methods/process/icon.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:n,rotate:0,value:"fa-angle-left"},button:{accepted:[!1,String],fallback:!1,opacity:1,process:n,rotate:0,value:!1},drop:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:n,rotate:0,value:"fa-angle-down"},next:{accepted:[!1,String],fallback:"&#x276f;",opacity:1,process:n,rotate:0,value:"fa-angle-right"},select:{accepted:[!1,String],fallback:"&#x2713;",opacity:1,process:n,rotate:0,value:"fa-check"},style:{accepted:[Object,String],value:"default"},value:"icon"}},{"../../core/methods/process/icon.coffee":89}],121:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,String],dataFilter:!0,mute:n(!0),nesting:["value"],solo:n(!0),value:"value"}},{"../../core/methods/filter.coffee":81}],122:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],mute:n(!0),solo:n(!0),value:"keywords"}},{"../../core/methods/filter.coffee":81}],123:[function(e,t,r){var n;n=e("../../core/methods/process/margin.coffee"),t.exports={accepted:[Number,Object,String],process:function(e){var t;return void 0===e&&(e=this.value),n(t=e,this),t},value:0}},{"../../core/methods/process/margin.coffee":90}],124:[function(e,t,r){t.exports={accepted:[Boolean],flipped:{accepted:[Boolean],value:!1},value:!1}},{}],125:[function(e,t,r){t.exports={accepted:[!1,Function,String],sort:{accepted:["asc","desc"],deprecates:["sort"],value:"asc"},value:!1}},{}],126:[function(e,t,r){t.exports={accepted:[void 0,Function],process:function(e,t){this.initialized&&t.container.ui.remove(),delete t.container.ui},value:void 0}},{}],127:[function(e,t,r){t.exports={accepted:["auto",Boolean],process:function(e){return"Boolean"==typeof e&&(this.enabled=e),e},term:"",value:"auto"}},{}],128:[function(e,t,r){t.exports={accepted:[String],chainable:!1,process:function(e,t){var r;return(r=t.container.value)&&e?r.select(e):e},value:void 0}},{}],129:[function(e,t,r){t.exports={accepted:[String],chainable:!1,process:function(e,t){var r;return(r=t.container.value)&&e?r.selectAll(e):e},value:void 0}},{}],130:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,String],nesting:!0,mute:n(!0),solo:n(!0),secondary:{accepted:[!1,String],nesting:!0,value:!1},value:!1}},{"../../core/methods/filter.coffee":81}],131:[function(e,t,r){t.exports={mouseevents:60,ui:200}},{}],132:[function(e,t,r){var n,a,o,i;n=e("../../core/methods/font/decoration.coffee"),a=e("../../core/methods/font/family.coffee"),i=e("../../core/methods/font/transform.coffee"),o=e("../../string/strip.js"),t.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:n(),family:a(),size:16,transform:i(),weight:400},link:!1,process:function(e,t){var r;return 0===t.container.id.indexOf("default")&&e&&(r=o(e).toLowerCase(),t.self.container({id:r})),e},value:!1}},{"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86,"../../string/strip.js":175}],133:[function(e,t,r){t.exports={accepted:function(e){return d3.keys(e.types)},value:"auto"}},{}],134:[function(e,t,r){var n,a,o,i,s;o=e("../../core/methods/font/family.coffee"),n=e("../../core/methods/font/align.coffee"),a=e("../../core/methods/font/decoration.coffee"),i=e("../../core/methods/process/margin.coffee"),s=e("../../core/methods/font/transform.coffee"),t.exports={align:n("center"),border:1,color:{primary:{process:function(e,t){var r;return r=this.value,t.ui.color.secondary.value||(t.ui.color.secondary.value=d3.rgb(r).darker(.75).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:n("center"),color:"#444",decoration:a(),family:o(),size:11,transform:s(),weight:200},margin:{process:function(e){var t;return void 0===e&&(e=this.value),i(t=e,this),t},value:5},padding:{process:function(e){var t;return void 0===e&&(e=this.value),i(t=e,this),t},value:5}}},{"../../core/methods/font/align.coffee":82,"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86,"../../core/methods/process/margin.coffee":90}],135:[function(e,t,r){t.exports={accepted:[!1,Number],secondary:!1,value:!1}},{}],136:[function(e,t,r){t.exports=function(e){var t=e.data.value.length;1===t?e.self.type("button").draw():t<5?e.self.type("toggle").draw():e.self.type("drop").draw()}},{}],137:[function(u,e,t){e.exports=function(t){var e,r,n,a,o,i,s,l;return i=u("../../../core/console/print.coffee"),n=u("./functions/color.coffee"),a=u("./functions/icons.js"),o=u("./functions/mouseevents.coffee"),s=u("./functions/style.js"),e=t.container.ui.selectAll("div.d3plus_node").data(t.data.viz,function(e){return e[t.id.value]}),t.dev.value&&i.time("enter"),e.enter().append("div").attr("class","d3plus_node").call(n,t).call(s,t).call(a,t).call(o,t),t.dev.value&&i.timeEnd("enter"),t.draw.update||t.draw.timing?(t.dev.value&&i.time("ordering"),e.order(),t.dev.value&&i.timeEnd("ordering"),l=e):(r=[t.focus.previous,t.focus.value,t.hover.previous,t.hover.value].filter(function(e){return e}),l=e.filter(function(e){return 0<=r.indexOf(e[t.id.value])})),t.dev.value&&i.time("update"),l.classed("d3plus_button_active",function(e){return t.focus.value===e[t.id.value]}),t.draw.timing?l.transition().duration(t.draw.timing).call(n,t).call(s,t):l.call(n,t).call(s,t),l.call(a,t).call(o,t),t.dev.value&&i.timeEnd("update"),e.exit().remove()}},{"../../../core/console/print.coffee":52,"./functions/color.coffee":138,"./functions/icons.js":139,"./functions/mouseevents.coffee":140,"./functions/style.js":141}],138:[function(t,e,r){e.exports=function(e,a){var o,i;return o=t("../../../../color/legible.coffee"),t("../../../../color/lighter.coffee"),i=t("../../../../color/text.coffee"),e.style("background-color",function(e){var t;return t=a.focus.value===e[a.id.value]?a.ui.color.secondary.value:a.ui.color.primary.value,a.hover.value===e[a.id.value]&&(t=d3.rgb(t).darker(.15).toString()),t}).style("color",function(e){var t,r,n;return n=a.focus.value===e[a.id.value]?.75:1,!(e[a.icon.value]&&a.data.viz.length<a.data.large)&&e[a.color.value]?r=o(e[a.color.value]):(t=a.focus.value===e[a.id.value]?a.ui.color.secondary.value:a.ui.color.primary.value,a.hover.value===e[a.id.value]&&(t=d3.rgb(t).darker(.15).toString()),r=i(t)),"rgba("+(r=d3.rgb(r)).r+","+r.g+","+r.b+","+n+")"}).style("border-color",a.ui.color.secondary.value)}},{"../../../../color/legible.coffee":44,"../../../../color/lighter.coffee":45,"../../../../color/text.coffee":50}],139:[function(e,t,r){var d=e("../../../../client/prefix.coffee"),f=e("../../../../client/rtl.coffee");t.exports=function(e,u){var c="right"===u.font.align.value&&!f||f&&"right"===u.font.align.value;e.each(function(r,e){var t=["label"];r[u.icon.value]&&u.data.viz.length<=u.data.large&&t.push("icon");var n=u.icon.button.value;r[u.id.value]===u.focus.value&&u.icon.select.value?(n=u.icon.select.value,t.push("selected")):n&&!1!==r.d3plus.icon&&t.push("selected");var a=0,o=d3.select(this).selectAll("div.d3plus_button_element").data(t,function(e){return e});o.enter().append("div").style("display",function(e){return"label"===e?"block":"absolute"}),o.order().attr("class",function(e){var t="";return"selected"===e&&0===n.indexOf("fa-")&&(t=" fa "+n),"d3plus_button_element d3plus_button_"+e+t}).html(function(e){if("label"===e){var t=u.text.value&&u.text.value in r&&!(r[u.text.value]instanceof Array)?u.text.value:u.id.value;return u.format.value(r[t])}return"selected"===e&&n.indexOf("fa-")<0?n:""}).style("background-image",function(e){return"icon"===e?"url('"+r[u.icon.value]+"')":"none"}).style("background-color",function(e){return"icon"===e&&"knockout"===r.style?r[u.color.value]||u.ui.color.primary.value:"transparent"}).style("background-size","100%").style("text-align",function(e){return"label"===e?u.font.align.value:"center"}).style("position",function(e){return"label"==e?"static":"absolute"}).style("width",function(e){return"label"===e?"auto":(a=u.height.value?u.height.value-(u.ui.padding.top+u.ui.padding.bottom)-2*u.ui.border:u.font.size+u.ui.border)+"px"}).style("height",function(e){return"icon"===e?a+"px":"auto"}).style("margin-top",function(e){if("label"===e)return"0px";if(this.offsetHeight||this.getBoundingClientRect().height)var t=this.offsetHeight||this.getBoundingClientRect().height;else if("selected"===e)t=u.font.size;else t=a;return-t/2+"px"}).style("top",function(e){return"label"===e?"auto":"50%"}).style("left",function(e){return"icon"===e&&!c||"selected"===e&&c?u.ui.padding.left+"px":"auto"}).style("right",function(e){return"icon"===e&&c||"selected"===e&&!c?u.ui.padding.right+"px":"auto"}).style(d()+"transition",function(e){return"selected"===e?u.draw.timing/1e3+"s":"none"}).style(d()+"transform",function(e){var t="selected"===e?u.icon.select.rotate:"none";return"string"==typeof t?t:"rotate("+t+"deg)"}).style("opacity",function(e){return"selected"===e?u.icon.select.opacity:1}),o.exit().remove();var i=d3.select(this).selectAll(".d3plus_button_label");if(0<a){var s=u.ui.padding;s=3===t.length?s.top+"px "+(2*s.right+a)+"px "+s.bottom+"px "+(2*s.left+a)+"px":0<=t.indexOf("icon")&&!f||0<=t.indexOf("selected")&&f?s.top+"px "+s.right+"px "+s.bottom+"px "+(2*s.left+a)+"px":s.top+"px "+(2*s.right+a)+"px "+s.bottom+"px "+s.left+"px",i.style("padding",s)}else i.style("padding",u.ui.padding.css);if("number"==typeof u.width.value){var l=u.width.value;l-=parseFloat(i.style("padding-left"),10),l-=parseFloat(i.style("padding-right"),10),l-=2*u.ui.border,l+="px"}else l="auto";i.style("width",l)})}},{"../../../../client/prefix.coffee":39,"../../../../client/rtl.coffee":40}],140:[function(o,e,t){e.exports=function(e,r,n){var t,a;return n=o("./color.coffee"),t=o("../../../../client/pointer.coffee"),a=o("../../../../client/ie.js"),e.on(t.over,function(e,t){return r.self.hover(e[r.id.value]),a||!r.draw.timing?d3.select(this).style("cursor","pointer").call(n,r):d3.select(this).style("cursor","pointer").transition().duration(r.timing.mouseevents).call(n,r)}).on(t.out,function(e){return r.self.hover(!1),a||!r.draw.timing?d3.select(this).style("cursor","auto").call(n,r):d3.select(this).style("cursor","auto").transition().duration(r.timing.mouseevents).call(n,r)}).on(t.click,function(e){return!1!==r.focus.value?r.self.focus(e[r.id.value]).draw():r.focus.callback?r.focus.callback(e,r.self):void 0})}},{"../../../../client/ie.js":37,"../../../../client/pointer.coffee":38,"./color.coffee":138}],141:[function(e,t,r){t.exports=function(e,t){e.style("position","relative").style("margin",t.ui.margin.css).style("display",t.ui.display.value).style("border-style","solid").style("border-width",t.ui.border+"px").style("font-family",t.font.family.value).style("font-size",t.font.size+"px").style("font-weight",t.font.weight).style("letter-spacing",t.font.spacing+"px")}},{}],142:[function(f,e,t){e.exports=function(e){var t,r,n,a,o,i,s,l,u,c,d;return n=f("./functions/element.coffee"),a=f("./functions/keyboard.coffee"),d=f("./functions/window.js"),c=f("./functions/width.js"),t=f("./functions/button.js"),s=f("./functions/selector.js"),l=f("./functions/title.js"),i=f("./functions/search.js"),o=f("./functions/list.js"),r=f("./functions/data.js"),u=f("./functions/update.js"),e.margin.top=0,e.margin.title=0,n(e),a(e),d(e),c(e),t(e),s(e),l(e),i(e),o(e),r(e),u(e)}},{"./functions/button.js":145,"./functions/data.js":146,"./functions/element.coffee":147,"./functions/keyboard.coffee":150,"./functions/list.js":151,"./functions/search.js":153,"./functions/selector.js":154,"./functions/title.js":155,"./functions/update.js":156,"./functions/width.js":157,"./functions/window.js":158}],143:[function(e,t,r){t.exports=function(e,t,r){var n=[];if((r=r||e.active.value)instanceof Array)for(var a=0;a<r.length;a++)n.push(this(e,t,r[a]));else{var o=typeof r;"number"===o?n.push(e.depth.value===r):"function"===o?n.push(r(t)):n.push(t===r)}return 0<=n.indexOf(!0)}},{}],144:[function(e,t,r){var n=e("../../../../core/console/print.coffee");t.exports=function(e){e.dev.value&&n.time("rotating arrow");var t="&#x276f;"===e.icon.drop.value?90:0;if(e.open.value!=e.open.flipped.value)var r=180+t;else r=t;e.container.button.icon({select:{opacity:e.open.value?.5:1,rotate:r}}).draw(),e.dev.value&&n.timeEnd("rotating arrow")}},{"../../../../core/console/print.coffee":52}],145:[function(e,t,r){var n=e("../../../../util/copy.coffee"),i=e("../../../../client/pointer.coffee"),s=e("../../../form.js"),l=e("../../../../core/console/print.coffee");t.exports=function(a){if("button"in a.container||(a.dev.value&&l.time("creating main button"),a.container.button=s().container(a.container.ui).type("button").ui({margin:0}),a.dev.value&&l.timeEnd("creating main button")),a.focus.changed||a.data.changed||a.depth.changed){var o=a.depth.value,e=n(a.data.value.filter(function(e){for(var t=!1,r=0;r<a.id.nesting.length;r++){var n=a.id.nesting[r];if(t=n in e&&e[n]===a.focus.value){o=r;break}}return t})[0]);e||(e=a.container.button.data()[0]||a.data.viz[0]),a.container.button.data([e]).id(a.id.nesting).depth(o)}var t=!0===a.hover.value&&a.focus.value;a.container.button.draw({update:a.draw.update}).focus("").font(a.font).format(a.format).hover(t).icon({button:a.icon.drop.value,select:a.icon.drop.value,value:a.icon.value}).text(a.text.value).timing({ui:a.draw.timing}).ui({border:a.ui.border,color:a.ui.color,padding:a.ui.padding.css}).width(a.width.value).draw();var r=a.container.button.container(Object).ui;a.margin.top+=r.node().offsetHeight||r.node().getBoundingClientRect().height,r.on(i.click,function(){a.self.open(!a.open.value).draw()})}},{"../../../../client/pointer.coffee":38,"../../../../core/console/print.coffee":52,"../../../../util/copy.coffee":207,"../../../form.js":104}],146:[function(e,t,r){var o=e("../../../../string/format.js"),f=e("../../../../string/strip.js");t.exports=function(s){if(s.data.url&&!s.data.loaded){var e={};e[s.text.value||s.id.value]=s.format.value(s.format.locale.value.ui.loading),s.data.filtered=[e],s.data.changed="loading"!==s.data.lastFilter,s.data.lastFilter="loading"}else if(s.open.value)if(s.search.term){var l=f(s.search.term).split("_"),t=[s.id.value,s.text.value,s.alt.value,s.keywords.value];t=t.filter(function(e){return e}),l=l.filter(function(e){return""!==e});var u=[],c=[],d=[],r=[];if(s.id.nesting.forEach(function(e){r=r.concat(s.data.nested.all[e])}),r.forEach(function(o){var i=!1;t.forEach(function(e){if(!i&&e in o&&"string"==typeof o[e]){var t=o[e].toLowerCase();if(0<=[s.text.value,s.id.value].indexOf(e)&&0===t.indexOf(s.search.term))u.push(o),i=!0;else if(0<=t.indexOf(s.search.term))c.push(o),i=!0;else{var r=f(t).split("_");for(var n in r){if(i)break;for(var a in l)if(0===r[n].indexOf(l[a])){d.push(o),i=!0;break}}}}})}),s.data.filtered=d3.merge([u,c,d]),s.data.filtered.forEach(function(e,t){e.d3plus_order=t}),s.data.changed=!0,s.data.lastFilter="search",0===s.data.filtered.length){var n={},a=s.format.value(s.format.locale.value.ui.noResults);n[s.text.value||s.id.value]=o(a,'"'+s.search.term+'"'),s.data.filtered=[n]}}else s.data.filtered=s.data.viz,s.data.changed="viz"!==s.data.lastFilter,s.data.lastFilter="viz",1<s.id.nesting.length&&s.depth.value<s.id.nesting.length-1&&(s.data.filtered=s.data.filtered.filter(function(e){return"endPoint"in e.d3plus&&e.d3plus.endPoint===s.depth.value&&(e.d3plus.icon=!1),!0}),s.data.changed="depth"!==s.data.lastFilter,s.data.lastFilter="depth");else s.data.filtered=[]}},{"../../../../string/format.js":173,"../../../../string/strip.js":175}],147:[function(e,t,r){t.exports=function(e){if(e.data.element.value)return e.data.element.value.on("focus."+e.container.id,function(){return e.self.hover(!0).draw()}),e.data.element.value.on("blur."+e.container.id,function(){if(!e.search.enabled||d3.event.relatedTarget!==e.container.value.select("input").node())return e.self.open(!1).hover(!1).draw()}),e.data.element.value.on("change."+e.container.id,function(){return e.self.focus(this.value).draw()}),e.data.element.value.on("keydown.cancel_"+e.container.id,function(){if(9!==d3.event.keyCode)return d3.event.preventDefault()})}},{}],148:[function(e,t,r){t.exports=function(e){var t=e.height.secondary,r=e.container.button.container().node().getBoundingClientRect(),n=window.innerHeight-r.bottom-2*e.ui.border-e.ui.margin.top-e.ui.margin.bottom-e.ui.padding.top-e.ui.padding.bottom;n<3*r.height&&(n=r.top-10,e.self.open({flipped:!0})),"number"!=typeof t&&(t=n),t>e.height.max&&(t=e.height.max),e.self.height({secondary:t})}},{}],149:[function(e,t,r){var i,n,a,s;i=e("./active.js"),n=e("../../../../util/copy.coffee"),a=e("../../../form.js"),s=e("../../../../core/console/print.coffee"),t.exports=function(o){var e,t,r;o.open.value&&(o.dev.value&&s.time("updating list items"),"items"in o.container||(o.container.items=a().container(o.container.list).type("button").ui({border:0,display:"block",margin:0}).width(!1)),t=o.draw.timing?o.data.large:1,(r=n(o.order)).value=o.search.term.length?"d3plus_order":o.order.value,e=o.depth.value===o.id.nesting.length-1,(o.focus.changed||!1===o.container.items.focus())&&o.container.items.focus(o.focus.value,function(t){var e,r,n,a;r=o.data.filtered.filter(function(e){return e[o.id.value]===t})[0],o.depth.value<o.id.nesting.length-1&&o.id.nesting[o.depth.value+1]in r?(n=o.depth.value,a=o.id.solo.value,o.history.states.push(function(){return o.self.depth(n).id({solo:a}).draw()}),o.self.depth(o.depth.value+1).id({solo:[t]}).draw()):(o.depth.changed||o.self.open(!1),(e=t!==o.focus.value)&&o.active.value&&(e=i(o,t)),e&&o.self.focus(t).draw())}),o.container.items.active(o.active.value).data({large:t,sort:o.data.sort.value,value:o.data.filtered}).draw({update:o.draw.update}).font(o.font.secondary).format(o.format).hover(o.hover.value).id(o.id.value).icon({button:!e&&o.icon.next,select:!!e&&o.icon.select,value:o.icon.value}).order(r).text(o.text.secondary.value||o.text.value).timing({ui:o.draw.timing}).ui({color:{primary:1===o.id.nesting.length?o.ui.color.primary.value:o.ui.color.secondary.value,secondary:o.ui.color.secondary.value},padding:o.ui.padding.css}).draw(),o.dev.value&&s.timeEnd("updating list items"))}},{"../../../../core/console/print.coffee":52,"../../../../util/copy.coffee":207,"../../../form.js":104,"./active.js":143}],150:[function(e,t,r){t.exports=function(f){return d3.select(window).on("keydown."+f.container.id,function(){var e,t,r,n,a,o,i,s,l,u,c,d;if(s=d3.event.keyCode,f.open.value||!0===f.hover.value){for(u=!0===f.hover.value?"focus":"hover",o=!1,a=i=0,l=(c=f.data.filtered).length;i<l;a=++i)if(c[a][f.id.value]===f[u].value){o=a;break}if(9===s&&f.open.value&&(!f.search.enabled||f.search.enabled&&!d3.event.shiftKey))return f.self.open(!1).hover(!1).draw();if(0<=[38,40].indexOf(s))return!1===o?o=0:38===s?f.open.value&&(o<=0?o=f.data.filtered.length-1:o-=1):40===s&&f.open.value&&(o>=f.data.filtered.length-1?o=0:o+=1),n="boolean"!=typeof f.hover.value?f.data.filtered[o][f.id.value]:f.focus.value,f.self.hover(n).open(!0).draw();if(13===s)return"boolean"!=typeof f.hover.value?(e=f.data.filtered.filter(function(e){return e[f.id.value]===f.hover.value})[0],(t=f.depth.value)<f.id.nesting.length-1&&f.id.nesting[t+1]in e?(d=f.id.solo.value,r=function(){return f.self.depth(t).id({solo:d}).draw()},f.history.states.push(r),f.self.depth(f.depth.value+1).id({solo:[f.hover.value]}).draw()):f.self.focus(f.hover.value).hover(!0).draw()):f.self.hover(f.focus.value).open(!0).draw();if(27===s){if(f.open.value)return f.self.open(!1).hover(!0).draw();if(!0===f.hover.value)return f.self.hover(!1).draw()}}})}},{}],151:[function(e,t,r){var n=e("../../../../core/console/print.coffee");t.exports=function(e){e.dev.value&&n.time("populating list"),e.container.list=e.container.selector.selectAll("div.d3plus_drop_list").data(["list"]),e.container.list.enter().append("div").attr("class","d3plus_drop_list").attr("id","d3plus_drop_list_"+e.container.id).style("overflow-y","auto").style("overflow-x","hidden"),e.dev.value&&n.timeEnd("populating list")}},{"../../../../core/console/print.coffee":52}],152:[function(e,t,r){var p=e("../../../../core/console/print.coffee");t.exports=function(r){if(r.open.value){r.dev.value&&p.time("calculating height");var e=!1;if("none"==r.container.selector.style("display"))e=!0;e&&r.container.selector.style("display","block");var t=r.container.selector.style("height"),n=r.container.selector.property("scrollTop"),a=r.container.list.style("max-height"),o=r.container.list.property("scrollTop");r.container.selector.style("height","auto"),r.container.list.style("max-height","200000px"),r.container.listHeight=parseFloat(r.container.selector.style("height"),10),r.container.list.style("max-height",a).property("scrollTop",o),r.container.selector.style("height",t).property("scrollTop",n);var i=!1;if(r.container.listHeight>r.height.secondary&&(r.container.listHeight=r.height.secondary,i=!0),e&&r.container.selector.style("display","none"),r.dev.value&&p.timeEnd("calculating height"),i){r.dev.value&&p.time("calculating scroll position");var s=r.container.list.select("div").selectAll("div.d3plus_node"),l=s[0][0],u="boolean"!=typeof r.hover.value?r.hover.value:r.focus.value;s.each(function(e,t){e[r.id.value]===u&&(l=this)});e=!1;"none"===r.container.selector.style("display")&&(e=!0,r.container.selector.style("display","block"));var c=l.offsetTop,d=l.offsetHeight||l.getBoundingClientRect().height,f=r.container.list.property("scrollTop");e&&r.container.selector.style("display","none"),e||r.data.changed||r.depth.changed?r.container.listScroll=c:c<(r.container.listScroll=f)?r.container.listScroll=c:c+d>f+r.height.secondary-r.search.height&&(r.container.listScroll=c-(r.height.secondary-d-r.search.height)),r.dev.value&&p.timeEnd("calculating scroll position")}else r.container.listScroll=0}else r.container.listScroll=r.container.list.property("scrollTop"),r.container.listHeight=0}},{"../../../../core/console/print.coffee":52}],153:[function(s,e,t){var l=s("../../../../client/prefix.coffee"),u=s("../../../../core/console/print.coffee");e.exports=function(r){r.dev.value&&u.time("creating search");var n=s("./data.js"),a=s("./items.coffee"),o=s("./update.js");function e(e){e.style("padding",r.ui.padding.css).style("display","block").style("background-color",d3.rgb(r.ui.color.primary.value).darker(.15).toString())}function t(e){var t=r.width.secondary-2*r.ui.padding.left-2*r.ui.padding.right+2*r.ui.border;e.style("padding",r.ui.padding.left/2+r.ui.padding.right/2+"px").style("width",t+"px").style("border-width","0px").style("font-family",r.font.secondary.family.value).style("font-size",r.font.secondary.size+"px").style("font-weight",r.font.secondary.weight).style("text-align",r.font.secondary.align).style("outline","none").style(l()+"border-radius","0").attr("placeholder",r.format.value(r.format.locale.value.method.search))}r.container.search=r.container.selector.selectAll("div.d3plus_drop_search").data(r.search.enabled?["search"]:[]),r.draw.timing?(r.container.search.transition().duration(r.draw.timing).call(e),r.container.search.select("input").transition().duration(r.draw.timing).call(t)):(r.container.search.call(e),r.container.search.select("input").call(t)),r.container.search.enter().insert("div","#d3plus_drop_list_"+r.container.id).attr("class","d3plus_drop_search").attr("id","d3plus_drop_search_"+r.container.id).call(e).append("input").attr("id","d3plus_drop_input_"+r.container.id).style("-webkit-appearance","none").call(t),r.container.search.select("input").on("keyup."+r.container.id,function(e){var t=this.value;r.search.term!==t&&(r.search.term=t,n(r),a(r),o(r))}),r.container.search.exit().remove();var i=r.container.selector.style("display");r.container.selector.style("display","block"),r.search.height=r.search.enabled?r.container.search.node().offsetHeight||r.container.search.node().getBoundingClientRect().height:0,r.container.selector.style("display",i),r.search.enabled&&(r.margin.title+=r.search.height),r.dev.value&&u.timeEnd("creating search")}},{"../../../../client/prefix.coffee":39,"../../../../core/console/print.coffee":52,"./data.js":146,"./items.coffee":149,"./update.js":156}],154:[function(e,t,r){t.exports=function(e){e.container.selector=e.container.ui.selectAll("div.d3plus_drop_selector").data(["selector"]),e.container.selector.enter().append("div").attr("class","d3plus_drop_selector").style("position","absolute").style("top","0px").style("z-index","-1").style("overflow","hidden"),e.container.selector.style("padding",e.ui.border+"px")}},{}],155:[function(e,t,r){var c=e("../../../../client/pointer.coffee"),d=e("../../../../color/lighter.coffee"),f=e("../../../../core/console/print.coffee"),p=e("../../../../color/text.coffee");t.exports=function(n){if(n.open.value){n.dev.value&&f.time("creating title and back button");var e=1===n.id.solo.value.length&&0<n.depth.value,r=e,t=n.container.button.data(Object).viz[0];r=!0;for(var a=0;a<n.id.nesting.length;a++){var o=n.id.nesting[a];if(o in t&&t[o]===n.focus.value){r=!1;break}}function i(e){e.style("padding",n.ui.padding.css).style("display","block").style("background-color",n.ui.color.secondary.value).style("font-family",n.font.secondary.family.value).style("font-size",n.font.secondary.size+"px").style("font-weight",n.font.secondary.weight).style("text-align",n.font.secondary.align).style("color",p(n.ui.color.secondary.value))}function s(e){if(!e.empty()){var t=0===n.icon.back.value.indexOf("fa-")?" fa "+n.icon.back.value:"";t="d3plus_drop_back"+t;var r=0===n.icon.back.value.indexOf("fa-")?"":n.icon.back.value;e.style("position","absolute").attr("class",t).style("top",n.ui.padding.top+n.font.secondary.size/2/2.5+"px").html(r)}}function l(e){var t=r?n.focus.value:n.format.locale.value.ui.back;e.text(n.format.value(t)).style("padding","0px "+(n.ui.padding.left+n.ui.padding.right)+"px")}n.container.title=n.container.selector.selectAll("div.d3plus_drop_title").data(e?["title"]:[]),n.draw.timing?(n.container.title.transition().duration(n.draw.timing).call(i),n.container.title.select("div.d3plus_drop_title_text").transition().duration(n.draw.timing).call(l)):(n.container.title.call(i),n.container.title.select("div.d3plus_drop_title_text").call(l)),n.container.title.select("span.d3plus_drop_back").call(s);var u=n.container.title.enter().insert("div","#d3plus_drop_list_"+n.container.id).attr("class","d3plus_drop_title").attr("id","d3plus_drop_title_"+n.container.id).call(i);u.append("span").attr("id","d3plus_drop_back_"+n.container.id).attr("class","d3plus_drop_back").call(s),u.append("div").attr("id","d3plus_drop_title_text_"+n.container.id).attr("class","d3plus_drop_title_text").call(l),n.container.title.on(c.over,function(e,t){var r=d(n.ui.color.secondary.value);d3.select(this).style("cursor","pointer").transition().duration(n.timing.mouseevents).style("background-color",r).style("color",p(r))}).on(c.out,function(e){var t=n.ui.color.secondary.value;d3.select(this).style("cursor","auto").transition().duration(n.timing.mouseevents).style("background-color",t).style("color",p(t))}).on(c.click,function(e){n.history.back()}),n.container.title.exit().remove(),e&&(n.margin.title+=n.container.title.node().offsetHeight||n.container.title.node().getBoundingClientRect().height),n.dev.value&&f.timeEnd("creating title and back button")}}},{"../../../../client/pointer.coffee":38,"../../../../color/lighter.coffee":45,"../../../../color/text.coffee":50,"../../../../core/console/print.coffee":52}],156:[function(e,t,r){var i=e("./items.coffee"),s=e("./height.js"),l=e("../../../../core/console/print.coffee"),u=e("./scroll.js"),c=e("./arrow.js");t.exports=function(r){function t(e){var t=r.open.flipped.value;e.style("top",function(){return t?"auto":r.margin.top-r.ui.border+"px"}).style("bottom",function(){return t?r.margin.top+r.ui.border+"px":"auto"})}function e(e){e.style("left",function(){return"left"===r.font.align.value?r.margin.left+"px":"center"===r.font.align.value?r.margin.left-(r.width.secondary-r.width.value)/2+"px":"auto"}).style("right",function(){return"right"===r.font.align.value?"0px":"auto"}).style("height",r.container.listHeight+"px").style("padding",r.ui.border+"px").style("background-color",r.ui.color.secondary.value).style("z-index",function(){return r.open.value?"9999":"-1"}).style("width",r.width.secondary-2*r.ui.border+"px").style("opacity",r.open.value?1:0).call(t)}function n(e){e.style("display",r.open.value?null:"none").call(t),r.search.enabled&&r.open.value&&r.container.selector.select("div.d3plus_drop_search input").node().focus()}r.draw.timing?r.container.ui.transition().duration(r.draw.timing).each("start",function(){r.open.value&&d3.select(this).style("z-index",9999)}).style("margin",r.ui.margin.css).each("end",function(){r.open.value||d3.select(this).style("z-index","auto")}):r.container.ui.style("margin",r.ui.margin.css).style("z-index",function(){return r.open.value?9999:"auto"}),i(r),s(r),u(r),c(r),r.dev.value&&l.time("drawing list");var a,o=r.open.value?r.height.secondary-r.margin.title:0;if(r.draw.timing){r.container.selector.transition().duration(r.draw.timing).each("start",function(){d3.select(this).style("display",r.open.value?"block":null)}).call(e).each("end",function(){d3.select(this).transition().duration(r.draw.timing).call(n)}),r.container.list.transition().duration(r.draw.timing).style("width",r.width.secondary-2*r.ui.border+"px").style("max-height",o+"px").tween("scroll",(a=r.container.listScroll,function(){var t=d3.interpolateNumber(this.scrollTop,a);return function(e){this.scrollTop=t(e)}}))}else r.container.selector.call(e).call(n),r.container.list.style("width",r.width.secondary-2*r.ui.border+"px").style("max-height",o+"px").property("scrollTop",r.container.listScroll);r.dev.value&&l.timeEnd("drawing list")}},{"../../../../core/console/print.coffee":52,"./arrow.js":144,"./height.js":148,"./items.coffee":149,"./scroll.js":152}],157:[function(e,t,r){var a=e("../../../../util/copy.coffee"),c=e("../../../../core/font/tester.coffee"),d=e("../../../form.js"),f=e("../../../../core/console/print.coffee"),o=e("../../../../object/validate.coffee");t.exports=function(l){var u=[];for(var e in l.data.nested.all){var t=l.data.nested.all[e],r=o(l.text.nesting)&&e in l.text.nesting?l.text.nesting[e][0]:e;[l.id.value,l.text.value].indexOf(r)<0&&(t=a(t)).forEach(function(e){e[l.text.value||l.id.value]=e[r]}),u=u.concat(t)}function n(e){var t="primary"===e?"value":e,r="value"===t?l.icon.drop.value:l.icon.select.value||l.icon.drop.value,n="value"===t?l.text.value:l.text.secondary.value||l.text.value,a="value"===t?l.font:l.font.secondary;l.dev.value&&f.time("calculating "+e+" width");var o=d().container(c()).data({large:9999,value:u}).draw({update:!1}).font(a).format(l.format).icon({button:r,value:l.icon.value}).id(l.id.value).timing({ui:0}).text(n||l.id.value).type("button").ui({border:"primary"===e?l.ui.border:0,display:"inline-block",margin:0,padding:l.ui.padding.css}).width(!1).draw(),i=[];o.selectAll("div.d3plus_node").each(function(e){i.push(this.offsetWidth+1)}).remove();var s={};s[t]=d3.max(i),l.self.width(s),l.dev.value&&f.timeEnd("calculating "+e+" width")}"number"!=typeof l.width.value&&n("primary"),"number"!=typeof l.width.secondary&&(l.text.secondary.value&&l.text.value!==l.text.secondary.value?n("secondary"):l.self.width({secondary:l.width.value}))}},{"../../../../core/console/print.coffee":52,"../../../../core/font/tester.coffee":68,"../../../../object/validate.coffee":172,"../../../../util/copy.coffee":207,"../../../form.js":104}],158:[function(e,t,r){var n=e("../../../../util/child.coffee"),a=function(r,e){if(void 0===e)e=window;d3.select(e).on("click."+r.container.id,function(){var e=d3.event.target||d3.event.toElement,t=e.parentNode;t&&0<=["d3plus_node","d3plus_drop_title"].indexOf(t.className)&&(e=t.parentNode),e&&t&&!n(r.container.ui,e)&&(r.open.value||r.hover.value)&&r.self.open(!1).hover(!1).draw()});try{var t=window.parent.location.host===window.location.host}catch(e){t=!1}t&&e.self!==window.top&&a(r,e.parent)};t.exports=a},{"../../../../util/child.coffee":205}],159:[function(e,t,r){var a=e("../form.js");t.exports=function(r){"buttons"in r.container||(r.container.buttons=a().container(r.container.ui).type("button"));var e=r.data.viz.length,n=!!r.width.value&&r.width.value/e,t=r.container.ui.selectAll("div.d3plus_toggle").data(r.data.viz,function(e){return e[r.id.value]});t.exit().remove(),t.enter().append("div").attr("class","d3plus_toggle").style("display","inline-block").style("vertical-align","top"),t.order().each(function(e){"form"in e.d3plus||(e.d3plus.form=a().container(d3.select(this)));var t=r.id.nesting.length>r.depth.value?r.id.nesting[r.depth.value+1]:r.id.value;e[t]instanceof Array?e.d3plus.form.container({id:r.container.id+"_"+e[r.id.value]}).data(e[t]).id(r.id.nesting.slice(1)).type("drop"):e.d3plus.form.data([e]).id(r.id.value).type("button"),e.d3plus.form.color(r.color).focus(r.focus.value,function(e){e!==r.focus.value&&r.self.focus(e).draw()}).hover(r.hover.value).icon({select:!1,value:r.icon.value}).font(r.font).format(r.format).order(r.order).text(r.text.value).ui({border:r.ui.border,color:r.ui.color,display:"inline-block",margin:0,padding:r.ui.padding.css}).width(n).draw()}),r.data.element.value&&r.data.element.value.on("focus."+r.container.id,function(){r.self.focus(this.value).hover(this.value).draw()}).on("blur."+r.container.id,function(){r.self.hover(!1).draw()})}},{"../form.js":104}],160:[function(e,t,r){var fe,m,pe,y,he,s,l,ve,c,ge,me;ge=e("simplify-js"),t.exports=function(n,e){var t,r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P,I,D,V,R,U,L,Y,H,X,G,J,W,Q,K,Z,$,ee,te,re,ne,ae,oe,ie,se,le,ue,ce,de;if(n.length<3)return null;if(f=[],.5,5,null==e&&(e={}),null==e.maxAspectRatio&&(e.maxAspectRatio=15),null==e.minWidth&&(e.minWidth=0),null==e.minHeight&&(e.minHeight=0),null==e.tolerance&&(e.tolerance=.02),null==e.nTries&&(e.nTries=20),null!=e.angle&&(e.angle instanceof Array?i=e.angle:"number"==typeof e.angle?i=[e.angle]:"string"!=typeof e.angle||isNaN(e.angle)||(i=[Number(e.angle)])),null==i&&(i=d3.range(-90,95,5)),null!=e.aspectRatio&&(e.aspectRatio instanceof Array?l=e.aspectRatio:"number"==typeof e.aspectRatio?l=[e.aspectRatio]:"string"!=typeof e.aspectRatio||isNaN(e.aspectRatio)||(l=[Number(e.aspectRatio)])),null!=e.origin&&e.origin instanceof Array&&(V=e.origin[0]instanceof Array?e.origin:[e.origin]),0===(s=Math.abs(d3.geom.polygon(n).area())))return null;if(q=(G=d3.extent(n,function(e){return e[0]}))[0],F=G[1],N=(J=d3.extent(n,function(e){return e[1]}))[0],S=J[1],se=Math.min(F-q,S-N)*e.tolerance,ie=function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)R=n[e],r.push({x:R[0],y:R[1]});return r}(),0<se&&(ie=ge(ie,se),n=function(){var e,t,r;for(r=[],e=0,t=ie.length;e<t;e++)R=ie[e],r.push([R.x,R.y]);return r}()),e.vdebug&&f.push({type:"simplify",poly:n}),q=(W=d3.extent(n,function(e){return e[0]}))[0],F=W[1],[[q,N=(Q=d3.extent(n,function(e){return e[1]}))[0]],[F,N],[F,S=Q[1]],[q,S]],c=(K=[F-q,S-N])[0],u=K[1],ue=Math.min(c,u)/50,null==V)for(V=[],d=d3.geom.polygon(n).centroid(),pe(d,n)&&V.push(d);V.length<e.nTries;)ae=Math.random()*c+q,oe=Math.random()*u+N,pe(ne=[ae,oe],n)&&V.push(ne);for(e.vdebug&&f.push({type:"origins",points:V}),O=null,g=A=0,b=i.length;g<b;g++)for(o=-(a=i[g])*Math.PI/180,e.vdebug&&f.push({type:"angle",angle:a}),h=m=0,w=V.length;m<w;h=++m)for(I=V[h],L=(Z=fe(n,I,o))[0],H=Z[1],U=($=fe(n,I,o+Math.PI/2))[0],Y=$[1],P=[],null!=L&&null!=H&&P.push([(L[0]+H[0])/2,(L[1]+H[1])/2]),null!=U&&null!=Y&&P.push([(U[0]+Y[0])/2,(U[1]+Y[1])/2]),e.vdebug&&f.push({type:"modifOrigin",idx:h,p1W:L,p2W:H,p1H:U,p2H:Y,modifOrigins:P}),y=0,_=P.length;y<_;y++)if(D=P[y],e.vdebug&&f.push({type:"origin",cx:D[0],cy:D[1]}),L=(ee=fe(n,D,o))[0],H=ee[1],null!==L&&null!==H&&(C=Math.min(me(D,L),me(D,H)),E=2*Math.sqrt(C),U=(te=fe(n,D,o+Math.PI/2))[0],Y=te[1],null!==U&&null!==Y&&(B=Math.min(me(D,U),me(D,Y)),!(E*(M=2*Math.sqrt(B))<A))))for(null!=l?r=l:(T=Math.max(1,e.minWidth/M,A/(M*M)),j=Math.min(e.maxAspectRatio,E/e.minHeight,E*E/A),r=d3.range(T,j+.5,.5)),z=0,k=r.length;z<k;z++)if(t=r[z],x=Math.max(e.minWidth,Math.sqrt(A*t)),!((re=Math.min(E,M*t))*M<A))for(ue<=re-x&&e.vdebug&&f.push({type:"aRatio",aRatio:t});ue<=re-x;)p=(le=(x+re)/2)/t,ce=D[0],de=D[1],X=ve(X=[[ce-le/2,de-p/2],[ce+le/2,de-p/2],[ce+le/2,de+p/2],[ce-le/2,de+p/2]],o,D),he(X,n)?(v=!0,A=le*p,O={cx:ce,cy:de,width:le,height:p,angle:a},x=le):(v=!1,re=le),e.vdebug&&f.push({type:"rectangle",cx:ce,cy:de,width:le,height:p,areaFraction:le*p/s,angle:a,insidePoly:v});return[O,A,f]},me=function(e,t){var r,n;return(r=t[0]-e[0])*r+(n=t[1]-e[1])*n},s=function(e,t,r){var n,a,o;return n=(o=t[1]<r[1]?[t,r]:[r,t])[0],a=o[1],e[1]!==a[1]&&e[1]!==n[1]||(e[1]+=Number.MIN_VALUE),!(e[1]>a[1]||e[1]<n[1])&&(!(e[0]>n[0]&&e[0]>a[0])&&(e[0]<n[0]&&e[0]<a[0]||(a[1]-n[1])/(a[0]-n[0])<(e[1]-n[1])/(e[0]-n[0])))},pe=function(e,t){var r,n,a,o,i;for(o=-1,n=t[(i=t.length)-1],a=0;++o<i;)r=n,n=t[o],s(e,r,n)&&a++;return a%2!=0},y=function(e,t,r){var n,a;return 1e-9,n=e[0],a=e[1],!(n<Math.min(t[0],r[0])-1e-9||n>Math.max(t[0],r[0])+1e-9||a<Math.min(t[1],r[1])-1e-9||a>Math.max(t[1],r[1])+1e-9)},m=function(e,t,r,n){var a,o,i,s,l,u,c;return 1e-9,s=e[0]-t[0],u=e[1]-t[1],l=r[0]-n[0],i=s*(c=r[1]-n[1])-u*l,Math.abs(i)<1e-9?null:[((a=e[0]*t[1]-e[1]*t[0])*l-(o=r[0]*n[1]-r[1]*n[0])*s)/i,(a*c-o*u)/i]},c=function(e,t,r,n){var a;return null!=(a=m(e,t,r,n))&&(y(a,e,t)&&y(a,r,n))},he=function(e,t){var r,n,a,o,i,s,l,u;for(i=-1,l=e.length,u=t.length,a=e[l-1];++i<l;)for(r=a,a=e[i],s=-1,o=t[u-1];++s<u;)if(n=o,o=t[s],c(r,a,n,o))return!1;return pe(e[0],t)},l=function(e,t,r){var n,a,o,i;return null==r&&(r=[0,0]),o=e[0]-r[0],i=e[1]-r[1],[(n=Math.cos(t))*o-(a=Math.sin(t))*i+r[0],a*o+n*i+r[1]]},ve=function(e,t,r){var n,a,o,i;for(i=[],n=0,a=e.length;n<a;n++)o=e[n],i.push(l(o,t,r));return i},fe=function(e,t,r){var n,a,o,i,s,l,u,c,d,f,p,h,v,g;for(1e-9,v=(t=[t[0]+1e-9*Math.cos(r),t[1]+1e-9*Math.sin(r)])[0],g=t[1],p=[v+Math.cos(r),g+Math.sin(r)],l=0,Math.abs(p[0]-v)<1e-9&&(l=1),s=-1,a=e[(d=e.length)-1],u=Number.MAX_VALUE,c=Number.MAX_VALUE,i=o=null;++s<d;)n=a,a=e[s],null!=(f=m(t,p,n,a))&&y(f,n,a)&&(h=me(t,f),f[l]<t[l]?h<u&&(u=h,o=f):f[l]>t[l]&&h<c&&(c=h,i=f));return[o,i]}},{"simplify-js":8}],161:[function(e,t,r){t.exports=function(e,t,r){var n,a,o,i;return a={x:0,y:0},e<0&&(e=2*Math.PI+e),"square"===r?(o=Math.PI/180*45,e<=Math.PI?e<Math.PI/2?e<o?(a.x+=t,i=Math.tan(e)*t,a.y+=i):(a.y+=t,n=t/Math.tan(e),a.x+=n):e<Math.PI-o?(a.y+=t,n=t/Math.tan(Math.PI-e),a.x-=n):(a.x-=t,i=Math.tan(Math.PI-e)*t,a.y+=i):e<3*Math.PI/2?e<o+Math.PI?(a.x-=t,i=Math.tan(e-Math.PI)*t,a.y-=i):(a.y-=t,n=t/Math.tan(e-Math.PI),a.x-=n):e<2*Math.PI-o?(a.y-=t,n=t/Math.tan(2*Math.PI-e),a.x+=n):(a.x+=t,i=Math.tan(2*Math.PI-e)*t,a.y-=i)):(a.x+=t*Math.cos(e),a.y+=t*Math.sin(e)),a}},{}],162:[function(e,t,r){var v;v=e("../geom/offset.coffee"),t.exports=function(e){var t,r,n,a,o,i,s,l,u,c,d,f,p,h;if(!e)return[];for(l=[],n=0,o=(e=e.slice(1).slice(0,-1).split(/L|A/)).length;n<o;n++)if(1===(s=(s=e[n]).split(" ")).length)l.push(s[0].split(",").map(function(e){return parseFloat(e)}));else{for(u=l[l.length-1],a=s.pop().split(",").map(function(e){return parseFloat(e)}),c=parseFloat(s.shift().split(",")[0]),h=Math.sqrt(Math.pow(a[0]-u[0],2)+Math.pow(a[1]-u[1],2)),t=Math.acos((c*c+c*c-h*h)/(2*c*c)),"1"===s[1].split(",")[0]&&(t=2*Math.PI-t),d=t/(2*Math.PI)*(c*Math.PI*2)/5,f=Math.atan2(-u[1],-u[0])-Math.PI,r=p=t/d;r<t;)i=v(f+r,c),l.push([i.x,i.y]),r+=p;l.push(a)}return l}},{"../geom/offset.coffee":161}],163:[function(e,t,r){var n,a,o;(n={}).version="1.9.8 - Cornflower",n.repo="https://github.com/alexandersimoes/d3plus/",n.array={comparator:e("./array/comparator.coffee"),contains:e("./array/contains.coffee"),sort:e("./array/sort.coffee"),update:e("./array/update.coffee")},n.client={css:e("./client/css.coffee"),ie:e("./client/ie.js"),pointer:e("./client/pointer.coffee"),prefix:e("./client/prefix.coffee"),rtl:e("./client/rtl.coffee"),scroll:e("./client/scroll.js"),scrollbar:e("./client/scrollbar.coffee"),touch:e("./client/touch.coffee")},n.color={legible:e("./color/legible.coffee"),lighter:e("./color/lighter.coffee"),mix:e("./color/mix.coffee"),random:e("./color/random.coffee"),scale:e("./color/scale.coffee"),sort:e("./color/sort.coffee"),text:e("./color/text.coffee"),validate:e("./color/validate.coffee")},n.data={bestRegress:e("./data/bestRegress.coffee"),lof:e("./data/lof.coffee"),mad:e("./data/mad.coffee")},n.font={sizes:e("./font/sizes.coffee"),validate:e("./font/validate.coffee")},n.form=e("./form/form.js"),n.geom={largestRect:e("./geom/largestRect.coffee"),offset:e("./geom/offset.coffee"),path2poly:e("./geom/path2poly.coffee")},n.network={cluster:e("./network/cluster.coffee"),distance:e("./network/distance.coffee"),normalize:e("./network/normalize.coffee"),shortestPath:e("./network/shortestPath.coffee"),smallestGap:e("./network/smallestGap.coffee"),subgraph:e("./network/subgraph.coffee")},n.number={format:e("./number/format.coffee")},n.object={merge:e("./object/merge.coffee"),validate:e("./object/validate.coffee")},n.string={format:e("./string/format.js"),list:e("./string/list.coffee"),strip:e("./string/strip.js"),title:e("./string/title.coffee")},n.textwrap=e("./textwrap/textwrap.coffee"),n.tooltip={create:e("./tooltip/create.js"),move:e("./tooltip/move.coffee"),remove:e("./tooltip/remove.coffee")},n.util={buckets:e("./util/buckets.coffee"),child:e("./util/child.coffee"),closest:e("./util/closest.coffee"),copy:e("./util/copy.coffee"),d3selection:e("./util/d3selection.coffee"),dataurl:e("./util/dataURL.coffee"),uniques:e("./util/uniques.coffee")},n.viz=e("./viz/viz.coffee"),o=e("./client/css.coffee"),a=e("./core/console/print.coffee"),o("d3plus.css")&&a.warning("d3plus.css has been deprecated, you do not need to load this file.",n.repo+"releases/tag/v1.4.0"),"undefined"!=typeof window&&(window.d3plus=n),t.exports=n},{"./array/comparator.coffee":32,"./array/contains.coffee":33,"./array/sort.coffee":34,"./array/update.coffee":35,"./client/css.coffee":36,"./client/ie.js":37,"./client/pointer.coffee":38,"./client/prefix.coffee":39,"./client/rtl.coffee":40,"./client/scroll.js":41,"./client/scrollbar.coffee":42,"./client/touch.coffee":43,"./color/legible.coffee":44,"./color/lighter.coffee":45,"./color/mix.coffee":46,"./color/random.coffee":47,"./color/scale.coffee":48,"./color/sort.coffee":49,"./color/text.coffee":50,"./color/validate.coffee":51,"./core/console/print.coffee":52,"./data/bestRegress.coffee":99,"./data/lof.coffee":100,"./data/mad.coffee":101,"./font/sizes.coffee":102,"./font/validate.coffee":103,"./form/form.js":104,"./geom/largestRect.coffee":160,"./geom/offset.coffee":161,"./geom/path2poly.coffee":162,"./network/cluster.coffee":164,"./network/distance.coffee":165,"./network/normalize.coffee":166,"./network/shortestPath.coffee":167,"./network/smallestGap.coffee":168,"./network/subgraph.coffee":169,"./number/format.coffee":170,"./object/merge.coffee":171,"./object/validate.coffee":172,"./string/format.js":173,"./string/list.coffee":174,"./string/strip.js":175,"./string/title.coffee":176,"./textwrap/textwrap.coffee":200,"./tooltip/create.js":201,"./tooltip/move.coffee":202,"./tooltip/remove.coffee":203,"./util/buckets.coffee":204,"./util/child.coffee":205,"./util/closest.coffee":206,"./util/copy.coffee":207,"./util/d3selection.coffee":208,"./util/dataURL.coffee":209,"./util/uniques.coffee":210,"./viz/viz.coffee":333}],164:[function(e,t,r){var S;S=e("./normalize.coffee"),t.exports=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F;if(f=[],null==t&&(t={}),(null==t.nodes||"object"!=typeof t.nodes)&&(e=(O=S(e,t))[0],null===(t=O[1])))return null;for(h in t.distance,A=t.nodeid,F=t.startpoint,d=t.endpoint,M={},j=t.nodes)M[h]={node:j[h].node,degree:0};for(b={},p=w=0,y=e.length;p<y;p++)r=A(F(c=e[p])),n=A(d(c)),r in b||(b[r]={}),n in b||(b[n]={}),n in b[r]||(b[r][n]=0,b[n][r]=0,w++,M[r].degree+=1,M[n].degree+=1);for(h in s={},0,M)z=M[h],s[h]={score:z.degree/(2*w),nodes:[h]};for(r in b)for(n in b[r])b[r][n]=1/(2*w)-M[r].degree*M[n].degree/(4*w*w);for(v=0;v<1e3;){for(r in u=-1,k=_=void 0,b)for(n in b[r])b[r][n]>u&&(u=b[r][n],_=r,k=n);if(u<0)break;for(m in b[_])m!==k&&(m in b[k]?b[k][m]+=b[_][m]:b[k][m]=b[_][m]-2*s[k].score*s[m].score,b[m][k]=b[k][m]),delete b[m][_];for(m in b[k])m in b[_]||m===k||(b[k][m]-=2*s[_].score*s[m].score,b[m][k]=b[k][m]);for(g=0,x=(E=s[_].nodes).length;g<x;g++)z=E[g],s[k].nodes.push(z);s[k].score+=s[_].score,t.vdebug&&f.push({type:"merge",father:k,child:_,nodes:s[k].nodes}),delete s[_],delete b[_],u,v++}return(i=function(){var e;for(a in e=[],s)l=s[a],e.push([a,l.nodes.length]);return e}()).sort(function(e,t){return t[1]-e[1]}),[function(){var e,t,r;for(r=[],e=0,t=i.length;e<t;e++)o=i[e],r.push(s[o[0]].nodes);return r}(),f]}},{"./normalize.coffee":166}],165:[function(e,t,r){t.exports=function(e,t){var r,n;return e instanceof Array||(e=[e.x,e.y]),t instanceof Array||(t=[t.x,t.y]),r=Math.abs(e[0]-t[0]),n=Math.abs(e[1]-t[1]),Math.sqrt(r*r+n*n)}},{}],166:[function(e,t,r){var I;I=e("../core/console/print.coffee"),t.exports=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P;if(E=t.source,S=t.target,o=t.directed,i=t.distance,A=t.nodeid,F=t.startpoint,u=t.endpoint,r=t.K,T=t.vdebug,o||(o=!1),null==r&&(r=1),null==A?A=function(e){return e}:"string"==typeof A&&(B=A,A=function(e){return e[B]}),null!=E&&"object"==typeof E&&(E=A(E)),null!=S&&"object"==typeof S&&(S=A(S)),null==F?F=function(e){return e.source}:"string"==typeof F&&(C=F,F=function(e){return e[C]}),null==u?u=function(e){return e.target}:"string"==typeof u&&(q=u,u=function(e){return e[q]}),null==i)i=function(e){return 1};else if("number"==typeof i)P=i,i=function(e){return P};else if("string"==typeof i)N=i,i=function(e){return e[N]};else if(i instanceof Array){for(l={},d=g=0,x=e.length;g<x;d=++g)s=e[d],n=A(F(s)),a=A(u(s)),l[n+"_"+a]=i[d];i=function(e){return n=A(F(e)),a=A(u(e)),l[n+"_"+a]}}for(j={},m=0,b=e.length;m<b;m++){for(s=e[m],k=F(s),z=u(s),h=A(k),v=A(z),y=0,w=(M=[k,z]).length;y<w;y++)(f=A(_=M[y]))in j||(j[f]={node:_,outedges:[]});j[h].outedges.push(s),o||j[v].outedges.push(s)}return c=null,0===e.length?c="The length of edges is 0":r<0?c="K can not have negative value":null==i(e[0])?c="Check the distance function/attribute":null==F(e[0])?c="Check the startpoint function/attribute":null==u(e[0])?c="Check the endpoint function/attribute":null==(p=A(F(e[0])))||"string"!=(O=typeof p)&&"number"!==O?c="Check the nodeid function/attribute":null==E||E in j?null==S||S in j||(c="The target is not in the graph"):c="The source is not in the graph",null!=c?(I.error(c),null):[e,{source:E,target:S,directed:o,distance:i,nodeid:A,startpoint:F,endpoint:u,K:r,nodes:j,vdebug:T}]}},{"../core/console/print.coffee":52}],167:[function(e,t,r){var S,T;S=e("heap"),T=e("./normalize.coffee"),t.exports=function(t,e,r){var n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F;if(null==r&&(r={}),r.source=e,(null==r.nodes||"object"!=typeof r.nodes)&&(_=T(t,r),t=_[0],null===(r=_[1])))return null;for(h in e=r.source,O=r.target,s=r.directed,l=r.distance,x=r.nodeid,M=r.startpoint,c=r.endpoint,n=r.K,b=r.nodes)b[h].count=0;for(f=new S(function(e,t){return e.distance-t.distance}),F={},null==O&&(F[e]=!0),f.push({edge:null,target:e,distance:0}),y=0,j=[];!f.empty()&&(y=Math.max(y,f.size()),b[E=(w=f.pop()).target].count++,null==O?j.push(w):E===O&&j.push(w),j.length!==n);)if(b[E].count<=n)for(p=0,g=(k=b[E].outedges).length;p<g;p++){if(a=x(M(u=k[p])),i=x(c(u)),s||i!==E||(a=(z=[i,a])[0],i=z[1]),null==O){if(F[i])continue;F[i]=!0}o=w.distance+l(u),f.push({edge:u,previous:w,target:i,distance:o})}for(d=function(e){for(t=[];null!=e.edge;)t.push(e.edge),e=e.previous;return t.reverse()},v=0,m=j.length;v<m;v++)A=j[v],null!=O&&(delete A.target,A.edges=d(A)),delete A.edge,delete A.previous;return j}},{"./normalize.coffee":166,heap:3}],168:[function(e,t,r){var d;d=e("./distance.coffee"),t.exports=function(e,u){var c;return u||(u={}),c=[],d3.geom.quadtree().x(function(e){return u.accessor?u.accessor(e)[0]:e[0]}).y(function(e){return u.accessor?u.accessor(e)[1]:e[1]})(e).visit(function(e){var t,r,n,a,o,i,s,l;if(!e.leaf)for(t=0,n=(s=e.nodes).length;t<n;t++)if((o=s[t])&&o.point)if(u.origin)c.push(d(o,u));else for(r=0,a=(l=e.nodes).length;r<a;r++)(i=l[r])&&i.point&&i.point!==o.point&&c.push(d(o,i));return!1}),u.all?c.sort(function(e,t){return e-t}):d3.min(c)}},{"./distance.coffee":165}],169:[function(e,t,r){var i;i=e("./normalize.coffee"),t.exports=function(n,e,t){var d,f,p,h,a,v,r,g,m,o,y,x;return null==t&&(t={}),t.source=e,null!=t.nodes&&"object"==typeof t.nodes||(o=i(n,t),n=o[0],null!==(t=o[1]))?(e=t.source,p=t.directed,h=t.distance,g=t.nodeid,y=t.startpoint,v=t.endpoint,d=t.K,m=t.nodes,(x={})[e]=!0,(f=function(e,t){var r,n,a,o,i,s,l,u,c;for(c=[],o=0,i=(l=m[e].outedges).length;o<i;o++)a=l[o],r=g(y(a)),n=g(v(a)),p||n!==e||(r=(u=[n,r])[0],n=u[1]),n in x?c.push(void 0):(s=t+h(a))<=d?(x[n]=!0,c.push(f(n,s))):c.push(void 0);return c})(e,0),{nodes:function(){var e;for(r in e=[],x)e.push(m[r].node);return e}(),edges:function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)a=n[e],g(y(a))in x&&g(v(a))in x&&r.push(a);return r}()}):null}},{"./normalize.coffee":166}],170:[function(e,t,r){var p;p=e("../core/locale/languages/en_US.coffee"),t.exports=function(e,t){var r,n,a,o,i,s,l,u,c,d,f;return null==e||!1===e?"":(t||(t={}),d=(s="locale"in t?t.locale:p).time.slice(),n=d3.locale(s.format),t||(t={}),f=t.vars||{},a=t.key,o=!("labels"in t)||t.labels,i=e.toString().split(".")[0].length,f.time&&f.time.value&&d.push(f.time.value),"string"==typeof a&&0<=d.indexOf(a.toLowerCase())?l=e:"share"===a?(l=0===e?0:100<=e?n.numberFormat(",f")(e):99<e?n.numberFormat(".3g")(e):n.numberFormat(".2g")(e),l+="%"):e<10&&-10<e?((u=1)<(i=e.toString().split(".")).length&&(u=d3.min([parseFloat(i[1]).toString().length,2]),-1<e&&e<1||(u+=1+(i[1].length-parseFloat(i[1]).toString().length))),l=n.numberFormat("."+u+"g")(e)):3<i?(c=(c=d3.formatPrefix(e).symbol).replace("G","B"),e=d3.formatPrefix(e).scale(e),e=(e=n.numberFormat(".3g")(e)).replace(s.format.decimal,"."),l=(e=(e=parseFloat(e)+"").replace(".",s.format.decimal))+c):l=3===i?n.numberFormat(",f")(e):0===e?0:e===parseInt(e,10)?n.numberFormat(".2")(e):n.numberFormat(".3g")(e),2<l.length&&""+l.indexOf(".0")===l.length-2&&(l=l.slice(0,l.length-2)),o&&a&&"format"in f&&a in f.format.affixes.value?(r=f.format.affixes.value[a])[0]+l+r[1]:l)}},{"../core/locale/languages/en_US.coffee":70}],171:[function(e,t,r){var s,l;s=e("../util/d3selection.coffee"),l=e("./validate.coffee"),t.exports=function(e,t){var i,r;return i=function(e,t,r){var n,a,o;for(n in a=[],e)void 0!==(o=e[n])?!r&&l(o)?("object"!=typeof t[n]&&(t[n]={}),a.push(i(o,t[n],0===n.indexOf("d3plus")))):!s(o)&&o instanceof Array?a.push(t[n]=o.slice(0)):a.push(t[n]=o):a.push(void 0);return a},r={},e&&i(e,r),t&&i(t,r),r}},{"../util/d3selection.coffee":208,"./validate.coffee":172}],172:[function(e,t,r){t.exports=function(e){return e&&e.constructor===Object}},{}],173:[function(e,t,r){t.exports=function(){var n=Array.prototype.slice.call(arguments),a=n.shift();return a.unkeyed_index=0,a.replace(/\{(\w*)\}/g,function(e,t){if(""===t&&(t=a.unkeyed_index,a.unkeyed_index++),t==+t)return"undefined"!==n[t]?n[t]:e;for(var r=0;r<n.length;r++)if("object"==typeof n[r]&&void 0!==n[r][t])return n[r][t];return e}.bind(a))}},{}],174:[function(e,t,r){var o,i;o=e("./format.js"),i=e("../core/locale/languages/en_US.coffee").ui,t.exports=function(e,t,r,n){var a;return e instanceof Array?(e=e.slice(0),t||(t=i.and),n||(n=i.moreText),2===e.length?e.join(" "+t+" "):(r&&e.length>r&&(a=e.length-r+1,(e=e.slice(0,r-1))[r-1]=o(n,a)),1<e.length&&(e[e.length-1]=t+" "+e[e.length-1]),e.join(", "))):e}},{"../core/locale/languages/en_US.coffee":70,"./format.js":173}],175:[function(e,t,r){t.exports=function(e){var n=["!","@","#","$","%","^","&","*","(",")","[","]","{","}",".",",","/","\\","|","'",'"',";",":","<",">","?","=","+"],a=[[/[\300-\306]/g,"A"],[/[\340-\346]/g,"a"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\322-\330]/g,"O"],[/[\362-\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\307]/g,"C"],[/[\347]/g,"c"]];return""+(e+="").replace(/[^A-Za-z0-9\-_]/g,function(e){if(" "===e)return"_";if(0<=n.indexOf(e))return"";for(var t=e,r=0;r<a.length;r++)if(new RegExp(a[r][0]).test(e)){t=a[r][1];break}return t})}},{}],176:[function(e,t,r){var s;s=e("../core/locale/languages/en_US.coffee"),t.exports=function(n,e){var a,o,t,i;return n?(e||(e={}),e.key,"."===n.charAt(n.length-1)?n.charAt(0).toUpperCase()+n.substr(1):(t="locale"in this?this.locale.value:s,i=t.lowercase.map(function(e){return e.toLowerCase()}),o=(o=t.uppercase).concat(o.map(function(e){return e+"s"})),a=o.map(function(e){return e.toLowerCase()}),n.replace(/[^\s!-#%&(-\x2A,-:;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]*/g,function(e,t){var r;return e?0<=(r=a.indexOf(e.toLowerCase()))?o[r]:0<=i.indexOf(e.toLowerCase())&&0!==t&&t!==n.length-1?e.toLowerCase():e.charAt(0).toUpperCase()+e.substr(1).toLowerCase():""}))):""}},{"../core/locale/languages/en_US.coffee":70}],177:[function(e,t,r){var n,a;n=e("./foreign.coffee"),a=e("./tspan.coffee"),t.exports=function(e){e.text.html.value?n(e):a(e)}},{"./foreign.coffee":178,"./tspan.coffee":181}],178:[function(e,t,r){t.exports=function(e){var t,r,n,a,o;n=(o=e.container.value).attr("font-family")||o.style("font-family"),t=e.align.value||o.attr("text-anchor")||o.style("text-anchor"),r=o.attr("fill")||o.style("fill"),a=o.attr("opacity")||o.style("opacity"),t="end"===t?"right":"middle"===t?"center":"left",d3.select(o.node().parentNode).append("foreignObject").attr("width",e.width.value+"px").attr("height",e.height.value+"px").attr("x","0px").attr("y","0px").append("xhtml:div").style("font-family",n).style("font-size",e.size.value[1]+"px").style("color",r).style("text-align",t).style("opacity",a).text(e.text.current)}},{}],179:[function(e,t,r){t.exports=function(e){var t,r,n,a,o,i,s,l,u,c;if(i=(a=(r=e.container.value).node().previousElementSibling)?a.tagName.toLowerCase():"",a&&(a=d3.select(a)),e.container.x=e.x.value||parseFloat(r.attr("x"),10),e.container.y=e.y.value||parseFloat(r.attr("y"),10),a&&(0<=e.shape.accepted.indexOf(i)&&e.self.shape(i),"rect"===i?(u=parseFloat(a.attr("x"),10)||0,c=parseFloat(a.attr("y"),10)||0,!1===e.padding.value&&(t=Math.abs(u-e.container.x))&&e.self.padding(t),e.container.x||(e.container.x=u+e.padding.value),e.container.y||(e.container.y=c+e.padding.value),e.width.value||(l=parseFloat(a.attr("width")),e.self.width(l)),e.height.value||(n=parseFloat(a.attr("height")),e.self.height(n))):"circle"===i?(o=parseFloat(a.attr("r"),10),u=parseFloat(a.attr("cx"),10)||0,u-=o,c=parseFloat(a.attr("cy"),10)||0,c-=o,!1===e.padding.value&&(t=Math.abs(u-e.container.x))&&e.self.padding(t),e.container.x||(e.container.x=u+e.padding.value),e.container.y||(e.container.y=c+e.padding.value),e.width.value||e.self.width(2*o,10),e.height.value||e.self.height(2*o,10)):(e.width.value||e.self.width(500),e.height.value||e.self.height(500))),e.container.x||(e.container.x=0),e.container.y||(e.container.y=0),e.width.inner=e.width.value-2*e.padding.value,e.height.inner=e.height.value-2*e.padding.value,s=r.attr("font-size")||r.style("font-size"),s=parseFloat(s,10),e.container.fontSize=s,e.container.dy=parseFloat(r.attr("dy"),10),!e.size.value)return e.resize.value?e.self.size([4,80]):e.self.size([s/2,s])}},{}],180:[function(e,t,r){t.exports=function(e){var t;if(e.text.value||(t=e.container.value.text())&&(0<=t.indexOf("tspan")&&(t.replace(/\<\/tspan\>\<tspan\>/g," "),t.replace(/\<\/tspan\>/g,""),t.replace(/\<tspan\>/g,"")),t=(t=t.replace(/(\r\n|\n|\r)/gm,"")).replace(/^\s+|\s+$/g,""),e.self.text(t)),e.text.value instanceof Array?e.text.phrases=e.text.value.filter(function(e){return 0<=["string","number"].indexOf(typeof e)}):e.text.phrases=[e.text.value+""],!e.align.value)return e.container.align=e.container.value.style("text-anchor")||e.container.value.attr("text-anchor")}},{}],181:[function(e,t,r){var T;T=e("../../client/rtl.coffee"),t.exports=function(i){var e,s,r,t,n,l,u,o,c,a,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S;return d=function(e){return(!h||e?i.container.value.append("tspan"):i.container.value.insert("tspan","tspan")).attr("x",O+"px").attr("dy",s+"px").style("baseline-shift","0%").attr("dominant-baseline","alphabetic")},a=-90===i.rotate.value||90===i.rotate.value,A=a?i.height.inner:i.width.inner,l=a?i.width.inner:i.height.inner,E="end"===(e="circle"===i.shape.value?"middle":i.align.value||i.container.align||"start")||"start"===e&&T?A:"middle"===e?A/2:0,z=i.valign.value||"top",O=i.container.x+E,t=i.resize.value?i.size.value[1]:i.container.fontSize||i.size.value[0],s=i.container.dy||1.1*t,j=p=w=null,h=!1,S=0,"circle"===i.shape.value&&("middle"===z?S=l/s%1*s/2:"end"===z&&(S=l/s%1*s)),i.container.value.attr("text-anchor",e).attr("font-size",t+"px").style("font-size",t+"px").attr("x",i.container.x).attr("y",i.container.y),k=function(){if(w.remove(),h?(u++,w=i.container.value.select("tspan")):(u--,w=d3.select(i.container.value.node().lastChild)),!w.empty())return j=w.text().match(/[^\s-]+-?/g),r()},o=function(){var e;return"circle"===i.shape.value?(l/2<(e=(u-1)*s+S)&&(e+=s),2*Math.sqrt(e*(A/2*2-e))):A},r=function(){var e,t;return j&&j.length?(e=(t=j.pop()).charAt(t.length-1),1===t.length&&0<=i.text.split.value.indexOf(t)?r():(0<=i.text.split.value.indexOf(e)&&(t=t.substr(0,t.length-1)),w.text(j.join(" ")+" "+t+"..."),w.node().getComputedTextLength()>o()?r():void 0)):k()},f=function(e){var t,r,n,a;if(t=w.text(),a="",h){if(" "===(a=i.text.current.charAt(i.text.current.length-p.length-1)))for(n="",r=2;" "===a;)n+=" ",a=i.text.current.charAt(i.text.current.length-p.length-r),r++;else n="";p=e+n+p,w.text(e+n+t)}else{if(" "===(a=i.text.current.charAt(p.length)))for(n="",r=1;" "===a;)n+=" ",a=i.text.current.charAt(p.length+r),r++;else n="";p+=n+e,w.text(t+n+e)}if(Math.floor(w.node().getComputedTextLength())>o()||"\n"===a)return w.text(t),t.length&&(w=d()),w.text(e),h?u--:u++},b=1,c=u=null,(M=function(){var e,t,r,n,a,o;for(i.container.value.text("").html(""),j=i.text.words.slice(),h&&j.reverse(),w=d(!(p="")),u=b,t=0,r=j.length;t<r;t++){if(o=j[t],l<u*s){k();break}for(f(o),a=!0;a;){for(n=i.text.current.charAt(p.length),e=1;" "===n;)n=i.text.current.charAt(p.length+e),e++;(a=0<=i.text.split.value.indexOf(n))&&f(n)}}return l<u*s&&k(),c=Math.abs(u-b)+1})(),c=0,i.container.value.selectAll("tspan").each(function(){if(d3.select(this).text().length)return c++}),"circle"===i.shape.value&&s<(x=l-c*s)&&("middle"===z?(b=1+(x/s/2>>0),M()):"bottom"===z&&(h=!0,b=l/s>>0,M())),c=0,i.container.value.selectAll("tspan").each(function(){if(d3.select(this).text().length)return c++}),"top"===z?F=0:(n=c*s,F="middle"===z?l/2-n/2:l-n),_="translate(0,"+(F-=.2*s)+")",180===i.rotate.value||-180===i.rotate.value?(m=i.container.x+A/2,y=i.container.y+l/2):(v=i.rotate.value<0?A:l,m=i.container.x+v/2,y=i.container.y+v/2),g="rotate("+i.rotate.value+", "+m+", "+y+")",i.container.value.attr("transform",g+_)}},{"../../client/rtl.coffee":40}],182:[function(e,t,r){var y,x,n,b;y=e("./flow.coffee"),x=e("../../font/sizes.coffee"),b=function(e){var t;e.text.phrases.length&&(e.text.current=e.text.phrases.shift()+"",e.text.words=e.text.current.match(e.text.split.break),(t=e.text.current.charAt(0))!==e.text.words[0].charAt(0)&&(e.text.words[0]=t+e.text.words[0]),e.container.value.html(""),e.resize.value?n(e):y(e))},t.exports=b,n=function(r){var e,t,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m;for(m=[],s=0;s<r.text.words.length;)e=s===r.text.words.length-1?"":" ",m.push(r.text.words[s]+e),s++;v=(c=-90===r.rotate.value||90===r.rotate.value)?r.height.inner:r.width.inner,o=c?r.width.inner:r.height.inner,d=Math.floor(r.size.value[1]),l="circle"===r.shape.value?.75*v:v,p=x(m,{"font-size":d+"px"},{parent:r.container.value}),u=d3.max(p,function(e){return e.width}),t=1.165+v/o*.11,h=d3.sum(p,function(e){var t;return t=r.container.dy||1.2*d,e.width*t})*t,a="circle"===r.shape.value?Math.PI*Math.pow(v/2,2):l*o,(l<u||a<h)&&(n=Math.sqrt(a/h),g=l/u,f=d3.min([n,g]),d=d3.max([r.size.value[0],Math.floor(d*f)])),(i=Math.floor(.8*o))<d&&(d=i),u*(d/r.size.value[1])<=l?(d!==r.size.value[1]&&r.self.size([r.size.value[0],d]),y(r)):b(r)}},{"../../font/sizes.coffee":102,"./flow.coffee":177}],183:[function(e,t,r){t.exports={accepted:[!1,"start","middle","end","left","center","right"],process:function(e){var t;return 0<=(t=["left","center","right"].indexOf(e))&&(e=this.accepted[t+1]),e},value:!1}},{}],184:[function(e,t,r){arguments[4][108][0].apply(r,arguments)},{dup:108}],185:[function(e,t,r){var n;n=e("../../util/d3selection.coffee"),t.exports={accepted:[!1,Array,Object,String],element:!1,id:"default",process:function(e){return!1!==e&&(n(e)?e:e instanceof Array?d3.select(e[0][0]):(this.selector=e,d3.select(e)))},value:!1}},{"../../util/d3selection.coffee":208}],186:[function(e,t,r){arguments[4][112][0].apply(r,arguments)},{dup:112}],187:[function(e,t,r){var a,o;a=e("../../core/console/print.coffee"),o=e("../../string/format.js"),t.exports={accepted:[void 0],process:function(e,t){var r,n;return!1===this.initialized||(!1===t.container.value?(n=t.format.locale.value.dev.setContainer,a.warning(n,"container")):t.container.value.empty()?(n=t.format.locale.value.dev.noContainer,r=t.container.selector||"",a.warning(o(n,'"'+r+'"'),"container")):(t.dev.value&&a.time("total draw time"),t.container.value.call(t.self))),e},value:void 0}},{"../../core/console/print.coffee":52,"../../string/format.js":173}],188:[function(e,t,r){var n,a;n=e("../../core/locale/locale.coffee"),a=e("../../object/merge.coffee"),t.exports={accepted:[Function,String],locale:{accepted:function(){return d3.keys(n)},process:function(e){var t;return"en_US",t=n.en_US,"en_US"!==e&&(t=a(t,n[e])),this.language=e,t},value:"en_US"},process:function(e,t){if(this.initialized&&"string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},value:"en_US"}},{"../../core/locale/locale.coffee":79,"../../object/merge.coffee":171}],189:[function(e,t,r){t.exports={accepted:[!1,Number],value:!1}},{}],190:[function(e,t,r){arguments[4][189][0].apply(r,arguments)},{dup:189}],191:[function(e,t,r){arguments[4][112][0].apply(r,arguments)},{dup:112}],192:[function(e,t,r){t.exports={accepted:[-180,-90,0,90,180],value:0}},{}],193:[function(e,t,r){t.exports={accepted:["circle","square"],value:!1}},{}],194:[function(e,t,r){t.exports={accepted:[Array,!1],value:!1}},{}],195:[function(e,t,r){t.exports={accepted:[!1,Array,Number,String],html:{accepted:[Boolean],value:!1},init:function(e){var t;return t=this.split.value,this.split.break=new RegExp("[^\\s\\"+t.join("\\")+"]+\\"+t.join("?\\")+"?","g"),!1},split:{accepted:[Array],process:function(e){return this.break=new RegExp("[^\\s\\"+e.join("\\")+"]+\\"+e.join("?\\")+"?","g"),e},value:["-","/",";",":","&"]}}},{}],196:[function(e,t,r){t.exports={accepted:[!1,"top","middle","bottom"],value:!1}},{}],197:[function(e,t,r){arguments[4][189][0].apply(r,arguments)},{dup:189}],198:[function(e,t,r){arguments[4][189][0].apply(r,arguments)},{dup:189}],199:[function(e,t,r){arguments[4][189][0].apply(r,arguments)},{dup:189}],200:[function(e,t,r){var n,a,o,i,s;n=e("../core/methods/attach.coffee"),o=e("./helpers/parseSize.coffee"),a=e("../core/console/print.coffee"),i=e("./helpers/parseText.coffee"),s=e("./helpers/wrap.coffee"),t.exports=function(){var t;return n(t={self:function(e){return e.each(function(){o(t),t.size.value[0]<=t.height.inner?(i(t),s(t)):t.container.value.html(""),t.dev.value&&a.timeEnd("total draw time")}),t.self}},{align:e("./methods/align.coffee"),config:e("./methods/config.coffee"),container:e("./methods/container.coffee"),dev:e("./methods/dev.coffee"),draw:e("./methods/draw.coffee"),format:e("./methods/format.coffee"),height:e("./methods/height.coffee"),padding:e("./methods/padding.coffee"),resize:e("./methods/resize.coffee"),rotate:e("./methods/rotate.coffee"),text:e("./methods/text.coffee"),shape:e("./methods/shape.coffee"),size:e("./methods/size.coffee"),valign:e("./methods/valign.coffee"),width:e("./methods/width.coffee"),x:e("./methods/x.coffee"),y:e("./methods/y.coffee")}),t.self}},{"../core/console/print.coffee":52,"../core/methods/attach.coffee":80,"./helpers/parseSize.coffee":179,"./helpers/parseText.coffee":180,"./helpers/wrap.coffee":182,"./methods/align.coffee":183,"./methods/config.coffee":184,"./methods/container.coffee":185,"./methods/dev.coffee":186,"./methods/draw.coffee":187,"./methods/format.coffee":188,"./methods/height.coffee":189,"./methods/padding.coffee":190,"./methods/resize.coffee":191,"./methods/rotate.coffee":192,"./methods/shape.coffee":193,"./methods/size.coffee":194,"./methods/text.coffee":195,"./methods/valign.coffee":196,"./methods/width.coffee":197,"./methods/x.coffee":198,"./methods/y.coffee":199}],201:[function(e,t,r){var M=e("../core/locale/languages/en_US.coffee"),O=e("../client/pointer.coffee"),E=e("../color/legible.coffee"),F=e("./move.coffee"),S=e("../client/prefix.coffee"),T=e("../client/rtl.coffee"),B=e("./remove.coffee"),C=e("../client/scroll.js"),q=e("../client/scrollbar.coffee"),N=e("../string/list.coffee"),P=e("../color/text.coffee");function I(){d3.selectAll("div.d3plus_tooltip_data_desc").style("height","0px"),d3.selectAll("div.d3plus_tooltip_data_help").style("background-color","#ccc")}t.exports=function(d){var e=d.fullscreen?250:200,f=S();d.width=d.width||e,d.max_width=d.max_width||386,d.id=d.id||"default",d.size=d.fullscreen||d.html?"large":"small",d.offset=d.offset||0,d.arrow_offset=d.arrow?8:0,d.x=d.x||0,d.y=d.y||0,d.parent=d.parent||d3.select("body"),d.curtain=d.curtain||"#fff",d.curtainopacity=d.curtainopacity||.8,d.background=d.background||"#fff",d.fontcolor=d.fontcolor||"#444",d.fontfamily=d.fontfamily||"sans-serif",d.fontweight=d.fontweight||"normal",d.fontsize=d.fontsize||"12px",d.style=d.style||"default",d.zindex="small"==d.size?2e3:500,d.locale=d.locale||M,d.stacked=d.stacked||!1;var t=d.parent?d.parent.node().offsetHeight||d.parent.node().getBoundingClientRect().height:0;if(d.iconsize||(d.iconsize="small"==d.size?22:50),d.parent.node()===document.body){d.limit=[window.innerWidth+C.x(),window.innerHeight+C.y()];var r=q();document.body.scrollHeight>window.innerHeight&&(d.limit[0]-=r)}else d.limit=[parseFloat(d.parent.style("width"),10),parseFloat(d.parent.style("height"),10)];if(d.title instanceof Array){var n=d.locale.ui.and,a=d.locale.ui.more;d.title=N(d.title,n,3,a)}if(B(d.id),d.anchor={},d.fullscreen)d.anchor.x="center",d.anchor.y="center",d.x=d.parent?d.parent.node().offsetWidth/2:window.innerWidth/2,d.y=d.parent?t/2:window.innerHeight/2;else if(d.align){var o=d.align.split(" ");d.anchor.y=o[0],o[1]?d.anchor.x=o[1]:d.anchor.x="center"}else d.anchor.x="center",d.anchor.y="top";var i=d.width-30;if(d.fullscreen)d.parent.append("div").attr("id","d3plus_tooltip_curtain_"+d.id).attr("class","d3plus_tooltip_curtain").style("background-color",d.curtain).style("opacity",d.curtainopacity).style("position","absolute").style("z-index",499).style("top","0px").style("right","0px").style("bottom","0px").style("left","0px").on(O.click,function(){B(d.id)});var s=d.parent.append("div").datum(d).attr("id","d3plus_tooltip_id_"+d.id).attr("class","d3plus_tooltip d3plus_tooltip_"+d.size).style("color",d.fontcolor).style("font-family",d.fontfamily).style("font-weight",d.fontweight).style("font-size",d.fontsize+"px").style(f+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").on(O.out,I);d.max_height&&s.style("max-height",d.max_height+"px"),d.fixed?(s.style("z-index",500),d.mouseevents=!0):s.style("z-index",2e3);var l=s.append("div").datum(d).attr("class","d3plus_tooltip_container").style("background-color",d.background).style("padding","6px");if(d.fullscreen&&d.html&&!d.stacked){c=d.parent?.75*d.parent.node().offsetWidth:.75*window.innerWidth,A=d.parent?.75*t:.75*window.innerHeight,l.style("width",c+"px").style("height",A+"px");var u=l.append("div").attr("class","d3plus_tooltip_body").style("padding-right","6px").style("display","inline-block").style("z-index",1).style("width",d.width+"px")}else{if("auto"==d.width){var c="auto";l.style("max-width",d.max_width+"px")}else c=d.width-14+"px";u=l.style("width",c)}if(d.title||d.icon)var p=u.append("div").attr("class","d3plus_tooltip_header").style("position","relative").style("z-index",1);if(d.fullscreen){s.append("div").attr("class","d3plus_tooltip_close").style("background-color",d.color).style("color",P(d.color)).style("position","absolute").style(f+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)").style("font-size","20px").style("height","18px").style("line-height","14px").style("text-align","center").style("right","16px").style("top","-10px").style("width","18px").style("z-index",10).html("&times;").on(O.over,function(){d3.select(this).style("cursor","pointer").style(f+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.5)")}).on(O.out,function(){d3.select(this).style("cursor","auto").style(f+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)")}).on(O.click,function(){B(d.id)});d3.select("body").on("keydown.esc_"+d.id,function(){27===d3.event.keyCode&&(B(d.id),d3.select("body").on("keydown.esc_"+d.id,null))})}if(d.mouseevents){if(!0!==d.mouseevents){var h=d3.select(d.mouseevents).on(O.out),v=function(){var e=d3.event.toElement||d3.event.relatedTarget;if(e)var t=0==("string"==typeof e.className?e.className:e.className.baseVal).indexOf("d3plus_tooltip");else t=!1;e&&(g(s.node(),e)||g(d.mouseevents,e)||t)||(h(d3.select(d.mouseevents).datum()),I(),d3.select(d.mouseevents).on(O.out,h))},g=function(e,t){for(var r=t.parentNode;null!==r;){if(r==e)return!0;r=r.parentNode}return!1};d3.select(d.mouseevents).on(O.out,v),s.on(O.out,v);var m=d3.select(d.mouseevents).on(O.move);m&&s.on(O.move,m)}}else s.style("pointer-events","none");if(d.arrow)s.append("div").attr("class","d3plus_tooltip_arrow").style("background-color",d.background).style(f+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("bottom","-5px").style("height","10px").style("left","50%").style("margin-left","-5px").style("width","10px").style(f+"transform","rotate(45deg)").style("z-index",-1);if(d.icon){var y=p.append("div").attr("class","d3plus_tooltip_icon").style("width",d.iconsize+"px").style("height",d.iconsize+"px").style("z-index",1).style("background-position","50%").style("background-size","100%").style("background-image","url("+d.icon+")").style("display","inline-block").style("margin","0px 3px 3px 0px");"knockout"==d.style&&y.style("background-color",d.color),i-=y.node().offsetWidth}if(d.title){var x=d.max_width-6;d.icon&&(x-=d.iconsize+6),x+="px";p.append("div").attr("class","d3plus_tooltip_title").style("max-width",x).style("color",d.icon?d.fontcolor:E(d.color)).style("vertical-align","top").style("width",i+"px").style("display","inline-block").style("overflow","hidden").style("text-overflow","ellipsis").style("word-wrap","break-word").style("z-index",1).style("font-size","large"===d.size?"18px":"16px").style("line-height","large"===d.size?"20px":"17px").style("padding","large"===d.size?"3px 6px":"3px").text(d.title)}if(d.description)u.append("div").attr("class","d3plus_tooltip_description").style("font-size","12px").style("padding","6px").text(d.description);if(d.data||d.html&&!d.fullscreen)var b=u.append("div").attr("class","d3plus_tooltip_data_container").style("overflow-y","auto").style("z-index",-1);if(d.data){var w=0,_={},k=null;d.data.forEach(function(e,t){e.group&&k!=e.group&&(k=e.group,b.append("div").attr("class","d3plus_tooltip_data_title").style("font-size","12px").style("font-weight","bold").style("padding","6px 3px 0px 3px").text(e.group));var r=b.append("div").attr("class","d3plus_tooltip_data_block").style("font-size","12px").style("padding","3px 6px").style("position","relative").datum(e);!0===e.highlight?r.style("color",E(d.color)):(e.allColors||e.highlight!==d.color)&&r.style("color",E(e.highlight));var n=r.append("div").attr("class","d3plus_tooltip_data_name").style("display","inline-block").html(e.name).on(O.out,function(){d3.event.stopPropagation()});if(e.link&&n.style("cursor","pointer").on(O.click,e.link),e.value instanceof Array){var a=d.locale.ui.and,o=d.locale.ui.more;e.value=list(e.value,a,3,o)}var i=r.append("div").attr("class","d3plus_tooltip_data_value").style("display","block").style("position","absolute").style("text-align","right").style("top","3px").html(e.value).on(O.out,function(){d3.event.stopPropagation()});if(T?i.style("left","6px"):i.style("right","6px"),d.mouseevents&&e.desc){var s=r.append("div").attr("class","d3plus_tooltip_data_desc").style("color","#888").style("overflow","hidden").style(f+"transition","height 0.5s").style("width","85%").text(e.desc).on(O.out,function(){d3.event.stopPropagation()}),l=s.node().offsetHeight||s.node().getBoundingClientRect().height;s.style("height","0px");var u=n.append("div").attr("class","d3plus_tooltip_data_help").style("background-color","#ccc").style(f+"border-radius","5px").style("color","#fff").style("cursor","pointer").style("display","inline-block").style("font-size","8px").style("font-weight","bold").style("height","10px").style("margin","3px 0px 0px 3px").style("padding-right","1px").style("text-align","center").style("width","10px").style("vertical-align","top").style(S+"transition","background-color 0.5s").text("?").on(O.over,function(){var e=d3.select(this.parentNode.parentNode).style("color");d3.select(this).style("background-color",e),s.style("height",l+"px")}).on(O.out,function(){d3.event.stopPropagation()});n.style("cursor","pointer").on(O.over,function(){I();var e=d3.select(this.parentNode).style("color");u.style("background-color",e),s.style("height",l+"px")}),r.on(O.out,function(){d3.event.stopPropagation(),I()})}var c=parseFloat(i.style("width"),10);c>d.width/2&&(c=d.width/2),w<c&&(w=c),t!=d.data.length-1&&(e.group&&e.group==d.data[t+1].group||!e.group&&!d.data[t+1].group)&&b.append("div").attr("class","d3plus_tooltip_data_seperator").style("background-color","#ddd").style("display","block").style("height","1px").style("margin","0px 3px")}),b.selectAll(".d3plus_tooltip_data_name").style("width",function(){return parseFloat(d3.select(this.parentNode).style("width"),10)-w-30+"px"}),b.selectAll(".d3plus_tooltip_data_value").style("width",w+"px").each(function(e){var t=parseFloat(d3.select(this).style("height"),10);_[e.name]=t}),b.selectAll(".d3plus_tooltip_data_name").style("min-height",function(e){return _[e.name]+"px"})}!d.html||d.fullscreen&&!d.stacked||(b.append("div").html(d.html),d.js&&d.js(l));var z=u.append("div").attr("class","d3plus_tooltip_footer").style("font-size","10px").style("position","relative").style("text-align","center");if(d.footer&&z.html(d.footer),d.height=s.node().offsetHeight||s.node().getBoundingClientRect().height,d.html&&d.fullscreen&&!d.stacked){var A=d.height-12;c=s.node().offsetWidth-d.width-44;l.append("div").attr("class","d3plus_tooltip_html").style("width",c+"px").style("height",A+"px").style("display","inline-block").style("vertical-align","top").style("overflow-y","auto").style("padding","0px 12px").style("position","absolute").html(d.html),d.js&&d.js(l)}if(d.width=s.node().offsetWidth,"center"!=d.anchor.y?d.height+=d.arrow_offset:d.width+=d.arrow_offset,d.data||(!d.fullscreen||d.stacked)&&d.html){if(!d.fullscreen||d.stacked){var j=d.fixed?t-d.y-10:t-10;A=d.height<j?d.height:j}else A=d.height;A-=parseFloat(l.style("padding-top"),10),A-=parseFloat(l.style("padding-bottom"),10),p&&(A-=p.node().offsetHeight||p.node().getBoundingClientRect().height,A-=parseFloat(p.style("padding-top"),10),A-=parseFloat(p.style("padding-bottom"),10)),z&&(A-=z.node().offsetHeight||z.node().getBoundingClientRect().height,A-=parseFloat(z.style("padding-top"),10),A-=parseFloat(z.style("padding-bottom"),10)),b.style("max-height",A+"px")}d.height=s.node().offsetHeight||s.node().getBoundingClientRect().height,F(d.x,d.y,d.id)}},{"../client/pointer.coffee":38,"../client/prefix.coffee":39,"../client/rtl.coffee":40,"../client/scroll.js":41,"../client/scrollbar.coffee":42,"../color/legible.coffee":44,"../color/text.coffee":50,"../core/locale/languages/en_US.coffee":70,"../string/list.coffee":174,"./move.coffee":202,"./remove.coffee":203}],202:[function(e,t,r){var i,s;s=e("../client/scroll.js"),t.exports=function(e,t,r){var n,a,o;return r||(r="default"),(o=d3.select("div#d3plus_tooltip_id_"+r)).node()&&((n=o.datum()).cx=e,n.cy=t,n.fixed||(a="body"===n.parent.node().tagName.toLowerCase()?[s.x(),s.y()]:[0,0],"center"!==n.anchor.y?("right"===n.anchor.x?n.x=n.cx-n.arrow_offset-4:"center"===n.anchor.x?n.x=n.cx-n.width/2:"left"===n.anchor.x&&(n.x=n.cx-n.width+n.arrow_offset+2),"bottom"===n.anchor.y?n.flip=n.cy+n.height+n.offset<=n.limit[1]:"top"===n.anchor.y&&(n.flip=n.cy-n.height-n.offset<a[1]),n.flip?n.y=n.cy+n.offset+n.arrow_offset:n.y=n.cy-n.height-n.offset-n.arrow_offset):(n.y=n.cy-n.height/2,"right"===n.anchor.x?n.flip=n.cx+n.width+n.offset<=n.limit[0]:"left"===n.anchor.x&&(n.flip=n.cx-n.width-n.offset<a[0]),"center"===n.anchor.x?(n.flip=!1,n.x=n.cx-n.width/2):n.flip?n.x=n.cx+n.offset+n.arrow_offset:n.x=n.cx-n.width-n.offset),n.x<a[0]?n.x=a[0]:n.x+n.width>n.limit[0]&&(n.x=n.limit[0]-n.width),n.y<a[1]?n.y=a[1]:n.y+n.height>n.limit[1]&&(n.y=n.limit[1]-n.height)),o.style("top",n.y+"px").style("left",n.x+"px"),n.arrow&&o.selectAll(".d3plus_tooltip_arrow").call(i)),o},i=function(e){return e.style("bottom",function(e){return"center"===e.anchor.y||e.flip?"auto":"-5px"}).style("right",function(e){return"center"!==e.anchor.y||e.flip?"auto":"-5px"}).style("top",function(e){return"center"!==e.anchor.y&&e.flip?"-5px":"center"===e.anchor.y?"50%":"auto"}).style("left",function(e){return"center"===e.anchor.y&&e.flip?"-5px":"center"!==e.anchor.y?"50%":"auto"}).style("margin-left",function(e){var t;return"center"===e.anchor.y?"auto":(t="right"===e.anchor.x?-e.width/2+e.arrow_offset/2:"left"===e.anchor.x?e.width/2-2*e.arrow_offset-5:-5,e.cx-e.width/2-5<t?(t=e.cx-e.width/2-5)<2-e.width/2&&(t=2-e.width/2):-(e.limit[0]-e.cx-e.width/2+5)>t&&(t=-(e.limit[0]-e.cx-e.width/2+5))>e.width/2-11&&(t=e.width/2-11),t+"px")}).style("margin-top",function(e){var t;return"center"!==e.anchor.y?"auto":(t="bottom"===e.anchor.y?-e.height/2+e.arrow_offset/2-1:"top"===e.anchor.y?e.height/2-2*e.arrow_offset-2:-9,e.cy-e.height/2-e.arrow_offset<t?(t=e.cy-e.height/2-e.arrow_offset)<4-e.height/2&&(t=4-e.height/2):-(e.limit[1]-e.cy-e.height/2+e.arrow_offset)>t&&(t=-(e.limit[1]-e.cy-e.height/2+e.arrow_offset))>e.height/2-22&&(t=e.height/2-22),t+"px")})}},{"../client/scroll.js":41}],203:[function(e,t,r){t.exports=function(e){return e?(d3.selectAll("div#d3plus_tooltip_curtain_"+e).remove(),d3.selectAll("div#d3plus_tooltip_id_"+e).remove()):(d3.selectAll("div.d3plus_tooltip_curtain").remove(),d3.selectAll("div.d3plus_tooltip").remove())}},{}],204:[function(e,t,r){t.exports=function(e,t){var r;return[],r=1/(t-1)*(e[1]-e[0]),d3.range(e[0],e[1]+r,r)}},{}],205:[function(e,t,r){var n;n=e("./d3selection.coffee"),t.exports=function(e,t){var r;if(!e||!t)return!1;for(n(e)&&(e=e.node()),n(e)&&(t=t.node()),r=t.parentNode;null!==r;){if(r===e)return!0;r=r.parentNode}return!1}},{"./d3selection.coffee":208}],206:[function(e,t,r){t.exports=function(e,t){var r,n;return t.constructor===String?-1<(n=e.indexOf(t))?e[n]:e[0]:(r=e[0],e.forEach(function(e){if(Math.abs(t-e)<Math.abs(t-r))return r=e}),r)}},{}],207:[function(e,t,r){var n,a,o;a=e("../object/merge.coffee"),o=e("../object/validate.coffee"),n=function(e){var t;return o(e)?a(e):e instanceof Array?(t=[],e.forEach(function(e){return t.push(n(e))}),t):e},t.exports=n},{"../object/merge.coffee":171,"../object/validate.coffee":172}],208:[function(e,t,r){var n;n=e("../client/ie.js"),t.exports=function(e){return n?"object"==typeof e&&e instanceof Array&&"size"in e&&"select"in e:e instanceof d3.selection}},{"../client/ie.js":37}],209:[function(e,t,r){t.exports=function(e,t){var r;(r=new Image).src=e,r.crossOrigin="Anonymous",r.onload=function(){var e;(e=document.createElement("canvas")).width=this.width,e.height=this.height,e.getContext("2d").drawImage(this,0,0),t.call(this,e.toDataURL("image/png")),e=null}}},{}],210:[function(e,t,r){var x,b;x=e("../object/validate.coffee"),b=function(e,t,r,n,a,o){var i,s,l,u,c,d,f,p,h,v,g,m,y;if(void 0===e)return[];if(n&&void 0===a&&(a=n.id.value),o=!0===o&&void 0===o,e instanceof Array||(e=[e]),v=[],void 0===t)return e.reduce(function(e,t){var r;return r=JSON.stringify(t),v.indexOf(r)<0&&(e.indexOf(t)<0&&e.push(t),v.push(r)),e},[]);if(y=[],i=function(e){var t;if(null!=e&&(t=JSON.stringify(e),v.indexOf(t)<0))return y.push(e),v.push(t)},"function"==typeof r&&n)for(l=0,d=e.length;l<d;l++)for(s=e[l],u=0,f=(m=b(r(n,s,t,a))).length;u<f;u++)i(m[u]);else if("function"==typeof t)for(c=0,p=e.length;c<p;c++)i(m=t(s=e[c]));else for(g=0,h=e.length;g<h;g++)s=e[g],x(s)&&i(m=s[t]);return o?y.sort(function(e,t){return e-t}):y},t.exports=b},{"../object/validate.coffee":172}],211:[function(e,t,r){t.exports=function(n){var a,e,t,r,o;for(n.container.value.style("position",function(){var e;return e=d3.select(this).style("position"),0<=["absolute","fixed"].indexOf(e)?e:"relative"}),n.container.changed&&n.container.value.html(""),e=0,t=(r=["width","height"]).length;e<t;e++)n[o=r[e]].value||((a=function(e){var t,r;return void 0===e.tagName||0<=["BODY","HTML"].indexOf(e.tagName)?(r=window["inner"+o.charAt(0).toUpperCase()+o.slice(1)],(t=document!==e&&d3.select(e))&&("width"===o?(r-=parseFloat(t.style("margin-left"),10),r-=parseFloat(t.style("margin-right"),10),r-=parseFloat(t.style("padding-left"),10),r-=parseFloat(t.style("padding-right"),10)):(r-=parseFloat(t.style("margin-top"),10),r-=parseFloat(t.style("margin-bottom"),10),r-=parseFloat(t.style("padding-top"),10),r-=parseFloat(t.style("padding-bottom"),10))),n[o].value=r<=20?n[o].small:r):"number"==typeof(r=parseFloat(d3.select(e).style(o),10))&&0<r?n[o].value=r:"BODY"!==e.tagName?a(e.parentNode):void 0})(n.container.value.node()),1===d3.selectAll("body > *:not(script)").size()&&d3.select("body").style("overflow","hidden"));n.container.value.style("width",n.width.value+"px").style("height",n.height.value+"px")}},{}],212:[function(e,t,r){var d=e("../../core/data/format.js"),f=e("../../core/data/color.js"),p=e("../../core/data/keys.coffee"),h=e("../../core/data/load.coffee"),v=e("./ui/drawer.js"),g=e("./ui/legend.js"),m=e("./ui/timeline.coffee"),y=e("./errorCheck.js"),x=e("../../core/fetch/data.js"),b=e("./finish.js"),w=e("./focus/tooltip.coffee"),_=e("./ui/history.coffee"),k=e("../../core/parse/edges.js"),z=e("../../core/parse/nodes.js"),A=e("../../core/console/print.coffee"),j=e("../../tooltip/remove.coffee"),M=e("./types/run.coffee"),O=e("./shapes/draw.js"),E=e("../../string/format.js"),F=e("./svg/enter.js"),S=e("./svg/update.js"),T=e("./ui/titles.js"),B=e("../../object/validate.coffee");t.exports=function(e){var t=[],r=e.type.value,n=e.format.locale.value,a=n.message.ui,o=n.message.draw;if(["data","attrs","coords","nodes","edges"].forEach(function(r){e.error.value||e[r].loaded||!e[r].url||t.push({function:function(e,t){h(e,r,t)},message:n.message.loading,wait:!0})}),e.draw.update){var i=n.visualization[r]||r,s=e.types[r].setup||!1,l=e.types[r].requirements||[],u=E(n.message.initializing,i),c=n.message.data;l instanceof Array||(l=[l]),i=i.toLowerCase(),e.error.value||"function"!=typeof s||t.push({function:function(e){if(e.dev.value){var t="running "+i+" setup";A.time(t)}s(e),e.dev.value&&A.timeEnd(t)},message:u}),e.container.changed&&t.push({function:F,message:u}),r in e.g.apps||t.push({function:function(e){if(e.dev.value){var t="creating "+i+" group";A.time(t)}e.g.apps[r]=e.g.app.append("g").attr("id",r).attr("opacity",0),e.dev.value&&A.timeEnd(t)},message:u}),e.data.changed&&t.push({function:function(e){e.data.cache={},delete e.nodes.restricted,delete e.edges.restricted,p(e,"data")},message:c}),e.attrs.changed&&t.push({function:function(e){p(e,"attrs")},message:c}),t.push({function:function(e){if(!e.color.type||e.color.changed||e.data.changed||e.attrs.changed||e.id.changed||e.depth.changed||e.id.solo.changed||!e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed)){if(e.color.valueScale=!1,e.dev.value){var t="checking color type";A.time(t)}if(e.color.type=!1,e.color.value){var r=e.color.value;B(r)&&(r=r[e.id.value]?r[e.id.value]:r[d3.keys(r)[0]]),e.data.keys&&r in e.data.keys?e.color.type=e.data.keys[r]:e.attrs.keys&&r in e.attrs.keys&&(e.color.type=e.attrs.keys[r])}else e.data.keys&&(e.color.type=e.data.keys[e.id.value]);e.dev.value&&A.timeEnd(t)}},message:c}),0<=l.indexOf("edges")&&e.edges.value&&(!e.edges.linked||e.edges.changed)&&t.push({function:k,message:c}),0<=l.indexOf("nodes")&&e.edges.value&&(!e.nodes.positions||e.nodes.changed||e.type.changed)&&t.push({function:z,message:c}),(e.data.changed||e.time.changed||e.time.format.changed||e.type.changed||e.id.changed||e.x.scale.changed&&0<=[e.x.scale.value,e.x.scale.previous].indexOf("discrete")||e.y.scale.changed&&0<=[e.y.scale.value,e.y.scale.previous].indexOf("discrete"))&&t.push({function:d,message:c}),e.error.value||t.push({function:function(e){var t=e.time.fixed.value?["all"]:null;if(e.dev.value){var r=t?"fetching pool data":"fetching data";A.time(r)}e.data.pool=x(e,t),e.dev.value&&A.timeEnd(r),t?(e.dev.value&&A.time("fetching data for current year"),e.data.viz=x(e),e.dev.value&&A.timeEnd("fetching data for current year")):e.data.viz=e.data.pool,e.draw.timing=e.data.viz.length<e.data.large?e.timing.transitions:0},message:c}),e.error.value||t.push({check:function(e){return e.color.value&&"number"===e.color.type&&!1===e.color.valueScale},function:f,message:c})}return t.push({function:function(e){if(e.dev.value){var t=e.format.locale.value.message.tooltipReset;A.time(t)}e.type.previous&&r!==e.type.previous&&j(e.type.previous),j(r),e.dev.value&&A.timeEnd(t)},message:a}),e.error.value||t.push({function:y,message:a}),t.push({function:function(e){if(e.margin.process(),T(e),!e.error.value)if(e.draw.update)v(e),m(e),g(e);else{e.dev.value&&A.time("calculating margins");var t=e.container.value.select("div#d3plus_drawer").node().offsetHeight||e.container.value.select("div#d3plus_drawer").node().getBoundingClientRect().height,r=e.g.timeline.node().getBBox();r=e.timeline.value?r.height+e.ui.padding:0;var n=e.g.legend.node().getBBox();n=e.legend.value?n.height+e.ui.padding:0,e.margin.bottom+=t+r+n,e.dev.value&&A.timeEnd("calculating margins")}_(e),e.height.viz-=e.margin.top+e.margin.bottom,e.width.viz-=e.margin.left+e.margin.right},message:a}),e.error.value||t.push({function:w,message:a}),t.push({function:S,message:o}),!e.error.value&&e.draw.update&&t.push({function:[M,O],message:o}),t.push({function:b,message:o}),t}},{"../../core/console/print.coffee":52,"../../core/data/color.js":54,"../../core/data/format.js":56,"../../core/data/keys.coffee":58,"../../core/data/load.coffee":59,"../../core/fetch/data.js":64,"../../core/parse/edges.js":95,"../../core/parse/nodes.js":98,"../../object/validate.coffee":172,"../../string/format.js":173,"../../tooltip/remove.coffee":203,"./errorCheck.js":213,"./finish.js":214,"./focus/tooltip.coffee":215,"./shapes/draw.js":225,"./svg/enter.js":238,"./svg/update.js":239,"./types/run.coffee":242,"./ui/drawer.js":243,"./ui/history.coffee":244,"./ui/legend.js":245,"./ui/timeline.coffee":247,"./ui/titles.js":248}],213:[function(e,t,r){var f=e("../../core/fetch/text.js"),p=e("../../core/console/print.coffee"),h=e("../../core/methods/rejected.coffee"),v=e("../../string/format.js"),g=e("../../string/list.coffee");t.exports=function(r){r.dev.value&&p.time("checking for errors");var e=["id"],t=r.types[r.type.value].requirements;t&&(t instanceof Array?e=e.concat(r.types[r.type.value].requirements):e.push(t));var n=[];if(e.forEach(function(e){if("string"==typeof e)r[e].value||n.push('"'+e+'"');else if("function"==typeof e){var t=e(r);!t.status&&t.text&&n.push('"'+t.text+'"')}}),1<n.length){var a=r.format.locale.value.error.methods,o=r.format.locale.value.visualization[r.type.value]||r.type.value,i=r.format.locale.value.ui.and;n=g(n,i),r.error.internal=v(a,o,n)}else if(1===n.length){a=r.format.locale.value.error.method,o=r.format.locale.value.visualization[r.type.value]||r.type.value;r.error.internal=v(a,o,n[0])}if(!r.error.internal&&0<=e.indexOf("edges")&&0<=e.indexOf("focus")&&0==r.edges.connections(r.focus.value[0],r.id.value).length){var s=f(r,r.focus.value[0],r.depth.value);a=r.format.locale.value.error.connections;r.error.internal=v(a,'"'+s+'"')}e=["d3"];r.types[r.type.value].libs&&(e=e.concat(r.types[r.type.value].libs));n=[];if(e.forEach(function(e){window[e]||n.push('"'+e+'"')}),1<n.length){a=r.format.locale.value.error.libs,o=r.format.locale.value.visualization[r.type.value],i=r.format.locale.value.ui.and;n=g(n,i),r.error.internal=v(a,o,n)}else if(1===n.length){a=r.format.locale.value.error.lib,o=r.format.locale.value.visualization[r.type.value];r.error.internal=v(a,o,n[0])}var l=r.shape.accepted(r);l instanceof Array||(l=[l]);var u=r.shape.value;if(u&&!h(r,l,u,"shape")||r.self.shape(l[0]),"modes"in r.types[r.type.value]){var c=r.types[r.type.value].modes;c instanceof Array||(c=[c]);var d=r.type.mode.value;d&&!h(r,c,d,"mode")||r.self.type({mode:c[0]})}r.dev.value&&p.timeEnd("checking for errors")}},{"../../core/console/print.coffee":52,"../../core/fetch/text.js":66,"../../core/methods/rejected.coffee":91,"../../string/format.js":173,"../../string/list.coffee":174}],214:[function(e,t,r){var d=e("./shapes/edges.js"),f=e("./shapes/paths.js"),p=e("./ui/message.js"),h=e("./focus/viz.js"),v=e("../../core/methods/reset.coffee"),g=e("../../core/console/print.coffee"),m=e("./shapes/labels.js"),y=e("../../string/title.coffee"),x=e("./zoom/bounds.coffee"),b=e("./zoom/labels.coffee"),w=e("./zoom/mouse.coffee");t.exports=function(e){if(e.draw.first?setTimeout(function(){h(e)},e.draw.timing):h(e),!e.error.value){var t=e.zoom.viewport||e.zoom.bounds;e.types[e.type.value].zoom&&e.zoom.value&&t?(e.dev.value&&g.time("calculating zoom"),e.draw.first||e.zoom.reset?x(e,t,0):(e.type.changed||e.focus.changed||e.height.changed||e.width.changed||e.nodes.changed||e.legend.changed||e.timeline.changed||e.ui.changed)&&x(e,t),e.dev.value&&g.timeEnd("calculating zoom")):(e.zoom.bounds=[[0,0],[e.width.viz,e.height.viz]],e.zoom.scale=1,x(e))}var r=e.zoom.size?e.zoom.size.width:e.width.viz,n=e.zoom.size?e.zoom.size.height:e.height.viz,a=e.zoom.bounds?e.zoom.bounds[0][0]:0,o=e.zoom.bounds?e.zoom.bounds[0][1]:0;if(e.g.overlay.attr("width",r).attr("height",n).attr("x",a).attr("y",o),e.error.value||(e.draw.update?(e.edges.path?f(e):d(e),m(e,"data"),e.edges.label&&!e.edges.path&&setTimeout(function(){m(e,"edges")},e.draw.timing+200)):(e.labels.value||e.labels.changed)&&e.types[e.type.value].zoom&&e.zoom.value&&e.draw.timing&&setTimeout(function(){b(e)},e.draw.timing)),!e.error.value){var i=e.types[e.type.value].requirements||[];i instanceof Array||(i=[i]);var s=0<=i.indexOf("data");e.error.internal||e.data.viz&&e.returned.nodes.length||!s||(e.error.internal=e.format.locale.value.error.data)}var l=e.type.previous;if(l&&e.type.value!=l&&e.g.apps[l]&&(e.dev.value&&g.time('hiding "'+l+'"'),e.draw.timing?e.g.apps[l].transition().duration(e.draw.timing).attr("opacity",0):e.g.apps[l].attr("opacity",0),e.dev.value&&g.timeEnd()),!e.error.value){var u=s&&0===e.data.viz.length||e.error.internal||e.error.value?0:e.focus.value.length&&e.types[e.type.value].zoom&&e.zoom.value?1-e.tooltip.curtain.opacity:1,c=e.draw.timing;e.group.transition().duration(c).attr("opacity",u),e.g.data.transition().duration(c).attr("opacity",u),e.g.edges.transition().duration(c).attr("opacity",u)}e.error.value?p(e,e.error.value):e.error.internal?(e.error.internal=y(e.error.internal),g.warning(e.error.internal),p(e,e.error.internal),e.error.internal=null):p(e),setTimeout(function(){v(e),e.types[e.type.value].zoom&&e.zoom.value?(e.g.zoom.datum(e).call(e.zoom.behavior.on("zoom",w)),e.zoom.scroll.value||e.g.zoom.on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("wheel.zoom",null),e.zoom.click.value||e.g.zoom.on("dblclick.zoom",null),e.zoom.pan.value||e.g.zoom.on("mousedown.zoom",null).on("mousemove.zoom",null)):e.g.zoom.call(e.zoom.behavior.on("zoom",null)).on("dblclick.zoom",null).on("mousedown.zoom",null).on("mousemove.zoom",null).on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("touchstart.zoom",null).on("wheel.zoom",null)},e.draw.timing)}},{"../../core/console/print.coffee":52,"../../core/methods/reset.coffee":93,"../../string/title.coffee":176,"./focus/viz.js":216,"./shapes/edges.js":226,"./shapes/labels.js":228,"./shapes/paths.js":230,"./ui/message.js":246,"./zoom/bounds.coffee":249,"./zoom/labels.coffee":251,"./zoom/mouse.coffee":252}],215:[function(e,t,r){var a,o,i,s;a=e("../tooltip/create.js"),o=e("../../../core/fetch/value.coffee"),i=e("../../../core/console/print.coffee"),s=e("../../../tooltip/remove.coffee"),t.exports=function(t){var e,r,n;r=t.focus,!t.error.internal&&1===r.value.length&&r.value.length&&!t.small&&r.tooltip.value?(t.dev.value&&i.time("drawing focus tooltip"),1<=(e=t.data.pool.filter(function(e){return o(t,e,t.id.value)===r.value[0]})).length?e=e[0]:(e={})[t.id.value]=r.value[0],n=t.labels.padding,a({anchor:"top left",arrow:!1,data:e,fullscreen:!1,id:"visualization_focus",length:"long",maxheight:t.height.viz-2*n,mouseevents:!0,offset:0,vars:t,width:t.tooltip.large,x:t.width.value-t.margin.right-n,y:t.margin.top+n}),t.width.viz-=t.tooltip.large+2*n,t.dev.value&&i.timeEnd("drawing focus tooltip")):s("visualization_focus")}},{"../../../core/console/print.coffee":52,"../../../core/fetch/value.coffee":67,"../../../tooltip/remove.coffee":203,"../tooltip/create.js":240}],216:[function(t,r,n){var p=t("../../../client/pointer.coffee"),h=t("../../../client/ie.js"),v=t("../../../core/fetch/value.coffee"),g=t("../../../core/console/print.coffee"),m=t("../../../util/uniques.coffee");r.exports=function(a){if(a.g.edge_focus.selectAll("g").remove(),a.g.data_focus.selectAll("g").remove(),a.focus.value.length&&a.types[a.type.value].zoom&&a.zoom.value){a.dev.value&&g.time("drawing focus elements");var t=a.g.edges.selectAll("g");if(0<t.size()){t.each(function(e){var t=e[a.edges.source][a.id.value],r=e[a.edges.target][a.id.value];if(t==a.focus.value[0]||r==a.focus.value[0]){var n=a.g.edge_focus.node().appendChild(this.cloneNode(!0));d3.select(n).datum(e).attr("opacity",1).selectAll("line, path").datum(e)}});var n=a.edges.arrows.value;a.g.edge_focus.selectAll("line, path").attr("vector-effect","non-scaling-stroke").style("stroke",a.color.focus).style("stroke-width",function(){return h&&a.types[a.type.value].zoom?0:a.edges.size.value?d3.select(this).style("stroke-width"):2*a.data.stroke.width}).attr("marker-start",function(e){var t=a.edges.arrows.direction.value;if("bucket"in e.d3plus)var r="_"+e.d3plus.bucket;else r="";return"source"==t&&n?"url(#d3plus_edge_marker_focus"+r+")":"none"}).attr("marker-end",function(e){var t=a.edges.arrows.direction.value;if("bucket"in e.d3plus)var r="_"+e.d3plus.bucket;else r="";return"target"==t&&n?"url(#d3plus_edge_marker_focus"+r+")":"none"}),a.g.edge_focus.selectAll("text").style("fill",a.color.focus)}var o=m(a.edges.connections(a.focus.value[0],a.id.value,!0),a.id.value,v,a);o.push(a.focus.value[0]);var i=[],s=[],l=[0],u=[0];a.g.data.selectAll("g").each(function(t){if(0<=o.indexOf(t[a.id.value])){var r=a.g.data_focus.node().appendChild(this.cloneNode(!0));r=d3.select(r).datum(t).attr("opacity",1);for(e in"coordinates"==a.shape.value?a.zoom.viewport=a.path.bounds(a.zoom.coords[t.d3plus.id]):"d3plus"in t&&("x"in t.d3plus&&i.push(t.d3plus.x),"y"in t.d3plus&&s.push(t.d3plus.y),"r"in t.d3plus?(l.push(t.d3plus.r),u.push(t.d3plus.r)):("width"in t.d3plus&&l.push(t.d3plus.width/2),"height"in t.d3plus&&u.push(t.d3plus.height/2))),p){var n=d3.select(this).on(p[e]);n&&r.on(p[e],n)}}});if(i.length&&s.length){var r=d3.extent(i),c=d3.extent(s),d=d3.max(l),f=d3.max(u);a.zoom.viewport=[[r[0]-d,c[0]-f],[r[1]+d,c[1]+f]]}a.g.data_focus.selectAll("path").style("stroke-width",h&&a.types[a.type.value].zoom?0:2*a.data.stroke.width),a.dev.value&&g.timeEnd("drawing focus elements")}else a.zoom.viewport=!1}},{"../../../client/ie.js":37,"../../../client/pointer.coffee":38,"../../../core/console/print.coffee":52,"../../../core/fetch/value.coffee":67,"../../../util/uniques.coffee":210}],217:[function(e,t,r){var l,u,c,d;d=e("./style.coffee"),u=e("../../../geom/largestRect.coffee"),c=e("../../../geom/path2poly.coffee"),l={start:{},end:{}},t.exports=function(n,e,t,r){var a,o,i,s;a=d3.svg.arc().innerRadius(0).outerRadius(function(e){return e.d3plus.r}).startAngle(function(e){return e.d3plus.startAngle}).endAngle(function(e){return e.d3plus.endAngle}),i=function(e){var t,r;return n.labels.value&&(e.d3plus.label?e.d3plus_label=e.d3plus.label:(t=c(a(e)),(r=u(t,{angle:0}))[0]?e.d3plus_label={w:r[0].width,h:r[0].height,x:r[0].cx,y:r[0].cy}:delete e.d3plus_label)),[e]},n.draw.timing?(s=d3.svg.arc().innerRadius(0).outerRadius(function(e){return e.d3plus.r}).startAngle(function(e){return void 0===l.start[e.d3plus.id]&&(l.start[e.d3plus.id]=0),isNaN(l.start[e.d3plus.id])&&(l.start[e.d3plus.id]=e.d3plus.startAngle),l.start[e.d3plus.id]}).endAngle(function(e){return void 0===l.end[e.d3plus.id]&&(l.end[e.d3plus.id]=0),isNaN(l.end[e.d3plus.id])&&(l.end[e.d3plus.id]=e.d3plus.endAngle),l.end[e.d3plus.id]}),o=function(e,o){return e.attrTween("d",function(t){var e,r,n,a;return void 0===o?(a=t.d3plus.startAngle,e=t.d3plus.endAngle):0===o&&(e=a=0),n=d3.interpolate(l.start[t.d3plus.id],a),r=d3.interpolate(l.end[t.d3plus.id],e),function(e){return l.start[t.d3plus.id]=n(e),l.end[t.d3plus.id]=r(e),s(t)}})},t.append("path").attr("class","d3plus_data").call(d,n).attr("d",s),e.selectAll("path.d3plus_data").data(i).transition().duration(n.draw.timing).call(d,n).call(o),r.selectAll("path.d3plus_data").transition().duration(n.draw.timing).call(o,0)):(t.append("path").attr("class","d3plus_data"),e.selectAll("path.d3plus_data").data(i).call(d,n).attr("d",a))}},{"../../../geom/largestRect.coffee":160,"../../../geom/path2poly.coffee":162,"./style.coffee":234}],218:[function(e,t,r){var c=e("../../../core/fetch/text.js"),d=e("../../../font/sizes.coffee"),f=e("../../../geom/largestRect.coffee"),o=e("./style.coffee");t.exports=function(l,e,t,r){var n=d3.svg.area().x(function(e){return e.d3plus.x}).y0(function(e){return e.d3plus.y0}).y1(function(e){return e.d3plus.y}).interpolate(l.shape.interpolate.value),a=d3.svg.area().x(function(e){return e.d3plus.x}).y0(function(e){return e.d3plus.y0}).y1(function(e){return e.d3plus.y0}).interpolate(l.shape.interpolate.value);t.append("path").attr("class","d3plus_data").attr("d",function(e){return a(e.values)}).call(o,l);var u={"font-weight":l.labels.font.weight,"font-family":l.labels.font.family.value};e.selectAll("path.d3plus_data").data(function(e){if(l.labels.value&&1<e.values.length){var t=!1;if(d3.max(e.values,function(e){return e.d3plus.y0-e.d3plus.y})>l.labels.font.size){var r=[],n=[],a=c(l,e);e.values.forEach(function(e){r.push([e.d3plus.x,e.d3plus.y]),n.push([e.d3plus.x,e.d3plus.y0])}),r=r.concat(n.reverse());var o=null;if(a.length){var i=d(a[0],u);o=i[0].width/i[0].height}t=f(r,{angle:d3.range(-70,71,1),aspectRatio:o,tolerance:0})}if(t&&t[0]){var s={w:~~t[0].width,h:~~t[0].height,x:~~t[0].cx,y:~~t[0].cy,angle:-1*t[0].angle,padding:2,names:a};0!==t[0].angle?s.translate={x:s.x,y:s.y}:s.translate=!1,10<=s.w&&10<=s.h&&(e.d3plus_label=s)}}return[e]}),l.draw.timing?e.selectAll("path.d3plus_data").transition().duration(l.draw.timing).attr("d",function(e){return n(e.values)}).call(o,l):e.selectAll("path.d3plus_data").attr("d",function(e){return n(e.values)}).call(o,l)}},{"../../../core/fetch/text.js":66,"../../../font/sizes.coffee":102,"../../../geom/largestRect.coffee":160,"./style.coffee":234}],219:[function(e,t,r){e("../../../core/fetch/text.js"),e("../../../geom/largestRect.coffee");var o=e("./style.coffee");t.exports=function(e,t,r,n){function a(e){e.attr("transform",function(e){var t=Math.min(e.d3plus.width,e.d3plus.height);return"scale("+Math.floor(t/16)+")"})}r.append("path").attr("class","d3plus_data").attr("d","M5-6.844L3.594-5.407L-2,0.188l-1.594-1.594L-5-2.844L-7.844,0l1.438,1.406l3,3L-2,5.843l1.406-1.438l7-7L7.844-4L5-6.844z").call(function(e){e.attr("transform","scale(1)")}).call(o,e),t.selectAll("path.d3plus_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(a).call(o,e):t.selectAll("path.d3plus_data").call(a).call(o,e)}},{"../../../core/fetch/text.js":66,"../../../geom/largestRect.coffee":160,"./style.coffee":234}],220:[function(e,t,r){var s,l,u;e("../../../core/fetch/value.coffee"),s=e("../../../core/fetch/color.coffee"),l=e("../../../color/lighter.coffee"),u=e("./segments.coffee"),t.exports=function(e,t,r){var n,a,o,i;return a=e.d3plus.shape||t.shape.value,"line"===t.shape.value&&"circle"!==a?"none":"area"===t.shape.value||"active"===a||"line"===t.shape.value?s(t,e):"temp"===a?r?s(t,e):"url(#d3plus_hatch_"+e.d3plus.id+")":e.d3plus.static?l(s(t,e),.75):(n=u(t,e,"active"),o=u(t,e,"temp"),i=u(t,e,"total"),!t.active.value&&!t.temp.value||!0===n||n&&i&&i<=n&&!o||n&&!i?s(t,e):t.active.spotlight.value?t.color.missing:l(s(t,e),.75))}},{"../../../color/lighter.coffee":45,"../../../core/fetch/color.coffee":63,"../../../core/fetch/value.coffee":67,"./segments.coffee":233}],221:[function(e,t,r){var k,z,A,j,M,O,E,o;k=e("../../../util/copy.coffee"),z=e("../../../network/distance.coffee"),A=e("../../../core/fetch/text.js"),j=e("../../../font/sizes.coffee"),O=e("../../../geom/largestRect.coffee"),E=e("../../../geom/path2poly.coffee"),o=e("./style.coffee"),M={},t.exports=function(_,e,t,r){var n,a;return(n=d3.geo[_.coords.projection.value]()).center&&n.center(_.coords.center),_.zoom.scale||(_.zoom.scale=1),_.zoom.area=1/_.zoom.scale/_.zoom.scale,_.path=d3.geo.path().projection(n),_.draw.timing?e.selectAll("path.d3plus_data").attr("d",_.path).transition().duration(_.draw.timing).call(o,_):e.selectAll("path.d3plus_data").attr("d",_.path).call(o,_),t.append("path").attr("id",function(e){return e.id}).attr("class","d3plus_data").attr("d",_.path).call(o,_),a=_.old_height!==_.height.viz||_.height.changed||_.old_width!==_.width.viz||_.width.changed,_.old_height=_.height.viz,_.old_width=_.width.viz,_.coords.changed||a||_.coords.mute.changed||_.coords.solo.changed||_.type.changed||_.text.changed||_.coords.projection.changed||_.labels.changed?(_.zoom.bounds=null,_.zoom.reset=!0,_.zoom.coords={},e.each(function(e){var n,a,t,r,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w;if(_.coords.simplify.value&&1<e.geometry.coordinates.length){for(u=[],a=[],n=0,f=k(e),y=k(e),e.geometry.coordinates=e.geometry.coordinates.filter(function(e,t){var r;return y.geometry.coordinates=[e],0<(r=_.path.area(y))&&(a.push(r),n<r&&(f.geometry.coordinates=[e],n=r),!0)}),o=_.path.centroid(f),c=d=0,p=(x=e.geometry.coordinates).length;d<p;c=++d)r=x[c],y.geometry.coordinates=[r],u.push(z(_.path.centroid(y),o));l=u.reduce(function(e,t,r){return t&&e.push(a[r]/t),e},[]),s=d3.quantile(l,_.coords.threshold.value),y.geometry.coordinates=e.geometry.coordinates.filter(function(e,t){var r,n;return n=u[t],r=a[t],0===n||s<=r/n}),(i=f.geometry.coordinates[0])&&"MultiPolygon"===f.geometry.type&&(i=i[0],f.geometry.coordinates[0]=i,f.geometry.type="Polygon")}else i=(f=y=e).geometry.coordinates[0];return _.zoom.coords[e.d3plus.id]=y,delete e.d3plus_label,_.labels.value&&(h=A(_,e),i&&h.length&&(v=E(_.path(f)),w={"font-weight":_.labels.font.weight,"font-family":_.labels.font.family.value},g=null,1===h[0].split(" ").length&&(g=(b=j(h[0],w)[0]).width/b.height),(m=O(v,{angle:0,aspectRatio:g}))&&(m=m[0],e.d3plus_label={anchor:"middle",valign:"center",h:m.height,w:m.width,x:m.cx,y:m.cy,names:h}))),M[e.id]=e.d3plus_label,t=_.path.bounds(y),_.zoom.bounds?(_.zoom.bounds[0][0]>t[0][0]&&(_.zoom.bounds[0][0]=t[0][0]),_.zoom.bounds[0][1]>t[0][1]&&(_.zoom.bounds[0][1]=t[0][1]),_.zoom.bounds[1][0]<t[1][0]&&(_.zoom.bounds[1][0]=t[1][0]),_.zoom.bounds[1][1]<t[1][1]?_.zoom.bounds[1][1]=t[1][1]:void 0):_.zoom.bounds=t})):_.focus.value.length?void 0:(_.zoom.viewport=!1,e.each(function(e){return e.d3plus_label=M[e.id]}))}},{"../../../core/fetch/text.js":66,"../../../font/sizes.coffee":102,"../../../geom/largestRect.coffee":160,"../../../geom/path2poly.coffee":162,"../../../network/distance.coffee":165,"../../../util/copy.coffee":207,"./style.coffee":234}],222:[function(e,t,r){var o=e("./style.coffee");t.exports=function(e,t,r,n){function a(e){e.attr("d",d3.svg.symbol().type("cross").size(function(e){var t=Math.min(e.d3plus.width,e.d3plus.height);return d3.scale.pow().exponent(2)(t/2)}))}r.append("path").attr("class","d3plus_data").call(function(e){e.attr("d",d3.svg.symbol().type("cross").size(10))}).call(o,e),t.selectAll("path.d3plus_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(a).call(o,e):t.selectAll("path.d3plus_data").call(a).call(o,e)}},{"./style.coffee":234}],223:[function(e,t,r){var o=e("./style.coffee");t.exports=function(e,t,r,n){function a(e){e.attr("d",d3.svg.symbol().type("diamond").size(function(e){var t=Math.min(e.d3plus.width,e.d3plus.height);return d3.scale.pow().exponent(2)(t/2)}))}r.append("path").attr("class","d3plus_data").call(function(e){e.attr("d",d3.svg.symbol().type("diamond").size(10))}).call(o,e),t.selectAll("path.d3plus_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(a).call(o,e):t.selectAll("path.d3plus_data").call(a).call(o,e)}},{"./style.coffee":234}],224:[function(e,t,r){var o=e("./style.coffee");t.exports=function(l,e,t,r){l.arcs||(l.arcs={donut:{},active:{},temp:{}});var u=d3.svg.arc().startAngle(0).endAngle(function(e){var t=l.arcs[e.d3plus.shape][e.d3plus.id].a;return t>2*Math.PI?2*Math.PI:t}).innerRadius(function(e){return e.d3plus.static?0:l.arcs[e.d3plus.shape][e.d3plus.id].r*l.data.donut.size}).outerRadius(function(e){return l.arcs[e.d3plus.shape][e.d3plus.id].r});function n(e,o,i,s){if(!o)o=0;if("number"!=typeof i)i=void 0;if("number"!=typeof s)s=void 0;e.attrTween("d",function(t){if(null==i)var e=t.d3plus.r?t.d3plus.r:d3.max([t.d3plus.width,t.d3plus.height]);else e=i;if(null==s)var r=t.d3plus.segments[t.d3plus.shape];else r=s;l.arcs[t.d3plus.shape][t.d3plus.id]||(l.arcs[t.d3plus.shape][t.d3plus.id]={r:0},l.arcs[t.d3plus.shape][t.d3plus.id].a=2*Math.PI);var n=d3.interpolate(l.arcs[t.d3plus.shape][t.d3plus.id].r,e+o),a=d3.interpolate(l.arcs[t.d3plus.shape][t.d3plus.id].a,r);return function(e){return l.arcs[t.d3plus.shape][t.d3plus.id].r=n(e),l.arcs[t.d3plus.shape][t.d3plus.id].a=a(e),u(t)}})}function a(e){return e.d3plus.label?e.d3plus_label=e.d3plus.label:delete e.d3plus_label,[e]}l.draw.timing?(r.selectAll("path.d3plus_data").transition().duration(l.draw.timing).call(n,0,0).each("end",function(e){delete l.arcs[e.d3plus.shape][e.d3plus.id]}),e.selectAll("path.d3plus_data").data(a).transition().duration(l.draw.timing).call(n).call(o,l),t.append("path").attr("class","d3plus_data").transition().duration(0).call(n,0,0).call(o,l).transition().duration(l.draw.timing).call(n).call(o,l)):(r.selectAll("path.d3plus_data").each(function(e){delete l.arcs[e.d3plus.shape][e.d3plus.id]}),t.append("path").attr("class","d3plus_data"),e.selectAll("path.d3plus_data").data(a).call(n).call(o,l))}},{"./style.coffee":234}],225:[function(e,t,r){var h=e("../../../util/child.coffee"),y=e("../../../util/closest.coffee"),x=e("../tooltip/create.js"),b=e("../../../client/pointer.coffee"),w=e("../../../core/fetch/value.coffee"),_=e("../../../core/fetch/color.coffee"),k=e("../../../core/fetch/text.js"),z=e("../../../color/legible.coffee"),A=e("../../../core/console/print.coffee"),j=e("../../../tooltip/remove.coffee"),M=e("./segments.coffee"),O=e("./fill.js"),E=e("../../../string/strip.js"),F=e("../../../client/touch.coffee"),S=e("../zoom/propagation.coffee"),T=e("../../../util/uniques.coffee"),B=e("../../../object/validate.coffee"),C=e("../zoom/direction.coffee"),q={arc:e("./arc.coffee"),area:e("./area.js"),check:e("./check.js"),coordinates:e("./coordinates.coffee"),cross:e("./cross.js"),diamond:e("./diamond.js"),donut:e("./donut.js"),line:e("./line.js"),radial:e("./radial.coffee"),rect:e("./rect.coffee"),triangle_down:e("./triangle_down.js"),triangle_up:e("./triangle_up.js"),whisker:e("./whisker.coffee")};t.exports=function(v){var e=v.returned.nodes||[],t=v.returned.edges||[];v.draw.timing=e.length<v.data.large&&t.length<v.edges.large?v.timing.transitions:0;var r={arc:"arc",area:"area",check:"check",circle:"rect",coordinates:"coordinates",cross:"cross",donut:"donut",diamond:"diamond",line:"line",plus:"cross",radial:"radial",rect:"rect",square:"rect",triangle_down:"triangle_down",triangle:"triangle_up",triangle_up:"triangle_up",whisker:"whisker"},n={};function a(r){if(!r.d3plus.id){r.d3plus.id="";for(var e=0;e<=v.depth.value;e++)r.d3plus.id+=w(v,r,v.id.nesting[e])+"_";r.d3plus.id+=l,["x","y","x2","y2"].forEach(function(e){if("discrete"==v[e].scale.value){var t=w(v,r,v[e].value);t.constructor===Date&&(t=t.getTime()),r.d3plus.id+="_"+t}}),r.d3plus.suffix&&(r.d3plus.id+="_"+r.d3plus.suffix),r.d3plus.id=E(r.d3plus.id)}return r}function g(e,t){var r=v.types[v.type.value].scale,n=1;r&&(B[r]&&v.shape.value in r?n=r[v.shape.value]:"function"==typeof r?n=r(v,v.shape.value):"number"==typeof r&&(n=r)),n=t?n:1,e.attr("transform",function(e){return["line","area","coordinates"].indexOf(l)<0?"translate("+(e.d3plus.x||0)+","+(e.d3plus.y||0)+")scale("+n+")":"scale("+n+")"})}function o(e){e.attr("id",function(e){return"d3plus_group_"+e.d3plus.id}).attr("class",function(e){var t=v.class.value?" "+w(v,e,v.class.value):"";return"d3plus_"+l+t})}for(var i in e.forEach(function(e){var t=e.d3plus&&e.d3plus.shape?e.d3plus.shape:v.shape.value;t in r&&(e.d3plus&&(e.d3plus.shape=t),n[t=r[t]]||(n[t]=[]),n[t].push(e))}),r)if(!(r[i]in n)||0===d3.keys(n).length){var s=v.g.data.selectAll("g.d3plus_"+r[i]);v.draw.timing?s.transition().duration(v.draw.timing).attr("opacity",0).remove():s.remove()}for(var l in n){var u=v.g.data.selectAll("g.d3plus_"+l).data(n[l],function(e){if(e.d3plus||(e.d3plus={}),"coordinates"===l)return e.d3plus.id=e.id,e.id;if(!e.d3plus.id)if(e.values)e.values.forEach(function(e){(e=a(e)).d3plus.shape="circle"}),e.d3plus.id=e.key;else if(!(e=a(e)).d3plus.segments){e.d3plus.segments={donut:2*Math.PI};var t=M(v,e,"active"),r=M(v,e,"temp"),n=M(v,e,"total");n&&(e.d3plus.segments.active=t?t/n*(2*Math.PI):0,e.d3plus.segments.temp=r?r/n*(2*Math.PI)+e.d3plus.segments.active:0)}return!!e.d3plus&&e.d3plus.id});if(v.draw.timing)var c=u.exit().transition().duration(v.draw.timing).attr("opacity",0).remove();else c=u.exit().remove();v.draw.timing?u.transition().duration(v.draw.timing).call(g).call(o):u.call(g).call(o);var d=v.draw.timing?0:1,f=u.enter().append("g").attr("opacity",d).call(g).call(o);v.draw.timing&&f.transition().duration(v.draw.timing).attr("opacity",1),u.order(),v.dev.value&&A.time('drawing "'+l+'" shapes'),q[l](v,u,f,c,g),v.dev.value&&A.timeEnd('drawing "'+l+'" shapes'),0<=["rect","donut"].indexOf(l)&&v.types[v.type.value].fill&&(v.dev.value&&A.time('filling "'+l+'" shapes'),O(v,u,f,c,g),v.dev.value&&A.timeEnd('filling "'+l+'" shapes'))}function m(o){if(o&&0<v.g.edges.selectAll("g").size()){v.g.edge_hover.selectAll("*").remove(),v.g.edges.selectAll("g").each(function(e){var t=o[v.id.value],r=e[v.edges.source][v.id.value],n=e[v.edges.target][v.id.value];if(r==t||r=="left_"+t||r=="right_"+t||n==t||n=="left_"+t||n=="right_"+t){var a=v.g.edge_hover.node().appendChild(this.cloneNode(!0));d3.select(a).datum(e).attr("opacity",1).selectAll("line, path").datum(e)}});var n=v.edges.arrows.value;v.g.edge_hover.attr("opacity",0).selectAll("line, path").style("stroke",v.color.primary).style("stroke-width",function(e){return v.edges.path&&e.dy?Math.max(1,e.dy):v.edges.size.value?d3.select(this).style("stroke-width"):2*v.data.stroke.width}).attr("marker-start",function(e){var t=v.edges.arrows.direction.value;if("bucket"in e.d3plus)var r="_"+e.d3plus.bucket;else r="";return"source"==t&&n?"url(#d3plus_edge_marker_highlight"+r+")":"none"}).attr("marker-end",function(e){var t=v.edges.arrows.direction.value;if("bucket"in e.d3plus)var r="_"+e.d3plus.bucket;else r="";return"target"==t&&n?"url(#d3plus_edge_marker_highlight"+r+")":"none"}),v.g.edge_hover.selectAll("text").style("fill",v.color.primary),v.draw.timing?(v.g.edge_hover.transition().duration(v.timing.mouseevents).attr("opacity",1),v.g.edges.transition().duration(v.timing.mouseevents).attr("opacity",.5)):v.g.edge_hover.attr("opacity",1)}else v.draw.timing?(v.g.edge_hover.transition().duration(v.timing.mouseevents).attr("opacity",0).transition().selectAll("*").remove(),v.g.edges.transition().duration(v.timing.mouseevents).attr("opacity",1)):v.g.edge_hover.selectAll("*").remove()}if(m(),v.tooltip.value)v.g.data.selectAll("g").on(b.over,function(e){if(F&&S(v,d3.event),d3.event.buttons||!v.mouse.value||!v.mouse.over.value||v.draw.frozen||e.d3plus&&e.d3plus.static)j(v.type.value);else{var t="function"!=typeof v.mouse.over.value;if("function"==typeof v.mouse.over.value&&(t=v.mouse.over.value(e,v.self)),t){var r=C(e.d3plus_data||e,v),n="function"==typeof v.mouse.viz||"function"==typeof v.mouse.viz[b.click]||v.zoom.value&&(v.types[v.type.value].zoom||e.d3plus.threshold&&e.d3plus.merged||1===r||-1===r&&v.history.states.length&&!v.tooltip.value.long);if(d3.select(this).style("cursor",n?"pointer":"auto").transition().duration(v.timing.mouseevents).call(g,!0),d3.select(this).selectAll(".d3plus_data").transition().duration(v.timing.mouseevents).attr("opacity",1),v.covered=!1,e.values&&v.axes.discrete){var a="x"===v.axes.discrete?0:1,o=d3.mouse(v.container.value.node())[a],i=T(e.values,function(e){return e.d3plus[v.axes.discrete]}),s=y(i,o);e.d3plus_data=e.values[i.indexOf(s)],e.d3plus=e.values[i.indexOf(s)].d3plus}var l=e.d3plus_data?e.d3plus_data:e;x({vars:v,data:l}),"function"==typeof v.mouse.viz?v.mouse.viz(e.d3plus_data||e,v):v.mouse.viz[b.over]&&v.mouse.viz[b.over](e.d3plus_data||e,v),m(e)}}}).on(b.move,function(e){if(F&&S(v,d3.event),d3.event.buttons||!v.mouse.value||!v.mouse.move.value||v.draw.frozen||e.d3plus&&e.d3plus.static)j(v.type.value);else{var t="function"!=typeof v.mouse.move.value;if("function"==typeof v.mouse.move.value&&(t=v.mouse.move.value(e,v.self)),t){var r=C(e.d3plus_data||e,v),n="function"==typeof v.mouse.viz||"function"==typeof v.mouse.viz[b.click]||v.zoom.value&&(v.types[v.type.value].zoom||e.d3plus.threshold&&e.d3plus.merged||1===r||-1===r&&v.history.states.length&&!v.tooltip.value.long);d3.select(this).style("cursor",n?"pointer":"auto");v.types[v.type.value].tooltip;if(e.values&&v.axes.discrete){var a="x"===v.axes.discrete?0:1,o=d3.mouse(v.container.value.node())[a],i=T(e.values,function(e){return e.d3plus[v.axes.discrete]}),s=y(i,o);e.d3plus_data=e.values[i.indexOf(s)],e.d3plus=e.values[i.indexOf(s)].d3plus}var l=e.d3plus_data?e.d3plus_data:e;x({vars:v,data:l}),"function"==typeof v.mouse.viz?v.mouse.viz(e.d3plus_data||e,v):v.mouse.viz[b.move]&&v.mouse.viz[b.move](e.d3plus_data||e,v)}}}).on(b.out,function(e){if(F&&S(v,d3.event),!d3.event.buttons&&v.mouse.value&&v.mouse.out.value){var t="function"!=typeof v.mouse.out.value;if("function"==typeof v.mouse.out.value&&(t=v.mouse.out.value(e,v.self)),t)h(this,d3.event.toElement)||v.draw.frozen||e.d3plus&&e.d3plus.static||(d3.select(this).transition().duration(v.timing.mouseevents).call(g),d3.select(this).selectAll(".d3plus_data").transition().duration(v.timing.mouseevents).attr("opacity",v.data.opacity),v.covered||j(v.type.value),"function"==typeof v.mouse.viz?v.mouse.viz(e.d3plus_data||e,v):v.mouse.viz[b.out]&&v.mouse.viz[b.out](e.d3plus_data||e,v),m())}else j(v.type.value)});else{var p=function(){S(v,d3.event)};v.g.data.selectAll("g").on(b.over,p).on(b.move,p).on(b.out,p)}d3.select(window).on("scroll.d3plus",function(){j(v.type.value)}),v.g.data.selectAll("g").on(b.click,function(e){if((!v.mouse.viz||!1!==v.mouse.viz.click)&&v.mouse.value&&v.mouse.click.value&&!d3.event.defaultPrevented&&!v.draw.frozen&&(!e.d3plus||!e.d3plus.static)){var t="function"!=typeof v.mouse.click.value;if("function"==typeof v.mouse.click.value&&(t=v.mouse.click.value(e,v.self)),t){if(e.values&&v.axes.discrete){var r="x"===v.axes.discrete?0:1,n=d3.mouse(v.container.value.node())[r],a=T(e.values,function(e){return e.d3plus[v.axes.discrete]}),o=y(a,n);e.d3plus_data=e.values[a.indexOf(o)],e.d3plus=e.values[a.indexOf(o)].d3plus}"function"==typeof v.mouse.viz?v.mouse.viz(e.d3plus_data||e,v):v.mouse.viz[b.out]?v.mouse.viz[b.out](e.d3plus_data||e,v):v.mouse.viz[b.click]&&v.mouse.viz[b.click](e.d3plus_data||e,v);var i=C(e.d3plus_data||e,v),s=v.id.solo.value,l=k(v,e)[0],u=z(_(v,e)),c=v.title.sub.value||!1,d=v.title.sub.font.color,f=v.title.total.font.color;if(e.d3plus.threshold&&e.d3plus.merged&&v.zoom.value)v.history.states.push(function(){v.self.id({solo:s}).title({sub:{font:{color:d},value:c},total:{font:{color:f}}}).draw()}),v.self.id({solo:s.concat(T(e.d3plus.merged,v.id.value,w,v))}).title({sub:{font:{color:u},value:l},total:{font:{color:u}}}).draw();else if(1===i&&v.zoom.value){var p=w(v,e.d3plus_data||e,v.id.value);v.history.states.push(function(){v.self.depth(v.depth.value-1).id({solo:s}).title({sub:{font:{color:d},value:c},total:{font:{color:f}}}).draw()}),v.self.depth(v.depth.value+1).id({solo:s.concat(p)}).title({sub:{font:{color:u},value:l},total:{font:{color:u}}}).draw()}else if(-1===i&&v.zoom.value&&v.history.states.length&&!v.tooltip.value.long)v.history.back();else if(v.types[v.type.value].zoom&&v.zoom.value)m(),d3.select(this).transition().duration(v.timing.mouseevents).call(g),d3.select(this).selectAll(".d3plus_data").transition().duration(v.timing.mouseevents).attr("opacity",v.data.opacity),j(v.type.value),v.draw.update=!1,e&&e[v.id.value]!=v.focus.value[0]?v.self.focus(e[v.id.value]).draw():v.self.focus(!1).draw();else if(v.types[v.type.value].requirements.indexOf("focus")<0){m();var h=e.d3plus_data?e.d3plus_data:e;x({vars:v,data:h})}}}})}},{"../../../client/pointer.coffee":38,"../../../client/touch.coffee":43,"../../../color/legible.coffee":44,"../../../core/console/print.coffee":52,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/validate.coffee":172,"../../../string/strip.js":175,"../../../tooltip/remove.coffee":203,"../../../util/child.coffee":205,"../../../util/closest.coffee":206,"../../../util/uniques.coffee":210,"../tooltip/create.js":240,"../zoom/direction.coffee":250,"../zoom/propagation.coffee":253,"./arc.coffee":217,"./area.js":218,"./check.js":219,"./coordinates.coffee":221,"./cross.js":222,"./diamond.js":223,"./donut.js":224,"./fill.js":227,"./line.js":229,"./radial.coffee":231,"./rect.coffee":232,"./segments.coffee":233,"./triangle_down.js":235,"./triangle_up.js":236,"./whisker.coffee":237}],226:[function(e,t,r){var z=e("../../../util/buckets.coffee"),q=e("../../../geom/offset.coffee");t.exports=function(F){var e=F.returned.edges||[],S=F.zoom.behavior.scaleExtent()[0];if("string"==typeof F.edges.size.value){var t=d3.extent(e,function(e){return e[F.edges.size.value]}),r=d3.min(F.returned.nodes||[],function(e){return e.d3plus.r})*(2*F.edges.size.scale);F.edges.scale=d3.scale.sqrt().domain(t).range([F.edges.size.min,r*S])}else{var n="number"==typeof F.edges.size.value?F.edges.size.value:F.edges.size.min;F.edges.scale=function(){return n}}var a=F.edges.opacity.value,o=typeof a;function i(e){e.attr("opacity",0).style("stroke-width",0).style("stroke",F.background.value).style("fill","none")}function s(e){var n=F.edges.arrows.value;e.attr("opacity",function(e){return"number"===o?a:"function"===o?a(e,F):F.edges.opacity.scale.value(e[a])}).style("stroke-width",function(e){return F.edges.scale(e[F.edges.size.value])}).style("stroke",F.edges.color).attr("marker-start",function(e){var t=F.edges.arrows.direction.value;if("bucket"in e.d3plus)var r="_"+e.d3plus.bucket;else r="";return"source"==t&&n?"url(#d3plus_edge_marker_default"+r+")":"none"}).attr("marker-end",function(e){var t=F.edges.arrows.direction.value;if("bucket"in e.d3plus)var r="_"+e.d3plus.bucket;else r="";return"target"==t&&n?"url(#d3plus_edge_marker_default"+r+")":"none"}).attr("vector-effect","non-scaling-stroke").attr("pointer-events","none")}function l(e){e.attr("x1",function(e){return e[F.edges.source].d3plus.edges[e[F.edges.target][F.id.value]].x}).attr("y1",function(e){return e[F.edges.source].d3plus.edges[e[F.edges.target][F.id.value]].y}).attr("x2",function(e){return e[F.edges.target].d3plus.edges[e[F.edges.source][F.id.value]].x}).attr("y2",function(e){return e[F.edges.target].d3plus.edges[e[F.edges.source][F.id.value]].y})}F.edges.opacity.changed&&"string"===o&&F.edges.opacity.scale.value.domain(d3.extent(e,function(e){return e[a]})).range([F.edges.opacity.min.value,1]);var u=d3.svg.line().interpolate(F.edges.interpolate.value);function c(e){e.attr("d",function(e){return u(e.d3plus.spline)})}function d(e){if(delete e.d3plus_label,F.g.edges.selectAll("line, path").size()<F.edges.large&&F.edges.label&&e[F.edges.label]){if("spline"in e.d3plus)var t=this.getTotalLength(),r=this.getPointAtLength(t/2),n=this.getPointAtLength(t/2-.1*t),a=this.getPointAtLength(t/2+.1*t),o=Math.atan2(a.y-n.y,a.x-n.x)*(180/Math.PI),i=(this.parentNode.getBBox(),.8*t),s=r.x,l=r.y;else{this.getBBox();var u=e[F.edges.source],c=e[F.edges.target],d=u.d3plus.edges[c[F.id.value]].x,f=u.d3plus.edges[c[F.id.value]].y,p=c.d3plus.edges[u[F.id.value]].x,h=c.d3plus.edges[u[F.id.value]].y,v=p-d,g=h-f;r={x:p-v/2,y:h-g/2},o=Math.atan2(g,v)*(180/Math.PI),i=t=Math.sqrt(v*v+g*g),s=r.x,l=r.y}i+=2*F.labels.padding;var m=0;F.edges.arrows.value&&(m="number"==typeof F.edges.arrows.value?F.edges.arrows.value:8,i-=2*(m/=F.zoom.behavior.scaleExtent()[1])),(o<-90||90<o)&&(o-=180),20<i*F.zoom.behavior.scaleExtent()[0]&&(e.d3plus_label={x:s,y:l,translate:{x:s,y:l},w:i,h:15+2*F.labels.padding,angle:o,anchor:"middle",valign:"center",color:F.edges.color,resize:!1,names:[F.format.value(e[F.edges.label])],background:1})}}var f=F.edges.arrows.value?"string"==typeof F.edges.size.value?["default_0","default_1","default_2","highlight_0","highlight_1","highlight_2","focus_0","focus_1","focus_2"]:["default","highlight","focus"]:[];if("string"==typeof F.edges.size.value)for(var p=z(F.edges.scale.range(),4),T=[],h=0;h<3;h++)T.push(p[h+1]+(p[1]-p[0])*(h+2)*2);else{var v="number"==typeof F.edges.arrows.value?F.edges.arrows.value:8;T="number"==typeof F.edges.size.value?F.edges.size.value/v:v}var g=F.defs.selectAll(".d3plus_edge_marker").data(f,String),m=function(e){e.attr("d",function(e){var t=e.split("_");if(2==t.length&&F.edges.scale){t=parseInt(t[1]);var r=T[t]}else r=T;return"target"==F.edges.arrows.direction.value?"M 0,-"+r/2+" L "+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2:"M 0,-"+r/2+" L -"+.85*r+",0 L 0,"+r/2+" L 0,-"+r/2}).attr("fill",function(e){var t=e.split("_")[0];return"default"==t?F.edges.color:"focus"==t?F.color.focus:F.color.primary}).attr("transform","scale("+1/S+")")};F.draw.timing?(g.exit().transition().duration(F.draw.timing).attr("opacity",0).remove(),g.select("path").transition().duration(F.draw.timing).attr("opacity",1).call(m)):(g.exit().remove(),g.select("path").attr("opacity",1).call(m));var y=F.draw.timing?0:1,x=g.enter().append("marker").attr("id",function(e){return"d3plus_edge_marker_"+e}).attr("class","d3plus_edge_marker").attr("orient","auto").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("path").attr("opacity",y).attr("vector-effect","non-scaling-stroke").call(m);F.draw.timing&&x.transition().duration(F.draw.timing).attr("opacity",1);var B="string"==typeof F.edges.size.value?z(F.edges.scale.domain(),4):null,C=F.edges.arrows.direction.value,b=e.filter(function(e){if(e.d3plus||(e.d3plus={}),e.d3plus.id="edge_"+e[F.edges.source][F.id.value]+"_"+e[F.edges.target][F.id.value],!0!==e.d3plus.spline){if(B){var t=e[F.edges.size.value];e.d3plus.bucket=t<B[1]?0:t<B[2]?1:2;var r=.85*T[e.d3plus.bucket]/S}else{delete e.d3plus.bucket;r=.85*T/S}var n=e[F.edges.source],a=e[F.edges.target];if(!n.d3plus||!a.d3plus)return!1;var o=Math.atan2(n.d3plus.y-a.d3plus.y,n.d3plus.x-a.d3plus.x),i=Math.atan2(a.d3plus.y-n.d3plus.y,a.d3plus.x-n.d3plus.x),s="source"==C&&F.edges.arrows.value?n.d3plus.r+r:n.d3plus.r,l="target"==C&&F.edges.arrows.value?a.d3plus.r+r:a.d3plus.r,u=q(o,s,F.shape.value),c=q(i,l,F.shape.value);return"edges"in n.d3plus||(n.d3plus.edges={}),n.d3plus.edges[a[F.id.value]]={x:n.d3plus.x-u.x,y:n.d3plus.y-u.y},"edges"in a.d3plus||(a.d3plus.edges={}),a.d3plus.edges[n[F.id.value]]={x:a.d3plus.x-c.x,y:a.d3plus.y-c.y},!0}return!1}),w=F.g.edges.selectAll("g.d3plus_edge_line").data(b,function(e){return e.d3plus.id}),_=e.filter(function(e){if(e.d3plus.spline){if(B){var t=e[F.edges.size.value];e.d3plus.bucket=t<B[1]?0:t<B[2]?1:2;var r=.85*T[e.d3plus.bucket]/S}else{delete e.d3plus.bucket;r=.85*T/S}var n=e[F.edges.source],a=e[F.edges.target],o=n.d3plus.edges&&n.d3plus.edges[a[F.id.value]]||{},i=a.d3plus.edges&&a.d3plus.edges[n[F.id.value]]||{},s=F.edges.arrows.value&&"source"==C?r:0,l=F.edges.arrows.value&&"target"==C?r:0,u=n.d3plus.x>a.d3plus.x?.9:1.1,c=n.d3plus.x>a.d3plus.x?1.1:.9,d="number"==typeof o.angle?o.angle:Math.atan2(n.d3plus.y-a.d3plus.y,n.d3plus.x-a.d3plus.x)*u,f=q(d,n.d3plus.r+s,F.shape.value),p="number"==typeof i.angle?i.angle:Math.atan2(a.d3plus.y-n.d3plus.y,a.d3plus.x-n.d3plus.x)*c,h=q(p,a.d3plus.r+l,F.shape.value),v=[n.d3plus.x-f.x,n.d3plus.y-f.y],g=!!o.offset&&q(d,o.offset),m=g?[v[0]-g.x,v[1]-g.y]:v,y=[a.d3plus.x-h.x,a.d3plus.y-h.y],x=!!i.offset&&q(p,i.offset),b=x?[y[0]-x.x,y[1]-x.y]:y,w=b[0]-m[0],_=b[1]-m[1],k="number"==typeof o.radius?o.radius:Math.sqrt(w*w+_*_)/4,z="number"==typeof i.radius?i.radius:Math.sqrt(w*w+_*_)/4,A=q(d,k-n.d3plus.r-2*s),j=q(p,z-a.d3plus.r-2*l);e.d3plus.spline=[v,y];var M=Math.abs(Math.atan2(n.d3plus.y-a.d3plus.y,n.d3plus.x-a.d3plus.x)).toFixed(5),O=Math.abs(d).toFixed(5),E=Math.abs(p-Math.PI).toFixed(5);return(O!==E||[O,E].indexOf(M)<0)&&(e.d3plus.spline.splice(1,0,[m[0]-A.x,m[1]-A.y],[b[0]-j.x,b[1]-j.y]),g&&e.d3plus.spline.splice(1,0,m),x&&e.d3plus.spline.splice(e.d3plus.spline.length-1,0,b)),!0}return!1}),k=F.g.edges.selectAll("g.d3plus_edge_path").data(_,function(e){return e.d3plus.id});F.draw.timing?(w.exit().transition().duration(F.draw.timing).attr("opacity",0).remove(),k.exit().transition().duration(F.draw.timing).attr("opacity",0).remove(),w.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(F.draw.timing/2).attr("opacity",0).remove(),k.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(F.draw.timing/2).attr("opacity",0).remove(),w.selectAll("line").data(function(e){return[e]}).transition().duration(F.draw.timing).call(l).call(s).each("end",d),k.selectAll("path").data(function(e){return[e]}).transition().duration(F.draw.timing).call(c).call(s).each("end",d),w.enter().append("g").attr("class","d3plus_edge_line").append("line").call(l).call(i).transition().duration(F.draw.timing).call(s).each("end",d),k.enter().append("g").attr("class","d3plus_edge_path").append("path").call(c).call(i).transition().duration(F.draw.timing).call(s).each("end",d)):(w.exit().remove(),k.exit().remove(),w.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),k.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),w.selectAll("line").data(function(e){return[e]}).call(l).call(s).call(d),k.selectAll("path").data(function(e){return[e]}).call(c).call(s).call(d),w.enter().append("g").attr("class","d3plus_edge_line").append("line").call(l).call(i).call(s).call(d),k.enter().append("g").attr("class","d3plus_edge_path").append("path").call(c).call(i).call(s).call(d))}},{"../../../geom/offset.coffee":161,"../../../util/buckets.coffee":204}],227:[function(e,t,r){var x=e("../../../util/copy.coffee"),b=e("../../../core/fetch/color.coffee"),w=(e("../../../core/fetch/value.coffee"),e("./segments.coffee")),_=e("./style.coffee");t.exports=function(v,e,t,r){function g(e){e.attr("x",0).attr("y",0).attr("width",0).attr("height",0)}function m(e,r){r||(r=0),e.attr("x",function(e){return-(e.d3plus.r?2*e.d3plus.r:e.d3plus.width)/2-r/2}).attr("y",function(e){return-(e.d3plus.r?2*e.d3plus.r:e.d3plus.height)/2-r/2}).attr("width",function(e){return(e.d3plus.r?2*e.d3plus.r:e.d3plus.width)+r}).attr("height",function(e){return(e.d3plus.r?2*e.d3plus.r:e.d3plus.height)+r}).attr("rx",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return 0<=["circle","donut"].indexOf(v.shape.value)?(t+r)/2:0}).attr("ry",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return 0<=["circle","donut"].indexOf(v.shape.value)?(t+r)/2:0}).attr("shape-rendering",function(e){return 0<=["square"].indexOf(v.shape.value)?v.shape.rendering.value:"auto"})}v.arcs||(v.arcs={donut:{},active:{},temp:{}});var l=d3.svg.arc().startAngle(0).endAngle(function(e){var t=v.arcs[e.d3plus.shape][e.d3plus.id].a;return t>2*Math.PI?2*Math.PI:t}).innerRadius(function(e){return e.d3plus.static||"donut"!==v.shape.value?0:v.arcs[e.d3plus.shape][e.d3plus.id].r*v.data.donut.size}).outerRadius(function(e){var t=v.arcs[e.d3plus.shape][e.d3plus.id].r;return"donut"===v.shape.value?t:2*t});function y(e,o,i,s){o||(o=0),"number"!=typeof i&&(i=void 0),"number"!=typeof s&&(s=void 0),e.attrTween("d",function(t){if(void 0===i)var e=t.d3plus.r?t.d3plus.r:d3.max([t.d3plus.width,t.d3plus.height]);else e=i;if(void 0===s)var r=t.d3plus.segments[t.d3plus.shape];else r=s;v.arcs[t.d3plus.shape][t.d3plus.id]||(v.arcs[t.d3plus.shape][t.d3plus.id]={r:0},v.arcs[t.d3plus.shape][t.d3plus.id].a="donut"===t.d3plus.shape?2*Math.PI:0);var n=d3.interpolate(v.arcs[t.d3plus.shape][t.d3plus.id].r,e+o),a=d3.interpolate(v.arcs[t.d3plus.shape][t.d3plus.id].a,r);return function(e){return v.arcs[t.d3plus.shape][t.d3plus.id].r=n(e),v.arcs[t.d3plus.shape][t.d3plus.id].a=a(e),l(t)}})}e.each(function(e){var t=w(v,e,"active"),r=w(v,e,"temp"),n=w(v,e,"total"),a=d3.select(this),o=b(v,e),i=[],s=[];if(n&&v.types[v.type.value].fill){var l;if(r)(l=x(e)).d3plus.shape="temp",i.push(l),s=["temp"];if(t&&(t<n||r))(l=x(e)).d3plus.shape="active",i.push(l)}function u(e){e.attr("stroke",o).attr("stroke-width",1).attr("shape-rendering",v.shape.rendering.value)}var c=v.defs.selectAll("pattern#d3plus_hatch_"+e.d3plus.id).data(s);v.draw.timing?(c.selectAll("rect").transition().duration(v.draw.timing).style("fill",o),c.selectAll("line").transition().duration(v.draw.timing).style("stroke",o)):(c.selectAll("rect").style("fill",o),c.selectAll("line").style("stroke",o));var d=c.enter().append("pattern").attr("id","d3plus_hatch_"+e.d3plus.id).attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g");d.append("rect").attr("x","0").attr("y","0").attr("width","10").attr("height","10").attr("fill",o).attr("fill-opacity",.25),d.append("line").attr("x1","0").attr("x2","10").attr("y1","0").attr("y2","10").call(u),d.append("line").attr("x1","-1").attr("x2","1").attr("y1","9").attr("y2","11").call(u),d.append("line").attr("x1","9").attr("x2","11").attr("y1","-1").attr("y2","1").call(u);var f=i.length?[e]:[],p=a.selectAll("#d3plus_clip_"+e.d3plus.id).data(f);p.enter().insert("clipPath",".d3plus_mouse").attr("id","d3plus_clip_"+e.d3plus.id).append("rect").attr("class","d3plus_clipping").call(g),v.draw.timing?(p.selectAll("rect").transition().duration(v.draw.timing).call(m),p.exit().transition().delay(v.draw.timing).remove()):(p.selectAll("rect").call(m),p.exit().remove());var h=a.selectAll("path.d3plus_fill").data(i);h.transition().duration(v.draw.timing).call(_,v).call(y),h.enter().insert("path","rect.d3plus_mouse").attr("class","d3plus_fill").attr("clip-path","url(#d3plus_clip_"+e.d3plus.id+")").transition().duration(0).call(_,v).call(y,0,void 0,0).transition().duration(v.draw.timing).call(y).call(_,v),h.exit().transition().duration(v.draw.timing).call(y,0,void 0,0).remove()})}},{"../../../core/fetch/color.coffee":63,"../../../core/fetch/value.coffee":67,"../../../util/copy.coffee":207,"./segments.coffee":233,"./style.coffee":234}],228:[function(e,t,r){e("../../../util/copy.coffee");var E=e("../../../core/fetch/text.js"),F=e("../../../core/fetch/value.coffee"),a=e("../../../color/mix.coffee"),n=e("../../../core/console/print.coffee"),S=(e("../../../client/rtl.coffee"),e("./segments.coffee")),i=e("./color.coffee"),T=e("../../../string/list.coffee"),s=e("../../../color/text.coffee"),l=e("../../../textwrap/textwrap.coffee");t.exports=function(z,e){var A=z.types[z.type.value].zoom?z.zoom.behavior.scaleExtent():[1,1],t=z.g[e].selectAll("g"),j=function(e){e.attr("opacity",function(e){var t=parseFloat(d3.select(this).attr("font-size"),10);return e.visible=2<=t*(z.zoom.scale/A[1]),e.visible?1:0})},M=function(e){z.draw.timing?e.transition().duration(z.draw.timing).attr("opacity",0).remove():e.remove()},O=function(e){var o="bottom"===z.labels.valign.value?"top":"bottom";e.attr("font-weight",z.labels.font.weight).attr("font-family",z.labels.font.family.value).attr("stroke","none").attr("pointer-events",function(e){return e.mouse?"auto":"none"}).attr("fill",function(e){if(e.color)return e.color;var t=i(e.parent,z),r=s(t),n=e.text?.15:1;return a(t,r,.2,n)}).each(function(e){if(e.resize instanceof Array)e.resize[0],e.resize[1];var t=e.resize,r=!0;if(e.text){t instanceof Array||(t=[9,50],r=e.resize);var n=e.y-e.h*A[1]/2+e.padding/2;"bottom"===o&&(n+=e.h*A[1]/2),l().align("center").container(d3.select(this)).height(e.h*A[1]/2).padding(e.padding/2).resize(r).size(t).text(z.format.value(100*e.text,{key:"share",vars:z})).width(e.w*A[1]).valign(o).x(e.x-e.w*A[1]/2+e.padding/2).y(n).draw()}else{e.resize instanceof Array||(t=[7,A[1]/A[0]*40],r=e.resize);var a="bottom"===z.labels.valign.value?e.share:0;l().align(e.anchor||z.labels.align.value).container(d3.select(this)).height(e.h*A[1]-e.share).padding(e.padding/2).resize(r).size(t).shape(e.shape||"square").text(e.names).valign(z.labels.valign.value).width(e.w*A[1]).x(e.x-e.w*A[1]/2+e.padding/2).y(e.y-e.h*A[1]/2+e.padding/2+a).draw()}}).attr("transform",function(e){var t=d3.select(this).attr("transform")||"",r=e.angle||0,n=e.translate&&e.translate.x?e.translate.x:0,a=e.translate&&e.translate.y?e.translate.y:0;return t.length&&(t=t.split(")").slice(-3).join(")")),"rotate("+r+","+n+","+a+")scale("+1/A[1]+")translate("+(e.x*A[1]-e.x)+","+(e.y*A[1]-e.y)+")"+t})};if("edges"===e||z.labels.value){if(z.dev.value){var r="drawing "+e+" labels";n.time(r)}t.each(function(e){var t=e.d3plus&&"label"in e.d3plus&&!e.d3plus.label,a=e.d3plus_label||null,r=e.d3plus_share,n=e.d3plus.text?e.d3plus.text:a&&a.names?a.names:z.labels.text.value?F(z,e,z.labels.text.value):E(z,e),o=a&&"group"in a?a.group:d3.select(this),i=0,s=z.types[z.type.value].fill;if(n instanceof Array||(n=[n]),a)if(0<=["line","area"].indexOf(z.shape.value))var l=!0;else if(e&&"d3plus"in e){var u=S(z,e,"active"),c=S(z,e,"temp"),d=S(z,e,"total");l=!c&&!u||d<=u||!u&&d<=c}if(t||!(a&&a.force||l)&&s)delete e.d3plus_label,d3.select(this).selectAll("text#d3plus_label_"+e.d3plus.id+", rect#d3plus_label_bg_"+e.d3plus.id).call(M),z.g.labels.selectAll("text#d3plus_label_"+e.d3plus.id+", rect#d3plus_label_bg_"+e.d3plus.id).call(M);else{if(r&&e.d3plus.share&&10<=r.w-2*z.labels.padding&&10<=r.h-2*z.labels.padding&&"middle"!=z.labels.valign.value){r.resize=!1!==z.labels.resize.value&&(!(r&&"resize"in r)||r.resize),r.padding=z.labels.padding,r.text=e.d3plus.share,r.parent=e;var f=o.selectAll("text#d3plus_share_"+e.d3plus.id).data([r],function(e){return e.w+""+e.h+e.text});z.draw.timing&&1===z.zoom.scale?(f.transition().duration(z.draw.timing/2).call(O),f.enter().append("text").attr("id","d3plus_share_"+e.d3plus.id).attr("class","d3plus_share").attr("opacity",0).call(O).transition().duration(z.draw.timing/2).delay(z.draw.timing/2).attr("opacity",1)):(f.attr("opacity",1).call(O),f.enter().append("text").attr("id","d3plus_share_"+e.d3plus.id).attr("class","d3plus_share").attr("opacity",1).call(O)),i=f.node().getBBox().height+z.labels.padding,f.exit().call(M)}else o.selectAll("text.d3plus_share").call(M);if(a&&(a.resize=!1!==z.labels.resize.value&&(!(a&&"resize"in a)||a.resize),a.padding="number"==typeof a.padding?a.padding:z.labels.padding),a&&20<=a.w*A[1]-a.padding&&10<=a.h*A[1]-a.padding&&n.length){for(var p=z.format.locale.value.ui.and,h=z.format.locale.value.ui.more,v=0;v<n.length;v++)n[v]instanceof Array&&(n[v]=T(n[v],p,3,h));a.names=n,a.share=i,a.parent=e;f=o.selectAll("text#d3plus_label_"+e.d3plus.id).data([a],function(e){return!!e&&e.w+"_"+e.h+"_"+e.x+"_"+e.y+"_"+e.names.join("_")});var g=a.resize?void 0:z.labels.font.size*A[0]+"px";if(z.draw.timing&&1===z.zoom.scale?(f.transition().duration(z.draw.timing/2).call(O).call(j),f.enter().append("text").attr("font-size",g).attr("id","d3plus_label_"+e.d3plus.id).attr("class","d3plus_label").attr("opacity",0).call(O).transition().duration(z.draw.timing/2).delay(z.draw.timing/2).call(j)):(f.attr("opacity",1).call(O).call(j),f.enter().append("text").attr("font-size",g).attr("id","d3plus_label_"+e.d3plus.id).attr("class","d3plus_label").call(O).call(j)),f.exit().call(M),0===f.size()||0===f.selectAll("tspan").size())delete e.d3plus_label,d3.select(this).selectAll("text#d3plus_label_"+e.d3plus.id+", rect#d3plus_label_bg_"+e.d3plus.id).call(M),z.g.labels.selectAll("text#d3plus_label_"+e.d3plus.id+", rect#d3plus_label_bg_"+e.d3plus.id).call(M);else{if(a.background){var m=["background"],y=f.node().getBBox();(b={height:y.height,width:y.width,x:y.x,y:0<y.y?y.y:-y.height/2}).width+=z.labels.padding*A[0],b.height+=z.labels.padding*A[0],b.x-=z.labels.padding*A[0]/2,b.y-=z.labels.padding*A[0]/2;var x=f.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0];1<(x=(x=x.replace(/([^a-z])\s([^a-z])/gi,"$1,$2")).split(",")).length&&(x=(x=x[x.length-1]).substring(0,x.length-1),b.y+=parseFloat(x))}else{m=[];var b={}}var w=o.selectAll("rect#d3plus_label_bg_"+e.d3plus.id).data(m),_="number"==typeof a.background?a.background:"string"==typeof a.background?1:.6;function k(e){var t="string"==typeof a.background?a.background:"none"===z.background.value?"#ffffff":z.background.value,r="string"==typeof a.background?a.background:t,n=f.attr("transform").split(")");n.pop(),n.pop(),n.push(""),n=n.join(")"),e.attr("fill",r).attr(b).attr("transform",n)}z.draw.timing?(w.exit().transition().duration(z.draw.timing).attr("opacity",0).remove(),w.transition().duration(z.draw.timing).attr("opacity",_).call(k),w.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+e.d3plus.id).attr("class","d3plus_label_bg").attr("opacity",0).call(k).transition().duration(z.draw.timing).attr("opacity",_)):(w.exit().remove(),w.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+e.d3plus.id).attr("class","d3plus_label_bg"),w.attr("opacity",_).call(k))}}else delete e.d3plus_label,d3.select(this).selectAll("text#d3plus_label_"+e.d3plus.id+", rect#d3plus_label_bg_"+e.d3plus.id).call(M),z.g.labels.selectAll("text#d3plus_label_"+e.d3plus.id+", rect#d3plus_label_bg_"+e.d3plus.id).call(M)}}),z.dev.value&&n.timeEnd(r)}else{if(z.dev.value){r="removing "+e+" labels";n.time(r)}t.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(M),z.g.labels.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(M),z.dev.value&&n.timeEnd(r)}}},{"../../../client/rtl.coffee":40,"../../../color/mix.coffee":46,"../../../color/text.coffee":50,"../../../core/console/print.coffee":52,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../string/list.coffee":174,"../../../textwrap/textwrap.coffee":200,"../../../util/copy.coffee":207,"./color.coffee":220,"./segments.coffee":233}],229:[function(e,t,r){var v=e("../../../util/copy.coffee"),g=e("../../../util/closest.coffee"),m=e("../../../client/pointer.coffee"),y=e("./style.coffee"),x=e("../../../core/fetch/value.coffee");function b(e){e.attr("x",function(e){return e.d3plus.x}).attr("y",function(e){return e.d3plus.y}).attr("width",0).attr("height",0)}function w(e,r){void 0===r&&(r=0),e.attr("x",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.width;return e.d3plus.x-(t/2+r/2)}).attr("y",function(e){var t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height;return e.d3plus.y-(t/2+r/2)}).attr("width",function(e){return(e.d3plus.r?2*e.d3plus.r:e.d3plus.width)+r}).attr("height",function(e){return(e.d3plus.r?2*e.d3plus.r:e.d3plus.height)+r}).attr("rx",function(e){return((e.d3plus.r?2*e.d3plus.r:e.d3plus.width)+r)/2}).attr("ry",function(e){return((e.d3plus.r?2*e.d3plus.r:e.d3plus.height)+r)/2})}function _(n,e,a,o){var t=n.draw.timing?n.timing.mouseevents:0;void 0===o&&(o=0),t?(d3.select(e.parentNode).selectAll("path.d3plus_line").transition().duration(t).style("stroke-width",function(e){var t=a;if(t.constructor!==Number){var r=x(n,e,a);t=r&&r.length?d3.max(r):n.data.stroke.width}return t+o}),d3.select(e.parentNode).selectAll("rect").transition().duration(t).style("stroke-width",function(e){var t=a;if(t.constructor!==Number){var r=x(n,e,a);t=r&&r.length?d3.max(r):n.data.stroke.width}return t}).call(w,o)):(d3.select(e.parentNode).selectAll("path.d3plus_line").style("stroke-width",function(e){var t=a;if(t.constructor!==Number){var r=x(n,e,a);t=r&&r.length?d3.max(r):n.data.stroke.width}return t+o}),d3.select(e.parentNode).selectAll("rect").style("stroke-width",function(e){var t=a;if(t.constructor!==Number){var r=x(n,e,a);t=r&&r.length?d3.max(r):n.data.stroke.width}return t}).call(w,o))}t.exports=function(c,e,t,r){var a=d3.svg.line().x(function(e){return e.d3plus.x}).y(function(e){return e.d3plus.y}).interpolate(c.shape.interpolate.value),d=c.size.value||c.data.stroke.width,f=c[c.axes.discrete],p=function(e){var t=d;if(t.constructor!==Number){var r=x(c,e,d);t=r&&r.length?d3.max(r):c.data.stroke.width}return t<15?15:t},h=f.ticks.values.map(function(e){return e.constructor===Date?e.getTime():e});e.each(function(o){var i=!1,s=[],l=[],u=v(o),e=d3.select(this);u.values=[],u.segment_key=u.key,o.values.forEach(function(e,t,r){var n=x(c,e,f.value);n.constructor===Date&&(n=n.getTime());var a=h.indexOf(g(h,n));!1===i||i===a-1?(u.values.push(e),u.segment_key+="_"+a):(1<u.values.length?s.push(u):l.push(u.values[0]),(u=v(o)).values=[e]),t===r.length-1&&(1<u.values.length?s.push(u):l.push(u.values[0])),i=a});var t=e.selectAll("path.d3plus_line").data(s,function(e){return e.d3plus||(e.d3plus={}),e.d3plus.shape="line",e.segment_key}),r=e.selectAll("rect.d3plus_anchor").data(l,function(e){return e.d3plus||(e.d3plus={}),e.d3plus.r=d,e.d3plus.id});c.draw.timing?(t.exit().transition().duration(c.draw.timing).attr("opacity",0).remove(),t.transition().duration(c.draw.timing).attr("d",function(e){return a(e.values)}).call(y,c),t.enter().append("path").attr("class","d3plus_line").style("stroke-linecap","round").attr("d",function(e){return a(e.values)}).call(y,c).attr("opacity",0).transition().duration(c.draw.timing).attr("opacity",1),r.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(e){return e.d3plus.id}).call(b).call(y,c),r.transition().duration(c.draw.timing).call(w).call(y,c),r.exit().transition().duration(c.draw.timing).call(b).remove()):(t.exit().remove(),t.enter().append("path").attr("class","d3plus_line").style("stroke-linecap","round"),t.attr("d",function(e){return a(e.values)}).call(y,c),r.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(e){return e.d3plus.id}),r.exit().remove(),r.call(w).call(y,c));var n=e.selectAll("path.d3plus_mouse").data(s,function(e){return e.segment_key});n.enter().append("path").attr("class","d3plus_mouse").attr("d",function(e){return a(e.values)}).style("stroke","black").style("stroke-width",p).style("fill","none").style("stroke-linecap","round").attr("opacity",0),n.on(m.over,function(e){!c.draw.frozen&&c.mouse.value&&c.mouse.over.value&&_(c,this,d,2)}).on(m.out,function(e){!c.draw.frozen&&c.mouse.value&&c.mouse.out.value&&_(c,this,d,0)}),c.draw.timing?n.transition().duration(c.draw.timing).attr("d",function(e){return a(e.values)}).style("stroke-width",p):n.attr("d",function(e){return a(e.values)}).style("stroke-width",p),n.exit().remove()})}},{"../../../client/pointer.coffee":38,"../../../core/fetch/value.coffee":67,"../../../util/closest.coffee":206,"../../../util/copy.coffee":207,"./style.coffee":234}],230:[function(e,t,r){t.exports=function(t){var e=t.returned.edges||[],r=t.g.edges.selectAll("g.d3plus_edge_path").data(e,function(e){return e.d3plus.id="path_"+e[t.edges.source][t.id.value]+"_"+e[t.edges.target][t.id.value],e.d3plus.id});function n(e){e.attr("d",t.edges.path).style("stroke-width",function(e){return Math.max(1,e.dy)}).style("stroke","#ddd").style("fill","none").attr("transform",function(e){return"translate("+e.d3plus.x+","+e.d3plus.y+")"})}t.draw.timing?(r.exit().transition().duration(t.draw.timing).attr("opacity",0).remove(),r.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(t.draw.timing/2).attr("opacity",0).remove(),r.selectAll("path").data(function(e){return[e]}).transition().duration(t.draw.timing).call(n),r.enter().append("g").attr("class","d3plus_edge_path").append("path").style("stroke-width",0).transition().duration(t.draw.timing).call(n)):(r.exit().remove(),r.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove(),r.selectAll("path").data(function(e){return[e]}).call(n),r.enter().append("g").attr("class","d3plus_edge_path").append("path").call(n))}},{}],231:[function(e,t,r){var d,f,p,s;s=e("./style.coffee"),p={},d={},f={r:{},a:{}},t.exports=function(i,e,t,r){var n,u,c,a,o;c=i.id.nesting[i.depth.value+1],a=d3.svg.line.radial().interpolate("linear-closed").radius(function(e){return e.d3plus.r}).angle(function(e){return e.d3plus.a}),n=function(e){return i.labels.value&&(e.d3plus.label?e.d3plus_label=e.d3plus.label:delete e.d3plus_label),[e]},i.draw.timing?(e.each(function(e){var t,r,n,a,o;for(o=[],r=0,n=(a=e[c]).length;r<n;r++)t=a[r],o.push(t.d3plus.id=t[i.id.value]+"_"+t[c]);return o}),u=d3.svg.line.radial().interpolate("linear-closed").radius(function(e,t){return void 0===p[e.d3plus.id]&&(p[e.d3plus.id]=0),isNaN(p[e.d3plus.id])&&(p[e.d3plus.id]=e.d3plus.r),p[e.d3plus.id]}).angle(function(e,t){return void 0===d[e.d3plus.id]&&(d[e.d3plus.id]=e.d3plus.a),isNaN(d[e.d3plus.id])&&(d[e.d3plus.id]=e.d3plus.a),d[e.d3plus.id]}),o=function(e,l){return e.attrTween("d",function(a){var e,o,i,t,r,n,s;for(s=a[c],i=t=0,r=s.length;t<r;i=++t)e=(o=s[i]).d3plus.a,void 0===l?n=o.d3plus.r:0===l&&(n=0),f.a[o.d3plus.id]=d3.interpolate(d[o.d3plus.id],e),f.r[o.d3plus.id]=d3.interpolate(p[o.d3plus.id],n);return function(e){var t,r,n;for(n=a[c],i=t=0,r=n.length;t<r;i=++t)o=n[i],d[o.d3plus.id]=f.a[o.d3plus.id](e),p[o.d3plus.id]=f.r[o.d3plus.id](e);return u(a[c])}})},t.append("path").attr("class","d3plus_data").call(s,i).attr("d",function(e){return u(e[c])}),e.selectAll("path.d3plus_data").data(n).transition().duration(i.draw.timing).call(s,i).call(o),r.selectAll("path.d3plus_data").transition().duration(i.draw.timing).call(o,0)):(t.append("path").attr("class","d3plus_data"),e.selectAll("path.d3plus_data").data(n).call(s,i).attr("d",function(e){return a(e[c])}))}},{"./style.coffee":234}],232:[function(e,t,r){var s;s=e("./style.coffee"),t.exports=function(n,e,t,r){var a,o,i;return a=function(e){var t,r;return n.labels.value&&!e.d3plus.label?(r=e.d3plus.r?2*e.d3plus.r:e.d3plus.width,t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height,e.d3plus_label={w:r,h:t,x:0,y:0},e.d3plus_share={w:r,h:t,x:0,y:0},e.d3plus_label.shape="circle"===e.d3plus.shape?"circle":"square"):e.d3plus.label?e.d3plus_label=e.d3plus.label:delete e.d3plus_label,[e]},o=function(e){return e.attr("x",function(e){return e.d3plus.init&&"x"in e.d3plus.init?e.d3plus.init.x:e.d3plus.init&&"width"in e.d3plus.init?-e.d3plus.width/2:0}).attr("y",function(e){return e.d3plus.init&&"y"in e.d3plus.init?e.d3plus.init.y:e.d3plus.init&&"height"in e.d3plus.init?-e.d3plus.height/2:0}).attr("width",function(e){return e.d3plus.init&&"width"in e.d3plus.init?e.d3plus.init.width:0}).attr("height",function(e){return e.d3plus.init&&"height"in e.d3plus.init?e.d3plus.init.height:0})},i=function(e){return e.attr("x",function(e){return-(e.d3plus.r?2*e.d3plus.r:e.d3plus.width)/2}).attr("y",function(e){return-(e.d3plus.r?2*e.d3plus.r:e.d3plus.height)/2}).attr("width",function(e){return e.d3plus.r?2*e.d3plus.r:e.d3plus.width}).attr("height",function(e){return e.d3plus.r?2*e.d3plus.r:e.d3plus.height}).attr("rx",function(e){var t,r;return t="circle"===e.d3plus.shape,r=e.d3plus.r?2*e.d3plus.r:e.d3plus.width,t?(r+2)/2:0}).attr("ry",function(e){var t,r;return r="circle"===e.d3plus.shape,t=e.d3plus.r?2*e.d3plus.r:e.d3plus.height,r?(t+2)/2:0}).attr("transform",function(e){return"rotate"in e.d3plus?"rotate("+e.d3plus.rotate+")":""}).attr("shape-rendering",function(e){return"square"!==e.d3plus.shape||"rotate"in e.d3plus?"auto":n.shape.rendering.value})},n.draw.timing?(t.append("rect").attr("class","d3plus_data").call(o).call(s,n),e.selectAll("rect.d3plus_data").data(a).transition().duration(n.draw.timing).call(i).call(s,n),r.selectAll("rect.d3plus_data").transition().duration(n.draw.timing).call(o)):(t.append("rect").attr("class","d3plus_data"),e.selectAll("rect.d3plus_data").data(a).call(i).call(s,n))}},{"./style.coffee":234}],233:[function(e,t,r){var a;a=e("../../../core/fetch/value.coffee"),t.exports=function(e,t,r){var n;return(n=e[r].value)?r in t.d3plus?t.d3plus[r]:a(e,t,n):t.d3plus[r]}},{"../../../core/fetch/value.coffee":67}],234:[function(e,t,r){var n,a,o;n=e("./color.coffee"),a=e("../../../client/ie.js"),o=e("../../../core/fetch/value.coffee"),t.exports=function(e,r){return e.attr("fill",function(e){return e.d3plus&&e.d3plus.spline?"none":n(e,r)}).style("stroke",function(e){var t;return e.d3plus&&e.d3plus.stroke?e.d3plus.stroke:(t=e.values?n(e.values[0],r):n(e,r,!0),d3.rgb(t).darker(.6))}).style("stroke-width",function(e){var t;if(a&&r.types[r.type.value].zoom)return 0;if("line"===e.d3plus.shape&&r.size.value){if(r.size.value.constructor===Number)return r.size.value;if((t=o(r,e,r.size.value))&&t.length)return d3.max(t)}return r.data.stroke.width}).attr("opacity",r.data.opacity).attr("vector-effect","non-scaling-stroke")}},{"../../../client/ie.js":37,"../../../core/fetch/value.coffee":67,"./color.coffee":220}],235:[function(e,t,r){var o=e("./style.coffee");t.exports=function(e,t,r,n){function a(e){e.attr("d",d3.svg.symbol().type("triangle-down").size(function(e){var t=Math.min(e.d3plus.width,e.d3plus.height);return d3.scale.pow().exponent(2)(t/2)}))}r.append("path").attr("class","d3plus_data").call(function(e){e.attr("d",d3.svg.symbol().type("triangle-down").size(10))}).call(o,e),t.selectAll("path.d3plus_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(a).call(o,e):t.selectAll("path.d3plus_data").call(a).call(o,e)}},{"./style.coffee":234}],236:[function(e,t,r){var o=e("./style.coffee");t.exports=function(e,t,r,n){function a(e){e.attr("d",d3.svg.symbol().type("triangle-up").size(function(e){var t=Math.min(e.d3plus.width,e.d3plus.height);return d3.scale.pow().exponent(2)(t/2)}))}r.append("path").attr("class","d3plus_data").call(function(e){e.attr("d",d3.svg.symbol().type("triangle-up").size(10))}).call(o,e),t.selectAll("path.d3plus_data").data(function(e){return[e]}),e.draw.timing?t.selectAll("path.d3plus_data").transition().duration(e.draw.timing).call(a).call(o,e):t.selectAll("path.d3plus_data").call(a).call(o,e)}},{"./style.coffee":234}],237:[function(e,t,r){t.exports=function(t,e,r,n){var a,o,i,s,l,u,c,d,f;o=function(e){return e.d3plus.text?e.d3plus_label={w:d,h:d,x:0,y:0,background:"#fff",resize:!1,angle:0<=["left","right"].indexOf(e.d3plus.position)?90:0}:e.d3plus.label?e.d3plus_label=e.d3plus.label:delete e.d3plus_label,[e]},f=function(e){return e.style("stroke-width",t.data.stroke.width).style("stroke","#444").attr("fill","none").attr("shape-rendering",t.shape.rendering.value)},i=function(e){return e.attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0)},c=function(e){return e.attr("x1",function(e){var t,r;return 0<=["top","bottom"].indexOf(e.d3plus.position)?0:(t=e.d3plus.offset||0,r=e.d3plus.width||0,(t<0?-r:r)+t)}).attr("x2",function(e){return 0<=["top","bottom"].indexOf(e.d3plus.position)?0:e.d3plus.offset||0}).attr("y1",function(e){var t,r;return 0<=["left","right"].indexOf(e.d3plus.position)?0:(r=e.d3plus.offset||0,t=e.d3plus.height||0,(r<0?-t:t)+r)}).attr("y2",function(e){return 0<=["left","right"].indexOf(e.d3plus.position)?0:e.d3plus.offset||0}).attr("marker-start","url(#d3plus_whisker_marker)")},(s=t.defs.selectAll("#d3plus_whisker_marker").data([0])).enter().append("marker").attr("id","d3plus_whisker_marker").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("line"),(a=e.datum())?(u=a.d3plus.position,l=0<=["top","bottom"].indexOf(u)?"horizontal":"vertical",d="horizontal"===l?a.d3plus.width:a.d3plus.height):(l="horizontal",d=0),s.select("line").attr("x1","horizontal"===l?-d/2:0).attr("x2","horizontal"===l?d/2:0).attr("y1","vertical"===l?-d/2:0).attr("y2","vertical"===l?d/2:0).call(f).style("stroke-width",2*t.data.stroke.width),t.draw.timing?(r.append("line").attr("class","d3plus_data").call(f).call(i),e.selectAll("line.d3plus_data").data(o).transition().duration(t.draw.timing).call(f).call(c),n.selectAll("line.d3plus_data").transition().duration(t.draw.timing).call(i)):(r.append("line").attr("class","d3plus_data"),e.selectAll("line.d3plus_data").data(o).call(f).call(c))}},{}],238:[function(e,t,r){var n=e("../../../client/pointer.coffee"),a=e("../../../client/prefix.coffee"),o=e("../../../core/console/print.coffee"),i=e("../../../client/touch.coffee"),s=e("../zoom/propagation.coffee");t.exports=function(t){t.dev.value&&o.time("creating SVG elements"),t.svg=t.container.value.selectAll("svg#d3plus").data([0]),t.svg.enter().insert("svg","#d3plus_message").attr("id","d3plus").attr("width",t.width.value).attr("height",t.height.value).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink"),t.g.bg=t.svg.selectAll("rect#bg").data(["bg"]),t.g.bg.enter().append("rect").attr("id","bg").attr("fill",t.background.value).attr("stroke","none").attr("width",t.width.value).attr("height",t.height.value),t.g.timeline=t.svg.selectAll("g#timeline").data(["timeline"]),t.g.timeline.enter().append("g").attr("id","timeline").attr("transform","translate(0,"+t.height.value+")"),t.g.legend=t.svg.selectAll("g#key").data(["key"]),t.g.legend.enter().append("g").attr("id","key").attr("transform","translate(0,"+t.height.value+")"),t.g.footer=t.svg.selectAll("g#footer").data(["footer"]),t.g.footer.enter().append("g").attr("id","footer").attr("transform","translate(0,"+t.height.value+")");var e="clipping_"+t.container.id;t.g.clipping=t.svg.selectAll("#clipping").data(["clipping"]),t.g.clipping.enter().append("clipPath").attr("id",e).append("rect").attr("width",t.width.viz).attr("height",t.height.viz),t.g.container=t.svg.selectAll("g#container").data(["container"]),t.g.container.enter().append("g").attr("id","container").attr("clip-path","url(#"+e+")").attr("transform","translate("+t.margin.left+","+t.margin.top+")"),t.g.zoom=t.g.container.selectAll("g#zoom").data(["zoom"]),t.g.zoom.enter().append("g").attr("id","zoom"),t.g.viz=t.g.zoom.selectAll("g#d3plus_viz").data(["d3plus_viz"]),t.g.viz.enter().append("g").attr("id","d3plus_viz"),t.g.overlay=t.g.viz.selectAll("rect#d3plus_overlay").data([{id:"d3plus_overlay"}]),t.g.overlay.enter().append("rect").attr("id","d3plus_overlay").attr("width",t.width.value).attr("height",t.height.value).attr("opacity",0),t.g.overlay.on(n.move,function(e){i&&s(t,d3.event),t.types[t.type.value].zoom&&t.zoom.pan.value&&t.zoom.behavior.scaleExtent()[0]<t.zoom.scale?d3.select(this).style("cursor",a()+"grab"):d3.select(this).style("cursor","auto")}).on(n.up,function(e){i&&s(t,d3.event),t.types[t.type.value].zoom&&t.zoom.pan.value&&t.zoom.behavior.scaleExtent()[0]<t.zoom.scale?d3.select(this).style("cursor",a()+"grab"):d3.select(this).style("cursor","auto")}).on(n.down,function(e){i&&s(t,d3.event),t.types[t.type.value].zoom&&t.zoom.pan.value&&t.zoom.behavior.scaleExtent()[0]<t.zoom.scale?d3.select(this).style("cursor",a()+"grabbing"):d3.select(this).style("cursor","auto")}),t.g.app=t.g.viz.selectAll("g#app").data(["app"]),t.g.app.enter().append("g").attr("id","app"),t.g.edges=t.g.viz.selectAll("g#edges").data(["edges"]),t.g.edges.enter().append("g").attr("id","edges").attr("opacity",0),t.g.edge_focus=t.g.viz.selectAll("g#focus").data(["focus"]),t.g.edge_focus.enter().append("g").attr("id","focus"),t.g.edge_hover=t.g.viz.selectAll("g#edge_hover").data(["edge_hover"]),t.g.edge_hover.enter().append("g").attr("id","edge_hover").attr("opacity",0),t.g.data=t.g.viz.selectAll("g#data").data(["data"]),t.g.data.enter().append("g").attr("id","data").attr("opacity",0),t.g.data_focus=t.g.viz.selectAll("g#data_focus").data(["data_focus"]),t.g.data_focus.enter().append("g").attr("id","data_focus"),t.g.labels=t.g.viz.selectAll("g#d3plus_labels").data(["d3plus_labels"]),t.g.labels.enter().append("g").attr("id","d3plus_labels"),t.defs=t.svg.selectAll("defs").data(["defs"]),t.defs.enter().append("defs"),t.dev.value&&o.timeEnd("creating SVG elements")}},{"../../../client/pointer.coffee":38,"../../../client/prefix.coffee":39,"../../../client/touch.coffee":43,"../../../core/console/print.coffee":52,"../zoom/propagation.coffee":253}],239:[function(e,t,r){var n=e("../../../core/console/print.coffee");t.exports=function(e){e.dev.value&&n.time("updating SVG elements"),e.draw.timing?(e.container.value.transition().duration(e.draw.timing).style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value),e.g.bg.transition().duration(e.draw.timing).attr("width",e.width.value).attr("height",e.height.value).attr("fill",e.background.value),e.g.clipping.select("rect").transition().duration(e.draw.timing).attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.transition().duration(e.draw.timing).attr("transform","translate("+e.margin.left+","+e.margin.top+")")):(e.container.value.style("width",e.width.value+"px").style("height",e.height.value+"px"),e.svg.attr("width",e.width.value).attr("height",e.height.value),e.g.bg.attr("width",e.width.value).attr("height",e.height.value).attr("fill",e.background.value),e.g.clipping.select("rect").attr("width",e.width.viz).attr("height",e.height.viz),e.g.container.attr("transform","translate("+e.margin.left+","+e.margin.top+")")),e.dev.value&&n.timeEnd("updating SVG elements")}},{"../../../core/console/print.coffee":52}],240:[function(e,t,r){var H=e("../../../array/sort.coffee"),X=e("../../../tooltip/create.js"),G=e("../../../core/data/nest.js"),J=e("./data.js"),W=e("../../../core/fetch/color.coffee"),Q=e("../../../core/fetch/text.js"),K=e("../../../core/fetch/value.coffee"),Z=e("../../../object/merge.coffee"),$=e("../../../tooltip/remove.coffee"),ee=e("../shapes/segments.coffee"),i=e("../../../client/scroll.js"),te=e("../../../util/uniques.coffee"),re=e("../../../object/validate.coffee"),s=e("../zoom/direction.coffee");t.exports=function(S){"d3plus"in S.data||(S.data.d3plus={});var T=S.vars,B=S.data,C="d3plus"in B&&"depth"in B.d3plus?B.d3plus.depth:T.depth.value,q=(S.ex,!!S.mouseevents&&S.mouseevents),N=!("arrow"in S)||S.arrow,e=K(T,B,T.id.value),P=S.id||T.type.value;if(!d3.event||"click"!=d3.event.type||!T.tooltip.html.value&&!T.tooltip.value.long||"fullscreen"in S){D=!1;var I=S.anchor||T.tooltip.anchor,t=(V=S.length||"short",s(B,T));if(-1===t){var r=T.id.nesting[C-1];K(T,e,r)}var n="";if(T.mouse.click.value&&(!T.mouse.viz||!1!==T.mouse.viz.click))if(1===t&&T.zoom.value)n=T.format.value(T.format.locale.value.ui.expand);else if(-1===t&&T.zoom.value&&T.history.states.length&&!T.tooltip.value.long)n=T.format.value(T.format.locale.value.ui.collapse);else if(T.small||"short"!=V||!T.tooltip.html.value&&!T.tooltip.value.long||1===T.focus.value.length&&T.focus.value[0]==e){if("long"==V)n=T.footer.value||""}else var n=T.format.locale.value.ui.moreInfo;R=!!n.length&&T.format.value(n,{key:"footer",vars:T})}else{var D=!0,V=(N=!1,q=!0,"long"),R=T.footer.value;T.covered=!0}if("x"in S)var U=S.x;else if("static"===T.types[T.type.value].tooltip){U=B.d3plus.x;T.zoom.translate&&T.zoom.scale&&(U=T.zoom.translate[0]+U*T.zoom.scale),U+=T.margin.left,"long"!==S.length&&(L+=i.x(),U+=T.container.value.node().getBoundingClientRect().left,U+=parseFloat(T.container.value.style("padding-left"),10))}else U=d3.mouse(d3.select("html").node())[0];if("y"in S)var L=S.y;else if("static"==T.types[T.type.value].tooltip){L=B.d3plus.y;T.zoom.translate&&T.zoom.scale&&(L=T.zoom.translate[1]+L*T.zoom.scale),L+=T.margin.top,"long"!==S.length&&(L+=i.y(),L+=T.container.value.node().getBoundingClientRect().top,L+=parseFloat(T.container.value.style("padding-top"),10))}else L=d3.mouse(d3.select("html").node())[1];if("offset"in S)var Y=S.offset;else if("static"==T.types[T.type.value].tooltip){Y=B.d3plus.r?B.d3plus.r:B.d3plus.height/2;T.zoom.scale&&(Y*=T.zoom.scale)}else Y=3;function a(e){var t,r="depth"in S?S.depth:C,n={},a=T.id.nesting[r+1]in B?r+1:r,o=T.id.nesting[a],i="merged"in B.d3plus?B.d3plus.merged:B[o];i instanceof Array||(i=[i]);var s=K(T,B,T.size.value);if(T.tooltip.children.value){if(1<(i=i.slice(0)).length&&re(i[0])&&(i=G(T,i,[o])),T.size.value&&re(i[0])){var l=[],u=i.filter(function(e){if(!(null===K(T,e,T.size.value)||"d3plus"in e&&e.d3plus.merged))return!0;l.push(e)});H(u,T.size.value,"desc",[],T),i=u.concat(l)}var c=!0===T.tooltip.children.value?3:T.tooltip.children.value,d="short"===V?c:T.data.large,f=i.length,p=d3.min([f,d]);t={values:[]};for(var h=0;h<p&&i.length;h++){var v=i.shift(),g=Q(T,v,a)[0],m=re(v)?K(T,v,o,a):v;if(m!==B[T.id.nesting[r]]&&g&&!t[g]){var y=re(v)?K(T,v,T.size.value,o):null,x=W(T,v,o);t[g]=!y||y instanceof Array?"":T.format.value(y,{key:T.size.value,vars:T,data:v});var b={};b[g]=t[g],t.values.push(b),x&&(t.d3plus_colors||(t.d3plus_colors={}),t.d3plus_colors[g]=x)}else h--}p<f&&(t.d3plusMore=f-p)}function w(e){return"string"==typeof T[e].value?T[e].value:T.format.locale.value.method[e]}B.d3plus.tooltip&&(n=Z(n,B.d3plus.tooltip)),T.tooltip.size.value&&(s&&"number"!=typeof T.size.value&&(n[w("size")]=s),T.axes.opposite&&T[T.axes.opposite].value!==T.size.value&&(n[w(T.axes.opposite)]=K(T,B,T[T.axes.opposite].value)),T.axes.opposite&&T[T.axes.opposite+"2"].value!==T.size.value&&(n[w(T.axes.opposite+"2")]=K(T,B,T[T.axes.opposite+"2"].value)),T.color.valueScale&&(n[w("color")]=K(T,B,T.color.value)));var _=ee(T,B,"active"),k=ee(T,B,"temp"),z=ee(T,B,"total");"number"==typeof _&&0<_&&z&&(n[w("active")]=_+"/"+z+" ("+T.format.value(_/z*100,{key:"share",vars:T,data:B})+")"),"number"==typeof k&&0<k&&z&&(n[w("temp")]=k+"/"+z+" ("+T.format.value(k/z*100,{key:"share",vars:T,data:B})+")"),T.tooltip.share.value&&B.d3plus.share&&(n.share=T.format.value(100*B.d3plus.share,{key:"share",vars:T,data:B}));a="depth"in S?S.depth:C;var A=S.title||Q(T,B,a)[0],j=te(B,T.icon.value,K,T,T.id.nesting[a]),M=S.titleOnly?[]:J(T,B,V,n,t,a);if(j=1===j.length&&"string"==typeof j[0]&&j[0],0<M.length||R||!B.d3plus_label&&"short"==V&&A||B.d3plus_label&&(!("visible"in B.d3plus_label)||"visible"in B.d3plus_label&&!1===B.d3plus_label.visible)){if(A||(A=T.format.value(m,{key:T.id.value,vars:T})),(a="d3plus"in B&&"merged"in B.d3plus?C-1:"depth"in S?S.depth:C)<0&&(a=0),a=T.id.nesting[a],"string"==typeof T.icon.style.value)var O=T.icon.style.value;else if("object"==typeof T.icon.style.value&&T.icon.style.value[a])O=T.icon.style.value[a];else O="default";var E=T.tooltip.small;S.width?E=S.width:D&&(E=T.tooltip.large);var F=!D&&"long"!==S.length||D&&T.tooltip.fullscreen.value?d3.select("body"):T.container.value;!S.description&&B&&T.tooltip.sub.value&&(S.description=K(T,B,T.tooltip.sub.value)),X({align:I,arrow:N,locale:T.format.locale.value,background:T.tooltip.background,curtain:T.tooltip.curtain.color,curtainopacity:T.tooltip.curtain.opacity,fontcolor:T.tooltip.font.color,fontfamily:T.tooltip.font.family.value,fontsize:T.tooltip.font.size,fontweight:T.tooltip.font.weight,data:M,color:W(T,B),allColors:!0,footer:!1===S.footer?S.footer:R,fullscreen:D,html:e,js:S.js,icon:j,id:P,max_height:S.maxheight,max_width:E,mouseevents:q,offset:Y,parent:F,stacked:T.tooltip.stacked.value,style:O,title:A,description:S.description,width:S.width||D||0!=M.length?E:"auto",x:U,y:L})}else $(P)}if(D||"long"===S.length)if("string"==typeof T.tooltip.html.value)a(T.tooltip.html.value);else if("function"==typeof T.tooltip.html.value)a(T.tooltip.html.value(e));else if(T.tooltip.html.value&&"object"==typeof T.tooltip.html.value&&T.tooltip.html.value.url){var o=T.tooltip.html.value.url;"function"==typeof o&&(o=o(e)),d3.json(o,function(e){a(T.tooltip.html.value.callback?T.tooltip.html.value.callback(e):e)})}else a(S.html);else a(S.html)}},{"../../../array/sort.coffee":34,"../../../client/scroll.js":41,"../../../core/data/nest.js":60,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/merge.coffee":171,"../../../object/validate.coffee":172,"../../../tooltip/create.js":201,"../../../tooltip/remove.coffee":203,"../../../util/uniques.coffee":210,"../shapes/segments.coffee":233,"../zoom/direction.coffee":250,"./data.js":241}],241:[function(e,t,r){var x=e("../../../util/copy.coffee"),b=e("../../../core/fetch/value.coffee"),w=e("../../../core/fetch/color.coffee"),_=e("../../../core/fetch/text.js"),k=e("../../../color/legible.coffee"),z=e("../../../object/merge.coffee"),A=e("../../../client/prefix.coffee"),j=e("../../../string/format.js"),M=e("../../../object/validate.coffee");t.exports=function(l,u,e,t,r,n){if(l.small)return[];if(!e)e="long";if("long"==e)var a="short";else a="long";var c={};if(t&&"string"==typeof t)t=[t];else if(t&&"object"==typeof t){c=z(c,t);t=[];for(var o in c)t.push(o)}else if(!t)t=[];var d=[];if(l.tooltip.value instanceof Array)var i=l.tooltip.value;else if("string"==typeof l.tooltip.value)i=[l.tooltip.value];else{if(l.tooltip.value[l.id.nesting[n]])i=l.tooltip.value[l.id.nesting[n]];else i=l.tooltip.value;i instanceof Array||(i=i[e]?i[e]:i[a]?[]:z({"":[]},i)),"string"==typeof i?i=[i]:i instanceof Array||(i=z({"":[]},i))}function s(t,e){if(l.attrs.value[e])var r=e;else r=null;e&&(e=l.format.value(e));var n=c[t]||b(l,u,t,r);if(M(n))f.push({name:l.format.value(t),value:l.format.value(n.value,{key:n.key,vars:l}),group:e});else if(null!=n&&"undefined"!=n&&!(n instanceof Array)&&("string"==typeof n&&n.indexOf("d3plus_other")<0||"string"!=typeof n)){var a=l.format.locale.value.ui[t]?l.format.value(l.format.locale.value.ui[t]):l.format.value(t),o=0<=d.indexOf(t);n instanceof Array?n.forEach(function(e){e=l.format.value(e,{key:t,vars:l,data:u})}):n=l.format.value(n,{key:t,vars:l,data:u});var i={name:a,value:n,highlight:o,group:e};if(l.descs.value)if("function"==typeof l.descs.value){var s=l.descs.value(t);"string"==typeof s&&(i.desc=s)}else t in l.descs.value&&(i.desc=l.descs.value[t]);f.push(i)}}var f=[];if(i.constructor===Array&&(i={"":i}),l.id.nesting.length&&n<l.id.nesting.length-1){i=x(i);l.id.nesting.forEach(function(e,t){n<t&&i[e]&&delete i[e]})}for(var p in i){i[p].constructor!==Array&&(i[p]=[i[p]]);for(var h=t.length;0<h;h--)0<=i[p].indexOf(t[h-1])&&t.splice(h-1,1)}if(l.tooltip.value.long&&"object"==typeof l.tooltip.value.long){for(var p in l.tooltip.value.long)for(h=t.length;0<h;h--){var v=t[h-1];0<=l.tooltip.value.long[p].indexOf(v)&&(i[p]||(i[p]=[]),i[p].push(v),t.splice(h-1,1))}}for(var p in t.length&&(i[""]||(i[""]=[]),i[""]=i[""].concat(t)),i)i[p].forEach(function(e){s(e,p)});if(r){var g=l.format.locale.value.ui.including,m=r.d3plus_colors;r.values.forEach(function(e){var t=d3.keys(e)[0];f.push({group:l.format.value(g),highlight:!(!m||!m[t])&&m[t],name:t,value:e[t]})}),r.d3plusMore&&f.push({group:l.format.value(g),highlight:!0,name:j(l.format.locale.value.ui.more,r.d3plusMore),value:""})}if(l.tooltip.connections.value&&"long"===e){var y=l.edges.connections(u[l.id.value],l.id.value,!0);y.length&&y.forEach(function(t){var e=(e=l.data.viz.filter(function(e){return e[l.id.value]===t[l.id.value]})).length?e[0]:t,r=_(l,e)[0],n=w(l,e),a=l.tooltip.font.size,o="square"==l.shape.value?0:a;styles=["background-color: "+n,"border-color: "+k(n),"border-style: solid","border-width: "+l.data.stroke.width+"px","display: inline-block","height: "+a+"px","left: 0px","position: absolute","width: "+a+"px","top: 0px",A()+"border-radius: "+o+"px"],node="<div style='"+styles.join("; ")+";'></div>";f.push({group:l.format.value(l.format.locale.value.ui.primary),highlight:!1,link:function(){l.self.focus([e[l.id.value]]).draw()},name:"<div id='d3plustooltipfocuslink_"+e[l.id.value]+"' class='d3plus_tooltip_focus_link' style='position:relative;padding-left:"+1.5*a+"px;'>"+node+r+"</div>"})})}return f}},{"../../../client/prefix.coffee":39,"../../../color/legible.coffee":44,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/merge.coffee":171,"../../../object/validate.coffee":172,"../../../string/format.js":173,"../../../util/copy.coffee":207}],242:[function(e,t,r){var c;c=e("../../../core/console/print.coffee"),t.exports=function(e){var t,r,n,a,o,i,s,l,u;if(e.group=e.g.apps[e.type.value],e.mouse.viz=!1,e.edges.path=!1,a=!(n=0<=((u=e.types[e.type.value]).requirements||[]).indexOf("data"))||n&&e.data.viz.length,!e.error.internal&&a){for(t=e.format.locale.value.visualization[e.type.value],e.dev.value&&c.time("running "+t),o=0,i=(s=e.data.viz).length;o<i;o++)(r=s[o]).d3plus&&(delete r.d3plus.shape,delete r.d3plus.label,delete r.d3plus.rotate,delete r.d3plus.share);l=u(e),e.dev.value&&c.timeEnd("running "+t)}else l=null;e.returned={nodes:[],edges:null},l instanceof Array?e.returned.nodes=l:l&&(l.nodes&&(e.returned.nodes=l.nodes),l.edges&&(e.returned.edges=l.edges))}},{"../../../core/console/print.coffee":52}],243:[function(e,t,r){var s=e("../../../util/copy.coffee"),l=e("../../../form/form.js"),u=e("../../../core/console/print.coffee"),c=e("../../../object/validate.coffee");t.exports=function(i){var e=i.ui.value&&i.ui.value.length,t=i.ui.position.value;i.dev.value&&e&&u.time("drawing custom UI elements");var r=i.container.value.selectAll("div#d3plus_drawer").data(["d3plus_drawer"]);r.enter().append("div").attr("id","d3plus_drawer");var n={};i.ui.position.accepted.forEach(function(e){n[e]=e==t?i.margin.bottom+"px":"auto"}),r.style("text-align",i.ui.align.value).style("position","absolute").style("width",i.width.value-2*i.ui.padding+"px").style("height","auto").style(n);var a=r.selectAll("div.d3plus_drawer_ui").data(e?i.ui.value:[],function(e){return e.method||!1});a.exit().remove(),a.enter().append("div").attr("class","d3plus_drawer_ui").style("display","inline-block"),a.style("padding",i.ui.padding+"px").each(function(t){var r,e;t.form||(t.form=l().container(d3.select(this)).data({sort:!1}).id("id").text("text")),"string"==typeof t.method&&t.method in i?(r=i[t.method].value,e=function(e){e!==i[t.method].value&&i.self[t.method](e).draw()}):(r=t.focus||t.value[0],c(r)&&(r=r[d3.keys(r)[0]]),"function"==typeof t.method&&(e=function(e){e!==r&&(r=e,t.focus=e,t.method(e,i.self))}));var n,a=[];t.label?n=t.label:"string"==typeof t.method&&t.method in i&&(n=i.format.locale.value.method[t.method]||t.method),t.value.forEach(function(e){var t={};c(e)?(t.id=e[d3.keys(e)[0]],t.text=i.format.value(d3.keys(e)[0])):(t.id=e,t.text=i.format.value(e)),a.push(t)});var o=s(i.ui.font);o.align=s(i.font.align),o.secondary=s(o),t.form.data(a).font(o).focus(1<t.value.length&&r).focus({callback:e}).format(i.format.locale.language).format({number:i.format.number.value,text:i.format.text.value}).title(i.format.value(n)).type(t.type||"auto").ui({align:i.ui.align.value,border:i.ui.border,color:{primary:i.ui.color.primary.value,secondary:i.ui.color.secondary.value},padding:i.ui.padding,margin:0}).width(t.width||!1).draw()});var o=r.node().offsetHeight||r.node().getBoundingClientRect().height;o&&(i.margin[t]+=o),i.dev.value&&e&&u.timeEnd("drawing custom UI elements")}},{"../../../core/console/print.coffee":52,"../../../form/form.js":104,"../../../object/validate.coffee":172,"../../../util/copy.coffee":207}],244:[function(e,t,r){var v,g,m,y;v=e("../../../client/pointer.coffee"),g=e("../../../color/lighter.coffee"),m=e("../../../core/console/print.coffee"),y=e("../../../client/css.coffee"),t.exports=function(t){var e,r,n,a,o,i,s,l,u,c,d,f,p,h;return!t.small&&0<t.history.states.length?(t.dev.value&&m.time("drawing back button"),e=t.container.value.selectAll("div#d3plus_back_button").data(["d3plus_back_button"]).style("position","relative").style("z-index",1900),l=t.title.sub.font.size,r=t.title.sub.font.color,a=t.title.sub.font.family.value,h=t.title.sub.font.weight,s=t.title.sub.padding,d=!1,t.title.sub.value&&["start","left"].indexOf(t.title.sub.font.align)<0?d="sub":t.title.total.value&&["start","left"].indexOf(t.title.total.font.align)<0?d="total":t.title.value&&["start","left"].indexOf(t.title.font.align)<0&&(d="title"),d?(u=function(e){var t;return t=(t=(t=(t=e.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0]).replace(/([^a-z])\s([^a-z])/gi,"$1,$2")).split(","))[t.length-1],parseFloat(t.substring(0,t.length-1))},f=t.svg.select(".d3plus_title."+d),p=u(f)+u(f.select("text"))):(p=t.margin.top-t.title.padding,i=l+2*s,t.margin.top+=i),n=parseFloat(t.container.value.style("padding-top"),10),p+=n,n=parseFloat(t.container.value.style("padding-left"),10),o=t.margin.left+l/2+n,c=function(e){return e.style("position","absolute").style("left",o+"px").style("top",p+"px").style("color",r).style("font-family",a).style("font-weight",h).style("font-size",l+"px")},e.enter().append("div").attr("id","d3plus_back_button").style("opacity",0).call(c).html(function(){var e;return y("font-awesome")&&0===t.icon.back.value.indexOf("fa-")?(e="<i class='fa "+t.icon.back.value,e+="' style='margin-top:2px;margin-right:4px;'></i>"):e=t.icon.back.value+" ",e+t.format.value(t.format.locale.value.ui.back)}),e.on(v.over,function(){if(!t.small&&0<t.history.states.length)return d3.select(this).style("cursor","pointer").transition().duration(t.timing.mouseevents).style("color",g(r,.25))}).on(v.out,function(){if(!t.small&&0<t.history.states.length)return d3.select(this).style("cursor","auto").transition().duration(t.timing.mouseevents).style("color",r)}).on(v.click,function(){return t.history.back()}).transition().duration(t.draw.timing).style("opacity",1).call(c),t.dev.value?m.timeEnd("drawing back button"):void 0):t.container.value.selectAll("div#d3plus_back_button").transition().duration(t.draw.timing).style("opacity",0).remove()}},{"../../../client/css.coffee":36,"../../../client/pointer.coffee":38,"../../../color/lighter.coffee":45,"../../../core/console/print.coffee":52}],245:[function(e,t,r){var q=e("../../../array/sort.coffee"),N=e("../../../util/buckets.coffee"),P=e("../../../util/copy.coffee"),I=e("../tooltip/create.js"),D=e("../../../core/data/nest.js"),V=e("../../../util/dataURL.coffee"),R=e("../../../client/pointer.coffee"),U=e("../../../core/fetch/value.coffee"),L=e("../../../core/fetch/color.coffee"),Y=e("../../../core/fetch/text.js"),H=e("../../../core/console/print.coffee"),X=e("../../../tooltip/remove.coffee"),G=e("../../../color/text.coffee"),J=e("../../../util/uniques.coffee"),W=e("../../../client/scroll.js"),Q=e("../../../string/strip.js"),K=e("../../../textwrap/textwrap.coffee"),Z=(e("../../../client/touch.coffee"),e("../../../object/validate.coffee"));t.exports=function(d){var e=!0,f=0;if(!d.error.internal&&d.color.value&&!d.small&&d.legend.value)if(d.color.valueScale)if(d.color.valueScale){d.dev.value&&H.time("drawing color scale"),d.g.legend.selectAll("g.d3plus_color").transition().duration(d.draw.timing).attr("opacity",0).remove();var t=d.color.valueScale.domain();k=d.color.valueScale.range();t.length<=2&&(t=N(t,6));var r=d.g.legend.selectAll("g.d3plus_scale").data(["scale"]);r.enter().append("g").attr("class","d3plus_scale").attr("opacity",0);var n=d.container.id+"_legend_heatmap",a=r.selectAll("#"+n).data(["heatmap"]);a.enter().append("linearGradient").attr("id",n).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");var o=a.selectAll("stop").data(d3.range(0,k.length));o.enter().append("stop").attr("stop-opacity",1),o.attr("offset",function(e){return Math.round(e/(k.length-1)*100)+"%"}).attr("stop-color",function(e){return k[e]}),o.exit().remove();var i=r.selectAll("rect#gradient").data(["gradient"]);i.enter().append("rect").attr("id","gradient").attr("x",function(e){return"middle"==d.legend.align?d.width.value/2:"end"==d.legend.align?d.width.value:0}).attr("y",d.ui.padding).attr("width",0).attr("height",d.legend.gradient.height).attr("stroke",d.legend.font.color).attr("stroke-width",1).style("fill","url(#"+n+")");var s=r.selectAll("text.d3plus_tick").data(d3.range(0,t.length));s.enter().append("text").attr("class","d3plus_tick").attr("stroke","none").attr("x",function(e){return"middle"==d.legend.align?d.width.value/2:"end"==d.legend.align?d.width.value:0}).attr("y",function(e){return this.getBBox().height+d.legend.gradient.height+2*d.ui.padding});var l=0;if(s.order().attr("font-weight",d.legend.font.weight).attr("font-family",d.legend.font.family.value).attr("font-size",d.legend.font.size+"px").style("text-anchor",d.legend.font.align).attr("fill",d.legend.font.color).text(function(e){return d.format.value(t[e],{key:d.color.value,vars:d})}).attr("y",function(e){return this.getBBox().height+d.legend.gradient.height+2*d.ui.padding}).each(function(e){var t=Math.ceil(this.getBBox().width);l<t&&(l=t)}),l+=2*d.labels.padding,(A=l*(t.length-1))+l<d.width.value){A+l<d.width.value/2&&(A=d.width.value/2,l=A/t.length,A-=l),O="start"==d.legend.align?d.ui.padding:"end"==d.legend.align?d.width.value-d.ui.padding-A:d.width.value/2-A/2,s.transition().duration(d.draw.timing).attr("x",function(e){return O+l*e}),s.exit().transition().duration(d.draw.timing).attr("opacity",0).remove();var u=r.selectAll("rect.d3plus_tick").data(d3.range(0,t.length));u.enter().append("rect").attr("class","d3plus_tick").attr("x",function(e){return"middle"==d.legend.align?d.width.value/2:"end"==d.legend.align?d.width.value:0}).attr("y",d.ui.padding).attr("width",0).attr("height",d.ui.padding+d.legend.gradient.height).attr("fill",d.legend.font.color),u.transition().duration(d.draw.timing).attr("x",function(e){return O+l*e-(0===e?1:0)}).attr("y",d.ui.padding).attr("width",1).attr("height",d.ui.padding+d.legend.gradient.height).attr("fill",d.legend.font.color),u.exit().transition().duration(d.draw.timing).attr("width",0).remove(),i.transition().duration(d.draw.timing).attr("x",function(e){return"middle"==d.legend.align?d.width.value/2-A/2:"end"==d.legend.align?d.width.value-A-d.ui.padding:d.ui.padding}).attr("y",d.ui.padding).attr("width",A).attr("height",d.legend.gradient.height),r.transition().duration(d.draw.timing).attr("opacity",1),d.dev.value&&H.timeEnd("drawing color scale")}else e=!1}else e=!1;else{var c;if(d.dev.value&&H.time("grouping data by colors"),d.nodes.value&&0<=d.types[d.type.value].requirements.indexOf("nodes")){if(c=P(d.nodes.restriced||d.nodes.value),d.data.viz.length)for(var p=0;p<c.length;p++){var h=d.data.viz.filter(function(e){return e[d.id.value]===c[p][d.id.value]});h.length&&(c[p]=h[0])}}else c=d.data.viz;c.length&&"key"in c[0]&&"values"in c[0]&&(c=d3.merge(c.map(function(e){return e.values})));var v=function(e){return L(d,e,g)},g=0,m=d.id.value,y=d.id.nesting.indexOf(d.color.value);if(0<=y)g=y,m=d.id.nesting[y];else for(var x=0;x<=d.depth.value;x++){g=x,m=d.id.nesting[x];var b=J(c,function(e){return U(d,e,m)}),w=J(c,v);if(b.length>=w.length&&1<w.length)break}var _=[d.color.value],k=D(d,c,_,!1);d.dev.value&&H.timeEnd("grouping data by color");var z=d.width.value,A=(f=d.legend.size)*k.length+d.ui.padding*(k.length+1);if(f instanceof Array){d.dev.value&&H.time("calculating legend size");for(p=f[1];p>=f[0];p--)if((A=p*k.length+d.ui.padding*(k.length+1))<=z){f=p;break}d.dev.value&&H.timeEnd("calculating legend size")}else"number"!=typeof f&&!1!==f&&(f=30);if(z<A||1==k.length)e=!1;else{if(A-=2*d.ui.padding,d.dev.value&&H.time("sorting legend"),"function"==typeof d.legend.order.value)k=d.legend.order.value(k);else{var j=d[d.legend.order.value].value,M=d.color.value;j?"color"!==d.legend.order.value&&(M=[]):j=d[d.color.value].value,q(k,j,d.legend.order.sort.value,M,d,g)}var O;function E(e){e.attr("transform",function(e,t){return"translate("+(O+t*(d.ui.padding+f))+","+d.ui.padding+")"})}function F(e){e.attr("width",f).attr("height",f).attr("fill",function(e){d3.select(this.parentNode).select("text").remove();var t,r=J(e,d.icon.value,U,d,m),n=L(d,e,m);if(d.legend.icons.value&&1===r.length&&"string"==typeof r[0]){r=r[0];var a=Q(r+"_"+n),o=d.icon.style.value,i=d.defs.selectAll("pattern#"+a).data([a]);n="knockout"==("string"==typeof o?d.icon.style.value:Z(o)&&o[m]?o[m]:"default")?n:"none",i.select("rect").transition().duration(d.draw.timing).attr("fill",n).attr("width",f).attr("height",f),i.select("image").transition().duration(d.draw.timing).attr("width",f).attr("height",f);var s=i.enter().append("pattern").attr("id",a).attr("width",f).attr("height",f);return s.append("rect").attr("fill",n).attr("stroke","none").attr("width",f).attr("height",f),s.append("image").attr("xlink:href",r).attr("width",f).attr("height",f).each(function(e){0===r.indexOf("/")||0<=r.indexOf(window.location.hostname)?V(r,function(e){i.select("image").attr("xlink:href",e)}):i.select("image").attr("xlink:href",r)}),"url(#"+a+")"}if(d.legend.labels.value&&1===(t=d.legend.text.value?[U(d,e,d.legend.text.value,g)]:Y(d,e,g)).length&&!(t[0]instanceof Array)&&t[0].length){var l=d3.select(this.parentNode).append("text"),u=d.legend.font.size;u instanceof Array||(u=[u]),l.attr("font-size",u[u.length-1]+"px").attr("font-weight",d.legend.font.weight).attr("font-family",d.legend.font.family.value).attr("stroke","none").attr("fill",G(n)).attr("x",0).attr("y",0).each(function(e){K().align("middle").container(d3.select(this)).height(f).padding(d.ui.padding).resize(1<u.length).size(u).text(t[0]).width(f).valign("middle").draw()}),l.select("tspan").empty()&&l.remove()}return n})}d.dev.value&&H.timeEnd("sorting legend"),d.dev.value&&H.time("drawing legend"),O="start"==d.legend.align?d.ui.padding:"end"==d.legend.align?z-d.ui.padding-A:z/2-A/2,d.g.legend.selectAll("g.d3plus_scale").transition().duration(d.draw.timing).attr("opacity",0).remove();var S={},T=d.g.legend.selectAll("g.d3plus_color").data(k,function(e){var t=L(d,e,m);return t in S||(S[t]=-1),S[t]++,S[t]+"_"+t});T.enter().append("g").attr("class","d3plus_color").attr("opacity",0).call(E).append("rect").attr("class","d3plus_color").attr("stroke","none").call(F),T.order().transition().duration(d.draw.timing).call(E).attr("opacity",1).selectAll("rect.d3plus_color").call(F),T.exit().transition().duration(d.draw.timing).attr("opacity",0).remove(),d.legend.tooltip.value&&T.on(R.over,function(e,t){d3.select(this).style("cursor","pointer");var r,n,a,o=this.getBoundingClientRect(),i=o.left+f/2+W.x(),s=o.top+f/2+W.y()+5,l=U(d,e,m),u=d.id.nesting.indexOf(m);if(r=d.legend.title.value?U(d,e,d.legend.title.value,g):0<=u?Y(d,e,u)[0]:d.format.value(U(d,e,d.color.value,m),{key:d.color.value,vars:d,data:e}),d.legend.filters.value&&!(l instanceof Array)){n="<div style='text-align:center;'>";var c=d.format.locale.value;n+="<div class='mute'>"+d.format.value(c.method.mute)+"</div>",n+="<div class='solo'>"+d.format.value(c.method.solo)+"</div>",n+="</div>",a=function(e){var t={border:"1px solid #ccc",display:"inline-block",margin:"1px 2px",padding:"3px 5px"};e.select(".mute").style(t).on(R.over,function(){d3.select(this).style("cursor","pointer")}).on(R.click,function(){var e=d.id.mute.value;d.history.states.push(function(){d.self.id({mute:e}).draw()}),d.self.id({mute:l}).draw()}),e.select(".solo").style(t).on(R.over,function(){d3.select(this).style("cursor","pointer")}).on(R.click,function(){var e=d.id.solo.value;d.history.states.push(function(){d.self.id({solo:e}).draw()}),d.self.id({solo:l}).draw()})}}I({data:e,html:n,js:a,depth:g,footer:!1,vars:d,x:i,y:s,mouseevents:this,title:r,titleOnly:!d.legend.data.value,offset:.4*f})}).on(R.out,function(e){X(d.type.value)}),d.dev.value&&H.timeEnd("drawing legend")}}else e=!1;if(d.legend.value&&key&&e){if(d.dev.value&&H.time("positioning legend"),f)var B=f+d.ui.padding;else{var C=d.g.legend.node().getBBox();B=C.height+C.y}0===d.margin.bottom&&(d.margin.bottom+=d.ui.padding),d.margin.bottom+=B,d.g.legend.transition().duration(d.draw.timing).attr("transform","translate(0,"+(d.height.value-d.margin.bottom)+")"),d.dev.value&&H.timeEnd("positioning legend")}else d.dev.value&&H.time("hiding legend"),d.g.legend.transition().duration(d.draw.timing).attr("transform","translate(0,"+d.height.value+")"),d.dev.value&&H.timeEnd("hiding legend")}},{"../../../array/sort.coffee":34,"../../../client/pointer.coffee":38,"../../../client/scroll.js":41,"../../../client/touch.coffee":43,"../../../color/text.coffee":50,"../../../core/console/print.coffee":52,"../../../core/data/nest.js":60,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/validate.coffee":172,"../../../string/strip.js":175,"../../../textwrap/textwrap.coffee":200,"../../../tooltip/remove.coffee":203,"../../../util/buckets.coffee":204,"../../../util/copy.coffee":207,"../../../util/dataURL.coffee":209,"../../../util/uniques.coffee":210,"../tooltip/create.js":240}],246:[function(e,t,r){var u=e("../../../client/pointer.coffee"),c=e("../../../color/text.coffee");t.exports=function(t,e){e=t.messages.value?e:null;var r=t.messages.style.value||(e===t.error.internal?"large":t.messages.style.backup);if("large"===r)var n=t.messages,a="center";else{if(t.footer.value)n=t.footer;else if(t.title.value)n=t.title;else if(t.title.sub.value)n=t.title.sub;else if(t.title.total.value)n=t.title.total;else n=t.title.sub;a=n.position}n={color:n.font.color,"font-family":n.font.family.value,"font-weight":n.font.weight,"font-size":n.font.size+"px",padding:n.padding+"px"};var o=t.messages.background.value;o||"none"!==(o=t.background.value)&&"transparent"!==o||(o=c(n.color)),t.g.message=t.container.value.selectAll("div#d3plus_message").data(["message"]),t.g.message.enter().append("div").attr("id","d3plus_message").attr("opacity",0).append("div").attr("class","d3plus_message_text").style("display","block"),t.g.message.select(".d3plus_message_text").text(e||t.g.message.text());var i=navigator.onLine,s=t.g.message.selectAll(".d3plus_message_branding").data(t.messages.branding.value&&"center"===a?[0]:[]);s.enter().append("div").attr("class","d3plus_message_branding").style("margin-top","15px").style("padding-top","0px").style("display","block").style("font-size","11px").style("background-size","75px").style("background-position","center 10px").style("background-repeat","no-repeat").style("cursor","pointer").on(u.click,function(){window.open("http://www.d3plus.org/","_blank")});var l=d3.hsl(o).l<.5?t.messages.branding.image.dark:t.messages.branding.image.light;s.text(i?"Powered by:":"Powered by D3plus").style("background-color",i?o:"transparent").style("background-image",i?"url('"+l+"')":"none").style("min-width",i?"75px":"auto").style("height",i?"75px":"auto"),s.exit().remove(),t.g.message.style("display",e?"inline-block":"none").call(function(e){e.style(n).style("position","absolute").style("background-color",o).style("text-align","center").style("left",function(){return"center"==a?"50%":"0px"}).style("width",function(){return"center"==a?"auto":t.width.value+"px"}).style("margin-left",function(){return"center"==a?-this.offsetWidth/2+"px":"0px"}).style("top",function(){return"center"==a?"50%":"top"==a?"0px":"auto"}).style("bottom",function(){return"bottom"==a?"0px":"auto"}).style("margin-top",function(){return"large"==r?-(this.offsetHeight||this.getBoundingClientRect().height)/2+"px":"0px"})}).style("opacity",e?1:0)}},{"../../../client/pointer.coffee":38,"../../../color/text.coffee":50}],247:[function(e,t,r){var Z,$,ee,te,re,ne,ae,oe,ie;Z=e("../../../util/closest.coffee"),$=e("../../../client/css.coffee"),e("../../../font/sizes.coffee"),ee=e("../../../client/pointer.coffee"),te=e("../../../color/mix.coffee"),ne=e("../../../client/prefix.coffee"),ae=e("../../../core/console/print.coffee"),oe=e("../../../color/text.coffee"),ie=e("../../../core/data/time.coffee"),re=!1,t.exports=function(a){var e,t,n,o,r,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P,I,D,V,R,U,L,Y,H,X,G,J,W,Q,K;if(!a.timeline.value||a.error.internal&&a.data.missing||a.small||!a.data.time||!(1<a.data.time.values.length))return a.g.timeline.transition().duration(a.draw.timing).attr("transform","translate(0,"+a.height.value+")");if(a.dev.value&&ae.time("drawing timeline"),N={"font-weight":a.ui.font.weight,"font-family":a.ui.font.family.value,"font-size":a.ui.font.size+"px","text-anchor":"middle"},K=a.data.time.ticks.map(function(e){return new Date(e)}),R=ie(a,{values:K,style:N}),X=R.values.map(Number),V=R.format,a.time.solo.value.length)for(f=d3.extent(a.time.solo.value),d=p=0,g=f.length;p<g;d=++p)(l=f[d]).constructor!==Date&&(4===(l+="").length&&parseInt(l)+""===l&&(l+="/01/01"),l=new Date(l),f[d]=l);else f=d3.extent(K);if(Q=K.slice(),J=d3.max(R.sizes.map(function(e){return e.height})),h=1+~~d3.max(R.sizes.map(function(e){return e.width})),h+=2*a.ui.padding,L=a.timeline.height.value||J+2*a.ui.padding,H=h*K.length,B=(M=L)-2*a.ui.padding>=J,e=a.width.value-2*a.ui.padding,B&&a.timeline.play.value&&(e-=M+a.ui.padding),!B||X.length<K.length||e<h*X.length){for(H=(h=(e-(b=h))/K.length)*K.length,I=(Y=1)+~~(b/(H/X.length));I<X.length-1&&(X.length-1)%I!=0;)I++;X=X.filter(function(e,t){return t%I==0})}else Y=0,(y=new Date(K[0]))["set"+(S=a.data.time.stepType)](y["get"+S]()+K.length),Q.push(y);return E=new Date(f[0]),E=Z(Q,E),u=new Date(f[1]),Y||u["set"+a.data.time.stepType](u["get"+a.data.time.stepType]()+1),u=Z(Q,u),W=Q.map(Number),x=W.indexOf(+E),m=W.indexOf(+u),o=[E,u],F="start"===a.timeline.align?a.ui.padding:"end"===a.timeline.align?a.width.value-a.ui.padding-H:a.width.value/2-H/2,B&&a.timeline.play.value&&(F+=(M+a.ui.padding)/2),T=function(){return clearInterval(re),re=!1,_.call(k,"icon")},i=function(){var e,t,r;if(null!==d3.event.sourceEvent){if(re&&T(),o=n.extent(),(r=Z(Q,o[0]))===(t=Z(Q,o[1]))&&(x=W.indexOf(+r),r<o[0]||0===x?t=Q[x+1]:r=Q[x-1]),x=W.indexOf(+r),1<=(m=W.indexOf(+t))-x)e=[r,t];else if(x+1<=K.length)e=[r,Q[x+1]];else{for(e=[r],d=1;d<=1;)x+d<=K.length?e.push(Q[x+d]):e.unshift(Q[x-(x+d-K.length)]),d++;e=[e[0],e[e.length-1]]}return o=e,C.attr("fill",q),d3.select(this).call(n.extent(e))}},O=function(){var e;return e=m-x==K.length-Y?[]:(e=W.filter(function(e,t){return x<=t&&t<m+Y})).map(function(e){return new Date(e)}),j(),a.self.time({solo:e}).draw()},s=function(){var e,t,r,n;if(null!==d3.event.sourceEvent&&(a.time.solo.value.length?(n=d3.extent(a.time.solo.value),r=W.indexOf(+Z(Q,n[0])),t=W.indexOf(+Z(Q,n[1])),e=r!==x||t!==m):e=m-x!=K.length-Y,e))return O()},A=function(e){return e.attr("width",M+1).attr("height",L+1).attr("fill",a.ui.color.primary.value).attr("stroke",a.ui.color.primary.value).attr("stroke-width",1).attr("x",F-M-1-a.ui.padding).attr("y",a.ui.padding)},(w=a.g.timeline.selectAll("rect.d3plus_timeline_play").data(B&&a.timeline.play.value?[0]:[])).enter().append("rect").attr("class","d3plus_timeline_play").attr("shape-rendering","crispEdges").attr("opacity",0).call(A),w.transition().duration(a.draw.timing).call(A),w.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),_=a.g.timeline.selectAll("text.d3plus_timeline_playIcon").data(B&&a.timeline.play.value?[0]:[]),k=function(e,t){var r;return t=a.timeline.play[t],$("font-awesome")?(t=t.awesome,r="FontAwesome"):(t=t.fallback,r="inherit"),e.style("font-family",r).text(t)},z=function(e){var t;return t=L/2+a.ui.padding+1,e.attr("fill",oe(a.ui.color.primary.value)).attr("stroke","none").attr(N).attr("x",F-(M-1)/2-a.ui.padding).attr("y",t).attr("dy","0.5ex").call(k,re?"pause":"icon")},_.enter().append("text").attr("class","d3plus_timeline_playIcon").call(z).style("pointer-events","none").attr("opacity",0),_.call(z).transition().duration(a.draw.timing).attr("opacity",1),_.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),(j=function(){return m-x==K.length-Y?(w.on(ee.hover,null).on(ee.click,null).transition().duration(a.draw.timing).attr("opacity",.3),_.transition().duration(a.draw.timing).attr("opacity",.3)):(w.on(ee.over,function(){return d3.select(this).style("cursor","pointer")}).on(ee.out,function(){return d3.select(this).style("cursor","auto")}).on(ee.click,function(){return re?T():(_.call(k,"pause"),m===K.length?(m-=x,x=0):(x++,m++),O(),re=setInterval(function(){return m===K.length-Y?T():(x++,m++,O())},a.timeline.play.timing.value))}).transition().duration(a.draw.timing).attr("opacity",1),_.transition().duration(a.draw.timing).attr("opacity",1))})(),q=function(e){var t,r,n;return r=Y?e<=o[1]:e<o[1],e>=o[0]&&r?(n=1,t=oe(a.ui.color.secondary.value)):(n=.5,t=oe(a.ui.color.primary.value)),Y&&a.background.value&&"none"!==a.background.value&&(t=d3.rgb(oe(a.background.value))),"rgba("+(t=d3.rgb(t)).r+","+t.g+","+t.b+","+n+")"},(t=a.g.timeline.selectAll("rect.d3plus_timeline_background").data(["background"])).enter().append("rect").attr("class","d3plus_timeline_background").attr("shape-rendering","crispEdges").attr("width",H+2).attr("height",L+2).attr("fill",a.ui.color.primary.value).attr("x",F-1).attr("y",a.ui.padding),t.transition().duration(a.draw.timing).attr("width",H+2).attr("height",L+2).attr("fill",a.ui.color.primary.value).attr("x",F-1).attr("y",a.ui.padding),(D=a.g.timeline.selectAll("g#ticks").data(["ticks"])).enter().append("g").attr("id","ticks").attr("transform","translate("+a.width.value/2+","+a.ui.padding+")"),(r=a.g.timeline.selectAll("g#brush").data(["brush"])).enter().append("g").attr("id","brush"),(v=a.g.timeline.selectAll("g#labels").data(["labels"])).enter().append("g").attr("id","labels"),(C=v.selectAll("text").data(K,function(e,t){return t})).enter().append("text").attr("stroke","none").attr("y",0).attr("dy","0.5ex").attr("x",0),G=d3.time.scale().domain(d3.extent(Q)).rangeRound([0,H]),C.order().attr(N).text(function(e,t){return 0<=X.indexOf(+e)?V(e):""}).attr("opacity",function(e,t){return 0<=a.data.time.dataSteps.indexOf(t)?1:.4}).attr("fill",q).attr("transform",function(e,t){var r,n;return r=F+G(e),Y||(r+=h/2),n=L/2+a.ui.padding+1,Y&&(n+=L/2+J),"translate("+Math.round(r)+","+Math.round(n)+")"}),C.exit().transition().duration(a.draw.timing).attr("opacity",0).remove(),n=d3.svg.brush().x(G).extent(o).on("brush",i).on("brushend",s),P=a.axes.discrete&&a[a.axes.discrete].value===a.time.value?a[a.axes.discrete].ticks.color:a.x.ticks.color,D.attr("transform","translate("+F+","+(a.ui.padding+1)+")").transition().duration(a.draw.timing).call(d3.svg.axis().scale(G).orient("top").ticks(function(){return Q}).tickFormat("").tickSize(-L).tickPadding(0)).selectAll("line").attr("stroke-width",1).attr("shape-rendering","crispEdges").attr("stroke",function(e){return 0<=X.indexOf(+e)?P:te(P,a.background.value,.4,1)}),D.selectAll("path").attr("fill","none"),r.attr("transform","translate("+F+","+(a.ui.padding+1)+")").attr("opacity",1).call(n),C.attr("pointer-events","none"),r.selectAll("rect.background").attr("fill","none").style("visibility","visible").attr("height",L).attr("shape-rendering","crispEdges").on(ee.move,function(){var e;return e=a.timeline.hover.value,0<=["grab","grabbing"].indexOf(e)&&(e=ne()+e),d3.select(this).style("cursor",e)}),r.selectAll("rect.extent").attr("opacity",.75).attr("height",L).attr("fill",a.ui.color.secondary.value).attr("shape-rendering","crispEdges").on(ee.move,function(){var e;return e=a.timeline.hover.value,0<=["grab","grabbing"].indexOf(e)&&(e=ne()+e),d3.select(this).style("cursor",e)}),a.timeline.handles.value?((c=r.selectAll("g.resize").selectAll("rect.d3plus_handle").data(["d3plus_handle"])).enter().insert("rect","rect").attr("class","d3plus_handle"),c.attr("fill",a.timeline.handles.color).attr("transform",function(e){return"translate("+("resize e"===this.parentNode.className.baseVal?-a.timeline.handles.size:0)+",0)"}).attr("width",a.timeline.handles.size).style("visibility","visible").attr("shape-rendering","crispEdges").attr("opacity",a.timeline.handles.opacity),r.selectAll("g.resize").selectAll("rect").attr("height",L)):r.selectAll("g.resize").remove(),U=a.g.timeline.node().getBBox(),0===a.margin.bottom&&(a.margin.bottom+=a.ui.padding),a.margin.bottom+=U.height+U.y,a.g.timeline.transition().duration(a.draw.timing).attr("transform","translate(0,"+Math.round(a.height.value-a.margin.bottom-a.ui.padding/2)+")"),a.margin.bottom+=a.ui.padding,a.dev.value?ae.time("drawing timeline"):void 0}},{"../../../client/css.coffee":36,"../../../client/pointer.coffee":38,"../../../client/prefix.coffee":39,"../../../color/mix.coffee":46,"../../../color/text.coffee":50,"../../../core/console/print.coffee":52,"../../../core/data/time.coffee":62,"../../../font/sizes.coffee":102,"../../../util/closest.coffee":206}],248:[function(e,t,r){var g=e("../../../client/pointer.coffee"),m=e("../../../core/fetch/value.coffee"),y=e("../../../core/console/print.coffee"),x=e("../../../client/rtl.coffee"),b=e("../../../textwrap/textwrap.coffee");t.exports=function(o){var n=o.size.value?o.size.value:"number"===o.color.type&&o.color.value;if(o.data.viz&&o.title.total.value&&!o.small)if(n){o.dev.value&&y.time("calculating total value");var e=o.data.pool;o.focus.value.length&&(e=o.data.viz.filter(function(e){return e[o.id.value]==o.focus.value[0]}));var t=o.aggs.value[n]||"sum";if(t.constructor===Function?l=t(e):(e=e.reduce(function(e,t){var r=m(o,t,n);return r instanceof Array?e=e.concat(r):e.push(r),e},[]),l=d3[t](e)),0!==l&&null!=l||(l=!1),"number"==typeof l){var r="";if(o.data.mute.length||o.data.solo.length||o.focus.value.length){var a=d3.sum(o.data.value,function(e){if(0<o.time.solo.value.length)var t=0<=o.time.solo.value.indexOf(m(o,e,o.time.value));else if(0<o.time.mute.value.length)t=o.time.solo.value.indexOf(m(o,e,o.time.value))<0;else t=!0;if(t)return m(o,e,n)});if(l<a){r=l/a*100;var i=o.format.value(a,{key:o.size.value,vars:o});r=" ("+o.format.value(r,{key:"share",vars:o})+" of "+i+")"}}l=o.format.value(l,{key:o.size.value,vars:o});var s=o.title.total.value;l=(s.prefix||o.format.value(o.format.locale.value.ui.total)+": ")+l,s.suffix&&(l+=s.suffix),l+=r}o.dev.value&&y.timeEnd("calculating total value")}else l=!1;else var l=!1;var u=[];if(o.footer.value&&u.push({link:o.footer.link,style:o.footer,type:"footer",value:o.footer.value}),!o.small){var c;if(o.title.value)"function"==typeof(c=o.title.value)&&(c=c(o.self)),u.push({link:o.title.link,style:o.title,type:"title",value:c});if(o.title.sub.value)"function"==typeof(c=o.title.sub.value)&&(c=c(o.self)),u.push({link:o.title.sub.link,style:o.title.sub,type:"sub",value:c});o.title.total.value&&l&&u.push({link:o.title.total.link,style:o.title.total,type:"total",value:l})}function d(e){e.attr("font-size",function(e){return e.style.font.size}).attr("fill",function(e){return e.link?o.links.font.color:e.style.font.color}).attr("font-family",function(e){return e.link?o.links.font.family.value:e.style.font.family.value}).attr("font-weight",function(e){return e.link?o.links.font.weight:e.style.font.weight}).style("text-decoration",function(e){return e.link?o.links.font.decoration.value:e.style.font.decoration.value}).style("text-transform",function(e){return e.link?o.links.font.transform.value:e.style.font.transform.value})}o.dev.value&&y.time("drawing titles");var f=o.svg.selectAll("g.d3plus_title").data(u,function(e){return e.type}),p=o.title.width||o.width.value-o.margin.left-o.margin.right;function h(e){var t=e.style.font.align;return"center"==t?"middle":"left"==t&&!x||"right"==t&&x?"start":"left"==t&&x||"right"==t&&!x?"end":t}f.enter().append("g").attr("class",function(e){return"d3plus_title "+e.type}).attr("opacity",0).append("text").attr("stroke","none").call(d),f.each(function(e){var t=d3.select(this).select("text").call(d),r=h(e);b().align(r).container(t).height(o.height.value/2).size(!1).text(e.value).width(p).draw(),e.y=o.margin[e.style.position],o.margin[e.style.position]+=this.getBBox().height+2*e.style.padding}).on(g.over,function(e){e.link&&d3.select(this).transition().duration(o.timing.mouseevents).style("cursor","pointer").select("text").attr("fill",o.links.hover.color).attr("font-family",o.links.hover.family.value).attr("font-weight",o.links.hover.weight).style("text-decoration",o.links.hover.decoration.value).style("text-transform",o.links.hover.transform.value)}).on(g.out,function(e){e.link&&d3.select(this).transition().duration(o.timing.mouseevents).style("cursor","auto").select("text").call(d)}).on(g.click,function(e){if(e.link){var t="/"!=e.link.charAt(0)?"_blank":"_self";window.open(e.link,t)}}).attr("opacity",1).attr("transform",function(e){var t=e.style.position,r="top"==t?0+e.y:o.height.value-e.y;"bottom"==t?r-=this.getBBox().height+e.style.padding:r+=e.style.padding;var n=h(e);if("start"===n)var a=o.margin.left+o.title.padding;else{d3.select(this).select("text").node().getBBox().width;a="middle"===n?o.width.value/2-p/2:o.width.value-p-o.margin.right-o.title.padding}return"translate("+a+","+r+")"}),f.exit().transition().duration(o.draw.timing).attr("opacity",0).remove(),0<o.margin.top&&(o.margin.top+=o.title.padding),0<o.margin.bottom&&(o.margin.bottom+=o.title.padding);var v=o.title.height;v&&o.margin[o.title.position]<v&&(o.margin[o.title.position]=v),o.dev.value&&y.timeEnd("drawing titles")}},{"../../../client/pointer.coffee":38,"../../../client/rtl.coffee":40,"../../../core/console/print.coffee":52,"../../../core/fetch/value.coffee":67,"../../../textwrap/textwrap.coffee":200}],249:[function(e,t,r){var d,f;d=e("./labels.coffee"),f=e("./transform.coffee"),t.exports=function(e,t,r){var n,a,o,i,s,l,u,c;return t||(t=e.zoom.bounds),"number"!=typeof r&&(r=e.timing.transitions),e.zoom.size={height:t[1][1]-t[0][1],width:t[1][0]-t[0][0]},c=e.types[e.type.value],n="auto"===(o=e.coords.fit.value)||c.requirements.indexOf("coords")<0?d3.max([e.zoom.size.width/e.width.viz,e.zoom.size.height/e.height.viz]):e.zoom.size[o]/e["app_"+o],l=((s=d3.min([e.width.viz,e.height.viz]))-(c.zoom?2*e.coords.padding:0))/s/n,(a=e.zoom.behavior.scaleExtent())[0]!==a[1]&&t!==e.zoom.bounds||e.zoom.behavior.scaleExtent([l,16*l]),(i=e.zoom.behavior.scaleExtent()[1])<l&&(l=i),e.zoom.scale=l,u=[e.width.viz/2-e.zoom.size.width*l/2-t[0][0]*l,e.height.viz/2-e.zoom.size.height*l/2-t[0][1]*l],e.zoom.translate=u,e.zoom.behavior.translate(u).scale(l),e.zoom.size={height:e.zoom.bounds[1][1]-e.zoom.bounds[0][1],width:e.zoom.bounds[1][0]-e.zoom.bounds[0][0]},e.zoom.reset=!1,(e.labels.value||e.labels.changed)&&d(e),f(e,r)}},{"./labels.coffee":251,"./transform.coffee":254}],250:[function(e,t,r){t.exports=function(e,t){var r,n,a;return n=t.id.nesting.length-1,r=t.depth.value,a=t.id.nesting[r+1],!1===t.types[t.type.value].nesting?0:(e.d3plus.merged||a in e&&r<n)&&(!e||a in e)?1:!(r===n&&0<r||e&&a&&!(a in e))||!t.small&&t.tooltip.html.value?0:-1}},{}],251:[function(e,t,r){var a;a=e("../../../core/console/print.coffee"),t.exports=function(r){var e,n;if(r.dev.value&&a.time("determining label visibility"),n=r.zoom.behavior.scaleExtent(),e=function(e){return e.attr("opacity",function(e){var t;return e||(e={}),t=parseFloat(d3.select(this).attr("font-size"),10),e.visible=2<=t*(r.zoom.scale/n[1]),e.visible?1:0})},r.draw.timing?r.g.viz.selectAll("text.d3plus_label").transition().duration(r.draw.timing).call(e):r.g.viz.selectAll("text.d3plus_label").call(e),r.dev.value)return a.timeEnd("determining label visibility")}},{"../../../core/console/print.coffee":52}],252:[function(e,t,r){var f,p,h;f=e("./labels.coffee"),p=e("../../../tooltip/remove.coffee"),h=e("./transform.coffee"),t.exports=function(e){var t,r,n,a,o,i,s,l,u,c,d;return r=d3.event.sourceEvent?d3.event.sourceEvent.type:null,o=d3.event.translate,a=d3.event.scale,n=e.zoom.bounds,s=0<(l=(e.width.viz-e.zoom.size.width*a)/2)?l:0,i=0<l?e.width.viz-l:e.width.viz,c=0<(d=(e.height.viz-e.zoom.size.height*a)/2)?d:0,u=0<d?e.height.viz-d:e.height.viz,o[0]+n[0][0]*a>s?o[0]=-n[0][0]*a+s:o[0]+n[1][0]*a<i&&(o[0]=i-n[1][0]*a),o[1]+n[0][1]*a>c?o[1]=-n[0][1]*a+c:o[1]+n[1][1]*a<u&&(o[1]=u-n[1][1]*a),e.zoom.behavior.translate(o).scale(a),e.zoom.translate=o,e.zoom.scale=a,"wheel"===r&&p(e.type.value),(e.labels.value||e.labels.changed)&&("wheel"===r?(t=e.draw.timing?100:250,clearTimeout(e.zoom.wheel),e.zoom.wheel=setTimeout(function(){return f(e)},t)):f(e)),h(e,"dblclick"===r?e.timing.transitions:0)}},{"../../../tooltip/remove.coffee":203,"./labels.coffee":251,"./transform.coffee":254}],253:[function(e,t,r){t.exports=function(e,t){var r,n,a;n=e.zoom,t||(t=d3.event),a=n.scale>n.behavior.scaleExtent()[0],r=e.types[e.type.value].zoom&&n.value&&n.scroll.value,t.touches&&1<t.touches.length&&r||a||t.stopPropagation()}},{}],254:[function(e,t,r){t.exports=function(e,t){var r;return"number"!=typeof t&&(t=e.timing.transitions),r="translate("+e.zoom.translate+")",r+="scale("+e.zoom.scale+")",t?e.g.viz.transition().duration(t).attr("transform",r):e.g.viz.attr("transform",r)}},{}],255:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Object,String],deprecates:"active_var",mute:n(!0),solo:n(!0),spotlight:{accepted:[Boolean],deprecates:"spotlight",value:!1},value:!1}},{"../../core/methods/filter.coffee":81}],256:[function(e,t,r){t.exports={accepted:[Object],deprecated:"nesting_aggs",objectAccess:!1,value:{}}},{}],257:[function(e,t,r){var n;n=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Object,String],delimiter:{accepted:String,value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},keys:{},process:n,value:!1}},{"../../core/methods/process/data.coffee":87}],258:[function(e,t,r){var n,a;n=e("../../core/methods/process/margin.coffee"),a=e("../../core/methods/rendering.coffee"),t.exports={background:{color:"#fafafa",rendering:a(),stroke:{color:"#ccc",width:1}},margin:{accepted:[Number,Object,String],process:function(e){var t;return void 0===e&&(e=this.value),n(t=e,this),t},value:10},mirror:{accepted:[Boolean],deprecates:["mirror_axis","mirror_axes"],value:!1},ticks:{accepted:[Boolean],value:!0}}},{"../../core/methods/process/margin.coffee":90,"../../core/methods/rendering.coffee":92}],259:[function(e,t,r){t.exports={accepted:[String],value:"#ffffff"}},{}],260:[function(e,t,r){t.exports={accepted:[Function,String],value:!1}},{}],261:[function(e,t,r){var n,a;n=e("../../core/methods/filter.coffee"),a=e("../../color/scale.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],deprecates:"color_var",domain:{accepted:[!1,Array],value:!1},focus:"#444444",heatmap:["#282F6B","#419391","#AFD5E8","#EACE3F","#B35C1E","#B22200"],missing:"#eeeeee",mute:n(!0),primary:"#d74b03",range:["#B22200","#FFEE8D","#759143"],scale:{accepted:[Array,Function,"d3plus","category10","category20","category20b","category20c"],process:function(e){return e instanceof Array?d3.scale.ordinal().range(e):"d3plus"===e?a:"string"==typeof e?d3.scale[e]():e},value:"d3plus"},solo:n(!0),secondary:"#e5b3bb",value:!1}},{"../../color/scale.coffee":48,"../../core/methods/filter.coffee":81}],262:[function(e,t,r){t.exports={accepted:[Array,Function,String],index:{accepted:[Boolean],value:!0},process:function(e,t){return"string"==typeof e&&(e=[e]),e},value:!1}},{}],263:[function(e,t,r){arguments[4][108][0].apply(r,arguments)},{dup:108}],264:[function(e,t,r){var n;n=e("../../util/d3selection.coffee"),t.exports={accepted:[!1,Array,Object,String],id:"default",process:function(e,t){return!1!==e&&("default"===t.container.id&&t.self.container({id:"d3plus_"+ +new Date}),n(e)?e.append("div"):e instanceof Array?d3.select(e[0][0]).append("div"):(this.selector=e,d3.select(e).append("div")))},value:!1}},{"../../util/d3selection.coffee":208}],265:[function(e,t,r){var n,a;n=e("../../core/methods/filter.coffee"),a=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],center:[0,0],filetype:{accepted:["json"],value:"json"},fit:{accepted:["auto","height","width"],value:"auto"},key:!1,mute:n(!1),padding:20,process:a,projection:{accepted:["albers","albersUsa","azimuthalEqualArea","azimuthalEquidistant","conicConformal","conicEqualArea","conicEquidistant","equirectangular","gnomonic","mercator","orthographic","stereographic","transverseMercator",Function],value:"mercator"},simplify:{accepted:[Boolean],value:!0},solo:n(!1),threshold:{accepted:[Number],value:.9},value:!1}},{"../../core/methods/filter.coffee":81,"../../core/methods/process/data.coffee":87}],266:[function(e,t,r){var P,I,D;P=e("../../core/fetch/value.coffee"),I=e("../../client/ie.js"),D=e("../../string/strip.js"),t.exports={accepted:[void 0,!0,Array,String],chainable:!1,data:[],process:function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N;if(void 0===t.returned)return[];if((e=e||t.cols.value)instanceof Array?o=e:"string"==typeof e&&(o=[e]),s=[],q=[],t.title.value?("function"==typeof(C=t.title.value)&&(C=C(t.self)),250,C=(C=D(C)).substr(0,250)):C="D3plus Visualization Data",!0===e)for(o=d3.keys(t.data.keys),s.push(o),f=0,v=(F=t.data.value).length;f<v;f++){for(l=F[f],B=[],p=0,g=o.length;p<g;p++)N=l[n=o[p]],"string"===t.data.keys[n]&&(N='"'+N+'"'),B.push(N);s.push(B)}else{for(o||(o=[t.id.value],t.time.value&&o.push(t.time.value),t.size.value&&o.push(t.size.value),t.text.value&&o.push(t.text.value)),h=0,m=o.length;h<m;h++)n=o[h],q.push(t.format.value(n));for(s.push(q),z=0,y=(S=t.returned.nodes).length;z<y;z++)if(null!=(j=S[z]).values&&j.values instanceof Array)for(A=0,x=(T=j.values).length;A<x;A++){for(N=T[A],B=[],M=0,b=o.length;M<b;M++)a=o[M],"string"==typeof(N=P(t,N,a))&&(N='"'+N+'"'),B.push(N);s.push(B)}else{for(B=[],O=0,w=o.length;O<w;O++)a=o[O],B.push(P(t,j,a));s.push(B)}}for(i="data:text/csv;charset=utf-8,",d=E=0,_=s.length;E<_;d=++E)u=(n=s[d]).join(","),i+=d<s.length?u+"\n":u;return I?(r=new Blob([i],{type:"text/csv;charset=utf-8;"}),navigator.msSaveBlob(r,C+".csv")):(c=encodeURI(i),(k=document.createElement("a")).setAttribute("href",c),k.setAttribute("download",C+".csv"),k.click()),this.data=s,o},value:void 0}},{"../../client/ie.js":37,"../../core/fetch/value.coffee":67,"../../string/strip.js":175}],267:[function(e,t,r){var n;n=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Function,String],cache:{},delimiter:{accepted:[String],value:"|"},donut:{size:.35},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},filters:[],keys:{},mute:[],large:400,opacity:.9,padding:{accepted:[Number],value:1},process:function(e,t){return n(e,t,this)},solo:[],stroke:{width:1},value:!1}},{"../../core/methods/process/data.coffee":87}],268:[function(e,t,r){t.exports={accepted:[Function,Number],value:0}},{}],269:[function(e,t,r){t.exports={accepted:[!1,Function,Object],value:!1}},{}],270:[function(e,t,r){arguments[4][112][0].apply(r,arguments)},{dup:112}],271:[function(e,t,r){var o=e("../../core/console/print.coffee"),i=e("../../string/format.js");t.exports={accepted:[void 0,Function],first:!0,frozen:!1,process:function(e,t){if(!1===this.initialized)return this.initialized=!0,e;if(void 0===e&&"function"==typeof this.value&&(e=this.value),!1===t.container.value){var r=t.format.locale.value.dev.setContainer;o.warning(r,"container")}else if(t.container.value.empty()){r=t.format.locale.value.dev.noContainer;var n=t.container.selector||"";o.warning(i(r,'"'+n+'"'),"container")}else t.dev.value&&o.time("total draw time"),t.container.value.call(t.self);if("function"==typeof e&&t.history.chain.length){var a={};t.history.chain.forEach(function(e){var t=e.method;delete e.method,a[t]=e}),e(a),t.history.chain=[]}return e},update:!0,value:void 0}},{"../../core/console/print.coffee":52,"../../string/format.js":173}],272:[function(e,t,r){var n=e("../../core/methods/process/data.coffee");t.exports={accepted:[!1,Array,Function,String],arrows:{accepted:[Boolean,Number],direction:{accepted:["source","target"],value:"target"},value:!1},color:"#d0d0d0",connections:function(r,n,a){var o=this;if(!o.value)return[];if(!n)n="id";var e=o.restricted||o.value,i=[];if(!r)return e;var t=e.filter(function(e){var t=!1;return e[o.source][n]==r?(t=!0,a&&i.push(e[o.target])):e[o.target][n]==r&&(t=!0,a&&i.push(e[o.source])),t});return a?i:t},delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},interpolate:{accepted:["basis","cardinal","linear","monotone","step"],value:"basis"},label:!1,large:100,limit:{accepted:[!1,Function,Number],value:!1},opacity:{accepted:[Function,Number,String],min:{accepted:[Number],value:.25},scale:{accepted:[Function],value:d3.scale.linear()},value:1},process:n,size:{accepted:[!1,Number,String],min:1,scale:.5,value:!1},source:"source",strength:{accepted:[!1,Function,Number,String],value:!1},target:"target",value:!1}},{"../../core/methods/process/data.coffee":87}],273:[function(e,t,r){t.exports={accepted:[Boolean,String],value:!1}},{}],274:[function(e,t,r){t.exports={accepted:[!1,Array,Function,Number,String],deprecates:"highlight",process:function(e){return!1===e?[]:e instanceof Array?e:[e]},tooltip:{accepted:[Boolean],value:!0},value:[]}},{}],275:[function(e,t,r){var n,a,o,i;n=e("../../core/methods/font/align.coffee"),a=e("../../core/methods/font/decoration.coffee"),o=e("../../core/methods/font/family.coffee"),i=e("../../core/methods/font/transform.coffee"),t.exports={align:n(),color:"#444444",decoration:a(),family:o(),secondary:{align:n(),color:"#444444",decoration:a(),family:o(),size:12,spacing:0,transform:i(),weight:200},size:12,spacing:0,transform:i(),weight:200}},{"../../core/methods/font/align.coffee":82,"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],276:[function(e,t,r){var n,a,o;a=e("../../core/methods/font/family.coffee"),n=e("../../core/methods/font/decoration.coffee"),o=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[!1,Number,String],font:{align:"center",color:"#444",decoration:n(),family:a(),size:11,transform:o(),weight:200},link:!1,padding:0,position:"bottom",value:!1}},{"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],277:[function(e,t,r){var a,n,o,i;a=e("../../number/format.coffee"),n=e("../../core/locale/locale.coffee"),o=e("../../object/merge.coffee"),i=e("../../string/title.coffee"),t.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:!1,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(n)},process:function(e){var t;return"en_US",t=n.en_US,"en_US"!==e&&(t=o(t,n[e])),this.language=e,t},value:"en_US"},number:{accepted:[!1,Function],value:!1},process:function(e,t){if("string"==typeof e)t.self.format({locale:e});else if("function"==typeof e)return e;return this.value},text:{accepted:[!1,Function],value:!1},value:function(e,t){var r,n;return t||(t={}),t.locale||(t.locale=this.locale.value),(n=t.vars||{}).time&&n.time.value&&t.key===n.time.value?(r=e.constructor===Date?e:new Date(e),n.data.time.format(r)):"number"==typeof e?(this.number.value||a)(e,t):"string"==typeof e?(this.text.value||i)(e,t):JSON.stringify(e)}}},{"../../core/locale/locale.coffee":79,"../../number/format.coffee":170,"../../object/merge.coffee":171,"../../string/title.coffee":176}],278:[function(e,t,r){t.exports={accepted:[!1,Number],max:600,secondary:!1,small:200,value:!1}},{}],279:[function(e,t,r){var n,a,o,s,l,u,c,d;n=e("../../../core/methods/font/align.coffee"),a=e("../../../core/methods/font/decoration.coffee"),o=e("../../../core/methods/font/family.coffee"),s=e("../../../core/methods/filter.coffee"),u=e("../../../core/methods/font/position.coffee"),c=e("../../../core/methods/rendering.coffee"),d=e("../../../core/methods/font/transform.coffee"),l={x:"bottom",x2:"top",y:"left",y2:"right"},t.exports=function(i){return{accepted:[Array,Boolean,Function,Object,String],affixes:{accepted:[Boolean],separator:{accepted:[Boolean,Array],value:!0},value:!1},axis:{accepted:[Boolean],color:"#444",font:{color:!1,decoration:a(!1),family:o(""),size:!1,spacing:0,transform:d(!1),weight:!1},rendering:c(),value:!0},dataFilter:!0,deprecates:[i+"axis",i+"axis_val",i+"axis_var"],domain:{accepted:[!1,Array],value:!1},grid:{accepted:[Boolean],color:"#ccc",rendering:c(),value:!0},label:{accepted:[Boolean,String],fetch:function(e){return!0===this.value?e.format.value(e[i].value,{key:i,vars:e}):this.value},font:{color:"#444",decoration:a(),family:o(),size:12,spacing:0,transform:d(),weight:200},padding:3,value:!0},lines:{accept:[!1,Array,Number,Object],dasharray:{accepted:[Array,String],process:function(e){return e instanceof Array&&(e=(e=e.filter(function(e){return!isNaN(e)})).length?e.join(", "):"none"),e},value:"10, 10"},color:"#888",font:{align:n("right"),color:"#444",background:{accepted:[Boolean],value:!0},decoration:a(),family:o(),padding:{accepted:[Number],value:10},position:u("middle"),size:12,transform:d(),weight:200},process:Array,rendering:c(),width:1,value:[]},mouse:{accept:[Boolean],dasharray:{accepted:[Array,String],process:function(e){return e instanceof Array&&(e=(e=e.filter(function(e){return!isNaN(e)})).length?e.join(", "):"none"),e},value:"none"},rendering:c(),width:2,value:!0},mute:s(!0),orient:{accepted:["top","right","bottom","left"],value:l[i]},padding:{accepted:[Number],value:.1},persist:{position:{accepted:[Boolean],value:!1},size:{accepted:[Boolean],value:!0}},range:{accepted:[!1,Array],value:!1},scale:{accepted:["linear","log","discrete","share"],deprecates:["layout","unique_axis",i+"axis_scale"],process:function(e,t){var r,n,a,o;for(r=0,n=(a=["log","discrete","share"]).length;r<n;r++)(o=a[r])===e?t.axes[o]=i:t.axes[o]===i&&(t.axes[o]=!1);return"discrete"===e&&(t.axes.opposite=0===i.indexOf("x")?"y":"x"),e},value:"linear"},solo:s(!0),stacked:{accepted:[Boolean],process:function(e,t){return e||t.axes.stacked!==i?e&&(t.axes.stacked=i):t.axes.stacked=!1,e},value:!1},ticks:{accepted:[!1,Array],color:"#ccc",font:{color:"#666",decoration:a(),family:o(),size:10,spacing:0,transform:d(),weight:200},labels:{accepted:[Boolean,Array],value:!0},rendering:c(),size:10,width:1,value:!1},value:!1,zerofill:{accepted:[Boolean],value:!1}}}},{"../../../core/methods/filter.coffee":81,"../../../core/methods/font/align.coffee":82,"../../../core/methods/font/decoration.coffee":83,"../../../core/methods/font/family.coffee":84,"../../../core/methods/font/position.coffee":85,"../../../core/methods/font/transform.coffee":86,"../../../core/methods/rendering.coffee":92}],280:[function(e,t,r){t.exports={accepted:[Boolean],back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var e;for(e=[];this.states.length;)e.push(this.states.pop()());return e},states:[],value:!0}},{}],281:[function(e,t,r){var n;n=e("../../core/methods/process/icon.coffee"),t.exports={accepted:[!1,Array,Function,Object,String],back:{accepted:[!1,String],fallback:"&#x276e;",opacity:1,process:n,rotate:0,value:"fa-angle-left"},deprecates:"icon_var",style:{accepted:[Object,String],deprecates:"icon_style",value:"default"},value:!1}},{"../../core/methods/process/icon.coffee":89}],282:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,String],dataFilter:!0,deprecates:["id_var","nesting"],grouping:{accepted:[Boolean],value:!0},mute:n(!0),nesting:["id"],solo:n(!0),value:"id"}},{"../../core/methods/filter.coffee":81}],283:[function(e,t,r){var n,a,o;n=e("../../core/methods/font/decoration.coffee"),a=e("../../core/methods/font/family.coffee"),o=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Boolean],align:{accepted:["start","middle","end","left","center","right"],process:function(e){var t;return 0<=(t=["left","center","right"].indexOf(e))&&(e=this.accepted[t]),e},value:"middle"},color:{accepted:[!1,String],value:!1},font:{decoration:n(),family:a(),size:11,transform:o(),weight:200},padding:7,resize:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},segments:2,valign:{accepted:[!1,"top","middle","bottom"],value:"middle"},value:!0}},{"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],284:[function(e,t,r){var n;n=e("../../core/methods/font/family.coffee"),t.exports={accepted:[Boolean],align:"middle",data:{accepted:[Boolean],value:!0},filters:{accepted:[Boolean],value:!1},font:{align:"middle",color:"#444444",family:n(),size:[8,14],weight:200},gradient:{height:10},icons:{accepted:[Boolean],value:!0},labels:{accepted:[Boolean],value:!0},order:{accepted:["color","id","size","text",Function],sort:{accepted:["asc","desc"],value:"asc"},value:"color"},size:[8,30],tooltip:{accepted:[Boolean],value:!0},text:{accepted:[!1,Function,String],value:!1},title:{accepted:[!1,Function,String],value:!1},value:!0}},{"../../core/methods/font/family.coffee":84}],285:[function(e,t,r){var n,a,o;n=e("../../core/methods/font/decoration.coffee"),a=e("../../core/methods/font/family.coffee"),o=e("../../core/methods/font/transform.coffee"),t.exports={font:{color:"#444444",decoration:n(),family:a(),transform:o(),weight:200},hover:{color:"#444444",decoration:n(),family:a(),transform:o(),weight:200}}},{"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],286:[function(e,t,r){arguments[4][123][0].apply(r,arguments)},{"../../core/methods/process/margin.coffee":90,dup:123}],287:[function(e,t,r){var n,a,o;n=e("../../core/methods/font/decoration.coffee"),a=e("../../core/methods/font/family.coffee"),o=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Boolean,String],background:{accepted:[!1,String],value:!1},branding:{accepted:[Boolean],image:{dark:"http://d3plus.org/assets/img/icon-transparent-invert.png",light:"http://d3plus.org/assets/img/icon-transparent.png"},value:!1},font:{color:"#444",decoration:n(),family:a(),size:16,transform:o(),weight:200},padding:5,style:{accepted:[!1,"small","large"],value:!1},value:!0}},{"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],288:[function(e,t,r){t.exports={accepted:[Boolean],click:{accepted:[Boolean,Function],value:!0},move:{accepted:[Boolean,Function],value:!0},out:{accepted:[Boolean,Function],value:!0},over:{accepted:[Boolean,Function],value:!0},value:!0}},{}],289:[function(e,t,r){var n;n=e("../../core/methods/process/data.coffee"),t.exports={accepted:[!1,Array,Function,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[!1,"json","xml","html","csv","dsv","tsv","txt"],value:!1},overlap:.6,process:n,value:!1}},{"../../core/methods/process/data.coffee":87}],290:[function(e,t,r){t.exports={accepted:[Boolean,Function,String],agg:{accepted:[!1,Function,"sum","min","max","mean","median"],value:!1},deprecates:["sort"],sort:{accepted:["asc","desc"],value:"desc"},value:!1}},{}],291:[function(e,t,r){t.exports={accepted:[Boolean],value:!1,timeout:400,process:function(e,n){var t,r,a;return!!e&&(t=null,r=function(){var e,t,r;if(r=(t=n.container.value.node().parentNode.getBoundingClientRect()).width,e=t.height,n.self.width(r),n.self.height(e),n.width.changed||n.height.changed)return n.self.draw()},d3.select(window).on("resize."+n.container.id,(a=this,function(e){return clearTimeout(t),t=setTimeout(r,a.timeout)})),e)}}},{}],292:[function(e,t,r){var n;n=e("../../core/methods/rendering.coffee"),t.exports={accepted:function(e){var t;return!(t=e.types[e.type.value].shapes)||t instanceof Array||(t=[t]),t.length?t:["square"]},interpolate:{accepted:["basis","basis-open","cardinal","cardinal-open","linear","monotone","step","step-before","step-after"],deprecates:"stack_type",value:"linear"},rendering:n(),value:!1}},{"../../core/methods/rendering.coffee":92}],293:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Number,Object,String],dataFilter:!0,deprecates:["value","value_var"],mute:n(!0),scale:{accepted:[Function],deprecates:"size_scale",domain:{min:{accepted:[!1,Number],value:!1},max:{accepted:[!1,Number],value:!1}},range:{max:{accepted:[Function,Number],value:function(e){return Math.floor(d3.max([d3.min([e.width.viz,e.height.viz])/15,6]))}},min:{accepted:[Function,Number],value:3}},value:d3.scale.sqrt()},solo:n(!0),threshold:{accepted:[Boolean,Function,Number],value:!1},value:!1}},{"../../core/methods/filter.coffee":81}],294:[function(e,t,r){t.exports={value:!1}},{}],295:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Object,String],deprecates:["else_var","else"],mute:n(!0),solo:n(!0),value:!1}},{"../../core/methods/filter.coffee":81}],296:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,Boolean,Function,Object,String],deprecates:["name_array","text_var"],nesting:!0,mute:n(!0),solo:n(!0),value:!1}},{"../../core/methods/filter.coffee":81}],297:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[Array,Boolean,Function,Object,String],dataFilter:!0,deprecates:["year","year_var"],fixed:{accepted:[Boolean],deprecates:["static_axis","static_axes"],value:!0},format:{accepted:[!1,Array,Function,String],value:!1},mute:n(!1),solo:n(!1),value:!1}},{"../../core/methods/filter.coffee":81}],298:[function(e,t,r){t.exports={accepted:[Boolean],align:"middle",hover:{accepted:["all-scroll","col-resize","crosshair","default","grab","grabbing","move","pointer"],value:"pointer"},handles:{accepted:[Boolean],color:"#666",opacity:1,size:3,stroke:"#666",value:!0},height:{accepted:[!1,Number],value:!1},play:{accepted:[Boolean],icon:{accepted:[!1,String],awesome:"",fallback:"►"},pause:{accepted:[!1,String],awesome:"",fallback:"❚❚"},timing:{accepted:[Number],value:1500},value:!0},value:!0}},{}],299:[function(e,t,r){t.exports={mouseevents:60,transitions:600,ui:200}},{}],300:[function(e,t,r){var n,a,o,i;n=e("../../core/methods/font/decoration.coffee"),a=e("../../core/methods/font/family.coffee"),i=e("../../core/methods/font/transform.coffee"),o=e("../../string/strip.js"),t.exports={accepted:[!1,Function,String],font:{align:"center",color:"#444444",decoration:n(),family:a(),size:16,transform:i(),weight:400},height:!1,link:!1,padding:2,position:"top",process:function(e,t){var r;return 0===t.container.id.indexOf("default")&&e&&(r=o(e).toLowerCase(),t.self.container({id:r})),e},sub:{accepted:[!1,Function,String],deprecates:"sub_title",font:{align:"center",color:"#444444",decoration:n(),family:a(),size:12,transform:i(),weight:200},link:!1,padding:1,position:"top",value:!1},total:{accepted:[Boolean,Object],deprecates:"total_bar",font:{align:"center",color:"#444444",decoration:n(),family:a(),size:12,transform:i(),weight:200,value:!1},link:!1,padding:1,position:"top",value:!1},width:!1,value:!1}},{"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86,"../../string/strip.js":175}],301:[function(e,t,r){var n,a;n=e("../../core/methods/font/family.coffee"),a=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Boolean,Array,Function,Object,String],anchor:"top center",background:"#ffffff",children:{accepted:[Boolean,Number],value:!0},connections:{accepted:[Boolean],value:!0},curtain:{color:"#ffffff",opacity:.8},deprecates:"tooltip_info",extent:{accepted:[Boolean],value:!0},font:{color:"#444",family:n(),size:12,transform:a(),weight:200},fullscreen:{accepted:[Boolean],value:!1},html:{accepted:[!1,Function,Object,String],deprecates:"click_function",value:!1},iqr:{accepted:[Boolean],value:!0},large:250,share:{accepted:[Boolean],value:!0},size:{accepted:[Boolean],value:!0},small:225,stacked:{accepted:[Boolean],value:!1},sub:{accepted:[!1,Function,String],value:!1},value:!0}},{"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],302:[function(e,t,r){var n;n=e("../../core/methods/filter.coffee"),t.exports={accepted:[!1,Function,Object,String],deprecates:["total_var"],mute:n(!0),solo:n(!0),value:!1}},{"../../core/methods/filter.coffee":81}],303:[function(e,t,r){t.exports={accepted:function(e){return d3.keys(e.types)},mode:{accepted:function(e){return e.types[e.type.value].modes||[!1]},value:!1},value:"tree_map"}},{}],304:[function(e,t,r){var n,a,o,i;o=e("../../core/methods/font/family.coffee"),n=e("../../core/methods/font/align.coffee"),a=e("../../core/methods/font/decoration.coffee"),i=e("../../core/methods/font/transform.coffee"),t.exports={accepted:[Array,Boolean],align:n("center"),border:1,color:{primary:{process:function(e,t){var r;return r=this.value,t.ui.color.secondary.value||(t.ui.color.secondary.value=d3.rgb(r).darker(.75).toString()),e},value:"#ffffff"},secondary:{value:!1}},display:{acceped:["block","inline-block"],value:"inline-block"},font:{align:"center",color:"#444",decoration:a(),family:o(),size:11,transform:i(),weight:200},margin:5,padding:5,position:{accepted:["top","right","bottom","left"],value:"bottom"},value:!1}},{"../../core/methods/font/align.coffee":82,"../../core/methods/font/decoration.coffee":83,"../../core/methods/font/family.coffee":84,"../../core/methods/font/transform.coffee":86}],305:[function(e,t,r){t.exports={accepted:[!1,Number],secondary:!1,small:200,value:!1}},{}],306:[function(e,t,r){t.exports={accepted:[Boolean],behavior:d3.behavior.zoom().scaleExtent([1,1]).duration(0),click:{accepted:[Boolean],value:!0},pan:{accepted:[Boolean],value:!0},scroll:{accepted:[Boolean],deprecates:"scroll_zoom",value:!0},value:!0}},{}],307:[function(e,t,r){var n,d,f,a,p,h,o;e("../../util/closest.coffee"),d=e("../../core/fetch/value.coffee"),f=e("./helpers/graph/draw.coffee"),a=e("./helpers/graph/nest.coffee"),p=e("../../array/sort.coffee"),h=e("./helpers/graph/stack.coffee"),o=e("../../core/data/threshold.js"),(n=function(e){var t,r,n,a,o,i,s,l,u,c;if(f(e,{buffer:e.axes.opposite,zero:!0}),0<=e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0))return[];for(r=p(e.data.viz,null,null,null,e),n=e[e.axes.discrete],l=e[e.axes.opposite],a=0,i=r.length;a<i;a++)for((u=r[a]).d3plus||(u.d3plus={}),o=0,s=(c=u.values).length;o<s;o++)(t=c[o]).d3plus||(t.d3plus={}),t.d3plus.x=n.scale.viz(d(e,t,n.value)),t.d3plus.x+=e.axes.margin.viz.left,t.d3plus.y=l.scale.viz(d(e,t,l.value)),t.d3plus.y+=e.axes.margin.viz.top,t.d3plus.merged instanceof Array&&(u.d3plus.merged||(u.d3plus.merged=[]),u.d3plus.merged=u.d3plus.merged.concat(t.d3plus.merged)),t.d3plus.text&&!u.d3plus.text&&(u.d3plus.text=t.d3plus.text);return h(e,r)}).filter=function(e,t){return a(e,o(e,t,e[e.axes.discrete].value))},n.requirements=["data","x","y"],n.setup=function(e){var t,r,n;return e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})),e[e.axes.discrete].zerofill.value||e.self[e.axes.discrete]({zerofill:!0}),e[e.axes.opposite].stacked.value||"stacked"!==e.type.value||e.self[e.axes.opposite]({stacked:!0}),n=e[e.axes.opposite],r=e.size,!n.value&&r.value||r.changed&&r.previous===n.value?e.self[e.axes.opposite](r.value):!r.value&&n.value||n.changed&&n.previous===r.value?e.self.size(n.value):void 0},n.shapes=["area"],n.threshold=function(e){return 20/e.height.viz},n.tooltip="static",t.exports=n},{"../../array/sort.coffee":34,"../../core/data/threshold.js":61,"../../core/fetch/value.coffee":67,"../../util/closest.coffee":206,"./helpers/graph/draw.coffee":314,"./helpers/graph/nest.coffee":320,"./helpers/graph/stack.coffee":321}],308:[function(e,t,r){var n,V,R,U,a,L,Y,H=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};V=e("../../util/buckets.coffee"),R=e("../../core/fetch/value.coffee"),U=e("./helpers/graph/draw.coffee"),a=e("./helpers/graph/nest.coffee"),L=e("./helpers/graph/stack.coffee"),Y=e("../../util/uniques.coffee"),(n=function(e){var t,r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P,I,D;if(u="x"===(i=e.axes.discrete)?"height":"width",P="x"===i?"width":"height",E=e.axes.opposite,n="x"===i?"left":"top",z="x"===i?"top":"left",U(e,{buffer:!0,zero:E}),0<=e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0))return[];if(_=e.data.viz,e.axes.stacked)for(f=0,v=_.length;f<v;f++)T=_[f],L(e,T.values);for(q=e.axes[P]/e[e.axes.discrete].ticks.values.length,(S=e[e.axes.discrete].padding.value)<1&&(S*=q),q<2*S&&(S=.1*q),b=q-2*S,e.axes.stacked||(e[i].persist.position.value?(B=e[i].value,A=q/2-(b/=l=0<=H.call(e.id.nesting,B)?d3.max(_,function(e){return e.values.length}):Y(_,e.id.value,R,e).length)/2-S,I=d3.scale.ordinal(),1===l?I.domain([0]).range([0]):I.domain([0,l-1]).range([-A,A])):I=d3.scale.linear()),o=[],j=(M=e[E]).scale.viz.domain().slice(),0===E.indexOf("y")&&(j=j.reverse()),j[0]<=0&&0<=j[1]?D=0:j[0]<0?D(d3.max(j)):D=d3.min(j),e[i].persist.position.value&&!e.axes.stacked&&(d=Y(d3.merge(_.map(function(e){return e.values})),e.id.value,R,e,e.id.value,!1),I.domain(d),1===d.length?I.range([0]):I.range(V(I.range(),d.length))),x=d3.max(_,function(e){return e.values.length}),p=0,g=_.length;p<g;p++)for(F=_[p],e.axes.stacked?(t=1,k=b):e[i].persist.position.value?(t=l,k=b):(t=F.values.length,A=e[i].persist.size.value?q/2-(k=b/x)/2*(x-t)-k/2-S:q/2-(k=b/t)/2-S,I.domain([0,t-1]),I.range([-A,A])),c=h=0,m=(C=F.values).length;h<m;c=++h){if(a=C[c],w=e.axes.stacked?0:e[i].persist.position.value?I(R(e,a,e.id.value)):I(c%t),e.axes.stacked)N=a.d3plus[E],r=a.d3plus[E+"0"];else{if(null===(O=R(e,a,M.value))&&(M=e[E+"2"],O=R(e,a,M.value)),0===O)continue;"log"===M.scale.value&&(D=O<0?-1:1),N=M.scale.viz(O),r=M.scale.viz(D)}s=R(e,a,e[i].value),a.d3plus[i]=e[i].scale.viz(s),a.d3plus[i]+=e.axes.margin.viz[n]+w,y=r-N,a.d3plus[E]=r-y/2,e.axes.stacked||(a.d3plus[E]+=e.axes.margin.viz[z]),delete a.d3plus.r,a.d3plus[P]=k,a.d3plus[u]=Math.abs(y),a.d3plus.init={},a.d3plus.init[E]=M.scale.viz(D),a.d3plus.init[E]-=a.d3plus[E],a.d3plus.init[E]+=e.axes.margin.viz[z],a.d3plus.init[P]=a.d3plus[P],e.text.value?delete a.d3plus.label:a.d3plus.label=!1,o.push(a)}return o}).filter=function(e,t){return a(e,t,e[e.axes.discrete].value)},n.requirements=["data","x","y"],n.setup=function(e){var t,r,n;return e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})),n=e[e.axes.opposite],r=e.size,!n.value&&r.value||r.changed&&r.previous===n.value?e.self[e.axes.opposite](r.value):!r.value&&n.value||n.changed&&n.previous===r.value?e.self.size(n.value):void 0},n.shapes=["square"],t.exports=n},{"../../core/fetch/value.coffee":67,"../../util/buckets.coffee":204,"../../util/uniques.coffee":210,"./helpers/graph/draw.coffee":314,"./helpers/graph/nest.coffee":320,"./helpers/graph/stack.coffee":321}],309:[function(e,t,r){var n,Z,a,$,ee,te;Z=e("../../core/fetch/value.coffee"),a=e("./helpers/graph/draw.coffee"),$=e("../../string/format.js"),ee=e("../../string/strip.js"),te=e("../../util/uniques.coffee"),(n=function(F){var S,T,B,C,q,N,P,I,D,V,R,U,L,Y,H,X,G,J,e,W,Q,K;return a(F,{buffer:!0}),0<=F.x.domain.viz.concat(F.y.domain.viz).indexOf(void 0)?[]:(B=F.axes.discrete,Y=F.axes.opposite,T="x"===B?F.axes.margin.viz.left:F.axes.margin.viz.top,L="x"===Y?F.axes.margin.viz.left:F.axes.margin.viz.top,C="x"===B?"height":"width",K="x"===B?"width":"height",W=F.axes[K]/F[B].ticks.values.length,e="number"==typeof(e=F.size.value)?e:100,W=d3.min([W-2*F.labels.padding,e]),(R=F.type.mode.value)instanceof Array||(R=[R,R]),U=!(D=function(e){var t,r,n;for(t in r={},F.data.keys)n=te(e,t,Z,F),r[t]=1===n.length?n[0]:n;return r}),P=[],q=F.format.value(F.format.locale.value.ui.iqr),N=F.format.value(F.format.locale.value.ui.max),V=F.format.value(F.format.locale.value.ui.min),H=F.format.value(F.format.locale.value.ui.percentile),S=F.format.value(F.format.locale.value.ui.tukey_bottom),Q=F.format.value(F.format.locale.value.ui.tukey_top),X=F.format.value(F.format.locale.value.ui.quartile_first),G=F.format.value(F.format.locale.value.ui.quartile_third),I=F.format.value(F.format.locale.value.ui.median),J=[],d3.nest().key(function(e){return Z(F,e,F[B].value)}).rollup(function(e){var t,r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E;for(b=F[Y].scale.viz,(M=e.map(function(e){return Z(F,e,F[Y].value)})).sort(function(e,t){return e-t}),te(M),l=d3.quantile(M,.25),v=d3.quantile(M,.5),w=d3.quantile(M,.75),_={},"tukey"===R[1]?(k=w-1.5*(l-w),z=Q):"extent"===R[1]?(k=d3.max(M),z=N):"number"==typeof R[1]&&(k=d3.quantile(M,(100-R[1])/100),z=$(H,R[1])),k=d3.min([d3.max(M),k]),F.tooltip.extent.value&&(_[z]={key:F[Y].value,value:k}),F.tooltip.iqr.value&&(_[G]={key:F[Y].value,value:w},_[I]={key:F[Y].value,value:v},_[X]={key:F[Y].value,value:l}),"tukey"===R[0]?(t=l+1.5*(l-w),r=S):"extent"===R[0]?(t=d3.min(M),r=V):"number"==typeof R[0]&&(t=d3.quantile(M,R[0]/100),z=$(H,R[0])),t=d3.max([d3.min(M),t]),F.tooltip.extent.value&&(_[r]={key:F[Y].value,value:t}),a=[],n=[],A=[],x=[],u=0,p=e.length;u<p;u++)o=e[u],l<=(j=Z(F,o,F[Y].value))&&j<=w?a.push(o):t<=j&&j<l?n.push(o):j<=k&&w<j?A.push(o):x.push(o);for(d=Z(F,e[0],F[B].value),O=F[B].scale.viz(d),O+=T,f=F.format.value(d,{key:F[B].value,vars:F}),d.constructor===Date&&(d=d.getTime()),d=ee(d),(a=D(a)).d3plus={color:"white",id:"box_"+d,init:{},label:!1,shape:"square",stroke:"#444",text:$(q,f)},a.d3plus[K]=W,a.d3plus.init[K]=W,a.d3plus[C]=Math.abs(b(l)-b(w)),a.d3plus[B]=O,E=d3.min([b(l),b(w)])+a.d3plus[C]/2,E+=L,a.d3plus[Y]=E,a.d3plus.tooltip=_,J.push(a),m={d3plus:{id:"median_line_"+d,position:"height"===C?"top":"right",shape:"whisker",static:!0}},f={background:"#fff",names:[F.format.value(v,{key:F[Y].value,vars:F})],padding:0,resize:!1,x:0,y:0},i=Math.abs(b(v)-b(l)),s=Math.abs(b(v)-b(w)),y=2*d3.min([i,s]),g=2*F.data.stroke.width+2*F.labels.padding,f["width"===K?"w":"h"]=W-g,f["width"===C?"w":"h"]=y-g,m.d3plus.label=f,m.d3plus[K]=W,m.d3plus[B]=O,m.d3plus[Y]=b(v)+L,J.push(m),(n=D(n)).d3plus={id:"bottom_whisker_line_"+d,offset:a.d3plus[C]/2,position:"height"===C?"bottom":"left",shape:"whisker",static:!0},"x"===Y&&(n.d3plus.offset*=-1),n.d3plus[C]=Math.abs(b(t)-b(l)),n.d3plus[K]=W,n.d3plus[B]=O,n.d3plus[Y]=E,J.push(n),(A=D(A)).d3plus={id:"top_whisker_line_"+d,offset:a.d3plus[C]/2,position:"height"===C?"top":"right",shape:"whisker",static:!0},"y"===Y&&(A.d3plus.offset*=-1),A.d3plus[C]=Math.abs(b(k)-b(w)),A.d3plus[K]=W,A.d3plus[B]=O,A.d3plus[Y]=E,J.push(A),c=0,h=x.length;c<h;c++)(o=x[c]).d3plus[B]=O,o.d3plus[Y]=b(Z(F,o,F.y.value)),o.d3plus[Y]+=L,o.d3plus.r=4,o.d3plus.shape=F.shape.value;return U=!x.length&&k-t==0,P.push(v),J=J.concat(x),e}).entries(F.data.viz),U&&1===te(P).length?[]:J)}).modes=["tukey","extent",Array,Number],n.requirements=["data","x","y"],n.shapes=["circle","check","cross","diamond","square","triangle","triangle_up","triangle_down"],n.setup=function(e){var t;if(!e.axes.discrete)return t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"})},t.exports=n},{"../../core/fetch/value.coffee":67,"../../string/format.js":173,"../../string/strip.js":175,"../../util/uniques.coffee":210,"./helpers/graph/draw.coffee":314}],310:[function(e,t,r){var q,n,N,P,I,D,V;q=e("../../array/sort.coffee"),I=e("../../core/fetch/value.coffee"),N=e("../../core/fetch/color.coffee"),P=e("../../core/fetch/text.js"),V=e("../../color/legible.coffee"),D=e("../../core/data/group.coffee"),(n=function(t){var e,r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C;if(u=D(t,t.data.viz),(i=(u=q(u,null,null,null,t)).length)<4?(n=i,w=1):(_=t.width.viz/t.height.viz,n=Math.ceil(Math.sqrt(i*_)),w=Math.ceil(Math.sqrt(i/_))),0<i)for(;i<=(w-1)*n;)w--;for(r=t.width.viz/n,e=t.height.viz/w,t.size.value?(E=t.size.scale.domain.min.value,O=t.size.scale.domain.max.value,s=["number"==typeof E?E:d3.min(t.data.viz,function(e){return I(t,e,t.size.value,t.id.value,"min")}),"number"==typeof O?O:d3.max(t.data.viz,function(e){return I(t,e,t.size.value,t.id.value)})]):s=[0,0],5,z=d3.min([r,e])/2-10,z-=h=t.labels.value&&!t.small&&40<=z?d3.max([20,d3.min([.25*z,50])]):0,A=d3.min([z,t.size.scale.range.min.value]),k=t.size.scale.value.domain(s).rangeRound([A,z]),x=d3.layout.pack().children(function(e){return e.values}).padding(5).radius(function(e){return k(e)}).size([r-10,e-10-h]).value(function(e){return e.value}),o=[],c=d=b=0,v=u.length;d<v;c=++d){for(a=u[c],M=x.nodes(a),S=r*c%t.width.viz,C=e*b,f=0,g=M.length;f<g;f++)(j=M[f]).children?(y={d3plus:{}})[t.id.value]=j.key:y=j.d3plus,y.d3plus.depth=t.id.grouping.value?j.depth:t.depth.value,y.d3plus.x=j.x,y.d3plus.xOffset=S,y.d3plus.y=j.y,y.d3plus.yOffset=C+h,y.d3plus.r=j.r,o.push(y);(c+1)%n==0&&b++}for(l=z/d3.max(o,function(e){return e.d3plus.r}),F=x.size()[0]/2,B=x.size()[1]/2,p=0,m=o.length;p<m;p++)(a=o[p]).d3plus.x=(a.d3plus.x-F)*l+F+a.d3plus.xOffset,a.d3plus.y=(a.d3plus.y-B)*l+B+a.d3plus.yOffset,a.d3plus.r=a.d3plus.r*l,delete a.d3plus.xOffset,delete a.d3plus.yOffset,a.d3plus.static=a.d3plus.depth<t.depth.value&&t.id.grouping.value,!h||0!==a.d3plus.depth&&!1!==t.id.grouping.value?delete a.d3plus.label:(a.d3plus.text=P(t,a[t.id.value],a.d3plus.depth),T=h>3*t.labels.padding?t.labels.padding:0,a.d3plus.label={x:0,y:-(z+T+h/2),w:2*z,h:h-T,padding:0,resize:!0,color:V(N(t,a,a.d3plus.depth)),force:!0});return o.sort(function(e,t){return e.d3plus.depth-t.d3plus.depth})}).fill=!0,n.requirements=["data"],n.scale=1.05,n.shapes=["circle","donut"],t.exports=n},{"../../array/sort.coffee":34,"../../color/legible.coffee":44,"../../core/data/group.coffee":57,"../../core/fetch/color.coffee":63,"../../core/fetch/text.js":66,"../../core/fetch/value.coffee":67}],311:[function(e,t,r){var n,a;a=e("../../../core/console/print.coffee"),(n=function(e){var t;t={circle:"scatter",donut:"scatter",line:"line",square:"scatter",area:"stacked"}[e.shape.value],a.warning('The "chart" visualization type has been deprecated and will be removed in version 2.0. Please use the "'+t+'" visualization type.'),e.self.type(t).draw()}).shapes=["circle","donut","line","square","area"],t.exports=n},{"../../../core/console/print.coffee":52}],312:[function(e,t,r){var n;(n=function(t){var e,r,n,a,o;return e=t.coords.value,n=t.coords.key||d3.keys(e.objects)[0],r=topojson.feature(e,e.objects[n]).features,o=t.coords.solo.value,a=t.coords.mute.value,r=r.filter(function(e){return e[t.id.value]=e.id,o.length?0<=o.indexOf(e.id):!a.length||a.indexOf(e.id)<0})}).libs=["topojson"],n.nesting=!1,n.requirements=["coords"],n.scale=1,n.shapes=["coordinates"],n.zoom=!0,t.exports=n},{}],313:[function(e,t,r){var p,h,v;p=e("../../../../core/fetch/color.coffee"),h=e("../../../../color/legible.coffee"),v=e("../../../../core/console/print.coffee"),t.exports=function(r){var n,e,t,a,o,i,s,l,u,c,d,f;for(n=r.axes,s=r.axes.margin.viz,f=2*(a=n.stacked||!n.ticks.value?[]:r.data.viz).length>r.data.large?0:r.draw.timing,u=function(e,t){return 0===t.indexOf("y")?e.attr("x1",-2).attr("x2",-8).attr("y1",function(e){return e.d3plus.y-s.top}).attr("y2",function(e){return e.d3plus.y-s.top}):e.attr("x1",function(e){return e.d3plus.x-s.left}).attr("x2",function(e){return e.d3plus.x-s.left}).attr("y1",n.height+2).attr("y2",n.height+8),e.style("stroke",function(e){return h(p(r,e))}).style("stroke-width",r.data.stroke.width).attr("shape-rendering",r.shape.rendering.value)},r.dev.value&&v.time("creating axis tick groups"),(d=r.group.select("g#d3plus_graph_plane").selectAll("g.d3plus_data_tick").data(a,function(e){var t;return t=n.discrete?"_"+e.d3plus[n.discrete]:"","tick_"+e[r.id.value]+"_"+e.d3plus.depth+t})).enter().append("g").attr("class","d3plus_data_tick").attr("opacity",0),r.dev.value&&v.timeEnd("creating axis tick groups"),o=0,i=(l=["x","y"]).length;o<i;o++)e=l[o],r.dev.value&&f&&v.time("creating "+e+" ticks"),t=f&&e!==n.discrete?a:[],c=d.selectAll("line.d3plus_data_"+e).data(t,function(e){return"tick_"+e[r.id.value]+"_"+e.d3plus.depth}),r.dev.value&&f&&v.timeEnd("creating "+e+" ticks"),r.dev.value&&f&&v.time("styling "+e+" ticks"),0<f?c.transition().duration(f).call(u,e):c.call(u,e),c.enter().append("line").attr("class","d3plus_data_"+e).call(u,e),r.dev.value&&f&&v.timeEnd("styling "+e+" ticks");0<f?(d.transition().duration(f).attr("opacity",1),d.exit().transition().duration(f).attr("opacity",0).remove()):(d.attr("opacity",1),d.exit().remove())}},{"../../../../color/legible.coffee":44,"../../../../core/console/print.coffee":52,"../../../../core/fetch/color.coffee":63}],314:[function(e,t,r){var n,a,o,i;n=e("./includes/axes.coffee"),a=e("./includes/svg.coffee"),o=e("./includes/mouse.coffee"),i=e("./includes/plot.coffee"),t.exports=function(e,t){void 0===t&&(t={}),n(e,t),i(e,t),a(e,t),e.mouse.viz=!0===t.mouse&&o}},{"./includes/axes.coffee":315,"./includes/mouse.coffee":317,"./includes/plot.coffee":318,"./includes/svg.coffee":319}],315:[function(e,t,r){var T,h,l,v,g,i,B,m,y,x,b,C;T=e("../../../../../array/sort.coffee"),v=e("./buffer.coffee"),l=e("../../../../../util/buckets.coffee"),i=e("../../../../../core/fetch/data.js"),B=e("../../../../../core/fetch/value.coffee"),x=e("../../../../../core/console/print.coffee"),C=e("../../../../../util/uniques.coffee"),t.exports=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p;for(!(a=g(e))&&e.axes.dataset||(e.axes.dataset=m(e)),e.axes.scale=!(!t.buffer||!0===t.buffer)&&b(e,t.buffer),i=0,l=(r=e.width.viz>e.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"]).length;i<l;i++)c=0===(n=r[i]).indexOf("x")?"y":"x",f=e.order.changed||e.order.sort.changed||!0===e.order.value&&e[c].changed,e[n].value&&(!e[n].ticks.values||a||f||e[n].value===e.time.value&&e.time.fixed.value)&&(e.dev.value&&x.time("calculating "+n+" axis"),e[n].reset=!0,e[n].ticks.values=!1,n===e.axes.discrete&&e[n].value!==e.time.value&&(e[n].ticks.values=C(e.axes.dataset,e[n].value,B,e)),p=!0===t.zero||0===n.indexOf(t.zero),d=h(e,n,p),0===n.indexOf("y")&&(d=d.reverse()),e[n].scale.viz=y(e,n,d),e[n].domain.viz=d,e.dev.value&&x.timeEnd("calculating "+n+" axis"));if(e.axes.mirror.value&&(o=d3.extent(e.y.domain.viz.concat(e.x.domain.viz)),e.x.domain.viz=o,e.x.scale.viz.domain(o),o=o.slice().reverse(),e.y.domain.viz=o,e.y.scale.viz.domain(o)),t.buffer)for(s=0,u=r.length;s<u;s++)(n=r[s])!==e.axes.discrete&&v(e,n,t.buffer)},g=function(e){var t,r,n,a,o,i,s,l,u,c,d,f;if((r=!e.time.fixed.value&&(e.time.solo.changed||e.time.mute.changed))||(r=e.id.solo.changed||e.id.mute.changed),r)return r;for(a=0,s=(n=["data","time","id","depth","type","width","height","x","y","x2","y2"]).length;a<s;a++)if(e[n[a]].changed){r=!0;break}if(r)return r;for(f=["mute","range","scale","solo","stacked","zerofill"],o=0,l=(c=["x","y","x2","y2"]).length;o<l;o++)for(t=c[o],i=0,u=f.length;i<u;i++)if(d=f[i],e[t][d].changed){r=!0;break}return r},m=function(n){var a,o;return n.time.fixed.value?(o=d3.range(0,n.id.nesting.length),d3.merge(d3.merge([function(){var e,t,r;for(r=[],e=0,t=o.length;e<t;e++)a=o[e],r.push(i(n,"all",a));return r}()]))):n.data.viz},h=function(r,n,e,t){var a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S;if(w=0===n.indexOf("x")?"y":"x",r[n].range.value&&2===r[n].range.value.length)return r[n].range.value.slice();if("share"===r[n].scale.value)return r[n].ticks.values=d3.range(0,1.1,.1),[0,1];if(r[n].stacked.value){for(O=[],d=0,v=(_=r.axes.dataset).length;d<v;d++)(c=_[d]).values?O=O.concat(c.values):O.push(c);return l=d3.nest().key(function(e){return B(r,e,r[w].value)}).rollup(function(e){var t;return t=d3.sum(e,function(e){var t;return 0<(t=B(r,e,r[n].value))?t:0}),[d3.sum(e,function(e){var t;return(t=B(r,e,r[n].value))<0?t:0}),t]}).entries(O),S=d3.merge(l.map(function(e){return e.values})),d3.extent(S)}if(r[n].value===r.time.value)return r.time.solo.value.length?d3.extent(r.time.solo.value).map(function(e){return e.constructor!==Date?(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e)):e}):d3.extent(r.data.time.ticks);for(S=[],f=0,g=(k=r.axes.dataset).length;f<g;f++)c=k[f],(F=B(r,c,r[n].value))instanceof Array?S=S.concat(F):S.push(F);if(S=S.filter(function(e){return null!==e}),n===r.axes.discrete){if(M=!0===r.order.value?r[w].value:r.order.value){for(j=r.order.sort.value,o=typeof(a=r.order.agg.value||r.aggs.value[M]||"max"),u=S.reduce(function(e,t){return e[t]=[],e},{}),h=0,m=(z=r.axes.dataset).length;h<m;h++)if((c=z[h]).values)for(x=0,y=(A=c.values).length;x<y;x++)E=A[x],u[B(r,E,r[n].value)].push(B(r,E,M));else u[B(r,c,r[n].value)].push(B(r,c,M));for(p in u)E=u[p],"string"===o?u[p]=d3[a](E):"function"===o&&(u[p]=a(E,M));return u=(u=T(d3.entries(u),"value",j)).reduce(function(e,t){return e.push(t.key),e},[])}return S[0].constructor===String?C(S).sort(function(e,t){return""+e.localeCompare(""+t)}):C(S).sort(function(e,t){return e-t})}return S.sort(function(e,t){return e-t}),"log"===r[n].scale.value&&(0===S[0]&&(S[0]=1),0===S[S.length-1]&&(S[S.length-1]=-1)),e&&(s=S.every(function(e){return 0<e}),i=S.every(function(e){return e<0}),(s||i)&&(b=s?1:-1,S.push("log"===r[n].scale.value?b:0))),d3.extent(S)},y=function(e,t,r){var n,a,o,i,s;return a=0===t.indexOf("x")?e.width.viz:e.height.viz,i=e[t].scale.value,0<=["discrete","share"].indexOf(i)&&(i="linear"),s=10,"string"==typeof r[0]?(i="ordinal",n=l([0,a],r.length)):(n=[0,a],"linear"===e[t].scale.value&&(s=Math.floor(a/(4*e[t].ticks.font.size)))),e[t].scale.ticks=s,"clamp"in(o=d3.scale[i]().domain(r).range(n))&&o.clamp(!0),o},b=function(t,r){var e,n,a;return!0===r&&(r="size"),r in t&&(r=t[r].value),"function"==typeof(a=t.size.scale.range.min.value)&&(a=a(t)),"function"==typeof(n=t.size.scale.range.max.value)&&(n=n(t)),!1===r?t.size.scale.value.domain([0,1]).rangeRound([n,n]):"number"==typeof r?t.size.scale.value.domain([0,1]).rangeRound([r,r]):r?(t.dev.value&&x.time("calculating buffer scale"),(e=d3.extent(t.axes.dataset,function(e){return B(t,e,r)||0}))[0]===e[1]&&(a=n),t.dev.value&&x.timeEnd("calculating buffer scale"),t.size.scale.value.domain(e).rangeRound([a,n])):void 0}},{"../../../../../array/sort.coffee":34,"../../../../../core/console/print.coffee":52,"../../../../../core/fetch/data.js":64,"../../../../../core/fetch/value.coffee":67,"../../../../../util/buckets.coffee":204,"../../../../../util/uniques.coffee":210,"./buffer.coffee":316}],316:[function(e,t,r){var B,C;B=e("../../../../../util/buckets.coffee"),C=e("../../../../../util/closest.coffee"),t.exports=function(e,t,r){var n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T;if("share"!==e[t].scale.value&&!e[t].range.value&&e[t].reset){if("clamp"in(j=e[t].scale.viz.copy())&&j.clamp(!1),t===e.axes.discrete){if("string"==typeof(d=j.domain())[0]){for(v=d.length;0<=v;)d.splice(v,0,"d3plus_buffer_"+v),v--;return _=j.range(),_=B(d3.extent(_),d.length),e[t].scale.viz.domain(d).range(_)}if(0===t.indexOf("y")&&(d=d.slice().reverse()),1===e[t].ticks.values.length)d=[d[0],d[0]],e[t].value===e.time.value&&1!==e.data.time.ticks.length?(s=C(e.data.time.ticks,d[0]),0<(M=e.data.time.ticks.indexOf(s))?d[0]=e.data.time.ticks[M-1]:(c=e.data.time.ticks[M+1]-s,d[0]=new Date(s.getTime()-c)),M<e.data.time.ticks.length-1?d[1]=e.data.time.ticks[M+1]:(c=s-e.data.time.ticks[M-1],d[1]=new Date(s.getTime()+c))):(d[0]-=1,d[1]+=1);else if(e.axes.scale)a=Math.abs(d[1]-d[0])/(e[t].ticks.values.length-1),a/=2,k=j.range()[1],b=1.5*e.axes.scale.range()[1],h=j.invert(-b),p=j.invert(k+b),d[0]-a<h?(d[0]=d[0]-a,d[d.length-1]=d[d.length-1]+a):(d=[h,p],0===t.indexOf("y")&&(d=d.reverse()),(f=(f=j.domain())[1]-f[0])||(d[0]-=1,d[1]+=1));else if(e[t].value===e.time.value)a=Math.abs(d[1]-d[0])/(e[t].ticks.values.length-1),a/=2,d[0]=d[0]-a,d[1]=d[1]+a;else{for(n=Math.abs(d[1]-d[0])/2,v=d.length,w=d.slice();0<=v;)u=v?w[v-1]+n:w[v]-n,d.splice(v,0,u),v--;_=j.range(),_=B(d3.extent(_),d.length),e[t].scale.viz.domain(d).range(_)}return 0===t.indexOf("y")&&(d=d.reverse()),e[t].scale.viz.domain(d)}if("x"===r&&0===t.indexOf("x")||"y"===r&&0===t.indexOf("y")||!0===r)return i=0<=(d=j.domain())[0]&&0<=d[1],o=d[0]<=0&&d[1]<=0,"log"===e[t].scale.value?(T=i?1:-1,i&&0===t.indexOf("y")&&(d=d.slice().reverse()),y=Math.pow(10,parseInt(Math.abs(d[0])).toString().length-1)*T,(g=m=d[0]%y)&&g/y<=.1&&(g+=y*T),x=0===m?y:g,d[0]-=x,0===d[0]&&(d[0]=T),F=Math.pow(10,parseInt(Math.abs(d[1])).toString().length-1)*T,E=d[1]%F,O=Math.abs(F-E),E&&O/F<=.1&&(O+=F*T),S=0===E?F:O,d[1]+=S,0===d[1]&&(d[1]=T),i&&0===t.indexOf("y")&&(d=d.reverse())):((T=0)===t.indexOf("y")&&(d=d.slice().reverse()),A=d.filter(function(e){return e.constructor===String}),a=.05*Math.abs(d[1]-d[0])||1,A.length||(d[0]=d[0]-a,d[1]=d[1]+a,(i&&d[0]<T||o&&d[0]>T)&&(d[0]=T),(i&&d[1]<T||o&&d[1]>T)&&(d[1]=T)),0===t.indexOf("y")&&(d=d.reverse())),e[t].scale.viz.domain(d);if(e.axes.scale)return l=!1,e.axes.mirror.value&&(l=e[0===t.indexOf("y")?"x":"y"].scale.viz,z=e.width.viz>e.height.viz?"x":"y"),t===z&&l?d=l.domain().slice().reverse():(k=j.range()[1],b=e.axes.scale.range()[1],d=[h=j.invert(1.5*-b),p=j.invert(k+1.5*b)],0===t.indexOf("y")&&(d=d.reverse()),(f=(f=j.domain())[1]-f[0])||(d[0]-=1,d[1]+=1),0===t.indexOf("y")&&(d=d.reverse())),e[t].scale.viz.domain(d)}}},{"../../../../../util/buckets.coffee":204,"../../../../../util/closest.coffee":206}],317:[function(e,t,r){var w,_,k,z,A;e("../../../../../util/copy.coffee"),w=e("../../../../../client/pointer.coffee"),_=e("../../../../../core/fetch/color.coffee"),k=e("../../../../../core/fetch/value.coffee"),z=e("../../../../../color/legible.coffee"),A=e("../../../../../color/text.coffee"),t.exports=function(n,a){var e,t,r,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b;return e=d3.event.type===w.click&&(a.tooltip.value.long||a.tooltip.html.value),r=0<=[w.over,w.move].indexOf(d3.event.type),x=n.d3plus.x,b=n.d3plus.y,f=n.d3plus.r||0,v=a.types[a.type.value].scale||1,f*=v,o=a.axes,d=a.axes.margin.viz,y=a.draw.timing?a.timing.mouseevents:0,!e&&r?(t=z(_(a,n)),i=["x","y","x2","y2"].filter(function(e){var t;return(t=k(a,n,a[e].value))&&!(t instanceof Array)&&e!==a.axes.stacked&&a[e].mouse.value})):i=[],s=function(e){return e.attr("x1",function(e){return 0===e.indexOf("x")?x:x-f}).attr("y1",function(e){return 0===e.indexOf("y")?b:b+f}).attr("x2",function(e){return 0===e.indexOf("x")?x:x-f}).attr("y2",function(e){return 0===e.indexOf("y")?b:b+f}).attr("opacity",0)},l=function(e){return e.style("stroke",function(e){return"area"===a.shape.value?"white":t}).attr("stroke-dasharray",function(e){return a[e].mouse.dasharray.value}).attr("shape-rendering",function(e){return a[e].mouse.rendering.value}).style("stroke-width",function(e){return a[e].mouse.width})},u=function(e){return e.attr("x1",function(e){return 0===e.indexOf("x")?x:x-f}).attr("y1",function(e){return 0===e.indexOf("y")?b:b+f}).attr("x2",function(e){return 0===e.indexOf("x")?x:n.d3plus.x0?n.d3plus.x0:"y"===e?d.left-a[e].ticks.size:d.left+o.width+a[e].ticks.size}).attr("y2",function(e){return 0===e.indexOf("y")?b:n.d3plus.y0?n.d3plus.y0:"x"===e?o.height+d.top+a[e].ticks.size:d.top-a[e].ticks.size}).style("opacity",1)},c=a.g.labels.selectAll("line.d3plus_mouse_axis_label").data(i),y?(c.enter().append("line").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(s).call(l),c.transition().duration(y).call(u).call(l),c.exit().transition().duration(y).call(s).remove()):(c.call(u).call(l),c.enter().append("line").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(s).call(l),c.exit().remove()),g=function(e){return e.attr("font-size",function(e){return a[e].ticks.font.size+"px"}).attr("font-family",function(e){return a[e].ticks.font.family.value}).attr("font-weight",function(e){return a[e].ticks.font.weight}).attr("x",function(e){return 0===e.indexOf("x")?x:"y"===e?d.left-5-a[e].ticks.size:d.left+o.width+5+a[e].ticks.size}).attr("y",function(e){return 0===e.indexOf("y")?b:n.d3plus.y0?n.d3plus.y+(n.d3plus.y0-n.d3plus.y)/2+d.top-6:"x"===e?o.height+d.top+5+a[e].ticks.size:d.top-5-a[e].ticks.size-1.35*a[e].ticks.font.size}).attr("fill","area"===a.shape.value?"white":A(t))},(m=a.g.labels.selectAll("text.d3plus_mouse_axis_label").data(i)).enter().append("text").attr("class","d3plus_mouse_axis_label").attr("id",function(e){return e+"_d3plusmouseaxislabel"}).attr("dy",function(e){return 0===e.indexOf("y")?.35*a[e].ticks.font.size:a[e].ticks.font.size}).style("text-anchor",function(e){return"y"===e?"end":"y2"===e?"start":"middle"}).attr("opacity",0).attr("pointer-events","none").call(g),m.text(function(e){var t,r;return t=a.axes.stacked||e,r=k(a,n,a[t].value),a.format.value(r,{key:a[t].value,vars:a,labels:a[t].affixes.value})}),y?(m.transition().duration(y).delay(y).attr("opacity",1).call(g),m.exit().transition().duration(y).attr("opacity",0).remove()):(m.attr("opacity",1).call(g),m.exit().remove()),p=function(e){var r;return r=function(e){var t;return(t=d3.select("text#"+e+"_d3plusmouseaxislabel")).size()?t.node().getBBox():{width:0,height:0}},e.attr("x",function(e){var t;return t=r(e).width,0===e.indexOf("x")?x-t/2-5:"y"===e?d.left-a[e].ticks.size-t-10:d.left+o.width+a[e].ticks.size}).attr("y",function(e){var t;return t=r(e).height,0===e.indexOf("y")?b-(t/2+5):n.d3plus.y0?n.d3plus.y+(n.d3plus.y0-n.d3plus.y)/2+d.top-(t/2+5):"x"===e?o.height+d.top+a[e].ticks.size:d.top-a[e].ticks.size-t-10}).attr("width",function(e){return r(e).width+10}).attr("height",function(e){return r(e).height+10}).style("stroke","area"===a.shape.value?"transparent":t).attr("fill",t).attr("shape-rendering",function(e){return a[e].mouse.rendering.value}).style("stroke-width",function(e){return a[e].mouse.width})},h=a.g.labels.selectAll("rect.d3plus_mouse_axis_label").data(i),y?(h.enter().insert("rect","text.d3plus_mouse_axis_label").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").attr("opacity",0).call(p),h.transition().duration(y).delay(y).attr("opacity",1).call(p),h.exit().transition().duration(y).attr("opacity",0).remove()):(h.attr("opacity",1).call(p),h.enter().insert("rect","text.d3plus_mouse_axis_label").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(p),h.exit().remove())}},{"../../../../../client/pointer.coffee":38,"../../../../../color/legible.coffee":44,"../../../../../color/text.coffee":50,"../../../../../core/fetch/color.coffee":63,"../../../../../core/fetch/value.coffee":67,"../../../../../util/copy.coffee":207}],318:[function(e,t,r){var S,_,k,z,T,B,A,C,j;S=e("../../../../../util/buckets.coffee"),_=e("./buffer.coffee"),z=e("../../../../../core/fetch/value.coffee"),T=e("../../../../../font/sizes.coffee"),C=e("../../../../../textwrap/textwrap.coffee"),j=e("../../../../../core/data/time.coffee"),e("../../../../../util/uniques.coffee"),t.exports=function(e,t){var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w;for(e.axes.margin.viz={top:e.axes.margin.top,right:e.axes.margin.right,bottom:e.axes.margin.bottom,left:e.axes.margin.left},e.axes.height=e.height.viz,e.axes.width=e.width.viz,i=0,u=(r=e.width.viz>e.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"]).length;i<u;i++)if(e[n=r[i]].value){if(!1===e[n].ticks.values)if(e[n].value===e.time.value){for(x=(x=e.time.solo.value).length?x.map(function(e){return e.constructor!==Date&&(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),e=new Date(e)),e}):e.data.time.values,o=d3.extent(x),g=e.data.time.stepType,x=[o[0]],y=o[0];y<o[1];)f=new Date(y),y=new Date(f["set"+g](f["get"+g]()+1)),x.push(y);e[n].ticks.values=x}else 1===n.indexOf("2")?(h=e[n.slice(0,1)].scale.viz,v=e[n].scale.viz,x=e[n.slice(0,1)].scale.ticks,e[n].ticks.values=h.ticks(x).map(function(e){return parseFloat(d3.format(".5f")(v.invert(h(e))))})):e[n].ticks.values=e[n].scale.viz.ticks(e[n].scale.ticks);e[n].ticks.values.length||((w=z(e,e.data.viz,e[n].value))instanceof Array||(w=[w]),e[n].ticks.values=w),p=0===n.indexOf("x")?"y":"x",(1===e[n].ticks.values.length||t.buffer&&t.buffer!==p&&n===e.axes.discrete&&!0===e[n].reset)&&_(e,n,t.buffer),e[n].reset=!1,e[n].value===e.time.value?(a={"font-family":e[n].ticks.font.family.value,"font-weight":e[n].ticks.font.weight,"font-size":e[n].ticks.font.size+"px","text-transform":e[n].ticks.font.transform.value,"letter-spacing":e[n].ticks.font.spacing+"px"},b=j(e,{values:e[n].ticks.values,limit:e.width.viz,style:a}),e[n].ticks.value?e[n].ticks.visible=e[n].ticks.value.map(Number):e[n].ticks.labels.value.constructor===Array?e[n].ticks.visible=e[n].ticks.labels.value.map(Number):e[n].ticks.visible=b.values.map(Number),e[n].ticks.format=b.format):e[n].ticks.value?(e[n].ticks.values=e[n].ticks.value,e[n].ticks.labels.value.constructor===Array?e[n].ticks.visible=e[n].ticks.labels.value:e[n].ticks.visible=e[n].ticks.value):e[n].ticks.labels.value.constructor===Array?e[n].ticks.visible=e[n].ticks.labels.value:"log"===e[n].scale.value?(m=(x=e[n].ticks.values).filter(function(e){return"1"===Math.abs(e).toString().charAt(0)})).length<3?e[n].ticks.visible=x:e[n].ticks.visible=m:e[n].ticks.visible=e[n].ticks.values,e[n].value===e.time.value&&(e[n].ticks.visible=e[n].ticks.visible.map(function(e){return e.constructor===Number&&4<(""+e).length?e:(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e).getTime())}))}if(e.small)for(e.axes.width-=e.axes.margin.viz.left+e.axes.margin.viz.right,e.axes.height-=e.axes.margin.viz.top+e.axes.margin.viz.bottom,s=0,c=r.length;s<c;s++)e[n=r[s]].label.height=0;else e.small||A(e);for(l=0,d=r.length;l<d;l++)e[n=r[l]].axis.svg=k(e,n)},A=function(r){var n,e,t,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F;for(g=r.x.scale.viz.domain(),j=r.y.scale.viz.domain(),r.x2.value&&(f=r.x2.scale.viz.domain()),r.y2.value&&(k=r.y2.scale.viz.domain()),e=0,o=(l=["y","y2"]).length;e<o;e++)r[n=l[e]].value&&(s="y"===n?"left":"right",z={"font-size":r[n].ticks.font.size+"px","font-family":r[n].ticks.font.family.value,"font-weight":r[n].ticks.font.weight,"text-transform":r[n].ticks.font.transform.value,"letter-spacing":r[n].ticks.font.spacing+"px"},F=r[n].ticks.visible,"log"===r[n].scale.value?E=F.map(function(e){return B(e)}):"share"===r[n].scale.value?E=F.map(function(e){return r.format.value(100*e,{key:"share",vars:r,output:n})}):r[n].value===r.time.value?E=F.map(function(e,t){return r[n].ticks.format(new Date(e))}):("string"==typeof F[0]&&(F=r[n].scale.viz.domain().filter(function(e){return 0!==e.indexOf("d3plus_buffer_")})),E=F.map(function(e){return r.format.value(e,{key:r[n].value,vars:r,labels:r[n].affixes.value,output:n})})),r[n].ticks.labels.value?(r[n].ticks.hidden=!1,(A=d3.max(T(E,z),function(e){return e.width}))&&(A=Math.ceil(A+r.labels.padding),r.axes.margin.viz[s]+=A)):r[n].ticks.hidden=!0,(M=r[n].label.fetch(r))?(O={"font-family":r[n].label.font.family.value,"font-weight":r[n].label.font.weight,"font-size":r[n].label.font.size+"px","text-transform":r[n].label.font.transform.value,"letter-spacing":r[n].label.font.spacing+"px"},r[n].label.height=T([M],O)[0].height):r[n].label.height=0,r[n].label.value&&(r.axes.margin.viz[s]+=r[n].label.height,r.axes.margin.viz[s]+=2*r[n].label.padding));for(r.axes.width-=r.axes.margin.viz.left+r.axes.margin.viz.right,r.x.scale.viz.range(S([0,r.axes.width],g.length)),f&&r.x2.scale.viz.range(S([0,r.axes.width],f.length)),t=0,i=(u=["x","x2"]).length;t<i;t++)r[n=u[t]].value&&(s="x"===n?"bottom":"top",r[n].ticks.labels.value?(r[n].ticks.hidden=!1,p={"font-size":r[n].ticks.font.size+"px","font-family":r[n].ticks.font.family.value,"font-weight":r[n].ticks.font.weight,"text-transform":r[n].ticks.font.transform.value,"letter-spacing":r[n].ticks.font.spacing+"px"},_=r[n].ticks.visible,"log"===r[n].scale.value?w=_.map(function(e){return B(e)}):"share"===r[n].scale.value?w=_.map(function(e){return r.format.value(100*e,{key:"share",vars:r,output:n})}):r[n].value===r.time.value?w=_.map(function(e,t){return r[n].ticks.format(new Date(e))}):("string"==typeof _[0]&&(_=r[n].scale.viz.domain().filter(function(e){return 0!==e.indexOf("d3plus_buffer_")})),w=_.map(function(e){return r.format.value(e,{key:r[n].value,vars:r,labels:r[n].affixes.value,output:n})})),b=T(w,p),v=d3.max(b,function(e){return e.width}),h=d3.max(b,function(e){return e.height}),1===_.length?x=r.axes.width:(x=r[n].scale.viz(_[1])-r[n].scale.viz(_[0]),x=Math.abs(x)),x<v&&0<w.join("").indexOf(" ")?(r[n].ticks.wrap=!0,b=T(w,p,{mod:function(e){return C().container(d3.select(e)).height(r.axes.height/2).width(x).draw()}}),v=d3.max(b,function(e){return e.width}),h=d3.max(b,function(e){return e.height})):r[n].ticks.wrap=!1,r[n].ticks.baseline="auto",v<=x?r[n].ticks.rotate=0:v<r.axes.height/2?(b=T(w,p,{mod:function(e){return C().container(d3.select(e)).width(r.axes.height/2).height(x).draw()}}),h=d3.max(b,function(e){return e.width}),v=d3.max(b,function(e){return e.height}),r[n].ticks.rotate=-90):h=v=0,v&&h||(r[n].ticks.hidden=!0,r[n].ticks.rotate=0),v=Math.ceil(v),h=Math.ceil(h),r[n].ticks.maxHeight=h,r[n].ticks.maxWidth=v,h&&(r.axes.margin.viz[s]+=h+r.labels.padding),a=r[n].ticks.visible[r[n].ticks.visible.length-1],c=r[n].scale.viz(a),(c+=v/2+r.axes.margin.viz.left)>r.width.value&&(d=c-r.width.value+r.axes.margin.viz.right,r.axes.width-=d,r.axes.margin.viz.right+=d)):r[n].ticks.hidden=!0,(m=r[n].label.fetch(r))?(y={"font-family":r[n].label.font.family.value,"font-weight":r[n].label.font.weight,"font-size":r[n].label.font.size+"px","text-transform":r[n].label.font.transform.value,"letter-spacing":r[n].label.font.spacing+"px"},r[n].label.height=T([m],y)[0].height):r[n].label.height=0,r[n].label.value&&(r.axes.margin.viz[s]+=r[n].label.height,r.axes.margin.viz[s]+=2*r[n].label.padding));if(r.axes.height-=r.axes.margin.viz.top+r.axes.margin.viz.bottom,r.x.scale.viz.range(S([0,r.axes.width],g.length)),f&&r.x2.scale.viz.range(S([0,r.axes.width],f.length)),r.y.scale.viz.range(S([0,r.axes.height],j.length)),k)return r.y2.scale.viz.range(S([0,r.axes.height],k.length))},k=function(a,o){return d3.svg.axis().tickSize(a[o].ticks.size).tickPadding(5).orient(a[o].orient.value).scale(a[o].scale.viz).tickValues(a[o].ticks.values).tickFormat(function(e,t){var r,n;return a[o].ticks.hidden?null:(n=a[o].scale.value,r=e.constructor===Date?+e:e,0<=a[o].ticks.visible.indexOf(r)?"share"===n?a.format.value(100*e,{key:"share",vars:a,labels:a[o].affixes.value,output:o}):e.constructor===Date?a[o].ticks.format(e):"log"===n?B(e):a.format.value(e,{key:a[o].value,vars:a,labels:a[o].affixes.value,output:o}):null)})},B=function(e){var t,r,n;return r=Math.round(Math.log(Math.abs(e))/Math.LN10),n=Math.abs(e).toString().charAt(0),t="10 "+(r+"").split("").map(function(e){return"⁰¹²³⁴⁵⁶⁷⁸⁹"[e]}).join(""),"1"!==n&&(t=n+" x "+t),e<0?"-"+t:t}},{"../../../../../core/data/time.coffee":62,"../../../../../core/fetch/value.coffee":67,"../../../../../font/sizes.coffee":102,"../../../../../textwrap/textwrap.coffee":200,"../../../../../util/buckets.coffee":204,"../../../../../util/uniques.coffee":210,"./buffer.coffee":316}],319:[function(e,t,r){var ie,se,le;ie=e("../../../../../color/mix.coffee"),se=e("../../../../../textwrap/textwrap.coffee"),le=e("../../../../../object/validate.coffee"),t.exports=function(i){var e,n,r,t,a,o,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P,I,D,V,R,U,L,Y,H,X,G,J,W,Q,K,Z,$,ee,te,re,ne,ae,oe;if(0<=i.x.domain.viz.concat(i.y.domain.viz).indexOf(void 0))return null;for(l={width:i.axes.width,height:i.axes.height,fill:i.axes.background.color,stroke:i.axes.background.stroke.color,"stroke-width":i.axes.background.stroke.width,"shape-rendering":i.axes.background.rendering.value},n={left:"start",center:"middle",right:"end"},t=i.small?[]:[0],te=function(e,t){return e.attr("x1",function(e){return 0===t.indexOf("x")?i.x.scale.viz(e):0}).attr("x2",function(e){return 0===t.indexOf("x")?i.x.scale.viz(e):i.axes.width}).attr("y1",function(e){return 0===t.indexOf("y")?i.y.scale.viz(e):0}).attr("y2",function(e){return 0===t.indexOf("y")?i.y.scale.viz(e):i.axes.height})},re=function(e,t,r){var n,a,o;return n=r?i[t].grid.color:i[t].ticks.color,a="log"===i[t].scale.value,o=i[t].ticks.visible||[],e.attr("stroke",function(e){return 0===e?i[t].axis.color:(e.constructor===Date&&(e=+e),!(0<=o.indexOf(e))||a&&"1"!==Math.abs(e).toString().charAt(0)?r&&"transparent"!==i.axes.background.color?ie(n,i.axes.background.color,.4,1):"transparent"!==i.background.value?ie(n,i.background.value,.4,1):ie(n,"white",.4,1):n)}).attr("stroke-width",i[t].ticks.width).attr("shape-rendering",i[t].ticks.rendering.value)},d=function(e,t,r){var n;return n=0===t?"axis":"ticks",(t=i[e][n].font[r])&&(t.length||"number"==typeof t)?t:i[e].ticks.font[r]},ee=function(e,r){var n;return n="log"===i[r].scale.value,e.attr("font-size",function(e){return d(r,e,"size")+"px"}).attr("stroke","none").attr("fill",function(e){var t;return t=d(r,e,"color"),n&&"1"!==Math.abs(e).toString().charAt(0)?ie(t,i.background.value,.4,1):t}).attr("font-family",function(e){return d(r,e,"family").value}).attr("font-weight",function(e){return d(r,e,"weight")}).style("text-transform",function(e){return d(r,e,"transform").value}).style("letter-spacing",function(e){return d(r,e,"spacing")+"px"})},S=function(e,t){var r,n;return r=0===t.indexOf("x")?"height":"width",n=0===t.indexOf("x")?"y":"x",e.attr(n+"1",0).attr(n+"2",i.axes[r]).attr(t+"1",function(e){return e.coords.line}).attr(t+"2",function(e){return e.coords.line}).attr("stroke",function(e){return e.color||i[t].lines.color}).attr("stroke-width",i[t].lines.width).attr("shape-rendering",i[t].lines.rendering.value).attr("stroke-dasharray",i[t].lines.dasharray.value)},O=function(e,t){var r;return r=0===t.indexOf("x")?"y":"x",e.attr(r,function(e){return e.coords.text[r]+"px"}).attr(t,function(e){return e.coords.text[t]+"px"}).attr("dy",i[t].lines.font.position.value).attr("text-anchor",n[i[t].lines.font.align.value]).attr("transform",function(e){return e.transform}).attr("font-size",i[t].lines.font.size+"px").attr("fill",function(e){return e.color||i[t].lines.color}).attr("font-family",i[t].lines.font.family.value).attr("font-weight",i[t].lines.font.weight)},D="translate("+i.axes.margin.viz.left+","+i.axes.margin.viz.top+")",(I=i.group.selectAll("g#d3plus_graph_plane").data([0])).transition().duration(i.draw.timing).attr("transform",D),I.enter().append("g").attr("id","d3plus_graph_plane").attr("transform",D),(s=I.selectAll("rect#d3plus_graph_background").data([0])).transition().duration(i.draw.timing).attr(l),s.enter().append("rect").attr("id","d3plus_graph_background").attr("x",0).attr("y",0).attr(l),(q=I.selectAll("path#d3plus_graph_mirror").data([0])).enter().append("path").attr("id","d3plus_graph_mirror").attr("fill","#000").attr("fill-opacity",.03).attr("stroke-width",1).attr("stroke","#ccc").attr("stroke-dasharray","10,10").attr("opacity",0),q.transition().duration(i.draw.timing).attr("opacity",function(){return i.axes.mirror.value?1:0}).attr("d",function(){var e,t;return"M "+(t=l.width)+" "+(e=l.height)+" L 0 "+e+" L "+t+" 0 Z"}),J=0!==i.x.ticks.rotate,ae=function(e,r){var t,n;return n="x"===r?i.axes.height:0,(t=e.attr("transform","translate(0,"+n+")").call(i[r].axis.svg.scale(i[r].scale.viz)).selectAll("g.tick")).selectAll("line").attr("y2",function(e){var t;return e.constructor===Date&&(e=+e),t=d3.select(this).attr("y2"),0<=i[r].ticks.visible.indexOf(e)?t:t/2}),t.select("text").style("text-anchor",J&&"x"===r?"end":J?"start":"middle").call(ee,r).each(function(e){if(d3.select(this).attr("dy","0px").attr("font-size",function(e){return d(r,e,"size")+"px"}),e.constructor===Date&&(e=+e),!i[r].ticks.hidden&&0<=i[r].ticks.visible.indexOf(e))return se().container(d3.select(this)).rotate(i[r].ticks.rotate).align(J?"end":"center").valign(J?"middle":"x"===r?"top":"bottom").width(i[r].ticks.maxWidth+2).height(i[r].ticks.maxHeight).padding(0).x(-i[r].ticks.maxWidth/2).y("x2"===r?-(i[r].ticks.maxHeight+2*i.labels.padding):0).draw()})},oe=function(e,t){var r,n;return n="y2"===t?i.axes.width:0,(r=e.attr("transform","translate("+n+", 0)").call(i[t].axis.svg.scale(i[t].scale.viz)).selectAll("g.tick")).selectAll("line").attr("y2",function(e){var t;return e.constructor===Date&&(e=+e),t=d3.select(this).attr("y2"),0<=i.x.ticks.visible.indexOf(e)?t:t/2}),r.select("text").call(ee,t)},v=0,w=(Y=["x","x2","y","y2"]).length;v<w;v++)Q=0===(r=Y[v]).indexOf("x")?ae:oe,R=t.length&&i[r].value?[0]:[],(a=I.selectAll("g#d3plus_graph_"+r+"ticks").data(R)).transition().duration(i.draw.timing).call(Q,r),a.selectAll("line").transition().duration(i.draw.timing).call(re,r),(h=a.enter().append("g").attr("id","d3plus_graph_"+r+"ticks").call(Q,r)).selectAll("path").attr("fill","none").attr("stroke","none"),h.selectAll("line").call(re,r),a.exit().transition().duration(i.data.timing).attr("opacity",0).remove();for(b=function(e,t){return e.attr("x",0===t.indexOf("x")?i.width.viz/2:-(i.axes.height/2+i.axes.margin.viz.top)).attr("y","x"===t?i.height.viz-i[t].label.height/2-i[t].label.padding:"y2"===t?i.width.viz-i[t].label.height/2-i[t].label.padding:i[t].label.height/2+i[t].label.padding).attr("transform",0===t.indexOf("y")?"rotate(-90)":null).attr("font-family",i[t].label.font.family.value).attr("font-weight",i[t].label.font.weight).attr("font-size",i[t].label.font.size+"px").attr("fill",i[t].label.font.color).style("text-anchor","middle").attr("dominant-baseline","central").style("text-transform",i[t].label.font.transform.value).style("letter-spacing",i[t].label.font.spacing+"px")},g=0,_=(H=["x","y"]).length;g<_;g++)i[r=H[g]].grid.value?p=i[r].ticks.value?i[r].ticks.value:i[r].ticks.values:(p=[],P="x"===r?"y":"x",0<=i[r].ticks.values.indexOf(0)&&i[P].axis.value&&(p=[0])),i[r].value===i.time.value&&(p=p.map(function(e){return 4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),new Date(e).getTime()})),(f=I.selectAll("g#d3plus_graph_"+r+"grid").data([0])).enter().append("g").attr("id","d3plus_graph_"+r+"grid"),(T=f.selectAll("line").data(p,function(e,t){return e.constructor===Date?e.getTime():e})).transition().duration(i.draw.timing).call(te,r).call(re,r,!0),T.enter().append("line").style("opacity",0).call(te,r).call(re,r,!0).transition().duration(i.draw.timing).delay(i.draw.timing/2).style("opacity",1),T.exit().transition().duration(i.draw.timing/2).style("opacity",0).remove();for(m=0,k=(X=["x","x2","y","y2"]).length;m<k;m++)i[r=X[m]].value?(o=i[r].label.fetch(i),x=t&&o&&!i.small?[0]:[],e=i.format.affixes.value[i[r].value],o&&!i[r].affixes.value&&e&&(!0===(W=i[r].affixes.separator.value)?W=["[","]"]:!1===W&&(W=["",""]),o+=" "+W[0]+e[0]+" "+e[1]+W[1])):(o="",x=[]),(y=i.group.selectAll("text#d3plus_graph_"+r+"label").data(x)).text(o).transition().duration(i.draw.timing).call(b,r),y.enter().append("text").attr("stroke","none").attr("id","d3plus_graph_"+r+"label").text(o).call(b,r),y.exit().transition().duration(i.data.timing).attr("opacity",0).remove();for(C=0,z=(G=["x","y","x2","y2"]).length;C<z;C++)if(i[r=G[C]].value){for((E=I.selectAll("g#d3plus_graph_"+r+"_userlines").data([0])).enter().append("g").attr("id","d3plus_graph_"+r+"_userlines"),c=i[r].scale.viz.domain(),0===r.indexOf("y")&&(c=c.slice().reverse()),K=[],M=[],N=0,A=(ne=i[r].lines.value||[]).length;N<A;N++)j=ne[N],u=le(j)?j.position:j,(r===i.axes.discrete?0<=c.indexOf(u):u>=c[0]&&u<=c[1])&&((u=le(j)?j:{position:u}).coords={line:i[r].scale.viz(u.position)},M.push(u),u.text&&(u.axis=r,u.padding=.5*i[r].lines.font.padding.value,u.align=i[r].lines.font.align.value,Z="middle"===(V=i[r].lines.font.position.text)?0:2*u.padding,"top"===V&&(Z=-Z),0===r.indexOf("x")?($="left"===u.align?i.axes.height:"center"===u.align?i.axes.height/2:0,"left"===u.align&&($-=2*u.padding),"right"===u.align&&($+=2*u.padding)):($="left"===u.align?0:"center"===u.align?i.axes.width/2:i.axes.width,"right"===u.align&&($-=2*u.padding),"left"===u.align&&($+=2*u.padding)),u.coords.text={},u.coords.text[0===r.indexOf("x")?"y":"x"]=$,u.coords.text[r]=i[r].scale.viz(u.position)+Z,u.transform=0===r.indexOf("x")?"rotate(-90,"+u.coords.text.x+","+u.coords.text.y+")":null,K.push(u)));(T=E.selectAll("line.d3plus_graph_"+r+"line").data(M,function(e){return e.position})).enter().append("line").attr("class","d3plus_graph_"+r+"line").attr("opacity",0).call(S,r),T.transition().duration(i.draw.timing).attr("opacity",1).call(S,r),T.exit().transition().duration(i.draw.timing).attr("opacity",0).remove(),(B=E.selectAll("text.d3plus_graph_"+r+"line_text").data(K,function(e){return e.position})).enter().append("text").attr("class","d3plus_graph_"+r+"line_text").attr("id",function(e){var t;return t=(t=(t=e.position+"").replace("-","neg")).replace(".","p"),"d3plus_graph_"+r+"line_text_"+t}).attr("opacity",0).call(O,r),B.text(function(e){return e.text}).transition().duration(i.draw.timing).attr("opacity",1).call(O,r),B.exit().transition().duration(i.draw.timing).attr("opacity",0).remove(),L=function(e){var t;return t=function(e){var t;return t=(t=(t=e.position+"").replace("-","neg")).replace(".","p"),I.select("text#d3plus_graph_"+e.axis+"line_text_"+t).node().getBBox()},e.attr("x",function(e){return t(e).x-e.padding}).attr("y",function(e){return t(e).y-e.padding}).attr("transform",function(e){return e.transform}).attr("width",function(e){return t(e).width+2*e.padding}).attr("height",function(e){return t(e).height+2*e.padding}).attr("fill","transparent"!==i.axes.background.color?i.axes.background.color:"white")},U=i[r].lines.font.background.value?K:[],(F=E.selectAll("rect.d3plus_graph_"+r+"line_rect").data(U,function(e){return e.position})).enter().insert("rect","text.d3plus_graph_"+r+"line_text").attr("class","d3plus_graph_"+r+"line_rect").attr("pointer-events","none").attr("opacity",0).call(L),F.transition().delay(i.draw.timing).each("end",function(e){return d3.select(this).transition().duration(i.draw.timing).attr("opacity",1).call(L)}),F.exit().transition().duration(i.draw.timing).attr("opacity",0).remove()}}},{"../../../../../color/mix.coffee":46,"../../../../../object/validate.coffee":172,"../../../../../textwrap/textwrap.coffee":200}],320:[function(e,t,r){var y,s,x;y=e("../../../../core/fetch/value.coffee"),s=e("../../../../string/strip.js"),x=e("../../../../util/uniques.coffee"),t.exports=function(f,e,i){var p,t,h,v,r,g,m;return void 0===i?i=f.id.nesting.slice(0,f.depth.value+1):i.constructor!==Array&&(i=[i]),void 0===t&&(t=[]),e||(e=f.data.viz),p=f[f.axes.discrete],v=f[f.axes.opposite],(m=p.value===f.time.value)?(g=f.data.time.ticks,h=f.time.solo.value.length?"solo":"mute",f.time[h].value.length&&(r=f.time[h].value.slice().map(function(e){return e.constructor!==Date&&(4===(e+="").length&&parseInt(e)+""===e&&(e+="/01/01"),e=new Date(e)),+e}),g=g.filter(function(e){return"solo"===h?0<=r.indexOf(+e):r.indexOf(+e)<0}))):g=p.ticks.values?p.ticks.values:x(e,p.value,y,f),d3.nest().key(function(e){var t,r,n,a,o;for(a="nesting",r=0,n=i.length;r<n;r++)t=i[r],(o=y(f,e,t))instanceof Array&&(o=o.join("_")),a+="_"+s(o);return a}).rollup(function(e){var t,r,n,a,o,i,s,l,u,c,d;if((t=x(e,p.value,y,f)).length&&t[0].constructor===Date&&(t=t.map(Number)),p.zerofill.value)for(r="log"===p.scale.value?v.scale.viz.domain().every(function(e){return e<0})?-1:1:0,n=a=0,i=g.length;a<i;n=++a)if(d=g[n],c=m?+d:d,t.indexOf(c)<0){for(l={d3plus:{}},o=0,s=(u=f.id.nesting).length;o<s;o++)(h=u[o])in e[0]&&(l[h]=e[0][h]);l[p.value]=d,l[v.value]=0,l[v.value]=r,e.splice(n,0,l)}return"string"==typeof e[0][p.value]?e:e.sort(function(e,t){var r;return(r=y(f,e,p.value)-y(f,t,p.value))?r:y(f,e,v.value)-y(f,t,v.value)})}).entries(e)}},{"../../../../core/fetch/value.coffee":67,"../../../../string/strip.js":175,"../../../../util/uniques.coffee":210}],321:[function(e,t,r){var y;y=e("../../../../core/fetch/value.coffee"),t.exports=function(n,e){var t,a,r,o,i,s,l,u,c,d,f,p,h,v,g,m;for(g=n.axes.stacked||n.axes.opposite,a=n[g].scale.viz(0),h=n[g].scale.value,f="x"===g?"y":"x",l="y"===g?n.axes.margin.viz.top:n.axes.margin.viz.left,d="share"===h?"expand":"zero",v=d3.layout.stack().values(function(e){return e.values||[e]}).offset(d).x(function(e){return e.d3plus[f]}).y(function(e){return a-n[g].scale.viz(y(n,e,n[g].value))}).out(function(e,t,r){return y(n,e,n[g].value)<0,"share"===h?(e.d3plus[g+"0"]=(1-t)*a,e.d3plus[g]=e.d3plus[g+"0"]-r*a):(e.d3plus[g+"0"]=a,n.axes.stacked&&(e.d3plus[g+"0"]-=t),e.d3plus[g]=e.d3plus[g+"0"]-r),e.d3plus[g]+=l,e.d3plus[g+"0"]+=l}),p=[],c=[],r=0,i=e.length;r<i;r++)if(t=e[r],(m=y(n,t,n[g].value))instanceof Array){for(u=!0,o=0,s=m.length;o<s;o++)if(0<=m[o]){u=!1;break}u?c.push(t):p.push(t)}else 0<=m&&p.push(t),m<0&&c.push(t);return 0===p.length||0===c.length?v(e):(p.length&&(p=v(p)),c.length&&(c=v(c)),p.concat(c))}},{"../../../../core/fetch/value.coffee":67}],322:[function(e,t,r){var c,d,n,a,f,p;c=e("../../core/fetch/value.coffee"),d=e("./helpers/graph/draw.coffee"),a=e("./helpers/graph/nest.coffee"),f=e("../../array/sort.coffee"),p=e("./helpers/graph/stack.coffee"),(n=function(e){var t,r,n,a,o,i,s,l,u;if(d(e,{buffer:e.axes.opposite,mouse:!0}),0<=e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0))return[];for(n=0,o=(r=f(e.data.viz,null,null,null,e)).length;n<o;n++)for(a=0,i=(s=r[n].values).length;a<i;a++)t=s[a],null!==(l=c(e,t,e.x.value))?(t.d3plus.x2=!1,t.d3plus.x=e.x.scale.viz(l)):(t.d3plus.x2=!0,t.d3plus.x=e.x2.scale.viz(c(e,t,e.x2.value))),t.d3plus.x+=e.axes.margin.viz.left,null!==(u=c(e,t,e.y.value))?(t.d3plus.y2=!1,t.d3plus.y=e.y.scale.viz(u)):(t.d3plus.y2=!0,t.d3plus.y=e.y2.scale.viz(c(e,t,e.y2.value))),t.d3plus.y+=e.axes.margin.viz.top;return e.axes.stacked?p(e,r):r}).filter=function(e,t){return a(e,t)},n.requirements=["data","x","y"],n.setup=function(e){var t;e.axes.discrete||(t=e.time.value===e.y.value?"y":"x",e.self[t]({scale:"discrete"}))},n.shapes=["line"],n.tooltip="static",t.exports=n},{"../../array/sort.coffee":34,"../../core/fetch/value.coffee":67,"./helpers/graph/draw.coffee":314,"./helpers/graph/nest.coffee":320,"./helpers/graph/stack.coffee":321}],323:[function(e,t,r){var v=e("../../network/smallestGap.coffee"),g=e("../../core/fetch/value.coffee"),n=function(a){var e=a.nodes.restricted||a.nodes.value,t=a.edges.restricted||a.edges.value,r=d3.extent(e,function(e){return e.x}),n=d3.extent(e,function(e){return e.y}),o=[1,1];if("number"==typeof a.size.value?o=[a.size.value,a.size.value]:a.size.value&&(o=d3.extent(e,function(e){var t=g(a,e,a.size.value);return 0===t?null:t})),void 0===o[0]&&(o=[1,1]),"number"==typeof a.size.value)var i=a.size.value,s=a.size.value;else{var l=(i=v(e,{accessor:function(e){return[e.x,e.y]}}))/2;if(i*=a.size.value?a.nodes.overlap:.4,a.edges.arrows.value&&(i*=.5),o[0]===o[1]){s=l;i=l}else{var u=r[1]+1.1*i-(r[0]-1.1*i),c=n[1]+1.1*i-(n[0]-1.1*i);if(u/c<a.width.viz/a.height.viz)var d=a.height.viz/c;else d=a.width.viz/u;(s=.25*i)*d<2&&(s=2/d)}}var f=a.size.scale.value.domain(o).range([s,i]);a.zoom.bounds=[[r[0]-1.1*i,n[0]-1.1*i],[r[1]+1.1*i,n[1]+1.1*i]];var p=[],h={};return e.forEach(function(t){var e=a.data.viz.filter(function(e){return e[a.id.value]==t[a.id.value]})[0]||{};e[a.id.value]=t[a.id.value],e.d3plus={},e.d3plus.x=t.x,e.d3plus.y=t.y;var r=g(a,e,a.size.value);e.d3plus.r=r?f(r):f.range()[0],h[e[a.id.value]]={x:e.d3plus.x,y:e.d3plus.y,r:e.d3plus.r},p.push(e)}),p.sort(function(e,t){return t.d3plus.r-e.d3plus.r}),t.forEach(function(e,t){e.d3plus&&delete e.d3plus.spline,e[a.edges.source].d3plus={};var r=h[e[a.edges.source][a.id.value]];void 0!==r?(e[a.edges.source].d3plus.r=r.r,e[a.edges.source].d3plus.x=r.x,e[a.edges.source].d3plus.y=r.y):delete e[a.edges.source].d3plus,e[a.edges.target].d3plus={};var n=h[e[a.edges.target][a.id.value]];void 0!==n?(e[a.edges.target].d3plus.r=n.r,e[a.edges.target].d3plus.x=n.x,e[a.edges.target].d3plus.y=n.y):delete e[a.edges.target].d3plus}),{nodes:p,edges:t}};n.nesting=!1,n.requirements=["nodes","edges"],n.scale=1.05,n.shapes=["circle","square","donut"],n.tooltip="static",n.zoom=!0,t.exports=n},{"../../core/fetch/value.coffee":67,"../../network/smallestGap.coffee":168}],324:[function(e,t,r){var ue,b,w,ce,de=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};b=e("../../network/shortestPath.coffee"),ue=e("../../core/fetch/value.coffee"),w=e("../../util/uniques.coffee"),(ce=function(t){var e,r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P,I,D,V,R,U,L,Y,H,X,G,J,W,Q,K,Z,$,ee,te,re,ne,ae,oe,ie,se,le;for(d=[],(R={})[t.focus.value[0]]=0,R[t.focus.value[1]]=0,U={all:[[t.focus.value[0]],[t.focus.value[1]]]},V=h=0,b=(X=ce.paths).length;h<b;V=++h)for(D=X[V],d=d.concat(D.edges),x=t.focus.value[0],U[V]=[x],c=v=0,w=(G=D.edges).length;v<w;c=++v)(u=G[c])[t.edges.source]=t.data.viz.filter(function(e){return u[t.edges.source][t.id.value]===e[t.id.value]})[0],u[t.edges.target]=t.data.viz.filter(function(e){return u[t.edges.target][t.id.value]===e[t.id.value]})[0],B=u[t.edges.source][t.id.value]===x?"target":"source",void 0===R[C=u[t.edges[B]][t.id.value]]&&(R[C]=V),U[V].push(C),x=C;for(V in te=0,U)if(D=U[V],"all"!==V){for(f=g=S=0,_=D.length;g<_;f=++g)if(p=D[f],0!==f&&f!==D.length-1&&R[p]===parseFloat(V)){for(L=D[f-(S=1)],T=D[f+1],q=Y=null,i=O=0,k=(J=U.all).length;O<k;i=++O)o=J[i],0<=de.call(o,L)&&(Y=i),0<=de.call(o,T)&&(q=i);null!==Y&&null===q?Y+1===U.all.length-1?U.all.splice(Y+1,0,[p]):U.all[Y+1].push(p):q-Y==1?U.all.splice(q,0,[p]):1<q-Y&&U.all[q-1].push(p)}te+=S}for(ee=Math.floor(t.height.viz/te),le=[],f=0;f<te;)f%2==0?le.push(f):le.unshift(f),f++;for(m=t.size.value&&!t.small?30:0,se=d3.scale.ordinal().domain(le).range(d3.range(ee/2-m,t.height.viz+ee/2-m,(t.height.viz-ee)/(te-1))),l=U.all.length,s=Math.floor(t.width.viz/l),oe=d3.scale.linear().domain([0,l-1]).rangeRound([s/2,t.width.viz-s/2]),5,E=.4*d3.min([s,ee-m]),ne=d3.extent(t.data.viz,function(e){return ue(t,e,t.size.value)||0}),re=t.size.scale.value.domain(ne).rangeRound([5,E]),F=0,z=(W=t.data.viz).length;F<z;F++){for(null==(N=W[F]).d3plus&&(N.d3plus={}),i=P=0,A=(Q=U.all).length;P<A;i=++P)o=Q[i],K=N[t.id.value],0<=de.call(o,K)&&(N.d3plus.x=oe(i));N.d3plus.y=se(R[N[t.id.value]]),t.size.value?(ae=ue(t,N,t.size.value),N.d3plus.r=ae?re(ae):5):N.d3plus.r=E,N.d3plus.r<.1*s&&!t.small?N.d3plus.label={x:0,y:N.d3plus.r+2*t.labels.padding,w:.6*s,h:m+E-N.d3plus.r,resize:!1}:delete N.d3plus.label}for(V=I=0,j=(Z=ce.paths).length;I<j;V=++I)for(D=Z[V],x=t.focus.value[0],c=H=0,M=($=D.edges).length;H<M;c=++H)y="target"===(B=(u=$[c])[t.edges.source][t.id.value]===x?"target":"source")?"source":"target",C=u[t.edges[B]][t.id.value],R[x]!==R[C]?(u.d3plus={spline:!0},null==(e=u[t.edges.source]).d3plus&&(e.d3plus={}),null==(r=u[t.edges.source].d3plus).edges&&(r.edges={}),null==(n=u[t.edges.target]).d3plus&&(n.d3plus={}),null==(a=u[t.edges.target].d3plus).edges&&(a.edges={}),ie=u[B].d3plus.x-u[y].d3plus.x,u[y].d3plus.edges[u[B][t.id.value]]={angle:Math.PI,radius:s/2},u[B].d3plus.edges[u[y][t.id.value]]={angle:0,radius:s/2,offset:ie-s}):delete u.d3plus,x=C;return{nodes:t.data.viz,edges:d}}).filter=function(t,e){var r,n,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x;for(o=t.edges.filtered||t.edges.value,ce.paths=b(o,t.focus.value[0],{target:t.focus.value[1],distance:t.edges.size.value||void 0,nodeid:t.id.value,startpoint:t.edges.source,endpoint:t.edges.target,K:t.edges.limit.value||5}),ce.nodes=[],r=[],l=0,d=(v=ce.paths).length;l<d;l++)for(u=0,f=(g=v[l].edges).length;u<f;u++)y=(a=g[u])[t.edges.source],x=a[t.edges.target],r.indexOf(y[t.id.value])<0&&(ce.nodes.push(y),r.push(y[t.id.value])),r.indexOf(x[t.id.value])<0&&(ce.nodes.push(x),r.push(x[t.id.value]));for(m=[],c=0,p=(s=w(ce.nodes,t.id.value,ue,t)).length;c<p;c++)i=s[c],(n=e.filter(function(e){return e[t.id.value]===i}))[0]?m.push(n[0]):((h={d3plus:{}})[t.id.value]=i,m.push(h));return m},ce.nesting=!1,ce.requirements=[function(e){return{status:2===e.focus.value.length,text:e.format.locale.value.method.focus+" x 2"}},"edges"],ce.scale=1,ce.shapes=["circle","square","donut"],ce.tooltip="static",t.exports=ce},{"../../core/fetch/value.coffee":67,"../../network/shortestPath.coffee":167,"../../util/uniques.coffee":210}],325:[function(e,t,r){var l,n,u,a;l=e("../../array/comparator.coffee"),n=e("../../core/data/threshold.js"),u=e("../../core/data/group.coffee"),(a=function(r){var e,t,n,a,o,i,s;for(o=d3.layout.pie().value(function(e){return e.value}).sort(function(e,t){return r.order.value?l(e.d3plus,t.d3plus,[r.order.value],r.order.sort.value,[],r):1<r.id.nesting.length?l(e.d3plus,t.d3plus,r.id.nesting.concat([r.size.value]),void 0,[],r):l(e.d3plus,t.d3plus,[r.size.value],"desc",[],r)})(u(r,r.data.viz,[])),s=[],i=d3.min([r.width.viz,r.height.viz])/2-2*r.labels.padding,t=0,a=o.length;t<a;t++)(n=(e=o[t]).data.d3plus).d3plus.startAngle=e.startAngle,n.d3plus.endAngle=e.endAngle,n.d3plus.r=i,n.d3plus.x=r.width.viz/2,n.d3plus.y=r.height.viz/2,n.d3plus.share=(e.endAngle-e.startAngle)/(2*Math.PI),s.push(n);return s}).filter=n,a.requirements=["data","size"],a.shapes=["arc"],a.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},t.exports=a},{"../../array/comparator.coffee":32,"../../core/data/group.coffee":57,"../../core/data/threshold.js":61}],326:[function(e,t,r){var Z,$,ee,te,re,n,ne,ae;e("../../array/comparator.coffee"),e("../../array/sort.coffee"),e("../../core/data/threshold.js"),$=e("../../core/fetch/text.js"),ee=e("../../core/fetch/value.coffee"),te=e("../../font/sizes.coffee"),re=e("../../geom/offset.coffee"),ne=e("../../textwrap/textwrap.coffee"),Z=e("../../util/buckets.coffee"),ae=e("../../util/uniques.coffee"),(n=function(n){var e,t,r,a,o,i,s,l,u,c,d,f,p,h,v,g,m,y,x,b,w,_,k,z,A,j,M,O,E,F,S,T,B,C,q,N,P,I,D,V,R,U,L,Y,H,X,G,J,W,Q,K;for(u=n.data.viz,q=n.depth.value+1,N=n.id.nesting[q],s=function(){var e,t,r;for(r=[],e=0,t=u.length;e<t;e++)l=u[e],r.push(l[N]);return r}(),K=function(){var e,t,r;for(r=[],e=0,t=u.length;e<t;e++)l=u[e],r.push(ae(u,N,ee,n,q));return r}(),K=ae(d3.merge(K)).length,a=2*Math.PI/K,B=d3.min([n.width.viz,n.height.viz])/2,A=_=0,j=function(){var e,t,r;for(r=[],e=0,t=s.length;e<t;e++)i=s[e],r.push($(n,i,q)[0]);return r}(),j=ae(d3.merge(j)),n.labels.value&&(c=re(Math.PI/2,B),X=re(a+Math.PI/2,B),_=c.x-X.x-2*n.labels.padding,W={fill:n.x.ticks.font.color,"font-family":n.x.ticks.font.family.value,"font-weight":n.x.ticks.font.weight,"font-size":n.x.ticks.font.size+"px"},G=te(j,W,{mod:function(e){return ne().container(d3.select(e)).width(n.height.viz/8).height(_).draw()}}),B-=A=d3.max(G,function(e){return e.width}),B-=2*n.labels.padding),T=function(){var e,t,r;for(r=[],e=0,t=s.length;e<t;e++)i=s[e],r.push(function(){var e,t,r;for(r=[],e=0,t=i.length;e<t;e++)l=i[e],r.push(ee(n,l,n.size.value));return r}());return r}(),T=d3.max(d3.merge(T)),D=d3.scale.linear().domain([0,T]).range([0,B]),v=function(){var e,t,r;for(r=[],e=0,t=s.length;e<t;e++)i=s[e],r.push(ee(n,i,N));return r}(),v=ae(d3.merge(v)),h=d3.scale.ordinal().domain(v).range(d3.range(0,v.length)),m=0,M=u.length;m<M;m++)for((l=u[m]).d3plus.x=n.width.viz/2+n.margin.top,l.d3plus.y=n.height.viz/2+n.margin.left,p=y=0,O=(V=l[N]).length;y<O;p=++y)(e=V[p]).d3plus||(e.d3plus={}),e.d3plus.r=D(ee(n,e,n.size.value)),e.d3plus.a=h(ee(n,e,N))*a;for(g=1,S=0,E=(R=[10,5,4,2]).length;S<E;S++)if(20<=B/(p=R[S])){g=p;break}for((L=Z([B/g,B],g-1).reverse()).length===g&&L.shift(),Y=function(e){return e.attr("fill",function(e,t){return 0===t?n.axes.background.color:"transparent"}).attr("cx",n.width.viz/2+n.margin.top).attr("cy",n.height.viz/2+n.margin.left).attr("stroke",n.x.grid.value?n.x.grid.color:"transparent")},(H=n.group.selectAll(".d3plus_radar_rings").data(L,function(e,t){return t})).enter().append("circle").attr("class","d3plus_radar_rings").call(Y).attr("r",0),H.transition().duration(n.draw.timing).call(Y).attr("r",function(e){return e}),H.exit().transition().duration(n.draw.timing).attr("opacity",0).remove(),k=d3.scale.ordinal().domain(j).range(d3.range(0,j.length)),b=[],C=0,F=j.length;C<F;C++)(e=(t=a*k(x=j[C])-Math.PI/2)*(180/Math.PI))<-90||90<e?(e-=180,o=-(B+2*n.labels.padding+A),r="end"):(o=B+2*n.labels.padding,r="start"),Q=t<0||t>Math.PI,U=t<Math.PI/2,I=B,n.labels.value&&(I+=n.labels.padding),(P=re(t,I)).x,P.y,U||A,Q&&_,0<=[0,Math.PI].indexOf(a*k(x))&&A/2,b.push({text:x,angle:e,x:o,anchor:r,offset:P});return(w=n.group.selectAll("g.d3plus_radar_label_group").data([0])).enter().append("g").attr("class","d3plus_radar_label_group").attr("transform","translate("+n.width.viz/2+","+n.height.viz/2+")"),w.transition().duration(n.draw.timing).attr("transform","translate("+n.width.viz/2+","+n.height.viz/2+")"),z=function(e){return e.attr(W).each(function(e,t){return ne().container(d3.select(this)).height(_).width(A).align(e.anchor).text(e.text).padding(0).valign("middle").x(e.x).y(-_/2).draw()}).attr("transform",function(e){var t;return(t=d3.select(this).attr("transform")||"").length&&(t=t.split(")").slice(-3).join(")")),"rotate("+e.angle+")"+t})},(J=w.selectAll(".d3plus_radar_labels").data(n.labels.value?b:[],function(e,t){return t})).call(z),J.enter().append("text").attr("class","d3plus_radar_labels").attr("opacity",0).call(z).transition().duration(n.draw.timing).attr("opacity",1),J.exit().transition().duration(n.draw.timing).attr("opacity",0).remove(),f=function(e){return e.attr("stroke",n.x.grid.color).attr("x1",n.width.viz/2+n.margin.left).attr("y1",n.height.viz/2+n.margin.top)},(d=n.group.selectAll(".d3plus_radar_lines").data(b,function(e,t){return t})).enter().append("line").attr("class","d3plus_radar_lines").call(f).attr("x2",n.width.viz/2+n.margin.left).attr("y2",n.height.viz/2+n.margin.top),d.transition().duration(n.draw.timing).call(f).attr("x2",function(e){return n.width.viz/2+n.margin.left+e.offset.x}).attr("y2",function(e){return n.height.viz/2+n.margin.top+e.offset.y}),d.exit().transition().duration(n.draw.timing).attr("opacity",0).remove(),n.mouse.viz={click:!1},u}).requirements=["data","size"],n.shapes=["radial"],t.exports=n},{"../../array/comparator.coffee":32,"../../array/sort.coffee":34,"../../core/data/threshold.js":61,"../../core/fetch/text.js":66,"../../core/fetch/value.coffee":67,"../../font/sizes.coffee":102,"../../geom/offset.coffee":161,"../../textwrap/textwrap.coffee":200,"../../util/buckets.coffee":204,"../../util/uniques.coffee":210}],327:[function(e,t,r){var A=e("../../array/sort.coffee"),j=e("../../client/pointer.coffee"),M=e("../../core/fetch/value.coffee"),O=e("../../core/fetch/color.coffee"),E=e("../../color/legible.coffee"),F=e("../../tooltip/remove.coffee"),S=e("../../network/smallestGap.coffee"),T=e("../../color/text.coffee"),B=e("../../util/uniques.coffee"),n=function(u){var r=d3.min([u.height.viz,u.width.viz])/2,s=u.small||!u.labels.value?(r-2*u.labels.padding)/2:r/3,c=u.small||!u.labels.value?1.4*s:s,d=2*s,i=[],l=[],f=u.data.viz.filter(function(e){return e[u.id.value]===u.focus.value[0]})[0];f||((f={d3plus:{}})[u.id.value]=u.focus.value[0]),f.d3plus.x=u.width.viz/2,f.d3plus.y=u.height.viz/2,f.d3plus.r=.65*c;var p=[],o=[u.focus.value[0]];u.edges.connections(u.focus.value[0],u.id.value).forEach(function(e){var t=e[u.edges.source][u.id.value]==u.focus.value[0]?e[u.edges.target]:e[u.edges.source],r=u.data.viz.filter(function(e){return e[u.id.value]===t[u.id.value]})[0];r||((r={d3plus:{}})[u.id.value]=t[u.id.value]),r.d3plus.edges=u.edges.connections(r[u.id.value],u.id.value).filter(function(e){return e[u.edges.source][u.id.value]!=u.focus.value[0]&&e[u.edges.target][u.id.value]!=u.focus.value[0]}),r.d3plus.edge=e,o.push(r[u.id.value]),p.push(r)});var n=u.order.value||u.color.value||u.size.value||u.id.value;p.sort(function(e,t){var r=e.d3plus.edges.length-t.d3plus.edges.length;return r||A([e,t],n,u.order.sort.value,u.color.value||[],u)}),"number"==typeof u.edges.limit.value?p=p.slice(0,u.edges.limit.value):"function"==typeof u.edges.limit.value&&(p=u.edges.limit.value(p));var h=[],v=0;p.forEach(function(e){var a=e[u.id.value];e.d3plus.edges=e.d3plus.edges.filter(function(e){var t=e[u.edges.source][u.id.value],r=e[u.edges.target][u.id.value];return o.indexOf(t)<0&&r==a||o.indexOf(r)<0&&t==a}),v+=e.d3plus.edges.length||1,e.d3plus.edges.forEach(function(e){var t=e[u.edges.source],r=e[u.edges.target],n=r[u.id.value]==a?t:r;o.push(n[u.id.value])})}),A(p,n,u.order.sort.value,u.color.value||[],u);var g=0,m=2*Math.PI;p.forEach(function(i,e){var s=i.d3plus.edges.length||1,t=m/v*s;0==e&&(l,g-=t/2);var l=g+t/2;l-=m/4,i.d3plus.radians=l,i.d3plus.x=u.width.viz/2+c*Math.cos(l),i.d3plus.y=u.height.viz/2+c*Math.sin(l),g+=t,i.d3plus.edges.sort(function(e,t){e=e[u.edges.source][u.id.value]==i[u.id.value]?e[u.edges.target]:e[u.edges.source],t=t[u.edges.source][u.id.value]==i[u.id.value]?t[u.edges.target]:t[u.edges.source];return A([e,t],n,u.order.sort.value,u.color.value||[],u)}),i.d3plus.edges.forEach(function(e,t){var r=e[u.edges.source][u.id.value]==i[u.id.value]?e[u.edges.target]:e[u.edges.source],n=m/v,o=u.data.viz.filter(function(e){return e[u.id.value]===r[u.id.value]})[0];o||((o={d3plus:{}})[u.id.value]=r[u.id.value]),a=l-n*s/2+n/2+n*t,o.d3plus.radians=a,o.d3plus.x=u.width.viz/2+d*Math.cos(a),o.d3plus.y=u.height.viz/2+d*Math.sin(a),h.push(o)})});var y=S(p,{accessor:function(e){return[e.d3plus.x,e.d3plus.y]}}),x=S(h,{accessor:function(e){return[e.d3plus.x,e.d3plus.y]}});if(y||(y=s/2),x||(x=s/4),y/2-4<8)var e=d3.min([y/2,8]);else e=y/2-4;if(x/2-4<4)var t=d3.min([x/2,4]);else t=x/2-4;s/10<t&&(t=s/10),e<t&&10<t&&(t=.75*e),1.5*t<e&&(e=1.5*t),e=Math.floor(e),t=Math.floor(t);var b=B(p,u.id.value,M,u);(b=b.concat(B(h,u.id.value,M,u))).push(u.focus.value[0]);var w=u.data.viz.filter(function(e){return 0<=b.indexOf(e[u.id.value])});if(u.size.value){var _=d3.extent(w,function(e){return M(u,e,u.size.value)});_[0]==_[1]&&(_[0]=0);r=d3.scale.linear().domain(_).rangeRound([3,d3.min([e,t])]);var k=M(u,f,u.size.value);f.d3plus.r=r(k)}else{r=d3.scale.linear().domain([1,2]).rangeRound([e,t]);u.edges.label&&(f.d3plus.r=1.5*r(1))}h.forEach(function(e){e.d3plus.ring=2;var t=u.size.value?M(u,e,u.size.value):2;e.d3plus.r=r(t)}),p.forEach(function(e){e.d3plus.ring=1;var t=u.size.value?M(u,e,u.size.value):1;e.d3plus.r=r(t)}),l=[f].concat(p).concat(h),p.forEach(function(o,e){var t=[u.edges.source,u.edges.target],r=o.d3plus.edge;t.forEach(function(t){r[t]=l.filter(function(e){return e[u.id.value]==r[t][u.id.value]})[0]}),delete r.d3plus,i.push(r),u.edges.connections(o[u.id.value],u.id.value).forEach(function(n){var t=n[u.edges.source][u.id.value]==o[u.id.value]?n[u.edges.target]:n[u.edges.source];if(t[u.id.value]!=f[u.id.value]){var a=h.filter(function(e){return e[u.id.value]==t[u.id.value]})[0];if(a);else{a=p.filter(function(e){return e[u.id.value]==t[u.id.value]})[0]}if(a)n.d3plus={spline:!0,translate:{x:u.width.viz/2,y:u.height.viz/2}},[u.edges.source,u.edges.target].forEach(function(t,e){n[t]=l.filter(function(e){return e[u.id.value]==n[t][u.id.value]})[0],void 0===n[t].d3plus.edges&&(n[t].d3plus.edges={});var r=0===e?n[u.edges.target][u.id.value]:n[u.edges.source][u.id.value];n[t][u.id.value]==o[u.id.value]?n[t].d3plus.edges[r]={angle:o.d3plus.radians+Math.PI,radius:s/2}:n[t].d3plus.edges[r]={angle:a.d3plus.radians,radius:s/2}}),i.push(n)}})});var z=!1;return u.background.value&&["transparent","none"].indexOf(u.background.value)<0&&d3.hsl(u.background.value).l<.5&&(z=T(u.background.value)),l.forEach(function(e){if(!u.small&&u.labels.value)if(e[u.id.value]!=u.focus.value[0]){e.d3plus.rotate=e.d3plus.radians*(180/Math.PI);var t=e.d3plus.rotate,r=s-3*u.labels.padding-e.d3plus.r;if(t<-90||90<t){t-=180;var n=-(e.d3plus.r+r/2+u.labels.padding),a="end"}else n=e.d3plus.r+r/2+u.labels.padding,a="start";var o=0<=p.indexOf(e),i=1==e.d3plus.ring?y:x;e.d3plus.label={x:n,y:0,w:r,h:i,angle:t,anchor:a,valign:"center",color:z||E(O(u,e)),resize:[8,u.labels.font.size],background:o,mouse:!0}}else if(u.size.value||u.edges.label){i=c-2*e.d3plus.r-2*u.labels.padding;e.d3plus.label={x:0,y:e.d3plus.r+i/2,w:c,h:i,color:z||E(O(u,e)),resize:[10,40],background:!0,mouse:!0}}else delete e.d3plus.rotate,delete e.d3plus.label;else delete e.d3plus.rotate,delete e.d3plus.label}),u.mouse.viz={},u.mouse.viz[j.click]=function(e){if(e[u.id.value]!=u.focus.value[0]){F(u.type.value);var t=u.focus.value[0];u.history.states.push(function(){u.self.focus(t).draw()}),u.self.focus(e[u.id.value]).draw()}},{edges:i,nodes:l,data:w}};n.filter=function(n,a){var e=n.edges.connections(n.focus.value[0],n.id.value,!0),t=[];e.forEach(function(e){t=t.concat(n.edges.connections(e[n.id.value],n.id.value,!0))});var r=e.concat(t),o=B(r,n.id.value,M,n),i=[];return o.forEach(function(t){var e=a.filter(function(e){return e[n.id.value]==t})[0];if(e)i.push(e);else{var r={d3plus:{}};r[n.id.value]=t,i.push(r)}}),i},n.nesting=!1,n.scale=1,n.shapes=["circle","square","donut"],n.requirements=["edges","focus"],n.tooltip="static",t.exports=n},{"../../array/sort.coffee":34,"../../client/pointer.coffee":38,"../../color/legible.coffee":44,"../../color/text.coffee":50,"../../core/fetch/color.coffee":63,"../../core/fetch/value.coffee":67,"../../network/smallestGap.coffee":168,"../../tooltip/remove.coffee":203,"../../util/uniques.coffee":210}],328:[function(e,t,r){var v,g,m,n;v=e("./sankey.js"),g=e("../../client/pointer.coffee"),m=e("../../tooltip/remove.coffee"),e("../../util/uniques.coffee"),(n=function(n){var e,t,a,r,o,i,s,l,u,c,d,f,p,h;for(a=n.focus.value[0],d=2*n.data.stroke.width,h=n.size.value.constructor===Number?n.size.value:20,t=n.edges.connections(a,n.id.value).filter(function(e){return e[n.edges.source][n.id.value]!==a||e[n.edges.target][n.id.value]!==a}),c=[],f=[],t=t.map(function(e){var t,r;return e[n.edges.target][n.id.value]===a?(t={id:"left_"+e[n.edges.source][n.id.value],dupe:"left",data:e[n.edges.source],value:e[n.edges.strength.value]},r=e[n.edges.target]):(t=e[n.edges.source],r={id:"right_"+e[n.edges.target][n.id.value],dupe:"right",data:e[n.edges.target],value:e[n.edges.strength.value]}),f.indexOf(t.id)<0&&c.push(t),f.indexOf(r.id)<0&&c.push(r),f.push(t.id),f.push(r.id),{source:t,target:r,value:e[n.edges.strength.value]||1}}),i=v().nodeWidth(h).nodePadding(n.data.padding.value).size([n.width.viz-2*d,n.height.viz-2*d]).nodes(c).links(t).layout(2),p=[],r=0,s=c.length;r<s;r++)(e={id:(e=(u=c[r]).data||u)[n.id.value]}).d3plus={x:u.x+u.dx/2+d,y:u.y+u.dy/2+d,width:u.dx,height:u.dy,suffix:u.dupe},e.id!==a&&(e[n.edges.strength.value]=u.value),p.push(e);for(n.edges.path=i.link(),o=0,l=t.length;o<l;o++)t[o].d3plus={x:d,y:d};return n.mouse.viz={},n.mouse.viz[g.click]=function(e){var t;if(e[n.id.value]!==n.focus.value[0])return m(n.type.value),t=n.focus.value[0],n.history.states.push(function(){return n.self.focus(t).draw()}),n.self.focus(e[n.id.value]).draw()},{nodes:p,edges:t}}).requirements=["edges","focus","nodes"],n.shapes=["square"],t.exports=n},{"../../client/pointer.coffee":38,"../../tooltip/remove.coffee":203,"../../util/uniques.coffee":210,"./sankey.js":329}],329:[function(e,t,r){t.exports=function(){var t={},o=24,l=8,u=[1,1],c=[],d=[];function r(){function t(e,t){return e.source.y-t.source.y}function r(e,t){return e.target.y-t.target.y}c.forEach(function(e){e.sourceLinks.sort(r),e.targetLinks.sort(t)}),c.forEach(function(e){var t=0,r=0;e.sourceLinks.forEach(function(e){e.sy=t,t+=e.dy}),e.targetLinks.forEach(function(e){e.ty=r,r+=e.dy})})}function f(e){return e.y+e.dy/2}function p(e){return e.value}return t.nodeWidth=function(e){return arguments.length?(o=+e,t):o},t.nodePadding=function(e){return arguments.length?(l=+e,t):l},t.nodes=function(e){return arguments.length?(c=e,t):c},t.links=function(e){return arguments.length?(d=e,t):d},t.size=function(e){return arguments.length?(u=e,t):u},t.layout=function(e){return c.forEach(function(e){e.sourceLinks=[],e.targetLinks=[]}),d.forEach(function(e){var t=e.source,r=e.target;"number"==typeof t&&(t=e.source=c[e.source]),"number"==typeof r&&(r=e.target=c[e.target]),t.sourceLinks.push(e),r.targetLinks.push(e)}),c.forEach(function(e){e.value=Math.max(d3.sum(e.sourceLinks,p),d3.sum(e.targetLinks,p))}),function(){var t,e=c,r=0;for(;e.length;)t=[],e.forEach(function(e){e.x=r,e.dx=o,e.sourceLinks.forEach(function(e){t.indexOf(e.target)<0&&t.push(e.target)})}),e=t,++r;a=r,c.forEach(function(e){e.sourceLinks.length||(e.x=a-1)}),n=(u[0]-o)/(r-1),c.forEach(function(e){e.x*=n});var n;var a}(),function(e){var t=d3.nest().key(function(e){return e.x}).sortKeys(d3.ascending).entries(c).map(function(e){return e.values});r=d3.min(t,function(e){return(u[1]-(e.length-1)*l)/d3.sum(e,p)}),t.forEach(function(e){e.forEach(function(e,t){e.y=t,e.dy=e.value*r})}),d.forEach(function(e){e.dy=e.value*r}),i();var r;for(var n=1;0<e;--e)o(n*=.99),i(),a(n),i();function a(r){function n(e){return f(e.source)*e.value}t.forEach(function(e,t){e.forEach(function(e){if(e.targetLinks.length){var t=d3.sum(e.targetLinks,n)/d3.sum(e.targetLinks,p);e.y+=(t-f(e))*r}})})}function o(r){function n(e){return f(e.target)*e.value}t.slice().reverse().forEach(function(e){e.forEach(function(e){if(e.sourceLinks.length){var t=d3.sum(e.sourceLinks,n)/d3.sum(e.sourceLinks,p);e.y+=(t-f(e))*r}})})}function i(){t.forEach(function(e){var t,r,n,a=0,o=e.length;for(e.sort(s),n=0;n<o;++n)t=e[n],0<(r=a-t.y)&&(t.y+=r),a=t.y+t.dy+l;if(0<(r=a-l-u[1]))for(a=t.y-=r,n=o-2;0<=n;--n)t=e[n],0<(r=t.y+t.dy+l-a)&&(t.y-=r),a=t.y})}function s(e,t){return e.y-t.y}}(e),r(),t},t.relayout=function(){return r(),t},t.link=function(){var l=.5;function t(e){var t=e.source.x+e.source.dx,r=e.target.x,n=d3.interpolateNumber(t,r),a=n(l),o=n(1-l),i=e.source.y+e.sy+e.dy/2,s=e.target.y+e.ty+e.dy/2;return"M"+t+","+i+"C"+a+","+i+" "+o+","+s+" "+r+","+s}return t.curvature=function(e){return arguments.length?(l=+e,t):l},t},t}},{}],330:[function(e,t,r){var o,i,n,s,l;o=e("../../core/fetch/value.coffee"),i=e("./helpers/graph/draw.coffee"),e("../../core/console/print.coffee"),s=e("../../array/sort.coffee"),l=e("./helpers/graph/dataTicks.coffee"),(n=function(e){var t,r,n,a;if(i(e,{buffer:"size",mouse:!0}),0<=e.x.domain.viz.concat(e.y.domain.viz).indexOf(void 0))return[];for(r=0,n=(a=e.data.viz).length;r<n;r++)(t=a[r]).d3plus.x=e.x.scale.viz(o(e,t,e.x.value)),t.d3plus.x+=e.axes.margin.viz.left,t.d3plus.y=e.y.scale.viz(o(e,t,e.y.value)),t.d3plus.y+=e.axes.margin.viz.top,"number"!=typeof e.size.value&&e.size.value?t.d3plus.r=e.axes.scale(o(e,t,e.size.value)):t.d3plus.r=e.axes.scale(0);return l(e),s(e.data.viz,e.order.value||e.size.value||e.id.value,"desc"===e.order.sort.value?"asc":"desc",e.color.value||[],e)}).fill=!0,n.requirements=["data","x","y"],n.scale=1.1,n.setup=function(e){if(e.time.value&&!e.axes.discrete&&(e.time.value===e.x.value&&e.self.x({scale:"discrete"}),e.time.value===e.y.value))return e.self.y({scale:"discrete"})},n.shapes=["circle","square","donut"],n.tooltip="static",t.exports=n},{"../../array/sort.coffee":34,"../../core/console/print.coffee":52,"../../core/fetch/value.coffee":67,"./helpers/graph/dataTicks.coffee":313,"./helpers/graph/draw.coffee":314}],331:[function(e,t,r){var a=e("../../core/fetch/value.coffee"),c=e("../../util/uniques.coffee"),d=e("../../util/copy.coffee"),f=e("../../color/random.coffee"),n=function(o){var e=c(o.data.viz,o.id.value,a,o),t=c(o.cols.value);t.indexOf("label")<0&&o.cols.index.value&&t.unshift("label");var i=o.height.viz/(e.length+1),s=o.width.viz/t.length;o.group.selectAll("rect").data([0]).enter().append("rect").attr("class","background").attr("height",o.height.viz).attr("width",o.width.viz).style("fill",o.color.missing);var r=o.group.selectAll("line.horiz").data(o.data.viz);r.enter().append("line").attr("class","horiz"),r.attr("x1",0).attr("y1",function(e,t){return i*t+i}).attr("x2",o.width.viz).attr("y2",function(e,t){return i*t+i}).style("fill","#fff").style("stroke","#fff"),r.exit().remove();var n=o.group.selectAll("line.vert").data(t);n.enter().append("line").attr("class","vert"),n.attr("x1",function(e,t){return s*t+s}).attr("y1",0).attr("x2",function(e,t){return s*t+s}).attr("y2",o.height.viz).style("fill","#fff").style("stroke","#fff"),n.exit().remove();var l=[],u={};return t.forEach(function(t,e){var r={d3plus:{x:s*e+s/2,y:i/2,width:s,height:i,id:"d3p_header_"+t.toString().replace(/ /g,"_"),shape:"square",color:"#fff",text:o.format.value(t)}};if(t==o.id.value&&(r.d3plus.color="#fff"),"label"==t&&(r.d3plus.label=!1,r.d3plus.color="#fff",r.d3plus.stroke="#fff"),l.push(r),"number"==o.data.keys[t]){var n=d3.extent(o.data.viz,function(e){return e[t]});n[0]==n[1]&&(n=[n[0]-1,n[1]]),u[t]=d3.scale.linear().domain(n).range([o.color.missing,f(t)])}else"boolean"==o.data.keys[t]&&(u[t]=function(e){return e?f(t):o.color.missing})}),o.data.viz.forEach(function(n,a){a+=1,t.forEach(function(e,t){var r=d(n);r.d3plus.id="d3p_"+r[o.id.value].toString().replace(/ /g,"_")+"_"+e,r.d3plus.x=s*t+s/2,r.d3plus.y=i*a+i/2,r.d3plus.width=s,r.d3plus.height=i,"label"==e&&(r.d3plus.shape="square",r.d3plus.color="#fff",l.push(r)),0<=d3.keys(n).indexOf(e)&&e in n&&(u[e]&&(r.d3plus.color=u[e](r[e])),r.d3plus.text=o.format.value(r[e]),"boolean"==o.data.keys[e]?r.d3plus.label=!1:"string"==o.data.keys[e]&&(r.d3plus.color=o.color.missing,r.d3plus.stroke="#fff",r.d3plus.shape="square"),l.push(r))})}),l};n.shapes=["check","cross","diamond","square","triangle","triangle_up","triangle_down"],n.requirements=["data","cols"],t.exports=n},{"../../color/random.coffee":47,"../../core/fetch/value.coffee":67,"../../util/copy.coffee":207,"../../util/uniques.coffee":210}],332:[function(e,t,r){var n,l,u,a;n=e("../../core/data/threshold.js"),l=e("../../core/data/group.coffee"),u=e("../../object/merge.coffee"),(a=function(e){var t,r,n,a,o,i,s;if(n=l(e,e.data.viz),(r=d3.layout.treemap().mode(e.type.mode.value).round(!0).size([e.width.viz,e.height.viz]).children(function(e){return e.values}).padding(e.data.padding.value).sort(function(e,t){var r;return 0===(r=e.value-t.value)?e.id<t.id:r}).nodes({name:"root",values:n}).filter(function(e){return!e.values&&e.area})).length){for(s=r[0];s.parent;)s=s.parent;for(i=[],a=0,o=r.length;a<o;a++)(t=r[a]).d3plus.d3plus=u(t.d3plus.d3plus,{x:t.x+t.dx/2,y:t.y+t.dy/2,width:t.dx,height:t.dy,share:t.value/s.value}),i.push(t.d3plus)}return i}).filter=n,a.modes=["squarify","slice","dice","slice-dice"],a.requirements=["data","size"],a.shapes=["square"],a.threshold=function(e){return 1600/(e.width.viz*e.height.viz)},t.exports=a},{"../../core/data/group.coffee":57,"../../core/data/threshold.js":61,"../../object/merge.coffee":171}],333:[function(e,t,r){var n,a,u,c,d,f;n=e("../core/methods/attach.coffee"),a=e("./methods/helpers/axis.coffee"),c=e("./helpers/ui/message.js"),d=e("./helpers/drawSteps.js"),f=e("../core/console/print.coffee"),u=e("./helpers/container.coffee"),e("../object/validate.coffee"),t.exports=function(){var l;return(l={g:{apps:{}},types:{area:e("./types/area.coffee"),bar:e("./types/bar.coffee"),bubbles:e("./types/bubbles.coffee"),box:e("./types/box.coffee"),chart:e("./types/deprecated/chart.coffee"),geo_map:e("./types/geo_map.coffee"),line:e("./types/line.coffee"),network:e("./types/network.js"),paths:e("./types/paths.coffee"),pie:e("./types/pie.coffee"),radar:e("./types/radar.coffee"),rings:e("./types/rings.js"),sankey:e("./types/sankey.coffee"),scatter:e("./types/scatter.coffee"),stacked:e("./types/area.coffee"),table:e("./types/table.js"),tree_map:e("./types/tree_map.coffee")}}).self=function(e){return e.each(function(){var a,o,i,e,t,r,s;l.draw.frozen=!0,l.error.internal=null,"timing"in l.draw||(l.draw.timing=l.timing.transitions),l.error.value&&(l.draw.timing=0),u(l),r=l.width.value<=l.width.small,t=l.height.value<=l.height.small,l.small=r||t,l.width.viz=l.width.value,l.height.viz=l.height.value,a=!1,o=function(){s.length?e():l.dev.value&&(f.groupEnd(),f.timeEnd("total draw time"),f.log("\n"))},i=function(e,t){e[t=t||"function"]instanceof Array?e[t].forEach(function(e){e(l,o)}):"function"==typeof e[t]&&e[t](l,o),e.wait||o()},e=function(){var e,t,r,n;n=s.shift(),r=l.g.message&&a===n.message,"function"==typeof(t=!("check"in n)||n.check)&&(t=t(l)),t?r?i(n):(l.dev.value&&(!1!==a&&f.groupEnd(),f.group(n.message)),"string"==typeof l.messages.value?(a=l.messages.value,e=l.messages.value):(a=n.message,e=l.format.value(n.message)),l.draw.update?(c(l,e),l.error.value?i(n):setTimeout(function(){return i(n)},10)):i(n)):"otherwise"in n?l.error.value?i(n,"otherwise"):setTimeout(function(){return i(n,"otherwise")},10):o()},l.messages.style.backup=l.group&&"1"===l.group.attr("opacity")?"small":"large",s=d(l),e()}),l.self},n(l,{active:e("./methods/active.coffee"),aggs:e("./methods/aggs.coffee"),attrs:e("./methods/attrs.coffee"),axes:e("./methods/axes.coffee"),background:e("./methods/background.coffee"),class:e("./methods/class.coffee"),color:e("./methods/color.coffee"),cols:e("./methods/cols.js"),config:e("./methods/config.coffee"),container:e("./methods/container.coffee"),coords:e("./methods/coords.coffee"),csv:e("./methods/csv.coffee"),data:e("./methods/data.coffee"),depth:e("./methods/depth.coffee"),descs:e("./methods/descs.coffee"),dev:e("./methods/dev.coffee"),draw:e("./methods/draw.js"),edges:e("./methods/edges.js"),error:e("./methods/error.coffee"),focus:e("./methods/focus.coffee"),font:e("./methods/font.coffee"),footer:e("./methods/footer.coffee"),format:e("./methods/format.coffee"),height:e("./methods/height.coffee"),history:e("./methods/history.coffee"),icon:e("./methods/icon.coffee"),id:e("./methods/id.coffee"),labels:e("./methods/labels.coffee"),legend:e("./methods/legend.coffee"),links:e("./methods/links.coffee"),margin:e("./methods/margin.coffee"),messages:e("./methods/messages.coffee"),mouse:e("./methods/mouse.coffee"),nodes:e("./methods/nodes.coffee"),order:e("./methods/order.coffee"),resize:e("./methods/resize.coffee"),shape:e("./methods/shape.coffee"),size:e("./methods/size.coffee"),style:e("./methods/style.coffee"),temp:e("./methods/temp.coffee"),text:e("./methods/text.coffee"),time:e("./methods/time.coffee"),timeline:e("./methods/timeline.coffee"),timing:e("./methods/timing.coffee"),title:e("./methods/title.coffee"),tooltip:e("./methods/tooltip.coffee"),total:e("./methods/total.coffee"),type:e("./methods/type.coffee"),ui:e("./methods/ui.coffee"),width:e("./methods/width.coffee"),x:a("x"),x2:a("x2"),y:a("y"),y2:a("y2"),zoom:e("./methods/zoom.js")}),l.self}},{"../core/console/print.coffee":52,"../core/methods/attach.coffee":80,"../object/validate.coffee":172,"./helpers/container.coffee":211,"./helpers/drawSteps.js":212,"./helpers/ui/message.js":246,"./methods/active.coffee":255,"./methods/aggs.coffee":256,"./methods/attrs.coffee":257,"./methods/axes.coffee":258,"./methods/background.coffee":259,"./methods/class.coffee":260,"./methods/color.coffee":261,"./methods/cols.js":262,"./methods/config.coffee":263,"./methods/container.coffee":264,"./methods/coords.coffee":265,"./methods/csv.coffee":266,"./methods/data.coffee":267,"./methods/depth.coffee":268,"./methods/descs.coffee":269,"./methods/dev.coffee":270,"./methods/draw.js":271,"./methods/edges.js":272,"./methods/error.coffee":273,"./methods/focus.coffee":274,"./methods/font.coffee":275,"./methods/footer.coffee":276,"./methods/format.coffee":277,"./methods/height.coffee":278,"./methods/helpers/axis.coffee":279,"./methods/history.coffee":280,"./methods/icon.coffee":281,"./methods/id.coffee":282,"./methods/labels.coffee":283,"./methods/legend.coffee":284,"./methods/links.coffee":285,"./methods/margin.coffee":286,"./methods/messages.coffee":287,"./methods/mouse.coffee":288,"./methods/nodes.coffee":289,"./methods/order.coffee":290,"./methods/resize.coffee":291,"./methods/shape.coffee":292,"./methods/size.coffee":293,"./methods/style.coffee":294,"./methods/temp.coffee":295,"./methods/text.coffee":296,"./methods/time.coffee":297,"./methods/timeline.coffee":298,"./methods/timing.coffee":299,"./methods/title.coffee":300,"./methods/tooltip.coffee":301,"./methods/total.coffee":302,"./methods/type.coffee":303,"./methods/ui.coffee":304,"./methods/width.coffee":305,"./methods/zoom.js":306,"./types/area.coffee":307,"./types/bar.coffee":308,"./types/box.coffee":309,"./types/bubbles.coffee":310,"./types/deprecated/chart.coffee":311,"./types/geo_map.coffee":312,"./types/line.coffee":322,"./types/network.js":323,"./types/paths.coffee":324,"./types/pie.coffee":325,"./types/radar.coffee":326,"./types/rings.js":327,"./types/sankey.coffee":328,"./types/scatter.coffee":330,"./types/table.js":331,"./types/tree_map.coffee":332}]},{},[163]);